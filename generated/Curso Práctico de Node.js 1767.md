[Curso Pr√°ctico de Node.js 1767](https://platzi.com/cursos/practico-node)

# Introducci√≥n al proyecto del curso y su arquitectura [5078]

## 0010. Arquitectura de un backend complejo [25315](https://platzi.com/clases/1767-practico-node/25315-arquitectura-de-un-backend-complejo/)

### Descripci√≥n:


### Comentarios:

* **Brando Rodr√≠guez** (10) [923889](https://platzi.com/comentario/923889/) 

	`Programador, showman, barbudo, profe e inventor.` Iniciemos con el curso

* **AryRosvall** (7) [1040907](https://platzi.com/comentario/1040907/) 

	Todas las clases deber√≠an comenzar as√≠, explicando la arquitectura y forma de trabajo antes de empezar a codear, eso es lo que nos va a dar se√±ority. Bien por este profe!

* **Pacool84** (6) [1016481](https://platzi.com/comentario/1016481/) 

	Les recomiendo que como complemento consulten esta clase de NODE
	
	<https://platzi.com/clases/1689-backend-js/22632-conceptualmente-rutas-controladores-y-bases-de-dat/>

	* **carlosextra1** [1016481] (2)

		gracias!

* **ing.stephanysc** (5) [1000422](https://platzi.com/comentario/1000422/) 

	Este loco si sabe explicar muy bien

* **Andres Roberto Coello Goyes** (4) [923994](https://platzi.com/comentario/923994/) 

	Desde que lo conoci en los otros cursos he eprendido mas rapido con el‚Ä¶

* **platzerito080420202** (3) [1111030](https://platzi.com/comentario/1111030/) 

	Porfin un profesor coherente, sugerencia: No coloquen cualquier persona que sepa mucho, puede saber mucho del tema pero si no tiene pedagogia para ense√±ar es como que te hable una pared. Este se√±or si sabe como exponer los temas y empiezas con una metodologia espectacular desde el principio. Me encanto!

* **Jos√© Mar√≠a Cuevas Ram√≠rez** (3) [1092989](https://platzi.com/comentario/1092989/) 

	Impecable Carlos, necesitamos m√°s cursos de √©l!

	* **Fernando Cordero** [1092989] (1)

		tiene varios: - curso de node, fundamentos de node y este que es el practico de node

	* **Jos√© Mar√≠a Cuevas Ram√≠rez** [1092989] (1)

		Ya los tom√© todos üòù

	* **Fernando Cordero** [1092989] (1)

		Entonces hace falta que haga mas curso Carlos jaja

* **Jmundaca** (3) [995646](https://platzi.com/comentario/995646/) 

	que bien Carlos , que buena actitud .

* **William Eduardo Meza** (3) [979333](https://platzi.com/comentario/979333/) 

	¬øEsta arquitectura tiene un nombre? ¬øalg√∫n blog o referencia para mayor documentaci√≥n?

	* **Juan Jos√© Vega Quintero** [979333] (1)

		Este es casi un est√°ndar. Todo lo que tenga que ver con backend del blog de platzi

* **Fernando Cordero** (2) [1117227](https://platzi.com/comentario/1117227/) 

	Aca los cursos que tiene Carlos en Platzi
	
	<https://platzi.com/clases/fundamentos-node/>  
	<https://platzi.com/clases/backend-js/>  
	<https://platzi.com/clases/practico-node/>

* **platzerito080420202** (2) [1111024](https://platzi.com/comentario/1111024/) 

	Este si es capo:D!

* **Cristian Franco Bedoya** (2) [1001785](https://platzi.com/comentario/1001785/) 

	Excelente como explica. Muy buenos cursos.

* **David Valecillo** (2) [982704](https://platzi.com/comentario/982704/) 

	Iniciando tercer curso seguido de node y @codingCarlos ‚Ä¶

* **Mois√©s Cede√±o** (2) [956367](https://platzi.com/comentario/956367/) 

	Yo utilizar√≠a una capa de middleware para validar algunos requests. Jajaja, ya vi que lo menciona. Grande este man.

* **matu_exe** (2) [947243](https://platzi.com/comentario/947243/) 

	estaba esperando hace tiempo que se desbloequeara este curso

* **Angel Hernandez** (2) [930210](https://platzi.com/comentario/930210/) 

	Parece ser muy prometedor este curso, tengo altas expectativas

* **Oscar Ballesteros Ballesteros** (2) [926366](https://platzi.com/comentario/926366/) 

	wena wena carlitos

* **Fernando Cordero** (2) [926244](https://platzi.com/comentario/926244/) 

	Feliz de volver a tomar un curso contigo @codingcarlos

* **citux** (2) [925104](https://platzi.com/comentario/925104/) 

	veamos q tal esta el curso

* **alejo6460** (1) [986782](https://platzi.com/comentario/986782/) 

	Listo para empezar

* **waldoaraque** (1) [983146](https://platzi.com/comentario/983146/) 

	Emocionado por empezar este curso!

* **MartinMB** (1) [979124](https://platzi.com/comentario/979124/) 

	Seguimos con mas Node

* **ehnbytes** (1) [976495](https://platzi.com/comentario/976495/) 

	Continuando con NodeJS

* **robertmezagarcia** (1) [952225](https://platzi.com/comentario/952225/) 

	Interesante, estoy emocionado

* **Fernando Hernandez** (1) [940548](https://platzi.com/comentario/940548/) 

	Que emoci√≥n!

* **leonardo-albino** (1) [930892](https://platzi.com/comentario/930892/) 

	Perfecto!

* **Luis Alexander Chip** (1) [926256](https://platzi.com/comentario/926256/) 

	Empieza bien el curso üòÉ, buena explicaci√≥n!

* **Jessie Buckland P√©rez** (1) [924788](https://platzi.com/comentario/924788/) 

	Creo que voy a hacer primero el curso b√°sico de Nodejs y luego vuelvo üòÉ

	* **fernandajofili (Platzi)** [924788] (1)

		Si, buena idea! Hay definiciones del curso b√°sico de Node.JS que ser√°n importantes aqu√≠.

* **Miguel √Ångel Mu√±oz Pozos** (1) [924030](https://platzi.com/comentario/924030/) 

	Que bonito curso desde que conoc√≠ nodejs me enamore es JavaScript en el servidor que bonito la verdad amo este lenguaje ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏èüòÅ

* **Ivan Llorente Fern√°ndez** (1) [923538](https://platzi.com/comentario/923538/) 

	que bien pinta este curso!!!

## 0020. Estructuras de datos para nuestro proyecto [25316](https://platzi.com/clases/1767-practico-node/25316-estructuras-de-datos-para-nuestro-proyecto/)

### Descripci√≥n:


### Comentarios:

* **gsusmab** (16) [923661](https://platzi.com/comentario/923661/) 

	Hice este peque√±o diagrama, tengo un poco de dudas de la entidad user_follow  
	![_Blank ERD & Data Flow.png](https://static.platzi.com/media/user_upload/_Blank%20ERD%20%26%20Data%20Flow-c1b73ed2-31b9-4515-9a35-33e68d8215e3.jpg)

	* **Angel Hernandez** [923661] (4)

		Usar el nombre de la tabla mas el _id es algo que no recomiendo üòÑ no digo que este mal, cada quien tiene su forma de trabajar, pero creo que todo se puede simplificar con el campo ‚Äúid‚Äù, por ejemplo: post ( id, id_usuario ), usuario ( id )

	* **gsusmab** [923661] (1)

		lo suelo hacer por comodidad al momento de hacer las consultas

	* **David Valecillo** [923661] (2)

		Esta practica es mas recomendada para nombres de campos que representan una llave for√°nea es decir: nombreTablaForanea_id, el nombre del campo que representa la llave for√°nea se nombra solo con ID, asi no se confunde con en tablas con muchas relaciones.

	* **David Valecillo** [923661] (1)

		 **Correcci√≥n:** el nombre del campo que representa la llave **Primaria** se nombra solo con ID, asi no se confunde con en tablas con muchas relaciones.

* **Wilson Marino Pablo Mendez** (11) [932374](https://platzi.com/comentario/932374/) 
	
	![Modelo ER.jpg](https://static.platzi.com/media/user_upload/Modelo%20ER-74590b3b-c924-44d9-9a88-db795e9b6924.jpg)

* **Sebastian** (7) [983521](https://platzi.com/comentario/983521/) 

	Por fin un curso con sql gracias.

* **Fernando Cordero** (5) [927242](https://platzi.com/comentario/927242/) 

	Gracias al curso de fundamentos de base de datos [https://platzi.com/clases/bd-2017/](url) puedo entender y acompa√±ar con claridad esta clase. Gracias Platzi

	* **carlosextra1** [927242] (1)

		Ya no est√° disponible ese curso

	* **Fernando Cordero** [927242] (1)

		@carlosextra1 puedes hacer el nuevo curso de fundamentos de bases datos!!  
		<https://platzi.com/clases/bd/>

* **MartinMB** (3) [979178](https://platzi.com/comentario/979178/) 

	Me hubiera gustado mas que fuera con mongo

	* **Cristian Franco Bedoya** [979178] (4)

		Puedes encontrar otro curso con este mismo profesor utilizando MongoDB.

	* **Juan Jos√© Vega Quintero** [979178] (1)

		<https://platzi.com/clases/backend-js/>

* **pabloverduzcos** (2) [1069069](https://platzi.com/comentario/1069069/) 

	Incre√≠ble ü§Ø

* **carlosextra1** (2) [1068400](https://platzi.com/comentario/1068400/) 

	Esto suena super bien. ya es el 3er curso con el profesor y todo es genial

* **Letov** (1) [1106051](https://platzi.com/comentario/1106051/) 

	Esto se puede hacer con mongoDb?

	* **Fernando Cordero** [1106051] (1)

		no deberias!

	* **David Flores** [1106051] (1)

		las relaciones no, pero puedes referenciar datos y un propiedad llamada populate para organizar tu informaci√≥n, el curso de Node js con este mismo profesor explican esa parte

* **Rabi Leonel Leon Chan** (1) [1095673](https://platzi.com/comentario/1095673/) 

	Excelente

# Creando la estructura principal [5079]

## 0030. Estructura inicial del proyecto API y rutas [25317](https://platzi.com/clases/1767-practico-node/25317-estructura-inicial-del-proyecto-api-y-rutas/)

### Descripci√≥n:


### Comentarios:

* **David Behar** (9) [997523](https://platzi.com/comentario/997523/) 

	Recordemos que se permite, me parece que desde ES8 poner valores dummy desde la inicializaci√≥n de las funciones:
	``` 
	    exports.error = (req, res, message = 'Internal Server Error', status = 500) => {
	      res.status(status).send({
	        error: true,
	        status,
	        body: message
	      })
	    }
	    
	    
	```

	* **Cristobal Vega** [997523] (2)

		Es correcto!. #PorUnC√≥digoM√°sLimpio

	* **David Behar** [997523] (2)

		A mi me gusta mucho inicializar desde los par√©ntesis, si se entiende mejor y es mucho menos c√≥digo, y ni hablar de que es pensar en menos nombres de variables que es un dolor de cabeza.

	* **Juan Jos√© Vega Quintero** [997523] (2)

		Gracias, que dato.

	* **Fernando Cordero** [997523] (1)

		Esta muy bien lo que hiciste, pero la idea de Carlos era si no viene un mensaje mandar el Internal Server Error? se sigue cumpliendo con tu codigo la condicion?

* **raparisg** (6) [950152](https://platzi.com/comentario/950152/) 

	Mi soluci√≥n al archivo ‚Äúresponse.js‚Äù:
	``` 
	    const httpStatus = require("http-status-codes");
	    
	    exports.success = (req, res, message = "", status = httpStatus.OK) => {
	      res.status(status).send({
	        error: false,
	        status: status,
	        body: message
	      });
	    };
	    
	    exports.error = (req, res, message = "Internal server error", status = httpStatus.INTERNAL_SERVER_ERROR) => {
	      res.status(status).send({
	        error: true,
	        status: status,
	        body: message
	      });
	    };
	    
	```
	
	Utilizo una librer√≠a para los c√≥digos HTTP: <https://www.npmjs.com/package/http-status-codes>  
	.  
	Adem√°s que utilizo el valor por defecto del par√°metro en la declaraci√≥n de la funci√≥n para no crear las variables statusCode ni statusMessage

	* **Fernando Cordero** [950152] (1)

		Me gusto esto‚Ä¶Lo implemente en mi codigo. Gracias

	* **Alfonso Navarro** [950152] (1)

		Muy bueno muchas gracias.

	* **AryRosvall** [950152] (2)

		Lo √∫nico que mejorar√≠a ser√≠a que en status: status ya no es necesario por la funcionalidad de EcmaScript podr√≠a quedar as√≠:
		``` 
		    res.status(status).send({
		        error: false,
		        status,
		        body: message,
		      });
		    
		```

* **Cristian Coronel** (5) [923834](https://platzi.com/comentario/923834/) 

	Hay un error en response.js, falta asignar el statusMessage y statusCode, al status y al body.
	
	De esta manera:
	``` 
	    exports.success = function (req, res, message, status){
	    
	      let statusCode = status || 200; 
	      let statusMessage = message || '';
	    
	      res.status(status).send({
	        error: false,
	        status: statusCode,
	        body: statusMessage
	      });
	    }
	    
	    exports.error = function (req, res, message, status){
	      
	      let statusCode = status || 500;
	      let statusMessage = message || 'Internal server error';
	    
	      res.status(status).send({
	        error: false,
	        status:statusCode,
	        body: statusMessage
	      });
	    }
	    
	```

* **emanuel-alejandro-mamani** (2) [1088293](https://platzi.com/comentario/1088293/) 

	Hola espero ayudar
	``` 
	    // llamado
	        response(req, res, { success: 'Todo correcto' }, { success: 200 });
	    
	    // funcion
	    functionresponse(req, res, message, status) {
	        let statusError,statusCode,statusMessage;
	        console.log(message);
	    
	        if (status.success) {
	            statusError = null;
	            statusCode = status.success || 200;
	            statusMessage = message.success || 'Success Operation';
	        }else{
	            statusError = message.error || 'Internal Server Error';
	            statusCode = status.error || 500;
	            statusMessage = null;
	        }
	    
	        res.status(statusCode).send({
	            error: statusError,
	            status: statusCode,
	            body: statusMessage
	    
	        });
	    }
	    
	```

* **brandon.arrieta** (2) [83787](https://platzi.com/comentario/1035419/) 
Que patr√≥n de dise√±o se utiliza en este dise√±o?

* **Fernando Cordero** (1) [1120149](https://platzi.com/comentario/1120149/) 

	Chicos por los momentos para que su ruta sea dinamica pueden hacerlo asi:
	``` 
	    // SERVER LISTENING
	    app.listen(config.api.port, () => {
	        console.log(`Api listening on port http://localhost:${config.api.port}/api/user`);
	    });```
	    y en el package.json agreguen en el script 
	    
	    
	    
	```
	``` 
	    "start": "nodemon api/index.js"```
	    
	```

* **valeria-martinez268** (1) [930418](https://platzi.com/comentario/930418/) 

	no me funciona el nodemon, me dice que: El t√©rmino ‚Äònodemon‚Äô no se reconoce como nombre de un cmdlet, funci√≥n, archivo de script o programa ejecutable. he intentado de todo y no me funciona‚Ä¶ ayuda!

	* **Gabriel De Andrade (Platzi)** [930418] (2)

		Hola! Parece que est√°s usando la terminal de Windows, esta puede dar m√°s problemas que la de Linux o Mac. Te recomiendo seguir este curso para armar tu entorno de desarrollo en Windows: [Curso de Prework](https://platzi.com/clases/prework/). De todas maneras, ¬øPuedes mostrarnos que pasa cuando corres el comando `npm install -g nodemon`? üòÑ

	* **deveeup** [930418] (1)

		Hola, en windows utilizo esta terminal [cmder](https://cmder.net/), o la de git.  
		Tambi√©n verifica que tienes instalado nodemon de manera globlal:  
		npm i nodemon -g

	* **Wilson Marino Pablo Mendez** [930418] (1)

		Puedes usar gitbash como terminal

	* **Francisco L√≥pez** [930418] (2)

		Instalando nodemon de forma global deber√¨a resolverse el problema. Prob√° correr:  
		npm install -g nodemon

## 0040. Aislar el c√≥digo de la base de datos [25318](https://platzi.com/clases/1767-practico-node/25318-aislar-el-codigo-de-la-base-de-datos/)

### Descripci√≥n:


### Comentarios:

* **Lele Lester** (6) [931947](https://platzi.com/comentario/931947/) 

	Ser√≠a bueno que programen todo en ingles o en espa√±ol pero no mezclar.

	* **Carlos Hern√°ndez** [931947] (13)

		Tienes toda la raz√≥n.  
		.  
		En mi d√≠a a d√≠a, exclusivamente programo en ingl√©s. Sin embargo, para los cursos intento hacerlo en espa√±ol, por facilitar el aprendizaje.  
		.  
		Es muy dif√≠cil estar atento a todos los detalles, y siempre pongo el foco en explicar con claridad, a costa de que se me pueda pasar el detalle del idioma.  
		.  
		En cualquier caso, este tipo de comentarios me ayudan a mejorar, muchas gracias!

* **David Behar** (5) [997560](https://platzi.com/comentario/997560/) 

	¬øEl archivo `network` se podr√≠a llamar `routes`, correcto?

	* **Enrique Alexis Lopez Araujo** [997560] (1)

		Es correcto david puedes tambien llamarlo asi

	* **David Behar** [997560] (2)

		Me parece m√°s claro porque se utiliza m√°s ese nombre y es m√°s descriptivo

* **Jorge Monge** (5) [934705](https://platzi.com/comentario/934705/) 

	Tambien se puede usar en la funcion get() de dummy find en lugar de filter, ya que find te regresa el primero que encuentra, y filter te regresa todos los que cumplan con la condicion.
	``` 
	    functionget(table,id){
	        let col = list(table)
	        return col.find(item => item.id == id) || null
	    }
	    
	```
	
	Ya que queremos que regrese el primero nos sirve el find.

* **Angel Hernandez** (3) [938240](https://platzi.com/comentario/938240/) 

	Esta forma de realizar las consultas a la base de datos es simple y ahorra tiempo, pero no la recomiendo para proyectos profesionales, en su lugar, lo mejor es crear procedimientos almacenados

* **Alfonso Navarro** (2) [1058280](https://platzi.com/comentario/1058280/) 

	Excelente teacher, cada vez se entiende mas todo este tema de Node‚Ä¶

* **Cristian Franco Bedoya** (2) [1046714](https://platzi.com/comentario/1046714/) 

	El mejor profesor. No hay forma de perderse con √©l.

* **AryRosvall** (2) [1040986](https://platzi.com/comentario/1040986/) 

	Les recomiendo usar la extensi√≥n de Chrome JSON viewer para que se vea m√°s comprensible el JSON en la ventana, facilita mucho la lectura. <https://chrome.google.com/webstore/detail/json-viewer/gbmdgpbipfallnflgajpaliibnhdgobh>

* **AryRosvall** (2) [1040980](https://platzi.com/comentario/1040980/) 

	Me gusta como vamos, solo como sugerencia todas las variables deber√≠an ir en ingl√©s. Hay que irnos acostumbrando al lenguaje y a tener un estandar.

	* **Gabriel De Andrade (Platzi)** [1040980] (3)

		Estoy de acuerdo, sin embargo este tambi√©n es un ambiente de did√°ctico y puede que al profe se le haya pasado escribir todo en ingl√©s üòõ. Pero estoy de acuerdo en que hay que tener un est√°ndar en lo que escribimos.

* **alejandromarcano** (2) [932041](https://platzi.com/comentario/932041/) 

	Muy bueno Profe Carlos. Al principio me enrede un poco, pero luego fui conectando. Excelente contenido

* **Baldan** (1) [1108810](https://platzi.com/comentario/1108810/) 

	cuando escribo: localhost:3000/api/user me da el siguiente error:  
	RangeError [ERR_HTTP_INVALID_STATUS_CODE]: Invalid status code: Todo correcto  
	at ServerResponse.writeHead (_http_server.js:208:11)  
	at ServerResponse._implicitHeader ( _http_server.js:199:8)  
	at write_ (_http_outgoing.js:585:9)  
	at ServerResponse.end (_http_outgoing.js:709:5)  
	at ServerResponse.send (C:‚Ä¶\PlatziSocial\node_modules\express\lib\response.js:221:10)  
	at ServerResponse.json (C:‚Ä¶s\PlatziSocial\node_modules\express\lib\response.js:267:15)  
	at ServerResponse.send (C:‚Ä¶\PlatziSocial\node_modules\express\lib\response.js:158:21)  
	at Object.exports.success (C:‚Ä¶\PlatziSocial\network\response.js:4:24)  
	at C:‚Ä¶\PlatziSocial\api\components\user\network.js:10:14  
	at Layer.handle [as handle_request] (C:‚Ä¶\PlatziSocial\node_modules\express\lib\router\layer.js:95:5)

	* **Baldan** [1108810] (1)

		Ya encontr√© el error, estaba en la siguiente funci√≥n del archivo network.js:
		
		`router.get('/', function (req, res){ response.success(req, res, 'todo correcto' 200); })`
		
		Y reescrib√≠ la funci√≥n tal y como Carlos lo ense√±a:  
		router.get(‚Äô/‚Äô, function (req, res){  
		const lista = Controller.list();  
		response.success(req, res, lista, 200);  
		})

* **Rabi Leonel Leon Chan** (1) [1095773](https://platzi.com/comentario/1095773/) 

	Excelente

* **charliEM** (1) [1083450](https://platzi.com/comentario/1083450/) 

	De los profes de Platzi con las clases mejor logradas!  
	Excelente!

* **carlosextra1** (1) [1069732](https://platzi.com/comentario/1069732/) 

	Excelente clase, y super interesante como separa lo de la db

* **Lele Lester** (1) [931955](https://platzi.com/comentario/931955/) 

	Me encanta c√≥mo explica el profesor. Muy bueno.

* **Baldan** (1) [86936](https://platzi.com/comentario/1108824/) 
RangeError [ERR_HTTP_INVALID_STATUS_CODE]: Invalid status code: Todo correcto at ServerResponse.writeHead (_http_server.js:208:11) at Ser...

## 0050. Rutas para usuarios [25319](https://platzi.com/clases/1767-practico-node/25319-rutas-para-usuarios/)

### Descripci√≥n:


### Links:

* [https://github.com/CodingCarlos/proyecto-backend-node-platzi/commit/072d4fa1faade941606e616cc8cc171765d33687](https://github.com/CodingCarlos/proyecto-backend-node-platzi/commit/072d4fa1faade941606e616cc8cc171765d33687)

### Comentarios:

* **Lele Lester** (9) [931999](https://platzi.com/comentario/931999/) 

	Podemos usar async/await si no queremos encadenar then y catch, wrappeando todo en un try catch
	``` 
	    router.get("/", async (req, res) => {
	        try {
	            constlist = await controller.list()
	            response.success(req, res, list, 200)    
	        } catch (error) {
	            response.error(req, res, error.message, 500)
	        }
	    });```
	    
	    
	    
	```

* **carlosextra1** (8) [1070084](https://platzi.com/comentario/1070084/) 

	es muy facil perderte en esta clase!!

* **Lele Lester** (3) [932004](https://platzi.com/comentario/932004/) 

	Podemos simplificar el codigo del controller preguntando por injected store y retornar las funciones directamente como arrows
	``` 
	    module.exports = (injectedStore) => {
	      if(!injectedStore) injectedStore = require("../../../store/dummy");
	    
	      return {
	        list: () => injectedStore.list(TABLE),
	        get: id => injectedStore.get(TABLE, id)
	      };
	    };
	    
	```

	* **Walter Alexis Gysin** [932004] (2)

		Esa simplificaci√≥n hace al c√≥digo incluso mas limpio. Me encant√≥!

	* **David Behar** [932004] (2)

		O podr√≠amos ponerlo como un valor inicializado desde los argumentos as√≠:
		``` 
		    module.exports = (injectedStore = require('../../store/dummy')) => {
		    
		      return {
		        list: () => injectedStore.list(TABLE),
		        get: (id) => injectedStore.get(TABLE, id),
		        upsert: (payload = null) => injectedStore.get(TABLE, payload),
		        _delete: (id) => injectedStore.get(TABLE, id)
		    
		      }
		    }
		    
		```

* **Emanuel Valero** (2) [1037522](https://platzi.com/comentario/1037522/) 

	Mi c√≥digo de user/network.js
	``` 
	    // The express server
	    const { Router } = require('express');
	    
	    // Required files for client responses and data controllers
	    const response = require('../../../network/responses');
	    const controller = require('./index');
	    
	    // Instantiating express router
	    const router = Router();
	    
	    
	    // Set up the list of users
	    router.get('/', (req, res) => {
	        controller.list()
	            .then( list => {
	                response.success( req, res, list, 200);
	            })
	            .catch( error => {
	                response.error( req, res, error.message, 500);
	            });
	    });
	    
	    // Set up the user matching an id
	    router.get('/:id', (req, res) => {
	        controller.get(req.params.id)
	            .then( user => {
	                response.success( req, res, user, 200);
	            })
	            .catch( error => {
	                response.error( req, res, error.message, 500);
	            });
	    });
	    
	    module.exports = router;
	    
	```

* **Byron Mesias Cueva Cabrera** (2) [972666](https://platzi.com/comentario/972666/) 

	Le solucione el reto asi:  
	![reto.png](https://static.platzi.com/media/user_upload/reto-5a187bb5-d012-4535-bf72-4c1e1ef643b7.jpg)

	* **JDiaz0017** [972666] (1)

		Excelente aporte compa√±ero, veo que has convertido en Controlador en una clase (prototipo internamente si mal no estoy), donde tan solo en el fichero index en el contexto del usuario, se agrega la palabra clave: new para crear una instancia de dicho controlador, pregunta:
		
		¬øen un proyecto a mayor escala dichas instancias de muchos controladores no repercutir√≠a en temas de performance?.  
		Muchas gracias y saludos.

* **AryRosvall** (2) [84024](https://platzi.com/comentario/1041047/) 
El if que puso en el controller creo que se puede mejorar, ¬øcu√°l de las siguientes opciones ser√≠a mejor usar y por qu√©? Opci√≥n 1: let st...

	* **Jorge Humberto Nemog√° Pinz√≥n** [84024] (1)

		Definitivamente la segunda opci√≥n es mejor que la primera.
		
		Ahora, esa segunda opci√≥n comparada con la del video son ambas f√°ciles de leer para el desarrrollador. No obstante, si vas a usar `let` es mejor la opci√≥n del profe o en caso de que el `require` sea largo; por el otro lado si fuera `const store` y el llamado al m√≥dulo no sea largo es mejor la segunda que planteas.
		
		Debemos recordar, que c√≥digos cortos no siempre significa eficiencia - puede usar menos l√≠neas pero si es a costo de que luego te demores entendiendo el porque entonces es mejor una forma verbosa que de claridad r√°pido del proceso.

* **Fernando Cordero** (1) [1122701](https://platzi.com/comentario/1122701/) 

	Yo lo solucione asi:
	
	dummy.js
	``` 
	    const db = {
	        'user': [
	            { id: '1', name: 'Carlos'},
	            { id: '2', name: 'Fernando'},
	        ],
	    };
	    
	    asyncfunctionlist(tabla) {
	        return db[tabla];
	    };
	    asyncfunctionget(tabla, id) {
	        let col = awaitlist(tabla);
	        return col.filter( item => item.id === id)[0] || null;
	    };
	    
	    asyncfunctionupsert(tabla, data) {
	    
	        console.log(data)
	        db[tabla].push(data);
	        return data
	    }
	    
	    asyncfunctionremove(id) {
	    
	        for(let i = 0; i < db.user.length; i++){
	            if(db.user[i].id == '2'){
	                idRemoved = db.user[i].id;
	                delete db.user[i];
	                return`User with the id:${idRemoved} deleted`;
	            }
	        }
	    };
	    
	    module.exports = {
	        list,
	        get,
	        upsert,
	        remove,
	    };
	    
	```
	
	controller.js
	``` 
	    const nanoid = require('nanoid');
	    // variable TABLE for user
	    const TABLA = 'user';
	    
	    // function created to injec the store
	    module.exports = function(injectedStore) {
	        // validating if store exist
	        let store = injectedStore;
	        if (!store) {
	            store = require('../../../store/dummy');
	        }
	        // one validation is false use the function require from db
	        functionlist() {
	            return store.list(TABLA);
	        }
	        functionget(id) {
	            return store.get(TABLA, id);
	        }
	    
	        functionupsert(body) {
	            console.log(body)
	            const user = {
	                name: body.name,
	            }
	            if (body.id) {
	                user.id = body.id
	            } else {
	                user.id = nanoid()
	            }
	    
	            return store.upsert(TABLA, user);
	        }
	    
	        functionremove(TABLA, id) {
	            return store.remove(id);
	        }
	    
	    
	        return {
	            list,
	            get,
	            upsert,
	            remove,
	        };
	    };
	    
	```
	
	network.js
	``` 
	    const express = require('express');
	    
	    const response = require('../../../network/response');
	    const Controller = require('./index');
	    
	    const router = express.Router();
	    
	    router.get('/', function(req, res) {
	        Controller.list()
	            .then((lista) => {
	                response.success(req, res, lista, 200);
	            })
	            .catch ((err) => {
	                response.error(req, res, err.message, 500);
	            });
	    })
	    router.get('/:id', function(req, res) {
	        Controller.get(req.params.id)
	            .then((user) => {
	                response.success(req, res, user, 200);
	            })
	            .catch ((err) => {
	                response.error(req, res, err.message, 500);
	            });
	    });
	    router.post('/', function(req, res) {
	        Controller.upsert(req.body)
	            .then((user) => {
	                response.success(req, res, user, 201);
	            })
	            .catch((err) => {
	                response.error(req, res, err.message, 500);
	            })
	    });
	    
	    router.delete('/:id', function(req, res) {
	        Controller.remove(req.params.id)
	            .then((user) => {
	                response.success(req, res, user, 200);
	            })
	            .catch((err) => {
	                response.error(req, res, err.message, 500);
	            });
	    });
	    
	    
	```
	
	Para usar nanoid tiene que bajarse a la version 2 para que les funcione. Y ademas, instalar body-parser para poder trabajar bien con el body.
	
	npm i nanoid@^2.0.0  
	npm i body-parser
	
	Espero que les sirva la info a los que van llegando

* **Andres Roberto Coello Goyes** (1) [1006200](https://platzi.com/comentario/1006200/) 

	```
	    const express = require('express');
	    const response = require('../../../network/response');
	    const controller = require('./index');
	    const router = express.Router();
	    
	    router.get('/', function(req, res){
	        controller.listar()
	            .then( data => {
	                response.success(req, res, data, 200);
	            })
	            .catch( err => {
	                response.error(req, res, err, 500);
	            })
	    })
	    
	    module.exports = router;
	    
	```

* **juanfar** (1) [1000334](https://platzi.com/comentario/1000334/) 

	Esto responde a alg√∫n patron de dise√±o??

* **Byron Mesias Cueva Cabrera** (1) [972513](https://platzi.com/comentario/972513/) 

	Que opina Carlos de utilizar Clases?  
	controller.js:
	``` 
	    const TABLA = 'user';
	    
	    module.exports = classUserController{
	    
	        constructor(store) {
	            this.store = store || require('../../../store/dummy');
	        }
	    
	        list() {
	            returnthis.store.list(TABLA);
	        }
	    }
	    
	```
	
	index.js:
	``` 
	    const store = require('../../../store/dummy');
	    const UserController = require('./controller');
	    
	    module.exports = new UserController(store);
	    
	```
	
	El controlador solo se crea una vez.

* **Juan Alejandro Pardo Rodriguez** (1) [944875](https://platzi.com/comentario/944875/) 

	Porque razon el parametro en el get de id, lleva dos puntos?  
	`/:id`, de otra forma no funciona

	* **Jorge Monge** [944875] (2)

		Ve el **/:id** como una variable, al momento de entrar a ese endpoint, lo que este en esa posicion en la url sera el valor de esa variable.  
		[Aqui puedes ver la doc](https://expressjs.com/en/api.html#req.params)

* **Angel Hernandez** (1) [938546](https://platzi.com/comentario/938546/) 

	Los nombres de archivos me parecen confusos, asi como la estructura de las carpetas, quiza usando nombres mas descriptivos seria mejor

	* **Juan Jos√© Vega Quintero** [938546] (1)

		Es un est√°ndar que usa Carlos

* **Baldan** (1) [86964](https://platzi.com/comentario/1109325/) 
Me pregunto que si igual que puedo obtener datos mi base de datos (dummy.js) puedo a√±adirle datos. ¬øPuedo a√±adirle datos a trav√©s de la c...

* **Baldan** (1) [86950](https://platzi.com/comentario/1109014/) 
Al final del v√≠deo, tras aparentemente poner todo lo que pone Carlos, al escribir http://local...

	* **Baldan** [86950] (1)

		¬øAlguien sabe c√≥mo puedo tener m√°s detalles de este problema?

## 0060. Documentaci√≥n de nuestra API [25320](https://platzi.com/clases/1767-practico-node/25320-documentacion-de-nuestra-api/)

### Descripci√≥n:


### Links:

* [Insomnia Is Now Open Source | Insomnia REST Client](https://insomnia.rest/blog/open-source-announcement/)

* [Swagger Editor](http://editor.swagger.io/)

* [swagger-ui-express  -  npm](https://www.npmjs.com/package/swagger-ui-express)

### Comentarios:

* **Byron Mesias Cueva Cabrera** (5) [972816](https://platzi.com/comentario/972816/) 

	Reto cumplido:  
	![reto2.png](https://static.platzi.com/media/user_upload/reto2-ac19edfc-4a58-44f0-8cef-3e3d8f9747f1.jpg)

	* **emanuel-alejandro-mamani** [972816] (1)

		Hola que tal, quer√≠a preguntarte como hiciste para documentar as√≠.

* **Miguel Anselmo Carbajal L√©vano** (3) [950401](https://platzi.com/comentario/950401/) 

	Para no instalar body-parser ya que desde express 4.16.0 lo incluye tuve que agregar estas l√≠neas en api/index.js
	``` 
	    app.use(express.json());
	    app.use(express.urlencoded({ extended: true }));
	    
	```

	* **Juan Jos√© Vega Quintero** [950401] (1)

		La l√≠nea 2 que hace?

* **Jose Luis Campos Bautista** (2) [1076443](https://platzi.com/comentario/1076443/) 

	[Postman](https://learning.postman.com/docs/postman/api-documentation/documenting-your-api/) te genera la documentaci√≥n de tu API.

* **Enrique Alexis Lopez Araujo** (2) [1025336](https://platzi.com/comentario/1025336/) 

	Algo que pense que nunca aprenderia de repente aparecio y hoy agradezco por haber aprendido que siempre va a servir de una forma u otra üíö

* **Fernando Cordero** (2) [973422](https://platzi.com/comentario/973422/) 

	Me costo un poquito entender como funcionaba, pero lo logre!

* **Marco Aurelio Elizalde Torres** (1) [1091726](https://platzi.com/comentario/1091726/) 

	Aguien le aparece este error al intentar abrir la documentaci√≥n del API en local:
	
	Unable to render this definition  
	The provided definition does not specify a valid version field.
	
	Please indicate a valid Swagger or OpenAPI version field. Supported version fields are swagger: ‚Äú2.0‚Äù and those that match openapi: 3.0.n (for example, openapi: 3.0.0).

* **carlosextra1** (1) [1070391](https://platzi.com/comentario/1070391/) 

	el documentar es algo muy muy importante en cualquier desarrollo

* **pabloverduzcos** (1) [1069210](https://platzi.com/comentario/1069210/) 

	Tambi√©n pueden utilizar los middlewares que vienen dentro del core de Express:
	``` 
	    app.use(express.urlencoded({
	      extended: true
	    }));
	    
	```
	
	[express.urlencoded([options])](http://expressjs.com/en/5x/api.html#express.urlencoded)
	``` 
	    app.use(express.json());
	    
	```
	
	[express.json([options])](http://expressjs.com/en/api.html#express.json)

* **Cristian Franco Bedoya** (1) [1050240](https://platzi.com/comentario/1050240/) 

	La documentaci√≥n es supremamente importante para llevar un correcto desarrollo y una gran forma de compartir c√≥digo con otros desarrolladores.
	
	Este profesor es el mejor!!!

* **David Behar** (1) [998839](https://platzi.com/comentario/998839/) 

	Se puede exportar la documentaci√≥n en markdown?

	* **Juan Jos√© Vega Quintero** [998839] (2)

		Solo veo json y YAML :c

	* **David Behar** [998839] (1)

		:C

* **Fernando Hernandez** (1) [963098](https://platzi.com/comentario/963098/) 

	Esta clase es mi preferida de la vida ‚Ä¶

* **Matias Niz** (1) [946810](https://platzi.com/comentario/946810/) 

	Podrias no instalar body-parser y utilizar la misma libreria de express con express.json()

* **Miguel √Ångel Mu√±oz Pozos** (1) [939972](https://platzi.com/comentario/939972/) 

	La forma en la que llama funciones en las rutas esa si no me la sabia profe muy buen trabajo

* **JaimeRamos** (1) [933319](https://platzi.com/comentario/933319/) 

	ufff excelente tip Carlos, saludos.

* **Lele Lester** (1) [932084](https://platzi.com/comentario/932084/) 

	Excelente herramienta y c√≥mo lo explica. Ideal usar swagger cuando tenemos un equipo de frontend consumiendo nuestra API.

* **Emmanuel J√≥se D√°vila Duque** (1) [931011](https://platzi.com/comentario/931011/) 

	excelente

* **JDiaz0017** (1) [81828](https://platzi.com/comentario/990623/) 
Saludos, tengo la duda: ¬øEn node habr√° un paquete que permita documentar las APIS a trav√©s de anotaciones en las cabeceras de los m√©todos...

	* **Juan David Castro (Platzi)** [81828] (1)

		Puedes usar JSDoc: <https://jsdoc.app/about-getting-started.html>.
		
		¬°O TypeScript! <https://platzi.com/clases/1642-javascript-profesional/22178-introduccion/>

# Autenticaci√≥n basada en tokens [5080]

## 0070. JWT Gesti√≥n de acceso [25321](https://platzi.com/clases/1767-practico-node/25321-jwt-gestion-de-acceso/)

### Descripci√≥n:


### Links:

* [JSON Web Tokens - jwt.io](https://jwt.io/)

### Comentarios:

* **David Behar** (10) [999205](https://platzi.com/comentario/999205/) 

	## Anatom√≠a de un JWT
	
	**JWT** es un **est√°ndar de la industria** que nos permite manejar demandas de **informaci√≥n entre dos clientes**.  
	.  
	Un JSON Web Token es un estandar que nos permite generar demandas entre 2 clientes de manera **segura**.  
	Un JWT est√° **encriptado** , pero tiene 3 partes principales divididas por ‚Äú`.`‚Äù (punto)
	
	  1. **Header** : Contiene los archivos de **configuraci√≥n** (el tipo y el **algoritmo** de **encriptaci√≥n** )
	  2. **Payload** : Guarda la **informaci√≥n** de nuestros usuarios
	  3. **Signature** : es la firma que contiene el header c√≥dificado m√°s el payload c√≥dificado, para poder dar acceso a un contenido, √©ste deber√° de ser **firmado con un secret** , que es la clave secreta con la que se firman los tokens, misma que s√≥lo la **deber√° de conocer el backend**.
	
	
	
	Dentro del payload tenemos informaci√≥n que puede ser **relevante para la autorizaci√≥n** tal como:
	
	* La **expiraci√≥n**
	* **Id‚Äôs**
	* **Nombres**
	* etc  
	.  
	Es importante saber que los JWT acabar√°n firmando mucha parte de la comunicaci√≥n, por lo que no es recomendable que mucha informaci√≥n viaje, √©sto puede acabar alentando tu aplicaci√≥n.
	
	

	* **carlosextra1** [999205] (2)

		Excelente aporte

	* **Rabi Leonel Leon Chan** [999205] (2)

		Buen aporte hermano

* **raparisg** (7) [952623](https://platzi.com/comentario/952623/) 

	Platzi tiene un curso muy bueno en d√≥nde hablan a profundidad de JWT. Recomendado: <https://platzi.com/clases/1439-autenticacion-oauth/15810-json-web-tokens5758/>

	* **Ren√© Sanchez** [952623] (1)

		Muy Buen aporte üíö

	* **Ramiro** [952623] (1)

		gracias por el dato!!

* **finaktiva** (1) [930321](https://platzi.com/comentario/930321/) 

	Entonces donde se recomienda guardar ese secreto? sino es en el c√≥digo?

	* **Gabriel De Andrade (Platzi)** [930321] (8)

		En un archivo .env que no est√© dentro de control de versiones (git). Este archivo te permite tener variables de entorno y guardar todas tus credenciales üòÑ

	* **Ren√© Sanchez** [930321] (2)

		Tambien puedes guardar ese secreto en una variable de entorno dentro de la nube üíö.

* **Fernando L√≥pez** (1) [927491](https://platzi.com/comentario/927491/) 

	Excelente curso! üòÑ

## 0080. Autenticaci√≥n registro [25322](https://platzi.com/clases/1767-practico-node/25322-autenticacion-registro/)

### Descripci√≥n:


### Comentarios:

* **raparisg** (5) [952808](https://platzi.com/comentario/952808/) 

	Vengo del mundo de Java y estoy acostumbrado a la creaci√≥n de clases que servir√°n como payloads de request y response en cada petici√≥n. Adem√°s de crear clases que simulan el modelo de la base de datos. ¬øEn NodeJS no se realiza esto? Veo que se crean objetos dentro de las funciones pero no creamos prototipos ni clases en ning√∫n componente. Quiz√°s la creaci√≥n de estas clases ayudar√≠an a tener un c√≥digo m√°s mantenible y robusto. ¬øQu√© opinan?

	* **Carlos Hern√°ndez** [952808] (17)

		Las clases en JavaScript son az√∫car sint√°ctico. Esto es, no cambian absolutamente nada por debajo, sino que le dan una forma distinta al c√≥digo.  
		.  
		Si tu ves m√°s claro el c√≥digo con clases, √∫salas. Si, c√≥mo es mi caso, lo ves mejor con funciones que devuelven objetos, entonces no las uses.  
		.  
		Por detr√°s, va a suceder lo mismo, y el rendimiento va a ser el mismo üòâ

* **carlosextra1** (1) [1071520](https://platzi.com/comentario/1071520/) 

	no me funciono nanoid. por lo tanto tuve que hacer algo r√°pido para seguir con el curso.
	``` 
	    //const nanoid = require('nanoid');
	    const auth =  require('../auth');
	    const TABLA =  'user';
	    
	    module.exports =  function (injecterStore) { 
	        let store = injecterStore;
	        if (!store) store = require('../../../store/dummy');
	    
	        functionlist() { 
	            return store.list(TABLA);
	        }
	    
	        functionget (id) { 
	            return store.get(TABLA, id);
	        }
	    
	        asyncfunctionupsert(body) {
	    
	            const user = {
	                name: body.name,
	                username: body.username
	            }
	            user.id = body.id ? body.id : Math.floor((Math.random() * 10000) ); //nanoid(10)
	    
	            if ( body.username || body.password ) {
	                await auth.upsert({
	                    id: user.id,
	                    username: user.username,
	                    password: body.password
	                })
	            }
	            
	            return store.upsert(TABLA, user);
	        }
	         
	        return {
	            list,
	            get,
	            upsert
	        }
	     }```
	    
	```

	* **Juan Jos√© Vega Quintero** [1071520] (1)

		Cierto  
		Que raro y revise en npm y esta funcionando bien

	* **Jose Luis Campos Bautista** [1071520] (3)

		Intenta importando nanoid de la siguiente forma
		``` 
		    //Argument destructure
		    const { nanoid } = require('nanoid');
		    
		```
		
		Documentaci√≥n [Nano ID](https://www.npmjs.com/package/nanoid)

	* **Juan Jos√© Vega Quintero** [1071520] (1)

		Gracias @luiscampos, ya me funcion√≥

	* **Rabi Leonel Leon Chan** [1071520] (1)

		Excelente @luisCampos, buen aporte

* **AryRosvall** (1) [84034](https://platzi.com/comentario/1041394/) 
¬øHay alguna forma de reutilizar el c√≥digo del index.js del user y el del auth, me salta mucho el que el c√≥digo est√© repetido en dos archi...

* **almaginet** (1) [79918](https://platzi.com/comentario/949073/) 
Me salta error de JSON parse con body-parser.

	* **almaginet** [79918] (2)
Solucionado

## 0090. Autenticaci√≥n login [25323](https://platzi.com/clases/1767-practico-node/25323-autenticacion-login/)

### Descripci√≥n:


### Links:

* [Curso de Express.js](https://platzi.com/clases/express-js/)

* [Curso de Autenticaci√≥n con Passport](https://platzi.com/clases/passport/)

### Comentarios:

* **Francisco L√≥pez** (7) [938274](https://platzi.com/comentario/938274/) 

	Muy buenas clases! Gracias!  
	Una recomendaci√≥n que no hace al funcionamiento pero ayuda a orientarse mejor respecto al archivo con el que estamos trabajando en cada momento, o localizar m√°s r√°pidamente los errores, etc:  
	A cada archivo network, controller u otros que se vayan agregando a la app, agregarle el nombre del componente al cual pertence.  
	Por ejemplo:  
	en el caso del componente user: user-network.js, user-controller.js  
	En el caso de auth: auth-network.js, auth-controller.js  
	Esto ayuda tambi√©n a localizarlo m√°s r√°pidamente en la funci√≥n de b√∫squeda del editor que usemos.  
	!! Obviamente el index.js queda como index.js para que pueda cumplir la funci√≥n que explica el profesor =) !!

	* **Raul Contreras** [938274] (4)

		Ademas, si es una clase la que exporta el archivo es recomendable poner el nombre en CamelCasing (notaci√≥n de camello) De esa manera con el nombre de la clase puedes ver lo que exporta

	* **Alver Ortega** [938274] (3)

		En mi opini√≥n no veo necesario nombrar los archivos de esa forma porque ya tienes el folder para identificar cada archivo.

	* **Alfonso Navarro** [938274] (1)

		Me parece buena practica lo q dices, ya q por ejemplo si tienes dos archivos controller en el editor puedes saber de formas mas f√°cil cual es el archivo.

* **Luis Alexander Chip** (4) [941296](https://platzi.com/comentario/941296/) 

	Una clase epica!

* **Briam Mart√≠nez Escobar** (2) [1019207](https://platzi.com/comentario/1019207/) 

	Una duda, lo √∫nico es que al generar el token de acceso, le estamos pasando data del usuario y con ello la contrase√±a, eso no ser√≠a buena pr√°ctica no?

	* **th3_bu6** [1019207] (1)

		lo que pasa es que la contrase√±a debe ser cifrada antes de enviarse

* **maxialvarezm** (2) [940991](https://platzi.com/comentario/940991/) 
Excelente clase!

* **Letov** (1) [1109013](https://platzi.com/comentario/1109013/) 

	No te compliques la vida, solo tienes un parametro! ajaja

* **emanuel-alejandro-mamani** (1) [1103203](https://platzi.com/comentario/1103203/) 

	que gran claseee, me re abri√≥ la mente esto de JWT jajaja

* **carlosextra1** (1) [1071682](https://platzi.com/comentario/1071682/) 

	Excelente clase. JWT es una herramienta muy buena yo la he usado con angular

* **Alvaro Rojas** (1) [1065393](https://platzi.com/comentario/1065393/) 

	Una pregunta por que el uso throw new Error y no Promise.reject? gracias

	* **Juan Jos√© Vega Quintero** [1065393] (1)

		Esto tal vez ayude  
		<https://stackoverflow.com/questions/33445415/javascript-promises-reject-vs-throw>

* **esteban-meza** (1) [1003779](https://platzi.com/comentario/1003779/) 

	exelente

* **Fernando Hernandez** (1) [964781](https://platzi.com/comentario/964781/) 

	que clase de nivel‚Ä¶

* **JaimeRamos** (1) [933455](https://platzi.com/comentario/933455/) 

	muy buena clase.

## 0100. Autenticaci√≥n cifrar contrase√±as para evitar problemas de seguridad [25324](https://platzi.com/clases/1767-practico-node/25324-autenticacion-cifrar-contrasenas-para-evitar-probl/)

### Descripci√≥n:


### Comentarios:

* **matu_exe** (4) [952913](https://platzi.com/comentario/952913/) 

	Si alquien tiene inconvenientes al instalar bcrypt (como los tuve yo ) en windows, la solucion es instalar las windows build tools. Tienes 2 opciones, la primera por consola y la segunda descagando un instalador
	
	  1. Abrir powershell con permisos de administrador pegar el siguiente comando`npm install --global --production windows-build-tools`  
	2- ir al siguiente enlace y descargar el instalador <https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=BuildTools>
	
	
	
	espero que les sea de ayuda

* **nancygtec** (4) [949275](https://platzi.com/comentario/949275/) 

	"Es el peor de todos los planes"  
	Ciertamente lo es üòâ

* **FRANKLIN MAURICIO CARRERO CONTRERAS** (4) [926184](https://platzi.com/comentario/926184/) 

	el metodo login lo he hecho asi
	``` 
	    asyncfunctionlogin(username, password) {
	        const data = await store.query(TABLA, {
	          username
	        });
	        const equals = await bcrypt.compare(password, data.password);
	        if (!equals) {
	          thrownewError('information not valid');
	        }
	        return auth.sign(data);
	      }
	    
	```

	* **Lele Lester** [926184] (1)

		Hice lo mismo con async/await me parece mucho mas facil de leer‚Ä¶ hubiese sido bueno que usen esto en todos los videos. Tambien podrian agregar destruct y arrow funcs.

* **Sebastian** (3) [985939](https://platzi.com/comentario/985939/) 

	profe cuando nos subcribimos al jwt no deberia ser mejor quitar la password del payload?

* **Rene Ismael Barrios Rojas** (2) [997820](https://platzi.com/comentario/997820/) 

	Minuto 2:13 dice index.html jajaja

* **Rabi Leonel Leon Chan** (1) [1096803](https://platzi.com/comentario/1096803/) 

	Excelente se ve tan simple la logica, muy bien !!! ü§òü§ò

* **Luis Arturo Lira Cerda** (1) [1083748](https://platzi.com/comentario/1083748/) 

	No s√© si yo me equivoqu√© en algo, pero en este punto el token se regresa con el password hasheado, algo que se supone que tampoco deber√≠a hacerse. Esto es debido a que en dummy, estamos devolviendo el objeto entero que encuentra en ‚Äúauth‚Äù. Por lo que antes de generar el token, se debe eliminar al contrase√±a.
	``` 
	    asyncfunctionlogin(username, password) {
	      const data = await store.query(TABLE, { username })
	    
	      if (await bcrypt.compare(password, data.password)) {
	        delete data.password
	        return auth.sign(data)
	      } else {
	        thrownewError('Invalid information')
	      }
	    }
	    
	```

* **carlosextra1** (1) [1072199](https://platzi.com/comentario/1072199/) 

	Nunca hab√≠a visto la capa de seguridad como la dice carlos! y me gusta la idea! Gracias !!

* **AryRosvall** (1) [1041713](https://platzi.com/comentario/1041713/) 

	me gustar√≠a mucho que explicara c√≥mo es que toma la decisi√≥n de hacer las funciones asincronas y cuando no es necesario.

	* **brandon.arrieta** [1041713] (2)

		Las funciones asincronas se utilizan cuando se consume algun recurso que puede tomar tiempo, por ejemplo bases de datos, consumir un API entre otras,

	* **brandon.arrieta** [1041713] (1)

		puedes ver este curso que explica de manera detallada:  
		<https://platzi.com/clases/asincronismo-js/>

	* **brandon.arrieta** [1041713] (1)

		En este caso como al encriptar la contrase√±a toma tiempo es por eso que se aplica el Async await

	* **th3_bu6** [1041713] (1)

		En mi opinion debes usar funciones asincronas cuando vas a ejecutar un proceso que demora mucho tiempo. Esto es para que tu aplicaci√≥n sea mas eficiente y ademas las debes usar cuando necesitas obtener algun recurso de otras fuentes (obtener informaci√≥n o procesar informaci√≥n ) se deberan usar funciones asincronas por que no sabes cuanto tardara la respuesta (esto se ve afectado por la carga del otro servidor y por los enlaces de internet ). Esto es para que no se detenga la ejecuci√≥n de tu aplicaci√≥n en lo que obtienes dicha respuesta.

* **Emanuel Valero** (1) [1038057](https://platzi.com/comentario/1038057/) 

	As√≠ me qued√≥ la funci√≥n login. Muy cortita y f√°cil de leer
	``` 
	    const login = async (username, password) => {
	      const data = await store.queryUser( TABLE, { username } );
	    
	      // cifrate data.password; then compare both passwords after login
	      return bcrypt.compare(password, data.password)
	          .then( equals => {
	             if( equals ) return auth.sign(data)
	             elsereturn'Invalid password';
	          });
	    }
	    
	```

* **Antonello Almerighi** (1) [1025019](https://platzi.com/comentario/1025019/) 

	Es mas f√°cil comparar negado as√≠, de ser falso se corta la ejecuci√≥n y se levanta el error.
	``` 
	    // Comparacion de contrase√±as con bcrypt
	            if (!await bcrypt.compareSync(password, data.password)) {
	                thrownewError('Informacioninvalida');
	           	}
	    
	```

* **alexibarra11** (1) [1017995](https://platzi.com/comentario/1017995/) 

	++npm install --save bcryptjs && npm uninstall --save bcrypt  
	++Este comando me sirvio para instalarlo, lo unico que ne el require debes de poner bycriptjs, lo demas no cambia

* **Fernando Cordero** (1) [977335](https://platzi.com/comentario/977335/) 

	Recuerden actualizar node para que bcrypt pueda trabajar

* **joserubilar** (0) [951525](https://platzi.com/comentario/951525/) 

	no puedo instalar bcrypt :‚Äô(

* **Fabian Figueroa** (0) [79731](https://platzi.com/comentario/945373/) 
Me sale el error data and hash arguments required en el bcrypt.compare try { userMiddleware.getPasswordByUser...

	* **David Valecillo** [79731] (1)

		Ese error se debe a que uno de los dos par√°metros esperados por el m√©todo compare esta vaci√≥ o es undefined.

## 0110. Autenticaci√≥n gesti√≥n de permisos [25325](https://platzi.com/clases/1767-practico-node/25325-autenticacion-gestion-de-permisos/)

### Descripci√≥n:


### Comentarios:

* **Joel Aravena Villegas** (5) [1013882](https://platzi.com/comentario/1013882/) 

	Ojito Ojito‚Ä¶ en el video logr√≥ hacer el PUT porque el lo creo por SU propia cuenta cuando nos dej√≥ el reto de que lo crearamos nosotros ‚Ä¶
	
	REVISA LA DOCUMENTACION DE LA CLASE PARA VER COMO LO HIZO
	
	EN => API/COMPONENT/USER/NETWORK

* **David Valecillo** (5) [986768](https://platzi.com/comentario/986768/) 

	 _Funciones an√≥nimas complican el debug, funciones con nombres facilitan la vida._ Sabias palabras del prof‚Ä¶ üòÉ

* **Jorge Humberto Nemog√° Pinz√≥n** (2) [1069303](https://platzi.com/comentario/1069303/) 

	Es m√°s f√°cil hacer revisi√≥n de fallos cuando las funciones tienen nombres, que cuando son fuciones an√≥nimas.

* **Rene Ismael Barrios Rojas** (2) [997994](https://platzi.com/comentario/997994/) 

	de donde viene la funci√≥n next() ? se que ejecuta la siguiente funci√≥n (creo‚Ä¶) pero no explico o no me escuche de donde, es propia de Node ?

	* **Gabriel De Andrade (Platzi)** [997994] (2)

		Hola! B√°sicamente le dice al programa, ‚Äúbusca la siguiente ruta, esta no es‚Äù [Stack Overflow](https://stackoverflow.com/a/13133140). Te recomiendo el [Curso de Express.js](https://platzi.com/clases/express-js/) üòÑ

	* **Rene Ismael Barrios Rojas** [997994] (1)

		Justo a eso voy el siguiente curso jaja gracias por la recomendaci√≥n. üòÉ

	* **Gabriel De Andrade (Platzi)** [997994] (1)

		Hola Ismael! Te lo recomendar√≠a incluso antes de este, este curso contiene mucho Express y ser√° m√°s f√°cil de entender si tienes buenas bases en este framework üòÑ

* **T-gold** (1) [1083361](https://platzi.com/comentario/1083361/) 

	que es Bearer???

	* **T-gold** [1083361] (1)

		gracias alison!!!

	* **Oditza Alison Gaete Sep√∫lveda** [1083361] (2)

		Bearer (portador)  
		La autenticaci√≥n de portador (tambi√©n llamada autenticaci√≥n de token ) es un esquema de autenticaci√≥n HTTP que involucra tokens de seguridad llamados tokens de portador. El nombre ‚ÄúAutenticaci√≥n de portador‚Äù puede entenderse como ‚Äúdar acceso al portador de este token‚Äù. El token portador es una cadena cr√≠ptica, generalmente generada por el servidor en respuesta a una solicitud de inicio de sesi√≥n. El cliente debe enviar este token en el encabezado ‚ÄúAuthorization‚Äù al realizar solicitudes a recursos protegidos
		
		`Authorization: Bearer <token>`

* **carlosextra1** (1) [1072208](https://platzi.com/comentario/1072208/) 

	Tip de funciones an√≥nimas vs funciones normales

## 0120. Comprobar verificaci√≥n con token [25326](https://platzi.com/clases/1767-practico-node/25326-comprobar-verificacion-con-token/)

### Descripci√≥n:


### Comentarios:

* **Natasha Silveira** (5) [1051223](https://platzi.com/comentario/1051223/) 

	Comentarios importantes a este punto:
	
	* En el replace de Bearer se esta haciendo como replace(‚ÄúBearer‚Äù, ‚Äú‚Äù) pero por defecto cuando se manda un token con este formato, por defecto se le agrega un espacio en el medio. Digamos que tu token es ‚Äúqwerty12345‚Äù al servidor va a llegar como ‚ÄúBearer qwerty12345‚Äù por ende para obtener correctamente el token y que no explote tenemos que hacer un replace con Bearer y un espacio, osea replace("Bearer ", ‚Äú‚Äù).
	
	* A este punto cuando hagan el update les va a crear un usuario nuevo. Esto esta bien por que en el metodo upsert definido en nuestro dummy simpletemente hacemos un push sobre nuestra tabla, no hacemos primero una buesqueda por id si el mismo nos viene y actualizamos o en caso contrario creamos un nuevo ‚Äúrecord‚Äù. Esto seguro va a estar resuelto cuando se use un store en si mismo pero si quieren arreglarlo por ahora pueden agregar un metodo de busqueda por id dentro de la tabla aunque como tip deberia la tabla en vez de ser un array ser un hash, donde cada key es un id, asi la busqueda se hace mas optima.
	
	* Les puede pasar que algunas exceptions que les salgan, lleguen hasta el cliente en la response, keep calm and watch the next class.
	
	
	
	
	Cualquier cosa estoy para dar una mano si tienen algun problema

	* **carlosextra1** [1051223] (1)

		Gracias!

* **David Behar** (3) [1000101](https://platzi.com/comentario/1000101/) 

	Por el momento no responde nuestro servidor al editar nuestro usuario, √©sto porque nunca llega a un response.success, para √©sto tenemos que devolver algo en el check, por ejemplo:
	``` 
	    const check = {
	      own: (req, owner) => {
	        const decoded = decodeHeader(req)
	    
	        if (decoded.id !== owner) throw error('no puedes hacer √©sto', 401)
	        return (true)
	      }
	    }
	    
	```
	
	y hacer un response en secure
	``` 
	    switch (action) {
	          case'update':
	            auth.check.own(req, owner) && response.success(req, res, `${req.body.name} editado`, 201)
	            break
	          default:
	            next()
	    
	```

	* **carlosextra1** [1000101] (1)

		Muchas gracias por el tip!

* **Lele Lester** (3) [935761](https://platzi.com/comentario/935761/) 

	Importante: jwt.verify si los tokens son diferentes te devuelve una exception. Para que no se rompa podes wrappear verify con un try-catch
	``` 
	    functionverifyToken(token) {
	      try {
	        return jwt.verify(token, secret)
	      } catch (error) {
	        thrownewError(error.message)
	      }
	    }
	    
	```

* **nancygtec** (2) [949347](https://platzi.com/comentario/949347/) 

	¬øEl error ‚ÄúNo puedes hacer esto‚Äù, no deber√≠a devolverse como un error estandarizado de los definidos previamente en el response?

	* **nancygtec** [949347] (2)

		jajaja ok, tranquilos, esto se resuelve en la pr√≥xima clase üòÉ

* **T-gold** (1) [1083633](https://platzi.com/comentario/1083633/) 

	muy buena clase en la anterior no habia entendido nada y en esta se aclaro todo!!

* **esteban-meza** (1) [1005047](https://platzi.com/comentario/1005047/) 

	ami me crea otro usuario

* **maxialvarezm** (1) [941823](https://platzi.com/comentario/941823/) 
Impecable. C√≥mo usar un Middleware propio como control de seguridad

* **Lele Lester** (1) [935758](https://platzi.com/comentario/935758/) 

	Me encontr√© con un error super extra√±o. Usando el mismo token siempre me devolv√≠a error jwt.verify.  
	Hice console.log del token generado contra el token que recibo, exactamente los mismos.
	
	Si llegas hasta ac√° y tuviste ese error, yo lo resolv√≠ usando TRIM dentro de la function getToken
	``` 
	    functiongetToken(authorization) {
	      if (!authorization) thrownewError("No auth token sent");
	      if (authorization.indexOf("Bearer ") === -1)
	        thrownewError("Invalid token format");
	        const token = authorization.replace("Bearer", "");
	        return token.trim()
	    }
	    
	```

	* **maxialvarezm** [935758] (8)
Verific√° el replace, est√°s usando "Bearer" y deber√≠a ser "Bearer " ( con un espacio), ya que en el encabezado se env√≠a un string como este "Bearer xxxxxxx", lo que los interesa es lo de xxxx (sin el espacio separador). Trim lo que hace es sacar espacio excedente.

* **Jmundaca** (0) [1024453](https://platzi.com/comentario/1024453/) 

	a mi me agrega otro Usuario , porfavor actualizar esta secci√≥n

## 0130. Gesti√≥n avanzada de errores Throw [25327](https://platzi.com/clases/1767-practico-node/25327-gestion-avanzada-de-errores-throw/)

### Descripci√≥n:


### Comentarios:

* **Alver Ortega** (5) [987884](https://platzi.com/comentario/987884/) 

	les comparto mi implementaci√≥n del middleware de error
	``` 
	    const Sentry = require('@sentry/node');
	    const debug = require('debug')('api:error');
	    const config = require('./../config');
	    const response = require('./../network/response');
	    
	    const sentryUrl = `https://${config.sentry.dns}@sentry.io/${config.sentry.id}`;
	    Sentry.init({ dsn: sentryUrl });
	    
	    functionwithErrorStack(err, stack) {
	        if (config.dev) {
	            return { ...err, stack }
	        }
	    }
	    
	    functionlogErrors(err, req, res, next) {
	        Sentry.captureException(err);
	        debug(err.stack);
	        next(err);
	    }
	    
	    functionerrorHandler(err, req, res, next) {
	        const { statusCode } = err;
	        response.error(req, res, withErrorStack(err, err.stack), statusCode);
	    }
	    
	    module.exports = {
	        logErrors,
	        errorHandler,
	    }
	    
	```

* **Lele Lester** (2) [936488](https://platzi.com/comentario/936488/) 

	Entiendo el uso del helper lo que no entiendo es porqu√© repetimos en network/response la misma logica del status code y status msg.
	
	Ahora tenemos todos los errores centralizados dentro de utils/error, con lo cual no deberiamos llamar a network error sino llamar a utils/error y es este error catcheado por network error.
	
	Podemos modificar entonces network/response la function error
	``` 
	    exports.error = (req, res, message, status) => {
	      res.status(status).send({
	        error: true,
	        status,
	        body: message
	      });
	    };
	    
	    
	```

	* **Matias Niz** [936488] (4)

		El middleware tambien va a responder cuando se visite una ruta que no este definida con un mensaje de error y cualquier otra expecion que surgiera por una mala implementacion nuestra. La logica de network a la que te refieres son errores controlados por nosotros, cuando se solicita el recurso de las rutas que estamos controlando. Pero como comente, si visitaran otra ruta, o surgiera un error no controlado va a ser interceptado por ese ultimo middleware. Antes de este se podria agregar un middleware mas para generar por ejemplo un log de errores.

	* **Ezequiel Guerra** [936488] (5)

		- **./utils/error.js** : Este se encarga de generar un nuevo error dentro de nuestra api. Ej: en registrar nuevo usuario si falta el par√°metro username generamos un nuevo error con esta utilidad.
		
		- **./network/errors.js** : Este es un middleware que se va a encargar de capturar todos los errores que hayamos generados en el api.
		
		Al ser un middleware lo trabaja separado de lo que es la l√≥gica del _response_ , cada vez que se genera el error con throw error() debemos llamar a next() dentro del catch de la promesa para que el middleware maneje ese error.

* **TlalocES** (1) [932746](https://platzi.com/comentario/932746/) 

	Fijes√© que igual le devuelve un error:false cuando deber√≠a ser true, supongo que se solucionara en adelante.

	* **Oditza Alison Gaete Sep√∫lveda** [932746] (1)

		Eso se cambia en la carpeta network>response.js  
		en exports.success y exports.error
		``` 
		    res.status(statusCode).send({
		            error: false,
		            status: statusCode,
		            body: statusMessage
		        })
		    
		```
		
		donde error: false debe cambiar a error: true para exports.error

# Almacenando datos: MySql [5081]

## 0140. Base de datos real MySQL [25328](https://platzi.com/clases/1767-practico-node/25328-base-de-datos-real-mysql/)

### Descripci√≥n:


### Links:

* [Free Remote MySQL](https://remotemysql.com/)

### Comentarios:

* **David Behar** (3) [1002477](https://platzi.com/comentario/1002477/) 

	Para crear la funci√≥n get, simplemente hacemos lo mismo, pero usando el id (de la manera que el profe explic√≥ primero)
	``` 
	    const get = async (table, id) => new Promise((resolve, reject) => {
	      connection.query(`SELECT * FROM ${table} WHERE id = '${id}'`, (error, data) => {
	        if (error) return reject(error)
	        resolve(data)
	      })
	    })
	    
	    
	```

	* **Alfonso Navarro** [1002477] (1)

		gracias amigo

* **David Behar** (3) [1002471](https://platzi.com/comentario/1002471/) 

	¬øQui√©n m√°s siente que en mysql es m√°s sencillo?

	* **carlosextra1** [1002471] (2)

		si, creo que es porque ya estamos acostumbrados!

	* **Rabi Leonel Leon Chan** [1002471] (1)

		justamente pens√© lo mismo üòÅüòÅ

	* **Jos√© Mar√≠a Cuevas Ram√≠rez** [1002471] (2)

		Creo que a mi me gusta m√°s MongoDB üòù

* **Fernando Hernandez** (3) [965012](https://platzi.com/comentario/965012/) 

	Ver como consultas a la BBDD y todo funciona ‚Ä¶ que lindo‚Ä¶

* **raparisg** (3) [955454](https://platzi.com/comentario/955454/) 

	En la clase nos conectamos con el driver de MySQL directo. Cosa que est√° excelente para aprender! Excelente clase  
	.  
	Igualmente existen ORM en Node que nos facilitar√° el desarrollo. Ac√° uno bien popular para qui√©n pueda interesar: <https://sequelize.org/v5/manual/getting-started.html>

	* **Lele Lester** [955454] (1)

		Sequelize me dio muchisimos dolores de cabeza cuando tuve que armar las asociaciones y la documentaci√≥n es muy mala.
		
		Knex me pareci√≥ una buena opci√≥n pero hay que escribir las sentencias de sql en el c√≥digo y a veces es engorroso.

* **gsusmab** (3) [926391](https://platzi.com/comentario/926391/) 

	 **Congiguracion para usar el[Mysql Community Server](https://dev.mysql.com/downloads/mysql/)**  
	Yo lo instale a traves de el [Mysql Installer for Windows](https://dev.mysql.com/downloads/installer/) para no complicarme la vida con los usuarios y contrase√±as, no olviden agregar la carpeta bin de mysql al PATH.
	
	**Antes de ejecutar el servidor**
	
	  1. Iniciar sesi√≥n a trav√©s del cmd con el comando
	
	
	``` 
	     mysql -u tu_usuario -h localhost -p
	    
	```
	
	(presionan enter y escribir la password).
	
	  1. Otorgar privilegios flush al usuario para que no te provoque error al conectarse al servidor en Node:
	
	
	``` 
	    ALTERUSER tu_usuario IDENTIFIEDWITH mysql_native_password BY'password_de_tu_usuario';
	    flushprivileges;
	    
	```
	
	Si quieres utilizar el usuario root:
	``` 
	    ALTERUSER root@localhost IDENTIFIEDWITH mysql_native_password BY'password_root';
	    flushprivileges;
	    
	```
	
	  1. Necesitamos crear la base de datos:
	
	
	``` 
	    CREATEDATABASE nombe_de_la_bd;
	    
	```
	
	Puedes comprobar que se cre√≥ con:
	``` 
	    SHOWDATABASES;
	    
	```
	
	  1. Colocar en el host la dirrecion 127.0.0.1 (equivalente a localhost) y agregar a la configuraci√≥n el puerto, que por lo general es el 3306.
	
	
	``` 
	    // mysql.js
	    ...
	    const dbconfig = {
	      host: config.mysql.host,
	      port: config.mysql.port,
	      user: config.mysql.user,
	      password: config.mysql.password,
	      database: config.mysql.database
	    };
	    ...
	    
	    // config.js
	    ...
	    mysql: {
	        host: process.env.MYSQL_HOST || "127.0.0.1",
	        port: process.env.MYSQL_PORT || "3306",
	        user: process.env.USER || "gsus",
	        password: process.env.MYSQL_PASSWORD || "1234",
	        database: process.env.MYSQL_DATABASE || "pruebamicro"
	      }
	    ...
	    
	```

* **Tob√≠as Schwarz** (1) [961900](https://platzi.com/comentario/961900/) 

	Me encant√≥ que no tengamos que instalarnos MySQL en la PC para poder continuar con el curso, al menos para los que usamos otras DBs como PSQL o MongoDB.  
	Genial herramienta Remote MySQL.

* **TlalocES** (1) [932922](https://platzi.com/comentario/932922/) 

	Actualmente esta la version 2, no hay diferencias?

* **ThAlan** (1) [923373](https://platzi.com/comentario/923373/) 

	¬øSi quiero utilizar node y sql para producci√≥n que hosting de mysql me recomiendan?  
	Igual uno que no sea muy caro.

	* **Lele Lester** [923373] (2)

		Te recomiendo probar heroku, me ha resultado bastante bueno y facil de utilizar. No tuve que pagar nada.

* **JDiaz0017** (1) [81904](https://platzi.com/comentario/992958/) 
¬øA alguien le ha funcionado la tra√≠da de los parametros definidos en el fichero .env? a mi de momento no me trae los par√°metros de dicho ...

	* **Luis Arturo Lira Cerda** [81904] (1)

		¬øC√≥mo tienes tu c√≥digo?  
		Para que funcione, el archivo .env debe estar en la ra√≠z y donde quieras usarlo debes poner
		``` 
		    const dotenv = require('dotenv')
		    dotenv.config()
		    
		```
		
		o creo que tambi√©n se puede con
		``` 
		    require('dotenv').config()
		    
		```
		
		Y en el .env deben ser
		``` 
		    TU_VARIABLE=VALOR
		    OTRA_VARIABLE=VALOR
		    
		```

## 0150. Completando la base de datos [25329](https://platzi.com/clases/1767-practico-node/25329-completando-la-base-de-datos/)

### Descripci√≥n:


### Comentarios:

* **nancygtec** (7) [954426](https://platzi.com/comentario/954426/) 

	La l√≥gica del _upsert_ para determinar si llamar al _insert_ o al _update_ no est√° funcionando.
	
	Tal como est√° el c√≥digo, **siempre** viene informaci√≥n dentro del _[data.id](http://data.id)_ (si es registro **nuevo** el _[data.id](http://data.id)_ lo estamos llenando desde el _controller_ con el _id_ generado por _nanoid_ ).
	
	Como desde el controlador para cualquier caso _[data.id](http://data.id)_ viene lleno, entonces se est√° entrando directamente al _update_ y nunca en el _insert_.
	
	Para solventar esto yo agregu√© un par√°metro en la funci√≥n _upsert_ que me dice si el registro es nuevo o no:
	``` 
	    function upsert(table, data, isNew){
	        if(data && isNew){
	            return insert(table, data);
	        }else{
	            return update(table, data);
	        }
	    }
	    
	```
	
	No s√© si hay alguna mejor forma de hacerlo.

	* **raparisg** [954426] (5)

		Buena observaci√≥n! Yo utilic√© el m√©todo get para saber si el ID ya corresponde a un registro. En caso de que sea as√≠, lo actualiza. De caso contrario, lo inserta. As√≠:
		``` 
		    asyncfunctionupsert(table, data) {
		      const row = await get(table, data.id);
		      if (row.length === 0) {
		        return insert(table, data);
		      } else {
		        return update(table, data);
		      }
		    }
		    
		```

	* **Ezequiel Mella Leonardelli** [954426] (3)

		Sisi lo que yo hice fue quitar la creacion del id con nanoid(), y en la base de datos poner el id autoincremental, ya que lo que no hace falta ahora es crear nuestros propios ids

	* **Alan Alexis Arostegui Maranto** [954426] (1)

		Yo prob√© sus m√©todos pero ninguno me funcion√≥ üò¶

	* **Ernesto Vizca√≠no Alvarado** [954426] (1)
Hola @nancygtec puedes explicar c√≥mo lo solucionaste por favor es que no he podido hacer que funcione para mi. Gracias

	* **Fernando Hernandez** [954426] (1)

		Hola @nancygtec! y el isNew lo pasas por Json con como un Boolean ? o como lo manejas?

	* **Cristian Fabian Tovar** [954426] (3)

		Me pasaron una soluci√≥n:  
		<https://github.com/crizy182/proyecto-backend-node-platzi/tree/Fix>

	* **Fernando Hernandez** [954426] (1)

		Hola @CristianTovar, Gracias por el Fix pero:
		``` 
		    code: 'ER_BAD_FIELD_ERROR',
		      errno: 1054,
		      sqlMessage: "Unknown column 'mF9eXsaKCtynePZlLZIE6' in 'where clause'",
		      sqlState: '42S22',
		      index: 0,
		      sql: 'SELECT * FROM auth WHERE id=mF9eXsaKCtynePZlLZIE6'
		    
		```

	* **Cristian Fabian Tovar** [954426] (1)

		La otra posibilidad de que te falle, es que la definici√≥n de DB no coincida, solo por asegurar que te qued√© igual, corre este script de SQL en el phpMyAdmin (prefiriblemente ensayando con una DB nueva):
		``` 
		    CREATETABLEuser(
		        idVARCHAR(32),
		        username VARCHAR(32),
		        nameVARCHAR(64)
		    );
		    
		    INSERTINTO`user`(`id`,`username`,`name`)
		    VALUES ('123','cristian','cristian');
		    
		    CREATETABLE auth(
		        idVARCHAR(32),
		        username VARCHAR(32),
		        passwordVARCHAR(64)
		    );
		    
		    
		```

	* **David Behar** [954426] (3)

		Yo ataqu√© el problema desde mysql con el `ON DUPLICATE KEY`
		``` 
		    const upsert = async (table, payload) => newPromise((resolve, reject) => {
		      connection.query(`INSERT INTO ${table} SET ? ON DUPLICATE KEY UPDATE ?`, [payload, payload], (error, data) => {
		        console.log('UPDATE DATA: ', data)
		        if (error) {
		          return reject(error)
		        }
		        resolve(data)
		      })
		    })
		    
		```

	* **Ernesto Vizca√≠no Alvarado** [954426] (2)

		@david-behar Wow, gracias brother, si me funciono creo que tengo que hecharle un vistazo al curso de mysql.

	* **David Behar** [954426] (3)

		Hice este acercamiento por flojo, busqu√© en Google literalmente, `upsert mysql query`, lo bueno de mysql es que como es viejo, es f√°cil encontrar la respuesta a todo en internet

* **David Behar** (4) [1002650](https://platzi.com/comentario/1002650/) 

	Si cambiamos un poco la estructura de nuestra tabla de mysql (haciendo que el username sea √∫nico lo que es lo correcto), podr√≠amos s√≥lo hacer una funci√≥n para el upsert:
	``` 
	    const upsert = async (table, payload) => newPromise((resolve, reject) => {
	      connection.query(`INSERT INTO ${table} SET ? ON DUPLICATE KEY UPDATE ?`, [payload, payload], (error, data) => {
	        console.log('UPDATE DATA: ', data)
	        if (error) {
	          return reject(error)
	        }
	        resolve(data)
	      })
	    })
	    
	```

	* **Fernando Cordero** [1002650] (2)

		Esta fue la solucion que me sirvio a mi‚Ä¶gracias

	* **Emanuel Valero** [1002650] (2)

		Gracias David!
		
		Tu soluci√≥n me funcion√≥ a la perfecci√≥n a mi tambi√©n üòÑ

	* **Jose Luis Campos Bautista** [1002650] (2)

		Excelente aporte, gracias

* **ing-moreno** (4) [938990](https://platzi.com/comentario/938990/) 

	Tuve un problema al generar el token debido a que el resultado de la query es un rowdatapacket. Lo solucione creando un nuevo objeto simple para que el metodo sign de jwt no me genere problemas.
	``` 
	    function query(table, query){
	        return new Promise((resolve, reject) => {
	            connection.query(`SELECT * FROM ${table} WHERE ?`, query,(error, result)=>{
	                if(error) return reject(error)
	                
	                // Necesario para evitar el rowdatapacket
	                let output = {
	                    id: result[0].id,
	                    username: result[0].username,
	                    password: result[0].password
	                }
	                
	                resolve(output, null)
	            })
	        })
	    }
	    
	```

	* **Francisco L√≥pez** [938990] (2)

		Otra opci√≥n puede ser pasar a string el resultado, y luego de eso pasarlo a json. As√≠:
		
		let string = JSON.stringify(result);  
		let output = JSON.parse(string);

	* **nancygtec** [938990] (3)

		Es un buen comentario y tambi√©n la respuesta de Francisco.
		
		Ahora bien, mi recomendaci√≥n es que no editen la funci√≥n ‚Äúquery‚Äù del store, porque cuando les venga un resultado vac√≠o van a tener problemas.
		
		Como la funci√≥n que falla es ‚Äúsign‚Äù de jwt y √©sta se encuentra dentro del login, me parece mejor hacer el cambio all√≠ y as√≠ no afectar las dem√°s llamadas a la funci√≥n ‚Äúquery‚Äù.
		
		La funci√≥n query, quedar√≠a tal como en el video y la funci√≥n login quedar√≠a as√≠:
		``` 
		    asyncfunctionlogin(username, password){
		            const data = await store.query(TABLE, {username: username});
		            return bcrypt.compare(password, data.password)
		                .then(sonIguales => {
		                    if(sonIguales === true){
		                        //Este ser√≠a el cambio
		                        return auth.sign(JSON.parse(JSON.stringify(data)));
		                    }else{
		                        thrownewError('Informaci√≥n inv√°lida')
		                    }
		                });
		        }
		    
		```

	* **Carlos Andr√©s Charris S** [938990] (2)

		Yo solucione el error del login de esta manera:
		``` 
		    function query(table, q) {
		      return new Promise((resolve, reject) => {
		        connection.query(`SELECT * FROM ${table} WHERE ?`, q, (err, result) => {
		          if (err) return reject(err);
		          let output;
		          if (result.length > 0) {
		            output = { ...result[0] };
		          }
		    
		          resolve(output || null);
		        });
		      });
		    }
		    
		```

	* **Ezequiel Mella Leonardelli** [938990] (3)

		Si el tema es que los campos pueden variar, y supuestamente este modulo es para todas las consultas, te cuento como lo solucione
		``` 
		    if (err) return reject(err);
		    result=JSON.stringify(res[0]);
		    result=JSON.parse(result)   
		    resolve(result || null);
		    
		```

	* **Alan Alexis Arostegui Maranto** [938990] (3)

		yo simplemente tom√© una copia de los datos.
		``` 
		    asyncfunctionlogin(username, password) {
		        // Busca en la tabla todos los valores "username"
		        const data = await store.query(TABLE, { username: username });
		    
		        const match = await bcrypt.compare(password, data.password);
		        if (!match) {
		          thrownewError("Informacion invalida");
		        }
		        //Generar token
		        return auth.sign({...data});
		      }```
		    
		```

	* **AryRosvall** [938990] (1)

		Mi soluci√≥n a este problema que comentan fue pasar data como un objeto a la funci√≥n auth.sign as√≠
		``` 
		    asyncfunctionlogin(username, password) {
		    
		        const data = await store.query(TABLE, { username: username });
		    
		        const areEquals = await bcrypt.compare(password, data.password);
		    
		        if (!areEquals) thrownewError("Error: Informaci√≥n inv√°lida");
		    
		        return auth.sign({ data });
		      }```
		    
		```

* **Ernesto Vizca√≠no Alvarado** (3) [1026016](https://platzi.com/comentario/1026016/) 

	Pueden usar [db4free](https://www.db4free.net/) o [freemysqlhosting](https://www.freemysqlhosting.net/) como sustituto a remotemysql

* **carlosextra1** (2) [1073669](https://platzi.com/comentario/1073669/) 

	Estoy bloqueado con este error **Expected ‚Äúpayload‚Äù to be a plain object.** veo que es de jwt pero no se de porque.
	
	estes mi auth.js
	``` 
	    const jwt = require('jsonwebtoken')
	    const config = require('../config');
	    
	    const secret = config.jwt.secret;
	    
	    functionsign(data) {
	        data.id = parseInt(data.id.toString()); 
	        return jwt.sign(data, secret)
	    }
	    
	    functionverify(token) {
	        return jwt.verify(token, secret);
	    }
	    const check = {
	        own: function(req, owner) {
	           const decoded = decodeHader(req)
	           console.log(decoded);    
	        }
	    }
	    functiongetToken(auth) {
	        if (!auth)
	            thrownewError('No viene ningun token')
	        
	        if ( auth.indexOf('Bearer ') === -1 )
	            thrownewError('Formato invalido');
	        
	        let token = auth.replace('Bearer ', '');
	        return token;
	    }
	    functiondecodeHader(req) {
	        const authorization = req.headers.authorization || '';
	        const token = getToken(authorization)
	        const decoded = verify(token);
	    
	        req.user = decoded;
	    
	        return decoded;
	    }
	    module.exports = {
	        sign,
	        check
	    }
	    
	```

	* **carlosextra1** [1073669] (2)

		pude hacer la correcci√≥n y asi quedo mi funci√≥n sign
		``` 
		    functionsign(data) {
		        data = JSON.parse(JSON.stringify(data));
		        return jwt.sign(data, secret)
		    }
		    
		```

	* **Rabi Leonel Leon Chan** [1073669] (2)

		Excelente carlos, con json.parse evite ese problema

* **esteban-meza** (2) [1009068](https://platzi.com/comentario/1009068/) 

	yo tenia un problema con la promesa por lo que la modifique un poco para que me generara el codigo
	
	async function login(username,password) {  
	console.log(‚Äòingres2o‚Äô)  
	console.log(username+‚Äô??‚Äô+password)  
	const data= await store.query(TABLA,{username:username})  
	console.log(data.password)  
	let retorna = bcrypt.compareSync(password, data.password)  
	console.log(retorna)  
	if(retornatrue){  
	// return auth.sign(data)  
	return auth.sign(JSON.parse(JSON.stringify(data)));  
	}  
	else{  
	throw new Error (‚Äòinfo123 invalida‚Äô)  
	}  
	// bcrypt.compareSync(password, data.password)  
	// .then(igual=>{  
	// if(igual=true){  
	// console.log(bcrypt.compareSync(password, data.password))  
	// // generar token  
	// return auth.sign(data)  
	// } else{  
	// throw new Error (‚Äòinfo123 invalida‚Äô)  
	// };  
	// });
	``` 
	        // return data
	    }
	```

* **raparisg** (2) [955511](https://platzi.com/comentario/955511/) 

	No me queda clara la ventaja de usar un s√≥lo m√©todo para insertar y actualizar. Entiendo que los ORM funcionan as√≠. Pero en nuestro caso, que no estamos usando ninguno, no deber√≠amos cuidar la separaci√≥n de responsabilidades de los m√©todos?

* **Rabi Leonel Leon Chan** (1) [1098319](https://platzi.com/comentario/1098319/) 

	Hola Compa√±eros, comentando algo que me paso es que el remotemysql no me funcionaba correctamente, les recomiendo hacer la practica en modo local con xampp, o si tienen alg√∫n servidor seria mejor.

* **Fernando Cordero** (1) [1024027](https://platzi.com/comentario/1024027/) 

	<https://remotemysql.com/> esta caido. que podemos hacer?

	* **Ernesto Vizca√≠no Alvarado** [1024027] (3)

		Puedes usar [db4free](https://www.db4free.net/)  
		o [freemysqlhosting](https://www.freemysqlhosting.net/)

	* **carlosextra1** [1024027] (1)

		pues lo acabo de checar y esta funcionando sin problema

	* **Ernesto Vizca√≠no Alvarado** [1024027] (1)

		Si, ya est√° funcionando

	* **Fernando Cordero** [1024027] (1)

		pues ahora si esta funcionando, para el momento que comente no

	* **carlosextra1** [1024027] (1)

		@fernan942 suele pasar, lo bueno que no fue definitivo y ya est√° de nuevo funcionando !

* **esteban-meza** (1) [1009162](https://platzi.com/comentario/1009162/) 

	si depronto el codigo de: raparisg que esta abajo no les sirve
	
	async function upsert(table, data) {  
	console.log(table)  
	console.log([data.id](http://data.id))
	``` 
	    const row = await get(table, data.id);
	    console.log(row)
	    if (row.length === 0) {
	      return insert(table, data);
	    } else {
	      return update(table, data);
	    }
	    
	```
	
	}
	``` 
	    y les sale un errorde sql es por que tienen que poner en el get la consulta entre coomillas
	    
	    
	```
	
	function get(table, id) {  
	return new Promise((resolve, reject) => {  
	connection.query(`SELECT * FROM ${table} WHERE id="${id}"`, (err, data) => {  
	if (err) return reject(err);  
	resolve(data);  
	})  
	})  
	}```
	```
	```
	

* **esteban-meza** (1) [1009076](https://platzi.com/comentario/1009076/) 

	yo tenia un problema con la promesa por lo que la modifique un poco para que me generara el codigo
	``` 
	    
	    asyncfunctionlogin(username,password) {
	    console.log(‚Äòingres2o‚Äô)
	    console.log(username+‚Äô??‚Äô+password)
	    const data= await store.query(TABLA,{username:username})
	    console.log(data.password)
	    let retorna = bcrypt.compareSync(password, data.password)
	    console.log(retorna)
	    if(retornatrue){
	    // return auth.sign(data)
	    return auth.sign(JSON.parse(JSON.stringify(data)));
	    }
	    else{
	    thrownewError (‚Äòinfo123 invalida‚Äô)
	    }
	    // bcrypt.compareSync(password, data.password)
	    // .then(igual=>{
	    // if(igual=true){
	    // console.log(bcrypt.compareSync(password, data.password))
	    // // generar token
	    // return auth.sign(data)
	    // } else{
	    // throw new Error (‚Äòinfo123 invalida‚Äô)
	    // };
	    // });
	    
	    
	```

* **Alfredo Gonzalez** (1) [993234](https://platzi.com/comentario/993234/) 

	Para solucionar el error lo que hice fue tomar el objeto creado en el middleware de secure (req.user) pasarlo por par√°metro a la funci√≥n upsert del controlador

* **alejo6460** (1) [82420](https://platzi.com/comentario/1004805/) 
Complementando mi pregunta, adjunto el c√≥digoque tengo public async update(req: Request, res: Response): Promise<void> { ...

* **alejo6460** (1) [82418](https://platzi.com/comentario/1004795/) 
estoy usando node con express mysql, tengo una consulata que devienve una promesa, la consulta es un update, como hago para saber cuantos...

* **Ernesto Vizca√≠no Alvarado** (1) [80455](https://platzi.com/comentario/959244/) 
Hola, tengo un problema al tratar de actualizar informaci√≥n me lanza este problema: { "error": true, "status": 500, "body": "...

	* **Favio N√°quira** [80455] (2)

		Ya existe un registro con ese ID, por eso te dice que el ID est√° duplicado

* **SaFeRamirez** (1) [79298](https://platzi.com/comentario/937729/) 
¬øComo manejas la consulta list() a la hora que tengas por ejemplo 2000 usuarios?

	* **Carlos Hern√°ndez** [79298] (2)

		Usando paginaci√≥n, nativa (si la base de datos la ofrece) o con l√≠mites y offset. En ambos casos, est√° paginaci√≥n la pasamos c√≥mo par√°metro a la funci√≥n list üòâ

## 0160. Relacionando entidades follow [25330](https://platzi.com/clases/1767-practico-node/25330-relacionando-entidades-follow/)

### Descripci√≥n:


### Links:

* [https://github.com/CodingCarlos/proyecto-backend-node-platzi/commit/95d1d05ffa60032ceaa67f302ed264925c25999f](https://github.com/CodingCarlos/proyecto-backend-node-platzi/commit/95d1d05ffa60032ceaa67f302ed264925c25999f)

### Comentarios:

* **David Behar** (3) [1002851](https://platzi.com/comentario/1002851/) 

	Les dejo mi reto, estuvo interesante porque me ayud√≥ a entender c√≥mo se utiliza mysql en node.
	
	Ac√° mi c√≥digo <https://github.com/behagoras/platzi-practico-node/tree/mysql-follow>
	
	## api/components/user/network.js
	``` 
	    router.get('/follow', secure('follow'), followers)
	    ...
	    function followers (req, res, next) {
	      controller.followers(req.user.id)
	        .then((data) => {
	          response.success(req, res, data, 201)
	        })
	        .catch(next)
	    }
	    
	```
	
	## api/components/user/controller.js
	``` 
	    const followers = (id) => store.get(`${TABLE}_follow`, { user_from: id })
	      return {
	        ...
	        followers
	      }
	    
	```
	
	## api/components/store/mysql.js
	
	Modifiqu√© un poco la funci√≥n de get para que acepte diversos where, presten atenci√≥n al query:
	``` 
	    const get = async (table, where) => newPromise((resolve, reject) => {
	      console.log('table', table)
	      console.log('where', where)
	      // console.log(id)
	      connection.query(`SELECT * FROM ${table} WHERE ?`, where, (error, data) => {
	        if (error) { return reject(error) }
	        console.log(data)
	        resolve(data)
	      })
	    })
	    
	```

	* **Juan Jos√© Vega Quintero** [1002851] (2)

		Me gust√≥ la funciona de mysql üîù

	* **David Behar** [1002851] (2)

		A m√≠ tambi√©n me gusta c√≥mo funciona üòÑ

* **David Behar** (3) [1002825](https://platzi.com/comentario/1002825/) 

	En esta clase aprend√≠ algo bien interesante, al pasar un bearer token a una petici√≥n http podemos acceder al contenido del token desde el request:
	``` 
	    req.user.id // regresa el contenido del jwt con el usuario
	    
	```

	* **Sebasti√°n Mat√≠as Morales Napolitano** [1002825] (1)

		Vale aclarar que es una propiedad que le pusimos al objeto req nosotros mismos en el c√≥digo.
		
		En decodeHeader de auth/index.js fijate que hacemos  
		req.user = decoded;
		
		De esa manera en user/network.js en
		
		router.post(‚Äô/follow/:id‚Äô, secure(‚Äòfollow‚Äô), follow);
		
		una vez termina de ejecutar secure, el objeto req ya tiene cargado por nosotros el req.user.

* **Sebasti√°n Mat√≠as Morales Napolitano** (1) [1114665](https://platzi.com/comentario/1114665/) 

	Creo que en el c√≥digo hasta ac√° hay un problema y es que no se puede crear nuevos usuarios.  
	Esto pasa porque el controller de user siempre le pasa un id a la funci√≥n upsert de mysql.js.  
	Al cumplirse (data && [data.id](http://data.id)) siempre termina haciendo update.

* **JavierG** (1) [995535](https://platzi.com/comentario/995535/) 

	Mi solucion es esta:
	
	En user/network a√±adir la ruta:
	``` 
	    router.post("/followers", secure("follow"), followers);
	    
	```
	
	Y su funcion correspondiente es:
	``` 
	    functionfollowers(req, res, next) {
	      controller
	        .followers(req.user.id)
	        .then(data => {
	          response.succes(req, res, data, 201);
	        })
	        .catch(next);
	    }
	    
	```
	
	Ahora en user/controller a√±adir:
	``` 
	    functionfollowers(from) {
	        console.log(from, 'controller')
	        return store.getFollowers( {
	          user_from: from
	        });
	      }
	    
	```
	
	Y por ultimo en store/msql:
	``` 
	    function getFollowers(query) {
	      returnnew Promise((resolve, reject) => {
	        connection.query(
	          `select u.* from user_follow as f, user as u where u.id = f.user_to and ?`,
	          query,
	          (err, res) => {
	            if (err) return reject(err);
	    
	            resolve(res || null);
	          }
	        );
	      });
	    }
	    
	```
	
	El llamado seria asi:
	``` 
	    POST http://localhost:3000/api/user/followers/
	    
	```

	* **WilliamVelazquez** [995535] (1)

		En el caso que pones deber√≠as cambiar el verbo HTTP ya que **POST** se utiliza m√°s cuando vas a crear algo, y en este caso s√≥lo vas a obtener una lista. En el caso de s√≥lo obtener informaci√≥n utilizar√≠as **GET**. üòâ

* **JDiaz0017** (1) [81987](https://platzi.com/comentario/994624/) 
Buenas tardes, es mi impresi√≥n o este m√©todo para follow no sirve ya que en el store: Mysql tiene quemado la columna ID para llevar a cab...

## 0170. Posts y likes [25331](https://platzi.com/clases/1767-practico-node/25331-posts-y-likes/)

### Descripci√≥n:


### Links:

* [https://github.com/CodingCarlos/proyecto-backend-node-platzi/commit/fd5457815b7c6402ab3f96edf615af5c3422fa17](https://github.com/CodingCarlos/proyecto-backend-node-platzi/commit/fd5457815b7c6402ab3f96edf615af5c3422fa17)

### Comentarios:

* **Byron Mesias Cueva Cabrera** (3) [973750](https://platzi.com/comentario/973750/) 

	Reto resuelto:
	
	![retonuevo.png](https://static.platzi.com/media/user_upload/retonuevo-d3c1f7cb-1231-48ec-a991-26d0fbcac8cb.jpg)

* **Abraham Flores Cosme** (1) [1097637](https://platzi.com/comentario/1097637/) 

	Solo como mejora, ser√≠a ideal poner la llave for√°nea user como user_id para que al implementar relaciones por medio de alg√∫n ORM se pueda diferenciar que user_id es el ID y user es el objeto user a trav√©s de una relaci√≥n.

* **JavierG** (1) [1015120](https://platzi.com/comentario/1015120/) 

	Hola, tengo una duda, como seria la mejor manera de comunicar componentes? , por ejemplo si requiero de una funcionalidad de otro componente importo el controlador de este? , o hay alguna otra forma ?

	* **Sebasti√°n Mat√≠as Morales Napolitano** [1015120] (1)

		Fijate que en el controller de user usamos el auth.upsert

* **David Behar** (1) [1002891](https://platzi.com/comentario/1002891/) 

	Ac√° dejo todo mi reto, tuve que modificar mi m√©todo get para que obtenga arreglos de condiciones.  
	<https://github.com/behagoras/platzi-practico-node/tree/posts-likes>

* **Alver Ortega** (1) [988010](https://platzi.com/comentario/988010/) 

	Controller qued√≥ as√≠
	``` 
	    asyncfunctionfollowing({id}) {
	            const join = {
	                [TABLA]: ['user_to_id', 'id'],
	            };
	    
	            return store.query(`${TABLA}_follow`, {user_from_id: id}, join);
	        }```
	    
	```

* **Alver Ortega** (1) [988009](https://platzi.com/comentario/988009/) 

	Les comparto la funci√≥n query, donde acepta varios par√°metros para el join
	``` 
	    functionquery(table, query, join = null) {
	        let joinQuery = '';
	        if (join) {
	            Object.entries(join).forEach(([key, value]) => {
	                const [from, to] = value;
	                joinQuery+= `JOIN ${key} ON ${table}.${from} = ${key}.${to}`;
	            })
	        }
	        debug(`${table}, ${JSON.stringify(query)}, ${joinQuery}`);
	        returnnewPromise((resolve, reject) => {
	            connection.query(`SELECT * FROM ${table}${joinQuery} WHERE ?`, query,  (error, data) => {
	                if (error) return reject(error);
	                resolve(data);
	            })
	        });
	    }```
	    
	```

* **Leonardo Daniel Benitez Cuenca** (1) [980324](https://platzi.com/comentario/980324/) 

	Me podrian ayudar por favor con este error
	``` 
	    {
	        "error": false,
	        "status": 500,
	        "body": "Cannot enqueue Query after fatal error."
	    }
	    
	```
	
	En la consola me sale esto
	``` 
	    code: 'PROTOCOL_ENQUEUE_AFTER_FATAL_ERROR',
	      fatal: false
	    }
	    
	```

* **raparisg** (1) [957500](https://platzi.com/comentario/957500/) 

	Buena soluci√≥n al reto! En base a eso, modifiqu√© el m√©todo que elimina para hacer un endpoint que hace unfollow. Ac√° mi soluci√≥n:  
	.  
	M√©todo remove de mysql.js:
	``` 
	    function remove(table, firstCondition, othersCondition = []) {
	      let andConditions = "";
	      if (othersCondition.length > 0) {
	        andConditions = othersCondition.map(c => "AND ?").join(" ");
	      }
	    
	      return new Promise((resolve, reject) => {
	        connection.query(
	          `DELETE FROM ${table} WHERE ? ${andConditions}`,
	          [firstCondition, ...othersCondition],
	          (err, data) => {
	            if (err) return reject(err);
	            return resolve(data);
	          }
	        );
	      });
	    }
	    
	```
	
	.  
	M√©todo unfollow de userController:
	``` 
	    const unfollow = (from, to) => {
	        return store.remove("follows", { user_from: from }, [{ user_to: to }]);
	      };
	    
	```
	
	.  
	El userNetwork ya se lo conocen üòÉ

	* **Ernesto Vizca√≠no Alvarado** [957500] (2)

		Hola @raparisg, ¬øcomo solucionaste la funcion upsert?

# Microservicios en Node [5082]

## 0180. Microservicios pros y contras [25332](https://platzi.com/clases/1767-practico-node/25332-microservicios-pros-y-contras/)

### Descripci√≥n:


### Comentarios:

* **carlosextra1** (2) [1075114](https://platzi.com/comentario/1075114/) 

	WOO siempre he querido usar micro servicios pero siempre dije ¬∑cuando inicie una nueva app lo aplico¬∑ ahora veo que no es tan bueno iniciar una app desde cero en microservicios

* **maxialvarezm** (2) [943965](https://platzi.com/comentario/943965/) 
Que grande! Muy buena explicaci√≥n de pros y contras

* **Baldan** (1) [1109629](https://platzi.com/comentario/1109629/) 

	Oh! Qu√© increible! Me encantan los microservicios, pero no empezar√© haciendo todo microservicios desde cero.

* **Alfonso Navarro** (1) [1010649](https://platzi.com/comentario/1010649/) 

	Muy buena introducci√≥n a microservicios‚Ä¶ logro captar toda mi atenci√≥n‚Ä¶

* **Fabian Figueroa** (1) [974008](https://platzi.com/comentario/974008/) 

	Excelente la forma de explicar

* **Baldan** (1) [86974](https://platzi.com/comentario/1109617/) 
¬øQu√© cosas necesito para definir un servicio? Por ejemplo ¬øQu√© archivos tengo que tocar?

* **alejo6460** (0) [990321](https://platzi.com/comentario/990321/) 

	Excelente explicaci√≥n, que buen profesor

## 0190. Separando la base de datos a un microservicio [25333](https://platzi.com/clases/1767-practico-node/25333-separando-la-base-de-datos-a-un-microservicio/)

### Descripci√≥n:


### Comentarios:

* **Fernando Cordero** (5) [1032295](https://platzi.com/comentario/1032295/) 

	Un microservicio es una peque√±a aplicaci√≥n que se encarga de una parte de un software m√°s complejo de manera aislada, y se comunica con el resto del software mediante diferentes m√©todos: peticiones HTTP, o alg√∫n sistema de colas. micro.js es una librer√≠a muy peque√±a (alrededor de 100 l√≠neas de c√≥digo) de JavaScript, que nos permite usar Node.js para crear f√°cilmente microservicios que funcionen sobre el protocolo HTTP, y haciendo uso de Async/Await y todas las caracter√≠sticas que se incluyeron en ECMAScript 2015 para facilitarnos el programarlos.

* **David Valecillo** (2) [82022](https://platzi.com/comentario/995591/) 
En un caso real, si necesitamos desarrollar microservicios, es recomendable crear los microservicios dentro de un mismo proyecto de c√≥dig...

	* **Erik Ochoa (Platzi)** [82022] (2)

		Cada opci√≥n tiene sus ventajas y desventajas, todo depende de muchos factores: del proyecto, de la forma de trabajar del equipo, de las restricciones del cliente etc.
		
		Aqu√≠ las ventajas de cada uno:
		
		* Ventajas m√∫ltiples repositorios 
		  * Un CodeBase m√°s peque√±o.
		  * CI/CD m√°s sencillos de integrar.
		  * Ownership claro.
		* Ventajas un s√≥lo repositorio 
		  * F√°cil de depurar y de encontrar errores.
		  * F√°cil integraci√≥n de los diferentes equipos.
		  * Facilidad para compartir y reutilizar c√≥digo en com√∫n.
		
		
		
		Entre muchas otras.

* **carlosextra1** (1) [1075230](https://platzi.com/comentario/1075230/) 

	wooo creo que esto es complicado, m√°s porque el profe no esta usando un metodolog√≠a estructurada de trabajo como lo es MVC. Se que ese modelo no aplicar√≠a para APIs pero creo que es complicado seguirle el hilo he ir entendiendo todo!

	* **Jos√© Armando Hernandez Guanare** [1075230] (2)

		MVC es un patr√≥n de dise√±o de arquitectura, como lo es la arquitectura a base de componentes, como lo es la arquitectura basada en micro-servicios.  
		Puedes aplicar MVC en tus micro-servicios, no son patrones de dise√±o que se estorban.

* **Ramiro** (1) [1061627](https://platzi.com/comentario/1061627/) 

	El uso del Store, ¬øno tendr√≠amos que ponerlo dentro del controller?

* **Fernando Cordero** (1) [1030887](https://platzi.com/comentario/1030887/) 

	super!

* **Fabian Figueroa** (1) [81116](https://platzi.com/comentario/974020/) 
Tengo una duda , esta bien visto o es buena practica tener mi server en node con ES6 y tener babel para transpilar y luego levantar el se...

	* **Gabriel De Andrade (Platzi)** [81116] (1)

		Yo prefiero escribir en ES6 y transpilar, Babel hace un muy buen trabajo y no te d√° pr√°cticamente ninguna desventaja en performance. Mientras que ES6 te da ventaja en legibilidad del c√≥digo, algo muy importante a la hora de debuggear üòÑ

* **Cristian Franco Bedoya** (0) [1117644](https://platzi.com/comentario/1117644/) 

	Excelente. Vamos a separarlo.

## 0200. Conectando con nuestro microservicio de datos [25334](https://platzi.com/clases/1767-practico-node/25334-conectando-con-nuestro-microservicio-de-datos/)

### Descripci√≥n:


### Links:

* [https://github.com/CodingCarlos/proyecto-backend-node-platzi/commit/338617f2ccdde680d2f016967fda35f9d68f1d1c](https://github.com/CodingCarlos/proyecto-backend-node-platzi/commit/338617f2ccdde680d2f016967fda35f9d68f1d1c)

### Comentarios:

* **T-gold** (1) [1097442](https://platzi.com/comentario/1097442/) 

	AYUDA cuando hago leer users en insomnia me devuelve  
	un 500 en en consola me da este error
	
	[error]: connect ECONNREFUSED 127.0.0.1:80  
	error en la DB remota Error: connect ECONNREFUSED 127.0.0.1:80  
	at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1134:16) {  
	errno: ‚ÄòECONNREFUSED‚Äô,  
	code: ‚ÄòECONNREFUSED‚Äô,  
	syscall: ‚Äòconnect‚Äô,  
	address: ‚Äò127.0.0.1‚Äô,  
	port: 80

* **Alver Ortega** (1) [988052](https://platzi.com/comentario/988052/) 

	les comparto mi archivo de peticiones con axios
	``` 
	    const axios = require('axios');
	    
	    class AxiosInstance {
	        constructor(config = {}) {
	            this.axios = axios.create(config);
	        }
	    
	        send(url, method, data) {
	            return new Promise((resolve, reject) => {
	                this.axios({
	                    method,
	                    url,
	                    data
	                })
	                    .then(response => resolve(response.data))
	                    .catch(error => reject(error))
	            })
	        }
	    }
	    
	    module.exports = AxiosInstance;
	    
	```
	
	y el mysqlRemote
	``` 
	    const AxiosInstance = require('./../utils/axios-instance');
	    const config = require('./../config');
	    
	    class MysqlRemote {
	        constructor() {
	            this.request = new AxiosInstance({
	                baseURL: config.mysql.mysqlService.host,
	                timeout: 5000,
	                headers: {'Content-Type': 'application/json'},
	            })
	        }
	    
	        list(table) {
	            returnthis.request.send(`/${table}`, 'GET');
	        }
	    }
	    
	    module.exports = new MysqlRemote();
	    
	```

	* **Eric Rodr√≠guez Gallegos** [988052] (1)

		Hola, ¬øCu√°l es la raz√≥n por la que has usado **axios**?, recientemente me di cuenta que _**request**_ en **npm** esta marcado como obsoleto, ¬øEs esta la raz√≥n de tu cambio?. Saludos

	* **Alver Ortega** [988052] (1)

		Hola Eric, utilizo axios porque se puede usar en node y en la web, tambi√©n es muy f√°cil de usar y tiene una buena documentaci√≥n, otra raz√≥n es porque puedes hacer cosas personalizadas como interceptar la petici√≥n o la respuesta para agregar o quitar cosas como datos, etc. Saludos

	* **Eric Rodr√≠guez Gallegos** [988052] (1)

		Gracias por la respuesta, le dar√© una oportunidad ahora que estoy aprendiendo Node. Saludos.

	* **carlosextra1** [988052] (1)

		que es axios y que beneficios hay en el?

	* **Juan Jos√© Vega Quintero** [988052] (2)

		<https://www.npmjs.com/package/axios>

* **Byron Mesias Cueva Cabrera** (1) [975019](https://platzi.com/comentario/975019/) 

	Reto resuelto:
	``` 
	    const request = require('request');
	    
	    let urlRemote;
	    
	    function req(method, table, data = null) {
	        let url = `${urlRemote}/${table}`;
	        let body = '';
	    
	        if(data && method === 'GET') {
	            url += `/${id}`;
	        } elseif(data) {
	            body = JSON.stringify(data);
	        }
	        
	        return new Promise((resolve, reject) => {
	            request({
	                url,
	                method,
	                body,
	                headers: {
	                    'content-type': 'application/json'
	                }
	            },(error, req, result) => {
	                if(error) {
	                    console.error('Error en la base de datos', error);
	                    return reject(error.message);
	                }
	    
	                const res = JSON.parse(result);
	                return resolve(res.body);
	            });
	        });
	    }
	    
	    function insert(table, data) {
	        return req('POST', table, data);
	    }
	    
	    function update(table, data) {
	        return req('PUT', table, data);
	    }
	    
	    module.exports = class RemoteStore {
	    
	        constructor(host, port) {
	            urlRemote = `http://${host}:${port}`
	        }
	    
	        list(table) {
	            return req('GET', table);
	        }
	    
	        get(table, id) {
	            return req('GET', table, id);
	        }
	    
	        upsert(table, data) {
	            if(data.id) {
	                return update(table, data);
	            }
	            return insert(table, data);
	        }
	    }
	    
	```

	* **T-gold** [975019] (1)

		muy buen aporte!

* **Matias Niz** (1) [947511](https://platzi.com/comentario/947511/) 

	Si tenemos multiples instancias de un micro servicio, como balanceamos las cargas de solicitudes de cada una de ellas?

	* **Carlos Hern√°ndez** [947511] (2)

		Eso ser√° responsabilidad del balanceador. Puede ser PM2, kubernetes, now‚Ä¶ En cada caso, hay una forma de hacerlo. M√°s adelante, veremos un par de ellas üòâ

## 0210. Separando los posts a un microservicio [25335](https://platzi.com/clases/1767-practico-node/25335-separando-los-posts-a-un-microservicio/)

### Descripci√≥n:


### Comentarios:

* **Alver Ortega** (2) [81734](https://platzi.com/comentario/988584/) 
La aplicaci√≥n tiene una estructura monol√≠tica, es bueno mantenerla de esta manera o ir sacando los microservicios en su propia estructura ?

	* **boni** [81734] (1)

		depende del numero de equipos de developers que tengas, si es solo 1 equipo es mejor la estructura monolitica.

* **carlosextra1** (1) [1077153](https://platzi.com/comentario/1077153/) 

	Si es muy interesante ver c√≥mo podemos separar los m√≥dulos para mandarlos a microservicios, pero con una app muy grande tendr√≠amos problemas de tener tantos microservicios.
	
	Yo soy novato en microservicios los que ya tienen m√°s experiencia en el tema que opinan?

* **Ernesto Vizca√≠no Alvarado** (1) [1013683](https://platzi.com/comentario/1013683/) 
	
	![](https://media.giphy.com/media/5VKbvrjxpVJCM/giphy.gif)

## 0220. Gesti√≥n de microservicios con PM2 [25336](https://platzi.com/clases/1767-practico-node/25336-gestion-de-microservicios-con-pm2/)

### Descripci√≥n:


### Links:

* [PM2 - Home](https://pm2.keymetrics.io/)

### Comentarios:

* **Eduardo P. Rivero** (19) [937571](https://platzi.com/comentario/937571/) 

	Al iniciar un proceso en pm2 se le puede asignar un nombre usando el flag --name.
	``` 
	    pm2 start api/index.js --name api-principal
	    pm2 start mysql/index.js --name api-mysql
	    pm2 start post/index.js --name api-post
	    
	```

* **Alver Ortega** (10) [988665](https://platzi.com/comentario/988665/) 

	Revisando la documentaci√≥n de pm2 me encontr√© que se puede crear un archivo de configuraci√≥n de todas las apis y poderlas levantar o reiniciar:  
	primero creamos un archivo ecosystem.config.js
	``` 
	    module.exports = {
	      apps : [
	        {
	          name: 'API-MAIN',
	          script: 'src/api/index.js',
	          instances: 2,
	          autorestart: true,
	          watch: false,
	          max_memory_restart: '2G',
	          env: {
	            NODE_ENV: 'development'
	          },
	          env_production: {
	            NODE_ENV: 'production'
	          }
	        },
	        {
	          name: 'API-MYSQL',
	          script: 'src/microservices/mysql/index.js',
	          instances: 2,
	          autorestart: true,
	          watch: false,
	          max_memory_restart: '2G',
	          env: {
	            NODE_ENV: 'development'
	          },
	          env_production: {
	            NODE_ENV: 'production'
	          }
	        },
	        {
	          name: 'API-POST',
	          script: 'src/microservices/posts/index.js',
	          instances: 2,
	          autorestart: true,
	          watch: false,
	          max_memory_restart: '2G',
	          env: {
	            NODE_ENV: 'development'
	          },
	          env_production: {
	            NODE_ENV: 'production'
	          }
	        }
	      ],
	    };
	    
	```
	
	Para iniciar los servicios con
	``` 
	    pm2startecosystem.config.js--env[development|production]```
	    
	```

	* **carlosextra1** [988665] (1)

		Gracias por el aporte!!

* **Ramiro** (1) [1065324](https://platzi.com/comentario/1065324/) 

	Muy interesante!! Me gust√≥ mucho para poder gestionar en ambientes tipo PRD y tiene varias funcionalidades m√°s de las que vimos en la clase

# Puesta en producci√≥n serverless [5083]

## 0230. Microservicios en Zeit Now, serverless y seguridad [25337](https://platzi.com/clases/1767-practico-node/25337-microservicios-en-zeit-now-serverless-y-seguridad/)

### Descripci√≥n:


### Links:

* [World-Class Static Hosting - ZEIT](https://zeit.co/)

### Comentarios:

* **nancygtec** (4) [956804](https://platzi.com/comentario/956804/) 

	Si es la primera vez que corren _now_ , no tendr√°n las credenciales, por lo que deben correr primero:
	``` 
	    now login
	    
	```
	
	Y seguir las instrucciones de verificaci√≥n.

* **Cristobal Vega** (3) [1036737](https://platzi.com/comentario/1036737/) 

	Serverless es b√°sicamente no tener dependencia en un √∫nico servidor. es una manera de desplegar y usar servicios de c√≥mputo.
	
	De manera m√°s fancy es ‚Äúdesatendernos‚Äù del server y delegarle la tarea a otra entidad o servicio.
	
	Pueden aprender m√°s aqu√≠: <https://platzi.com/clases/1824-google-serverless/26193-por-que-elegir-serverless/> ‚úã

* **Sebastian** (1) [991639](https://platzi.com/comentario/991639/) 

	No puedo conectarme a la Base de Datos desde la ruta de now, pero en postman si funciona normal

	* **carlosextra1** [991639] (1)

		la db la tienes en tu servidor local?

* **Sebastian** (1) [991621](https://platzi.com/comentario/991621/) 

	tengo el siguiente error
	
	![Sin t√≠tulo.png](https://static.platzi.com/media/user_upload/Sin%20t%C3%ADtulo-e3ac42d1-5fe8-4210-a9d9-27b3fb25b8b1.jpg)

	* **Luis Manuel Brito Romero** [991621] (1)

		Yo estaba trabajando en un servidor de mysql local y me daba ese error. En el config.js agrega los datos de una base de datos de remotemysql como en la clase y veras que funciona otra vez.

## 0240. Variables de entorno en Now y despliegue local [25338](https://platzi.com/clases/1767-practico-node/25338-variables-de-entorno-en-now-y-despliegue-local/)

### Descripci√≥n:


### Comentarios:

* **Alver Ortega** (6) [988933](https://platzi.com/comentario/988933/) 

	les comparto mi archivo now.json
	``` 
	    {
	      "version": 2,
	      "env": {
	        "NODE_ENV": "production",
	        "MYSQL_DB_HOST": "@mysql_db_host",
	        "MYSQL_DB_PORT": "@mysql_db_port",
	        "MYSQL_DB_USER": "@mysql_db_user",
	        "MYSQL_DB_PASSWORD": "@mysql_db_password",
	        "MYSQL_DATABASE": "@mysql_database",
	        "MYSQL_SERVICE_HOST": "@mysql_service_host",
	        "SENTRY_ID": "@sentry_id",
	        "SENTRY_DNS": "@sentry_dns",
	        "AUTH_JWT_SECRET": "@auth_jwt_token"
	      },
	      "builds": [
	        {
	          "src": "src/api/index.js",
	          "use": "@now/node"
	        },
	        {
	          "src": "src/microservices/mysql/index.js",
	          "use": "@now/node"
	        },
	        {
	          "src": "src/microservices/posts/index.js",
	          "use": "@now/node"
	        }
	      ],
	      "routes": [
	        {
	          "src": "/api/users(.*)",
	          "dest": "src/api/index.js"
	        },
	        {
	          "src": "/api/auth(.*)",
	          "dest": "src/api/index.js"
	        },
	        {
	          "src": "/api/posts(.*)",
	          "dest": "src/microservices/posts/index.js"
	        },
	        {
	          "src": "/api/mysql(.*)",
	          "dest": "src/microservices/mysql/index.js"
	        }
	      ]
	    }
	    
	```

	* **David Behar** [988933] (3)

		Veo que est√°s usando secretos, genial!

	* **WilliamVelazquez** [988933] (2)

		Es mejor utilizar secrets üòÉ  
		Adem√°s de que no expones dichas variables de entorno directamente en el repositorio. üòÑ

	* **Alver Ortega** [988933] (2)

		Si y es f√°cil de configurar

	* **David Behar** [988933] (1)

		Puras ventajas con los secrets!!

	* **AryRosvall** [988933] (4)

		¬øQu√© es eso de secrets? ¬ønos lo comparten?

	* **WilliamVelazquez** [988933] (3)

		Secrets es la forma en que manejas cosas privadas dentro de now, por lo que es muy utilizado para el tema de variables de entorno para utilizarlos se usa el siguiente comando en tu consola:
		``` 
		    now secret add acme-api-key my-value-here
		    
		```
		
		Por otro lado te dejo un enlace para complementar directo de Zeit.  
		[Secrets en Now](https://zeit.co/blog/environment-variables-secrets)  
		üòâ
		
		Cualquier duda av√≠same üòÉ

* **carlosextra1** (1) [1077524](https://platzi.com/comentario/1077524/) 

	Excelente clase, y mas con el comando `now dev` que podemos ver todo en local antes de subir a producci√≥n

* **aesn_sas** (1) [81581](https://platzi.com/comentario/984617/) 
Es posible hacer el despliegue local con now en un servidor que tenga configurada una ip publica para hacer uso de la aplicacion construi...

# Cacheando nuestra aplicaci√≥n [5084]

## 0250. Cach√© como un microservicio. Redis [25339](https://platzi.com/clases/1767-practico-node/25339-cache-como-un-microservicio-redis/)

### Descripci√≥n:


### Comentarios:

* **Matias Niz** (3) [947714](https://platzi.com/comentario/947714/) 

	Este video deberia estar primero en la seccion de cache

	* **carlosextra1** [947714] (1)

		De hecho si es el primer video de la secci√≥n de cache!

## 0260. Conectando el microservicio a Redis [25340](https://platzi.com/clases/1767-practico-node/25340-conectando-el-microservicio-a-redis/)

### Descripci√≥n:


### Links:

* [Redis Labs | The Best Redis Experience](https://redislabs.com/)

### Comentarios:

* **ziker** (2) [1006795](https://platzi.com/comentario/1006795/) 

	A alguien m√°s le esta saliendo este error a la hora de generar el redis client?
	``` 
	    Ready check failed: NOAUTH Authentication required
	    
	    
	```

	* **esdraspavon** [1006795] (1)

		A mi, pudiste resolverlo?

	* **esdraspavon** [1006795] (1)

		Solucionado! Hab√≠a problemas con las credenciales.

* **carlosextra1** (1) [1077671](https://platzi.com/comentario/1077671/) 

	```
	    const redis = require('redis');
	    
	    const config = require('../config');
	    
	    const client = redis.createClient({
	        host: config.redis.host,
	        port: config.redis.port,
	        password: config.redis.password,
	    });
	    
	    functionlist(table) {
	        returnnew Promise( (resolve, reject) => {
	            client.get(table, (err, data) => {
	                if (err) return reject(err);
	    
	                let res = data || null
	                if (res)
	                    res = JSON.stringify(res);
	                
	                resolve(res);
	            })
	        })
	    }
	    
	    functionget(table, id) {
	        const search = `${table}_${id}`;
	        returnlist(search);
	    }
	    
	    functionupsert(table, data, action) {
	        action = action || 'insert'
	        let key = table;
	        if (action !== 'insert')
	            key = key + '_' + data.id;
	        
	        client.setex(key,10, JSON.stringify(data));
	        returntrue;
	    }
	    
	    
	    module.exports = {
	        list,
	        get,
	        upsert,
	    };```
	    
	```

* **Byron Mesias Cueva Cabrera** (1) [978427](https://platzi.com/comentario/978427/) 

	Reto resuelto:
	``` 
	    const redis = require('redis');
	    const config = require('../config');
	    
	    const client = redis.createClient({
	        host: config.redis.host,
	        port: config.redis.port,
	        password: config.redis.password
	    });
	    
	    functionlist(table) {
	        returnnew Promise((resolve, reject) => {
	            client.get(table, (error, result) => {
	                if(error) return Promise.reject(error);
	                const resp = JSON.parse(result);
	                resolve(resp);
	            })
	        }); 
	    }
	    
	    functionget(table, id) {
	        const key = `${table}_${id}`;
	        returnlist(key);
	    }
	    
	    asyncfunctionupsert(table, data) {
	        let key = table;
	        if(data && data.id) {
	            key += `_${data.id}`;
	        }
	        client.setex(key, 60, JSON.stringify(data));
	        returntrue;
	    }
	    
	    module.exports = {
	        list,
	        get,
	        upsert
	    };
	    
	```

* **Matias Niz** (1) [948018](https://platzi.com/comentario/948018/) 

	En el metodo list, en caso de existir data, no deberia ser JSON.parse(data) en lugar de de stringify?, es decir, si lo que esta almacenado es una cadena de texto, no deberiamos convertir esa cadena a json al retornarlo?

## 0270. Conectar la API al cach√© [25341](https://platzi.com/clases/1767-practico-node/25341-conectar-la-api-al-cache/)

### Descripci√≥n:


### Comentarios:

* **Matias Niz** (4) [947716](https://platzi.com/comentario/947716/) 

	Este deberia ser el ultimo video de la seccion de cache.

	* **nancygtec** [947716] (1)

		S√≠, el orden no est√° bien

	* **mariandrea (Platzi)** [947716] (2)

		gracias por reportarlo, ya est√° corregido üòÉ

	* **carlosextra1** [947716] (1)

		Todo est√° bien hoy 29 marzo 2020, tal vez cuando tu tomaste el curso esta cambiado!

* **carlosextra1** (1) [1077796](https://platzi.com/comentario/1077796/) 

	se est√° usando redis para chache es porque node corre en el server. Es correcto?

	* **Jorge Humberto Nemog√° Pinz√≥n** [1077796] (2)

		uhmm no queda muy clara tu afirmaci√≥n / pregunta.  
		Pero el servicio de Redis como cache se usa para acelerar la consulta de alguna informaci√≥n que previamente se hab√≠a consultado desde la DB.
		
		Ejemplo inventado: cada vez que ingresas a Platzi el front-end pide el dato de tu PlatziRank al backend que se lo pide a la DB (posiblemente el punto m√°s lento de todo el proceso), pero como cada vez que actualices o cierras el navegador por un corto per√≠odo entonces el vuelve a pedir el dato, pero est√° vez el dato est√° copiado en una √°rea de memoria r√°pida <Redis> (sea local o remota, pero m√°s r√°pido que preguntarle a mysql en remoto) y lo trae de redis.
		
		No estoy seguro si esto aclara algo. Sino, replaneta t√∫ pregunta o describe un poco sobre que es lo que deseas confirmar.

	* **Juan Jos√© Vega Quintero** [1077796] (2)

		Y creo que Redis esta muy optimizado para trabajar con cache

# Puesta en producci√≥n en virtual machine [5085]

## 0280. Desplegando los servicios de Node [25342](https://platzi.com/clases/1767-practico-node/25342-desplegando-los-servicios-de-node/)

### Descripci√≥n:


### Comentarios:

* **T-gold** (2) [1103110](https://platzi.com/comentario/1103110/) 

	al desplegarlo en cloud platform significa que ya esta en internet?  
	puedo abrir este backend en la computadora de mi tia en su cas?

	* **Abraham Flores Cosme** [1103110] (1)

		Es correcto, ya despu√©s puedes comprar un dominio que apunte a tal IP para poderlo abrir desde un dominio en particular, pero por ahora puedes usar las direcciones que te da google

	* **T-gold** [1103110] (1)

		gracias abrham!

* **carlosextra1** (2) [1077817](https://platzi.com/comentario/1077817/) 

	ok. yo lo voy a levantar en una m√°quina de aws

	* **Baldan** [1077817] (1)

		Perdona, ¬øPodr√≠as recomendarme alg√∫n curso para levantarlo en aws?

	* **carlosextra1** [1077817] (1)

		claro seria este <https://platzi.com/clases/aws-cloud/>  
		En realidad funciona igual que tu terminal de linux con un peque√±o cambio adapatado a aws

## 0290. Nginx como proxy inverso [25343](https://platzi.com/clases/1767-practico-node/25343-nginx-como-proxy-inverso/)

### Descripci√≥n:


### Comentarios:

* **Renzo Mayer** (5) [964064](https://platzi.com/comentario/964064/) 

	Un curso completo de nginx seria fantastico.
	
	Gracias por todo Carlos!

* **Matias Niz** (4) [948096](https://platzi.com/comentario/948096/) 

	Me gustaria una clase donde podamos armar un cluster de uno de los micro servicios y como utilizar un load balancer (mas alla de que aws ya tiene dicho servicio, por ejemplo). Si vamos al caso de spring boot con java, tenemos a eureka server, hay algo asi en node?

* **Luis Jeanpier Monserrate** (2) [974914](https://platzi.com/comentario/974914/) 

	Genial curso Carlos, sin duda un gran complemento al curso anterior que dictaste de node

* **Sebasti√°n Mat√≠as Morales Napolitano** (1) [1122344](https://platzi.com/comentario/1122344/) 

	En detalles de red de la instancia vm tienen que agregar regla de cortafuegos para default-allow-http y default-allow-https.

* **T-gold** (1) [1103242](https://platzi.com/comentario/1103242/) 

	si o si se necesita tarjeta no para aws o googleplatform no ?
	
	PREGUNTA!  
	Si tenemos un domain tambien hariamos el proxy_pass al localhost?

	* **Baldan** [1103242] (1)

		¬øEstas hablando de la tarjeta de banco? Yo me hice una cuenta con aws hace una semana y me la pidi√≥.

* **carlosextra1** (1) [1077834](https://platzi.com/comentario/1077834/) 

	muy buen curso, Alguien sabe que patr√≥n de dise√±o uso para el desarrollo de la API?

* **carlosextra1** (1) [1077827](https://platzi.com/comentario/1077827/) 

	configuraci√≥n de nginx con nuestra app

* **carlosextra1** (1) [1077822](https://platzi.com/comentario/1077822/) 

	ruta del archivo a editar con nano

* **Sebastian** (1) [994166](https://platzi.com/comentario/994166/) 

	Siempre debes implentarse el ngix asi el despliegue sea en Now o Heroku?

	* **esdraspavon** [994166] (1)

		No, s√≥lo en los casos que vayas a poner tu proyecto en un vps o servicio similar, sea de GCloud o AWS. Saludos!

* **Jpenavar** (1) [981175](https://platzi.com/comentario/981175/) 

	Buena explicaci√≥n Carlos, tengo un inconveniente, en mi VM centos 8, instal√© nginx version: nginx/1.14.1 y el proxy_pass no me funciona . tampoco me aparece la carpeta sites-available pero si un archivo nginx.conf y otro nginx.conf.default.

* **Juan Carrillo** (1) [975195](https://platzi.com/comentario/975195/) 

	Buen material y buenas explicaciones. Gracias

* **finaktiva** (1) [79045](https://platzi.com/comentario/932320/) 
donde esta el link del cerbot?

	* **Erik Ochoa (Platzi)** [79045] (1)

		¬øTe refieres a [este cerbot](https://certbot.eff.org/lets-encrypt/ubuntuxenial-nginx)?

