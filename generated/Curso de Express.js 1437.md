[Curso de Express.js 1437](https://platzi.com/cursos/express-js)

# Bienvenida e introducci√≥n [3073]

## 0010. Introducci√≥n y bienvenida [15698](https://platzi.com/clases/1437-express-js/15698-introduccion-y-bienvenida4244/)

### Descripci√≥n:


Guillermo Rodas es Engineer en Auth0 y ser√° tu profesor en este curso avanzado de **Express.js**.  
En esta clase veremos un poco de qu√© se trata el proyecto que vamos a desarrollar.

Para sacarle el m√°ximo provecho a este curso necesitar√°s cumplir algunos requisitos previos:

* Conocimiento b√°sico de Node.js, HTML y CSS
* Tener instalado Node y NPM en tu computador
* Tener un editor de texto como Atom o VisualStudioCode
* Tener instalado Chrome o Firefox
* Tener instalado Postman
* Tener instalada la extensi√≥n JSON Viewer para el navegador



### Links:

* [Careers - Auth0](https://auth0.com/careers)

* [Medell√≠n CSS (Medell√≠n, Colombia) | Meetup](https://www.meetup.com/medellincss)

* [Postman | API Development Environment](https://www.getpostman.com)

* [GitHub - tulios/json-viewer: It is a Chrome extension for printing JSON and JSONP.](https://github.com/tulios/json-viewer)

* [GitHub - glrodasz/platzi-express at creando-tu-primer-servidor](https://github.com/glrodasz/platzi-express/tree/creando-tu-primer-servidor)

### Comentarios:

* **FedeFenker** (5) [448715](https://platzi.com/comentario/448715/) 

	Una consulta: Tiene sentido estudiar laravel y vue‚Ä¶y luego estudiar todo el backend en JS? O es mejor directamente mandarse a JS? Ser backend en JS lleva mucho tiempo?

	* **Julio J Y√©pez** [448715] (11)

		Laravel es backend con PHP, y Vue aparentemente es el framework (de JS) ideal para frontend cuando tu backend es Laravel. Es lo que he escuchado. PHP va de lujo con PostgreSQL y otros manejadores relacionales.
		
		En el Stack de JS, MERN, el backend en s√≠ estar√≠a formado por Node (JS), Express (JS) y MongoDB (JS), y en el frontend, todo el ecosistema de React (JS) (Router, Navigation, NextJS, ReactNative, etc.)
		
		Si est√°s **empezando** a formarte como desarrollador (backend, frontend o FullStack), yo te sugerir√≠a entrar directo y de lleno con MERN ‚Ä¶ empezar por los Fundamentos de JS, Webpack, Git/Github, NodeJS, etc ‚Ä¶ es un camino un poco extenso y de complejidad media ‚Ä¶ pero es realmente potente y todo est√° muy integrado, adem√°s que al ser todo en el mismo lenguaje de programaci√≥n, se facilita el switcheo mental para ir de un lado a otro como pez en el agua ‚Ä¶
		
		Recuerda tambi√©n complementar tu formaci√≥n con todo lo relacionado a CSS.
		
		Mucho √©xito y Adelante!

	* **Eduardo Hidalgo D√≠az Rugama** [448715] (11)

		Backend JS es un mundo gigante, pero sus pilares son
		
		* **Javascript mismo**
		* **Node.js**
		* **Webpack**
		
		
		
		Con esos pilares en mano tu debes elegir m√≠nimo 1 **frontend framework** (Vue, React, Angular), 1 **framework para API‚Äôs** (sails, express, hapi, meteor, next, incluso node mismo puede hacer eso), y por √∫ltimo debes elegir alguna **tecnolog√≠a para almacenar tus datos** (postgre, firebase, mysql, sql server, mongodb).
		
		Como ves hay un buen de tecnolog√≠as solo dentro del marco Javascript, y no estoy incluyendo manejadores de datos (redux, graphql, apollo, vuex, flux), no estoy incluyendo tampoco el stack que tiene cada frontend framework (por ejemplo react tiene todo un stack de tecnolog√≠as).
		
		**Lo importante es: con 4 cursos estas 100% listo para backend javascript, yo eleg√≠ Webpack + React + Express + Mongodb y listo! con eso estoy construyendo.**
		
		Si me dices, tarda? no, 4 cursos de platzi y ya eres fullstack developer. Si me preguntas ¬øser experto tarda? eso si es tardado, como expliqu√© anteriormente.

* **Johan Manuel Perez Soto** (3) [884044](https://platzi.com/comentario/884044/) 

	üìçRequerimientos  
	üìåConocimiento de Node.js, HTML, CSS  
	üìåTener instalado Node y NPM en tu computador  
	üìåEditor de texto WebStorm  
	üìåTener Google Chrome  
	üìåTener Insomnia  
	üìåY no se que rayos es lo ultimos :v

	* **David Behar** [884044] (1)

		Tener instalada la siguiente extensi√≥n en el navegador <https://chrome.google.com/webstore/detail/json-viewer/gbmdgpbipfallnflgajpaliibnhdgobh>  
		.  
		JSON viewer es una extensi√≥n que te permite visualizar los archivos de json de manera amigable en el navegador

* **EmmanuelO** (3) [469316](https://platzi.com/comentario/469316/) 

	Tambien estoy tomando el de OAuth2 con Guillermo, que bueno que tambi√©n dar√° el de Express, ojal√° en un futuro tambi√©n de los cursos de React

	* **EmmanuelO** [469316] (6)

		Y tambi√©n los b√°sicos de Node xD

	* **glrodasz** [469316] (4)

		Me encataria dar los cursos de React y de Node. üòÉ

	* **Andres Roberto Coello Goyes** [469316] (1)

		Ayudaaaa‚Ä¶!!  
		<https://platzi.com/comentario/682505/>

* **jangove** (2) [652318](https://platzi.com/comentario/652318/) 

	ESTOY USANDO UN PROYECTO EN LARAVEL. ME AYUDARIA HACER ALGO CON EXPRESS!!! AYUDA

* **Luis Salazar** (2) [636434](https://platzi.com/comentario/636434/) 

	Me gustaria saber si este curso me servira para aprender de Express pero unido a React por ejemplo. Alguien me podra contestar?

	* **Diego Alexander Forero Higuera (Platzi)** [636434] (2)

		El curso esta enfocado en aprender a usar express para generar las rutas del crud de un API, se ense√±an motores de template que puedes usar para cargar tu aplicaci√≥n de react y contectarte con el API en express.

	* **Favio Sauto** [636434] (1)

		Hola Luis, por si sigues buscando Platzi sac√≥ la carrera de Escuela de Javascript y ah√≠ s√≠ hay cursos para aprender express con React, si todav√≠a no la has visto [este es el link](https://platzi.com/escuelajs/). Es todo el stack MERN (Mongo, Express, React, Node)

* **pabloverduzcos** (2) [539553](https://platzi.com/comentario/539553/) 

	Let‚Äôs do it üìì

* **Gustavo Ram√≠rez Apache** (2) [474461](https://platzi.com/comentario/474461/) 

	En las oficinas de la hermosa empresa donde trabajo Globant ‚ù§Ô∏è

* **mario-salinas** (2) [448519](https://platzi.com/comentario/448519/) 

	Muy emocionado por el curso!

* **FedeFenker** (2) [47915](https://platzi.com/comentario/448715/) 
Una consulta: Tiene sentido estudiar laravel y vue‚Ä¶y luego estudiar todo el backend en JS? O es mejor directamente mandarse a JS? Ser bac...

	* **Julio J Y√©pez** [47915] (11)

		Laravel es backend con PHP, y Vue aparentemente es el framework (de JS) ideal para frontend cuando tu backend es Laravel. Es lo que he escuchado. PHP va de lujo con PostgreSQL y otros manejadores relacionales.
		
		En el Stack de JS, MERN, el backend en s√≠ estar√≠a formado por Node (JS), Express (JS) y MongoDB (JS), y en el frontend, todo el ecosistema de React (JS) (Router, Navigation, NextJS, ReactNative, etc.)
		
		Si est√°s **empezando** a formarte como desarrollador (backend, frontend o FullStack), yo te sugerir√≠a entrar directo y de lleno con MERN ‚Ä¶ empezar por los Fundamentos de JS, Webpack, Git/Github, NodeJS, etc ‚Ä¶ es un camino un poco extenso y de complejidad media ‚Ä¶ pero es realmente potente y todo est√° muy integrado, adem√°s que al ser todo en el mismo lenguaje de programaci√≥n, se facilita el switcheo mental para ir de un lado a otro como pez en el agua ‚Ä¶
		
		Recuerda tambi√©n complementar tu formaci√≥n con todo lo relacionado a CSS.
		
		Mucho √©xito y Adelante!

* **fernan942** (1) [1019576](https://platzi.com/comentario/1019576/) 

	jsonViewer

* **jesus-olivares661** (1) [937784](https://platzi.com/comentario/937784/) 

	puedo hacer este curso sin hacer el de escenciales de node‚Ä¶?  
	La verdad no me parece para nada amigable ese curso‚Ä¶

* **Alejandro Gonz√°lez Reyes** (1) [767482](https://platzi.com/comentario/767482/) 

	Estoy en este curso para actualizar mis conocimientos. He leido 3 libros de Express publicados en el 2015. Los cuales me han dado la experiencia en el desarrollo de proyectos.
	
	Vamos a ver que hay de nuevo

* **Alejandro Gonz√°lez Reyes** (1) [767479](https://platzi.com/comentario/767479/) 

	Recuerdo que mi primer acercamiento con los frameworks Web fue con ExpressJS

## 0020. ¬øQu√© es express y para qu√© sirve [15697](https://platzi.com/clases/1437-express-js/15697-que-es-express-y-para-que-sirve/)

### Descripci√≥n:


 **Express.js** es un _framework_ para crear aplicaciones web, apis y web services que ha sido inspirado en la librer√≠a Sinatra de Ruby. Es software libre y de c√≥digo abierto con licencia MIT.

Algunas de las caracter√≠sticas de **Express.js** :

* Es **minimalista** , lo que lo hace muy liviano ya que muchas de sus funcionalidades deben ser instaladas posteriormente a trav√©s de plugins y m√≥dulos adicionales.
* Incluye un sistema de _**template engines**_ muy poderoso, con Handlebars, Pug, Mustach, etc. disponibles por defecto.
* Maneja **Routing** , con wildcards, par√°metros, etc.
* Implementa _middlewares_ , lo que es una de sus caracter√≠sticas m√°s notables e importantes.
* Permite la instalaci√≥n de _plugins_ a travpes de _middlewares_.



### Links:

* [Sinatra](http://sinatrarb.com/)

* [RandomKeygen - The Secure Password & Keygen Generator](https://randomkeygen.com/)

### Comentarios:

* **Carlos Enrique Gonzalez Pe√±a** (4) [450922](https://platzi.com/comentario/450922/) 

	Pregunta para la comunidad o el profesor.  
	Si necesito realizar un REST que esta pensado para ser robusto, que framework de node recomiendan?  
	Ya tengo un REST en Express y lo considero f√°cil de implementar y f√°cil de leer y f√°cil de hacer crecer, pero al leer un poco en internet muchos recomiendan diferentes frameworks como restify, koa o hapi.  
	Que recomendaci√≥n me hacen para usar cual framework y por que?
	
	Saludos!

	* **glrodasz** [450922] (3)

		Express puede funcionar para hacer un REST robusto, solo que requiere mucha organizacion de tu codigo y estructura del proyecto. Sin embargo si el unico proposito de tu app es ser una API, te recomiendo que explores Hapi.js: <https://platzi.com/cursos/hapi-js/>

	* **Carlos Enrique Gonzalez Pe√±a** [450922] (2)

		Por el momento si es el √∫nico prop√≥sito, pero en un futuro podr√≠a necesitar implementar mas cosas ya que el font-end si sera una plataforma muy grande por lo que puede que necesite mas herramientas o funcionalidades en un futuro que solo el REST

	* **glrodasz** [450922] (3)

		Yo creo que puedes continuar asi, Express.js realmente es muy versatil.

* **Eduardo Hidalgo D√≠az Rugama** (4) [449559](https://platzi.com/comentario/449559/) 

	Excelente introducci√≥n (: con todo

	* **Ulises Uriel Cabrera Rubio** [449559] (2)

		si

* **tzalejo** (3) [542261](https://platzi.com/comentario/542261/) 

	Buenas compa, les dejo un [link node-express](https://developer.mozilla.org/es/docs/Learn/Server-side/Express_Nodejs/Introduction) articulo que puede ayudarles para afianzar los conceptos de node y express.  
	Saludos

* **Alejandro Gonz√°lez Reyes** (1) [767491](https://platzi.com/comentario/767491/) 

	Si expressJS retomara algunas de las pr√°cticas de Sails. ser√≠a muy interesante.  
	Aunque es mejor tener el control absoluto de tu c√≥digo y no depender de estructuras rigidas.

* **Melina Jacqueline onoriaga** (1) [519048](https://platzi.com/comentario/519048/) 

	No entend√≠ que pagina menciono para la generaci√≥n del string de 256b , alguien me puede recomendar una?

	* **glrodasz** [519048] (3)

		@melonoriaga Esta te puede servir: <https://randomkeygen.com/>

* **Carlos Enrique Gonzalez Pe√±a** (1) [48095](https://platzi.com/comentario/450922/) 
Pregunta para la comunidad o el profesor. Si necesito realizar un REST que esta pensado para ser robusto, que framework de node recomiend...

	* **glrodasz** [48095] (3)

		Express puede funcionar para hacer un REST robusto, solo que requiere mucha organizacion de tu codigo y estructura del proyecto. Sin embargo si el unico proposito de tu app es ser una API, te recomiendo que explores Hapi.js: <https://platzi.com/cursos/hapi-js/>

## 0030. Creando tu primer servidor [15699](https://platzi.com/clases/1437-express-js/15699-creando-tu-primer-servidor/)

### Descripci√≥n:


Para crear un servidor **Express** b√°sico es necesario crear una carpeta para el proyecto, inicializar **npm** en este directorio e instalar Express.js como la primera dependencia de nuestro proyecto: **`npm i -S express`**. Seguidamente creamos el _index.js_ con el c√≥digo b√°sico para requerir y ejecutar el servidor y la ruta base de nuestra aplicaci√≥n.

Con el m√©todo **`.listen`** inicializamos nuestro server en el puerto que elijamos. Este m√©todo devuelve el servidor como un objeto, que luego podemos utilizar para hacer un log con informaci√≥n que se mostrar√° por consola.

En el archivo _package.json_ definimos el script con el que arrancaremos nuestro server, el cual ejecutar√° la instrucci√≥n **`node index`** , adicionalmente podemos definir un script para desarrollo en el que ejecutemos el index con **`nodemon`** que es una dependencia que ejecutar√° el servidor y actualizar√° su ejecuci√≥n de manera autom√°tica cada vez que se hagan cambios en los archivos.

Finalmente con **`npm run dev`** iniciamos el servidor y estamos listos para ver los resultados en el navegador, ya sea como _html_ o como _JSON_.

### Links:

* [Ejemplo "Hello World" de Express](http://expressjs.com/es/starter/hello-world.html)

### Comentarios:

* **David Vargas Dom√≠nguez** (12) [448857](https://platzi.com/comentario/448857/) 

	Recomiendo tener a mano la documentaci√≥n oficial para averiguar m√°s de express  
	<http://expressjs.com/en/starter/hello-world.html>

	* **dsepulved** [448857] (3)

		Tambi√©n en espa√±ol <http://expressjs.com/es/starter/hello-world.html>

* **Yus√©n Yosset Manchego Quispe** (8) [468536](https://platzi.com/comentario/468536/) 

	No es necesario inlcuir el -S , en las versiones recientes de npm esto es automatico

	* **glrodasz** [468536] (3)

		Gracias por la aclaraci√≥n. **yarn** tambien lo hace sin necesidad de agregar un parametro extra.

	* **Freddy C√≥rdova Arana** [468536] (1)

		Buen dato üëç

* **Carlos Enrique Gonzalez Pe√±a** (5) [450924](https://platzi.com/comentario/450924/) 

	Recomiendo ir leyendo un poco sobre variables de entorno en caso de ser nuevos en el ecosistema de Node para no usar valores por defecto como lo seria el puerto y mejor usar una variable de entorno

	* **maxhadortiz93** [450924] (3)

		Si es buena idea, por ejemplo si vas a subirlo en un servidor PaaS

* **david1906** (3) [704531](https://platzi.com/comentario/704531/) 

	Es como amor a primera vista, promete mucho este curso.

	* **glrodasz** [704531] (7)

		Ya sabes que cualquier duda, por aca estar√© pendiente.

* **Jhon Alexander Perez Valencia** (3) [611753](https://platzi.com/comentario/611753/) 

	<https://github.com/glrodasz/platzi-express>

* **Luis Casta√±eira** (2) [646543](https://platzi.com/comentario/646543/) 

	Me encanto la primera lecci√≥n.

* **juanortiz** (2) [552790](https://platzi.com/comentario/552790/) 

	expectativa y motivaci√≥n para este curso 10/10

* **Ulises Uriel Cabrera Rubio** (2) [476092](https://platzi.com/comentario/476092/) 

	mmm

* **Luis Arellano** (2) [454615](https://platzi.com/comentario/454615/) 

	no vemos el enlace de github por favor lo pueden poner?

	* **glrodasz** [454615] (2)

		Este es el enlace del repositorio, cada clase esta en su propia rama: <https://github.com/glrodasz/platzi-express>

* **omar-velez** (1) [1063836](https://platzi.com/comentario/1063836/) 

	Comparto c√≥digo del index.js
	``` 
	    const express = require("express");
	    const app = express();
	    
	    app.get("/", (req, res)=>{
	        res.send({
	            message: "Hello World!!!"
	        });
	    });
	    
	    const server = app.listen(8000, ()=>{
	        console.info(`Listening on http://localhost:${server.address().port}`);
	    });
	    
	```

* **albertodsosa** (1) [1043731](https://platzi.com/comentario/1043731/) 

	.gitignore con un comando `$ npx gitignore node`

* **Alejandro Gonz√°lez Reyes** (1) [767506](https://platzi.com/comentario/767506/) 

	Interesante ser√≠a el instalar babel para que nuestro c√≥digo funcionara con las √∫ltimas caracter√≠sticas de ES6

	* **Gerardo Nava Pereda** [767506] (1)

		No. Babel es para navegadores. Al hablar de servidores tu instalas la versi√≥n del Motor V8 de JavaScript, por tanto, aqu√≠ depende de la versi√≥n de NodeJS que usa tu servidor para saber si puedes o no usar ESx

* **xyz123** (1) [73327](https://platzi.com/comentario/832726/) 
Entonces es recomendable primero aprender Node.js?

	* **Kevin Javier Morales** [73327] (2)

		S√≠, ser√≠a bueno saber primero Node para que entiendas mejor este curso

## 0040. Express application generator [15700](https://platzi.com/clases/1437-express-js/15700-express-application-generator/)

### Descripci√≥n:


En esta clase veremos c√≥mo usar el generador de aplicaciones oficial de **Express** , llamado **`express-generator`** , que permite generar toda una estructura base o _scafold_ predeterminada para iniciar un proyecto nuevo.

Primero debemos instalarlo como una dependencia global con la instrucci√≥n:
``` 
    npm i express-generator -g
    
```

Luego para generar una aplicaci√≥n, ejecutamos la instrucci√≥n:
``` 
    express --view=pug <nombre-de-la-aplicacion>
    
```

Finalmente seguimos las instrucciones que nos indica:
``` 
    #Cambiar de directorio:
    cd <nombre-de-la-aplicacion>
    
    #Instalar las dependencias:
    npm install
    
    #Ejecutar la app:
    DEBUG=<nombre-de-la-aplicacion>:* npm start
    
```

Con esta funcionalidad creamos una estructura inicial, predeterminada para un nuevo proyecto con **Express.js** , con algunas rutas y _middlewares_ iniciales con los que podemos empezar a trabajar, ahorr√°ndonos algunos pasos de configuraci√≥n.

### Comentarios:

* **David Vargas Dom√≠nguez** (8) [448882](https://platzi.com/comentario/448882/) 

	Si no les ha funcionado el comando DEBUG=myapp:* npm start en Windows  
	pueden usar este comando set DEBUG=myapp:* & npm start
	
	<https://expressjs.com/en/starter/generator.html>

* **Javier Serrano Lule** (5) [578047](https://platzi.com/comentario/578047/) 

	Si tienen problemas en arrancar Express en Windows ejecuten las siguientes l√≠neas por separado y solucionado:
	
	* _set DEBUG=express-app-gen:*_
	* _npm start_
	
	

	* **darwinyusef** [578047] (2)

		no funciona

	* **Cristian Alexander Salazar Atalaya** [578047] (2)

		@darwinyusef descarga cmder, es un mejor shell y ah√≠ si me funcion√≥ lo que indic√≥ javie, gracias.

	* **Moises Aceves** [578047] (1)

		muchas gracias si me dio ese problema

	* **Wilson Marino Pablo Mendez** [578047] (1)

		Lo que sufrimos los usuarios de windows.
		
		* 
		
		
		Yo uso _gitbash_

* **Eduardo Hidalgo D√≠az Rugama** (5) [449584](https://platzi.com/comentario/449584/) 

	Reto:
	
	![1.PNG](https://static.platzi.com/media/user_upload/1-454ef8da-7b5c-481c-bee4-71abe4ff3aef.jpg) ![2.PNG](https://static.platzi.com/media/user_upload/2-88c4a3e1-0c2f-43c7-8dbd-5d7d9fbe87a0.jpg)

	* **Eduardo Hidalgo D√≠az Rugama** [449584] (3)

		No olviden ir a app.js y crear la variable de enrutado y ponerla en uso:
		``` 
		    ...
		    var infoRouter = require('./routes/info');
		    ...
		    app.use('/info', infoRouter);
		    ...
		    
		```

	* **Freddy C√≥rdova Arana** [449584] (3)

		Muy bueno, gracias por compartirlo üòÑ

* **juand_silva** (4) [682494](https://platzi.com/comentario/682494/) 

	Para los que llegamos tarde:
	``` 
	    npx express-generator --view=pug
	    
	```
	
	para que no se instale de forma global.

* **Jos√© Ricardo Romo Guti√©rrez** (4) [468860](https://platzi.com/comentario/468860/) 

	Genial introducci√≥n, conciso, claro y preciso. Por eso me gusta tanto express, no conoc√≠a este generador de aplicaciones‚Ä¶ Genial curso le veo futuro

* **fernan942** (3) [1019727](https://platzi.com/comentario/1019727/) 

	Para los usuarios de windows como yo, les recomiendo:  
	1er. Crean una carpeta llamada express-app-gen  
	2do. Entren a la carpeta express-app-gen  
	3ero. Corran el comando npx express-generator  
	Con este ultimo paso tendran toda app creada con sus carpetas, tal cual esta en la clase.

* **Angel Hernandez** (3) [879186](https://platzi.com/comentario/879186/) 

	La explicacion es muy pobre y se nota que a pesar de manejar el tema, no puede comunicar sus ideas en la clase

* **luisangeldev** (3) [529885](https://platzi.com/comentario/529885/) 

	Les comparto:
	
	Agregu√© un nuevo archivo en la carpeta **routes** y lo llam√© about-me.js, este es el c√≥digo:
	``` 
	    // routes/about-me.js
	    var express = require('express');
	    var router = express.Router();
	    
	    /* GET home page. */
	    router.get('/', function (req, res, next) {
	        res.render('about-me', {
	            me: {
	                name: 'Luis Angel',
	                last_name: 'Frias',
	                favorite_food: 'chilaquiles :O___',
	                size: '1.65m',
	                weight: '85kg >:D'
	            }
	        });
	    });
	    
	    module.exports = router;
	    
	```
	
	En archivo anterior, al momento de dar una respuesta lo estamos haciendo usando una vista la cual tambi√©n agregar√© en la carpeta **views** llamando al archivo, about-me.pug con el siguiente c√≥digo:
	``` 
	    // views/about-me.pug
	    extends layout
	    
	    block content
	        p !{JSON.stringify(me)} /* <= Con esto muestro el JSON completo dentro de la vista*/
	    
	```
	
	Importamos/agregamos nuestro archivo de la carpeta **routes** en el archivo **app.js** del proyecto:
	``` 
	    // app.js
	    var usersRouter = require('./routes/users');
	    var aboutMe = require('./routes/about-me'); /* <= Mi ruta */
	    
	```
	
	Y al final declaramos la ruta que usaremos para llamar a ese archivo:
	``` 
	    // app.js
	    app.use('/users', usersRouter);
	    app.use('/about', aboutMe); /* <= Mi ruta about */
	    
	```

* **dagaor** (3) [477533](https://platzi.com/comentario/477533/) 

	Para el ejercicio quise crear un objeto ‚ÄòUsuarios‚Äô con dos elementos, los cuales tienen atributos cada uno. Lo hice de la siguiente manera:
	``` 
	    const express = require('express');
	    const app = express();
	    
	    var usuarios = {
	      'Alberto': {
	        nombre: 'alberto',
	        apellido: 'Lopez jimenez',
	        edad: 21
	      },
	      'Maximina' : {
	        nombre: 'Maximina',
	        apellido: 'Sanchez Garcia',
	        edad: 22
	      }
	    };
	    
	    app.get("/usuarios", function(req, res,next){
	      res.send(usuarios)
	    });
	    
	    const server = app.listen(3000, function(){
	      console.log(`Escuchando en htttp://localhost:${server.address().port}`);
	    });
	    
	```

* **Ulises Uriel Cabrera Rubio** (3) [476094](https://platzi.com/comentario/476094/) 

	falto un poco mas de explicaci√≥n

	* **glrodasz** [476094] (4)

		La idea es mantener los videos cortos y que el estudiante se anime a hacer su propia exploraci√≥n.
		
		Sin embargo, este medio de comentarios sirve para hacer todas las preguntes que necesites. Dime que quieres que te explique con profundidad?

* **rubenchanamesanchez** (2) [942542](https://platzi.com/comentario/942542/) 

	```
	    const express = require("express");
	    const app = express();
	    const port = process.env.PORT || 3000;
	    app.get("/", (req, res, next) => {
	      res.status(200).send({
	        firstName: "Rub√©n",
	        lastName: "Chanam√©",
	        age: 29
	      });
	    });
	    const server = app.listen(port, () => {
	      console.log(`Escuchando en el puerto ${port}`);
	    });
	    
	```

* **Alejandro Gonz√°lez Reyes** (2) [767555](https://platzi.com/comentario/767555/) 

	Crear un modulo de rutas para nuestra aplicaci√≥n
	``` 
	    const express = require('express')
	    // Inicializar nuestro enrutador
	    const router = express.Router()
	    
	    // Registrar rutas en nuestro enrutador
	    router.get('/', function (req, res) {
	      res.send('<h1>Bienvenidos al sitio</h1>')
	    })
	    
	    router.get('/products', function (req, res) {
	      res.json({
	        results: [
	          {
	            id: Math.floor(Math.random() * 1000),
	            name: 'Producto A',
	            createdAt: newDate
	          },
	          {
	            id: Math.floor(Math.random() * 1000),
	            name: 'Producto B',
	            createdAt: newDate
	          }
	        ]
	      })
	    })
	    
	    router.get('/servicios', function (req, res) {
	      res.render('site/servicios', {
	        title: 'Express JS Servicios',
	        contents: 'Contenido principal de la vista para servicios del estado mexicano'
	      })
	    })
	    
	    // Exportar nuestro enrutador
	    module.exports = router
	    
	```

* **Milton Cesar Catalan Parra** (2) [575138](https://platzi.com/comentario/575138/) 

	Buenos dias, tengo un problemas me sale esto, intente de varias formas pero sigue en lo mismo, alguien me puede ayudar??
	
	PS C:\Users\Milton\Desktop\express\express-app-gen> set DEBUG=express-app-gen:* & npm start  
	En l√≠nea: 1 Car√°cter: 29
	
	* set DEBUG=express-app-gen:* & npm start
	* 
	```                            ~
	    
	```
	
	
	
	
	No se permite usar el car√°cter de Y comercial (&). El operador & est√° reservado para un uso futuro; encierre un s√≠mbolo de Y comercial  
	entre comillas dobles ("&") para pasarlo como parte de una cadena.  
	\+ CategoryInfo : ParserError: (üòÉ [], ParentContainsErrorRecordException  
	\+ FullyQualifiedErrorId : AmpersandNotAllowed  
	![](url)

	* **Diego Alexander Forero Higuera (Platzi)** [575138] (3)

		Hola, creo que power shell no soporta encadenar los comandos como la terminal de linux o mac, lo mejor es que ejecutes tus comandos de manera separada.
		``` 
		    set DEBUG=express-app-get:*
		    npm start
		    
		```

* **JoosCode** (2) [573303](https://platzi.com/comentario/573303/) 

	no me gusta pug :S ‚Ä¶

* **harold-gama** (2) [572033](https://platzi.com/comentario/572033/) 

	me canse muchos errores en Windows ,instalando ubuntu para no perder tanto tiempo

	* **Sebastian Cardoso Castillo** [572033] (2)

		Felicidades. La mejor decisi√≥n de todas!

	* **Wilson Marino Pablo Mendez** [572033] (1)

		Yo quisiera pasar a linux pero utilizo XD, Illustrator, Photoshop.

* **Alexis Olveres** (2) [543674](https://platzi.com/comentario/543674/) 

	Cual es la diferencia entre el m√©todo
	
	`res.render()` y `res.send()`

	* **susegroj** [543674] (3)

		 **res.render()** : Renderiza una vista con datos (puedes utilizar HTML), situados en la carpeta views.  
		**res.send()** : Te ayuda a mostrar los datos que necesites cuando no te sea necesario utilizar HTML, es decir s√≥lo texto.

* **Juli√°n Cipagauta** (2) [527358](https://platzi.com/comentario/527358/) 
	
	![Captura.JPG](https://static.platzi.com/media/user_upload/Captura-f0c60990-b90b-4e1c-96d5-27edfb4085cf.jpg)

* **Juli√°n Cipagauta** (2) [527354](https://platzi.com/comentario/527354/) 

	Para los que usan PowerShell, el comando para cambiar la variable ENV, es: $env:NODE_ENV=‚Äúproduction‚Äù, despues ejecuten el comando npm start; Fuente: [https://stackoverflow.com/questions/9249830/how-can-i-set-node-env-production-on-windows](url).

* **George_18** (2) [518638](https://platzi.com/comentario/518638/) 
	
	![](https://scontent.fbog11-1.fna.fbcdn.net/v/t1.15752-9/s2048x2048/52602625_353741531886259_2105053464219353088_n.png?_nc_cat=101&_nc_ht=scontent.fbog11-1.fna&oh=0081f2f8123f38951b0eba25492427ea&oe=5CE405C7)
	
	Reto : en este caso estoy renderizando directamente un html y el cubo generado es con la libreria three.js

	* **Eduardo Hidalgo D√≠az Rugama** [518638] (3)

		est√° muy guapo (: has deploy de tu proyecto en [now.sh](http://now.sh)

	* **George_18** [518638] (2)

		Hola Eduardo Gracias es algo similar a heroku ?

	* **Eduardo Hidalgo D√≠az Rugama** [518638] (2)

		si, pero 10 veces m√°s facil

* **Brian Bentancourt** (2) [510018](https://platzi.com/comentario/510018/) 

	Reto
	``` 
	    const express = require('express')
	    const app = express()
	    
	    const puerto = process.env.PORT || 8000
	    
	    const dev = { 
	        name: "Brian",
	        lastName: "Bentancourt",
	        gitHub: "https://github.com/brianbentancourt"
	    }
	    
	    app.get('/',(req, res, next)=>{
	        res.send(dev)
	    })
	    
	    const server = app.listen(puerto, ()=>{
	        console.log(`Puerto ejecutando en puerto: ${server.address().port}`)
	    })
	    
	    
	```

* **MichaelSornoza** (2) [497010](https://platzi.com/comentario/497010/) 

	```
	    const express = require('express')
	    
	    const app = express()
	    
	    const Person = {
	      name: 'Michael',
	      lastName: 'Sornoza',
	      eMail: 'mospmanta@gmail.com'
	    }
	    
	    app.get('/', function(req, res, next) {
	      res.send({Person})
	    })
	    
	    const server = app.listen(8000, function() {
	      console.log(`Listening: http://localhost:${server.address().port}`);
	    })```
	    
	```

* **Mitchell Contreras** (2) [485602](https://platzi.com/comentario/485602/) 
El 'env' viaja en todos los request?

	* **glrodasz** [485602] (1)

		A que te refieres que el env viaja en todos los request?

* **Mitchell Contreras** (2) [485598](https://platzi.com/comentario/485598/) 
En el app.js en la funcion de error handler, se hace req.app.get('env') esto me causa una duda.

	* **glrodasz** [485598] (1)

		Hace parte de una serie de settings que se pueden establecer en el objeto app: <https://expressjs.com/en/4x/api.html#app.settings.table>

* **Daniel .** (2) [466776](https://platzi.com/comentario/466776/) 

	vamo a darle  
	![retoexpress.png](https://static.platzi.com/media/user_upload/retoexpress-b5f374ba-0ba8-45c5-8993-f67635453cf1.jpg)

* **Cristian David Franco Garcia** (2) [464634](https://platzi.com/comentario/464634/) 

	express --pug --git express-app-gen

* **ivanguerra10** (2) [462221](https://platzi.com/comentario/462221/) 

	Link al challenge: <https://github.com/iguerra94/reto1-curso-express>

* **Juan Pablo Montoya** (2) [457079](https://platzi.com/comentario/457079/) 

	si les sale error de express not recognized as internal or external command, es porque creo que tienen que estar linkeados al users root, no se, me estuve una noche entera solucionandolo, creo que fue eso

	* **glrodasz** [457079] (2)

		Es muy posible que hayas instalado node o paquete como usuario administrador y root, y no es recomendale hacerlo. NVM es una buena alternativa para instalar node:  
		<https://github.com/creationix/nvm>  
		<https://github.com/coreybutler/nvm-windows>

	* **Juan Pablo Montoya** [457079] (1)

		muchas gracias üòÉ

* **Juli√°n Andr√©s Vela Salazar** (2) [455783](https://platzi.com/comentario/455783/) 

	muy claro la info, vamos bien!

* **emanuel-alejandro-mamani** (1) [1064353](https://platzi.com/comentario/1064353/) 

	Reto completado
	``` 
	    const express = require('express');
	    const app = express();
	    
	    let data = {
	        status: 200,
	        error: null,
	        body : {
	            fullname: "Emanuel Mamani",
	            age: 22,
	            profession: 'Desarrollador Web'
	        }
	    }
	    
	    app.get('/', (req, res, next) => {
	        res.send(data);
	    });
	    
	    const server = app.listen(3000, () => console.log('Listening http://localhost:3000'))
	    
	```

* **omar-velez** (1) [1064041](https://platzi.com/comentario/1064041/) 

	Comparto c√≥digo de ejemplo‚Ä¶
	``` 
	    const express = require("express");
	    const app = express();
	    
	    app.get("/", (req, res)=>{
	        res.send({
	            "Informaci√≥n personal": {
	                Nombre: "Omar Velez",
	                Profesi√≥n: "Ingeniero de Sistemas",
	                Genero: "Masculino",
	                Pa√≠s: "Colombia",
	                Ciudad: "Bogota",
	            },
	            "Hobbies": {
	                1: "Leer",
	                2: "Escuchar Musica",
	                3: "Cine",
	                4: "Cocina"
	            },
	            "Bandas Preferidas": {
	                1: "AC/DC",
	                2: "The Strokes",
	                3: "Prisioneros",
	                4: "The Offspring",
	                5: "Daft Punk"
	            },
	        });
	    });
	    
	    const server = app.listen(8000, ()=>{
	        console.info(`Listening on http://localhost:${server.address().port}`);
	    });
	    
	    
	```

* **sebastianlosad6** (1) [1030413](https://platzi.com/comentario/1030413/) 

	const express = require(‚Äòexpress‚Äô);  
	const app = express();
	
	app.get(‚Äô/‚Äô, function(req, res, next) {  
	res.send({ title: ‚ÄúBienvenido a este su servidor de express‚Äù,  
	name: ‚ÄòJuan Sebastian‚Äô,  
	age: 22,  
	Profesion: ‚ÄòIngeniero de Software‚Äô,  
	hobbies: {  
	1: ‚Äòaeromodelismo‚Äô,  
	2: ‚Äòtocar acordeon‚Äô,  
	3: ‚ÄòJugar Futbol‚Äô  
	} });  
	});
	
	const server = app.listen(8000, function() {  
	console.log(`Listening http://localhost: ${server.address().port}`);  
	});

* **Rene Ismael Barrios Rojas** (1) [998710](https://platzi.com/comentario/998710/) 

	les dejo un recurso para no tener que escribir toda la ruta o comando en la consola
	``` 
	    aliasexpress="DEBUG=express-app:* npm start"
	    
	```
	
	‚Äúexpress‚Äù puede ser remplazado por la palabra que quieras, ya solo en la consola ejecutas express y listo!

* **Jenner Orozco** (1) [992902](https://platzi.com/comentario/992902/) 

	Si eres un usuario en WINDOWS y no te es posible ejecutar el comando `express --vies=pug [Nombre de la aplicacion]` debes de modificar tu variable de entorno e ir a buscar en la carpeta de tu usuario la carpeta appData>Roaming>node . Luego de esto ya te sera posible ejectuar el comando express

* **Sergio David Paez Suarez** (1) [975919](https://platzi.com/comentario/975919/) 

	```
	    <code>
	    const express = require('express');
	    const app = express();
	    
	    let usuarios = [];
	    
	    classUsuario {
	        constructor(nombre, edad, sexo) {
	            this.nombre = nombre;
	            this.edad = edad;
	            this.sexo = sexo;
	        }
	    }
	    
	    usuarios.push(new Usuario('sergio', 18, 'M'));
	    
	    usuarios.push(new Usuario('miguel', 18, 'M'));
	    
	    usuarios.push(new Usuario('nicolas', 18, 'M'));
	    
	    
	    app.get('/usuarios', (req, res) => {
	        res.send(usuarios);
	    });
	    
	    app.listen(2000, () => {
	        console.log("Servidor iniciado");
	    });
	    
	```

* **Santiago Rincon** (1) [964698](https://platzi.com/comentario/964698/) 

	```
	    const express = require('express')
	    
	    const app = express()
	    
	    const port = process.env.PORT || 8000
	    
	    app.get('/', (req, res, next) => {
	      res.send({
	        name: 'Santiago Rinc√≥n',
	        pokedex: {
	          _1: 'Bulbasaur',
	          _4: 'Charmander',
	          _7: 'Squirtle',
	          _10: 'Caterpie',
	          _13: 'Weedle'
	        }
	      })
	    })
	    
	    const server = app.listen(port, () => {
	      console.log(`Your Pokemon list at http://127.0.0.1:8000`)
	    })
	    
	```

* **Ken Ramirez** (1) [892859](https://platzi.com/comentario/892859/) 

	En mi caso para usar PowerShell tuve que utilizar el siguiente c√≥digo:
	
	`[Environment]::SetEnvironmentVariable("DEBUG","express:*"); & npm start`
	
	Original: <https://stackoverflow.com/a/51459879/7426916>

* **Ricardo Lugo Recillas** (1) [777771](https://platzi.com/comentario/777771/) 

	```
	    var express = require('express');
	    var router = express.Router();
	    
	    /* GET home page. */
	    router.get('/', function(req, res, next) {
	      res.render('index', { title: 'Express' });
	    });
	    
	    router.get('/info', function(req, res, next) {
	      res.send({
	        'name': 'Ricardo',
	        'last_name': 'Lugo',
	        'age': 29
	      });
	    });
	    
	    module.exports = router;
	    
	    
	```

* **Alejandro Gonz√°lez Reyes** (1) [767513](https://platzi.com/comentario/767513/) 

	```
	    const express = require('express')
	    const app = express()
	    
	    // Declaraci√≥n de rutas y sus respectivos controladores
	    app.get('/', function (req, res) {
	      // Enviar respuestas en formato HTML
	      res.send('<h1>Hello world</h1>');
	    })
	    
	    app.get('/json', function (req, res) {
	      // Enviar respuestas en formato json
	      res.json({
	        message: "Hello world javascripters",
	        date: newDate
	      })
	    })
	    
	    // Iniciar el servidor de la aplicaci√≥n
	    const server = app.listen(8000, function () {
	      console.log(`Listening http://localhost:${server.address().port}`)
	    })
	    
	    // Recomendable exportar como modulo para hacer pruebas unitarias a nuestra app, u ofrecerla como una librer√≠a para otros proyectos
	    exports.module = server
	    
	```

* **George_18** (1) [53542](https://platzi.com/comentario/518638/) 
Reto : en este caso estoy renderizando directamente un html y el cubo generado es con la libreria three.js

	* **Eduardo Hidalgo D√≠az Rugama** [53542] (3)

		est√° muy guapo (: has deploy de tu proyecto en [now.sh](http://now.sh)

# Template Engines y archivos est√°ticos [3074]

## 0050. Qu√© es y c√≥mo crear tu propio template engine [15702](https://platzi.com/clases/1437-express-js/15702-que-es-y-como-crear-tu-propio-template-engine/)

### Descripci√≥n:


Un _template engine_ es una implementaci√≥n de software que nos permite mezclar datos con una plantilla o _template_ con el fin de generar un documento que ser√° renderizado en el navegador. Algunos de los _template engines_ m√°s conocidos son: _Handlebars_ (para JavaScript), _Twig_ y _Blade_ (para Laravel / PHP), _JSP_ (para Java) o _Jinja_ (de python).

**Express** nos permite crear nuestro propio _template engine_ personalizado. Adem√°s permite el uso de m√∫ltiples _engines_ seg√∫n la extensi√≥n de los archivos que le hayamos indicado.
``` 
    app.engine('<extension>', function( filePath, options, callback ){});
    
    app.set('views', '<directorio-de-vistas>');
    app.set('view engine', '<extension>');
    
```

Donde **`filePath`** indica la ruta del _template_ , **`options`** indica las variables que vamos a mezclar con el _template_ y **`callback`** ser√° la funci√≥n que mezcle la plantilla con las opciones para obtener el documento que ser√° mostrado en el navegador.

Algo importante que debemos notar es que en Node, los callbacks son _‚Äú‚Äúerror first‚Äù‚Äù_ , por lo que el primer par√°metro devuelto por las funciones por lo general ser√°n siempre el objeto que contenga los detalles del error, si es que los hay.

Adem√°s en el objeto _options_ recibido en el _callback_ del _engine_ , no solo se pasan las variables que definimos en la llamada, sino otros datos como _settings_ y _locals_ que deberemos descartar cuando estamos creando nuestro propio _engine_ , pero que, cuando trabajamos con los _template engines_ predefinidos, ya es Node quien se encarga de manejarlos.

### Comentarios:

* **Erick Lugo** (11) [448111](https://platzi.com/comentario/448111/) 

	Me encanta la manera de explicar del profesor y la metodolog√≠a que utiliza para ense√±ar los temas! Gracias por este curso.

	* **Julio J Y√©pez** [448111] (6)

		Pienso lo mismo,  
		El dominio que tiene Guillermo de la herramienta y la forma de explicar cada tema est√° incre√≠ble ‚Ä¶ todo es s√∫per din√°mico.

	* **Erick Lugo** [448111] (5)

		Espero poder ver a guillermo en mas cursos! saludos @jjyepez

	* **Julio J Y√©pez** [448111] (5)

		Quiz√°s quieras pasarte luego por el curso de **OAuth** ‚Ä¶  
		<https://platzi.com/cursos/autenticacion-oauth/>

	* **edesalla17** [448111] (2)

		x3

* **doblesesays** (5) [486359](https://platzi.com/comentario/486359/) 

	Alguna raz√≥n en particular por las que no uses las arrow functions, @glrodasz?

	* **glrodasz** [486359] (9)

		A veces es preferencia, pero mi recomendaci√≥n es usar arrow functions cuando son necesarias, es decir cuando queremos que la funcion no tenga contexto. Tambien si es una funcion de un metodo funcional como map, filter, etc. Suelo usar arrow functions por comodidad.

	* **Karl Heitmann** [486359] (1)

		Buena, yo iba a preguntar lo mismo

* **Daniel .** (5) [466814](https://platzi.com/comentario/466814/) 

	Que bueno que no tengamos que hacer nuestros propios template engine

* **pabloverduzcos** (4) [542989](https://platzi.com/comentario/542989/) 

	Un **Template Engine** es una implementacion de software que sirve para mezclar datos y un template, y mediante el template engine podemos generar un **documento** como HTML

* **dagaor** (4) [477571](https://platzi.com/comentario/477571/) 

	Es informaci√≥n muy √∫til poder saber c√≥mo crear una custom template por nuestra cuenta, lo bueno es que hay herramientas que nos ahorran el trabajo.

* **tzalejo** (3) [541053](https://platzi.com/comentario/541053/) 

	Muy bueno, la descripci√≥n! no todo los curso lo agregan!  
	Saludos

* **Facundo Martin Gordillo** (3) [466664](https://platzi.com/comentario/466664/) 

	Quien haya hecho el curso de POO,
	``` 
	    constapp = express()
	    
	```
	
	Esto es como un ‚Äúconstructor‚Äù de Express e ‚Äúinstancia‚Äù Express en nuestro servidor. Lo pongo entre comillas porque en realidad todo en Javascript es una funci√≥n. Para m√°s informaci√≥n sobre eso investiguen sobre `modules` y `CommonJS` (<http://wiki.commonjs.org/wiki/Modules/1.1#Sample_Code>) bastante avanzado, pero ¬°bajo el riesgo de cada uno!

	* **glrodasz** [466664] (2)

		JavaScript tambien es un lenguaje orientado a objetos pero que tambien se comporta de manera funcional. Lo que mas diferencia es la manera como implementa la herencia ya que usa ‚Äúherencia prototipada‚Äù.
		
		> ECMAScript is an object-oriented programming language for performing computations and manipulating computational objects within a host environment.
		
		M√°s info:  
		<https://www.ecma-international.org/ecma-262/9.0/index.html#sec-overview>

* **doblesesays** (2) [51017](https://platzi.com/comentario/486359/) 
Alguna raz√≥n en particular por las que no uses las arrow functions, @glrodasz?

	* **glrodasz** [51017] (9)

		A veces es preferencia, pero mi recomendaci√≥n es usar arrow functions cuando son necesarias, es decir cuando queremos que la funcion no tenga contexto. Tambien si es una funcion de un metodo funcional como map, filter, etc. Suelo usar arrow functions por comodidad.

* **omar-velez** (1) [1065539](https://platzi.com/comentario/1065539/) 

	Muy interesante realmente, gracias por la clase!!

* **jlbousing** (1) [914283](https://platzi.com/comentario/914283/) 

	interesante. No sab√≠a que se pueden crear template engine tan facilmente.

* **adrianrbp** (1) [61278](https://platzi.com/comentario/619164/) 
Se hace set de "view" y "view engine", d√≥nde se llama o utiliza? No entiendo muy bien, es algo interno √≥ en alg√∫n lugar se referencia?

	* **adrianrbp** [61278] (1)
*"views"... Y en res.render("index",...). El index a que hace referencia? Es alg√∫n archivo index.algo?

## 0060. Implementando un template engine [15701](https://platzi.com/clases/1437-express-js/15701-implementando-un-template-engine/)

### Descripci√≥n:


### Links:

* [https://pugjs.org/](https://pugjs.org/)

* [Pug cheatsheet](https://devhints.io/pug)

* [PugHtml - Pug and HTML online converter in realtime](https://pughtml.com)

* [HTML2Jade - HTML to Jade/Pug Online Realtime Converter](https://html2jade.org/)

### Comentarios:

* **Julio J Y√©pez** (13) [449287](https://platzi.com/comentario/449287/) 

	Les comparto una lista de varios _template engines_ muy usados en la actualidad:
	
	* [Mustache](https://mustache.github.io/)
	* [Handlebars](http://handlebarsjs.com/)
	* [doT](https://olado.github.io/doT/)
	* [EJS](http://ejs.co/)
	* [Nunjucks](https://mozilla.github.io/nunjucks/)
	* [Underscore](http://underscorejs.org/)
	* [ECT](http://ectjs.com/)
	* [Template7](http://www.idangero.us/template7/)
	* [jTemplates](http://jtemplates.tpython.com/)
	
	
	
	Adem√°s de [PUG](https://pugjs.org/) obviamente.

* **Carlos Enrique Gonzalez Pe√±a** (7) [451482](https://platzi.com/comentario/451482/) 

	Como dato, la function RegExp es una Expresi√≥n Regular o Regular Expression, Platzi tiene un curso para el que quiera saber un poco mas sobre estas ya que las puedes aplicar en casi cualquier lenguaje de programaci√≥n moderno y puedes encontrar y filtrar cualquier cadena de texto sin importar que tan grande o complejo sea

* **Daniel .** (6) [475447](https://platzi.com/comentario/475447/) 

	Me parece genial que expliques el funcionamiento de los template con un ejemplo ‚Äúen bruto‚Äù, eso hace que tengamos una mejor idea de c√≥mo funcionan las cosas.

* **GerAlfonso** (4) [782039](https://platzi.com/comentario/782039/) 

	Comparto mi implementacion. en general remplazo el for por reducer y algunos otros refators:
	``` 
	    const fs = require('fs');
	    
	    const getKeysFromOptions = ({ settings, _locals, cache, ...sendOptions }) =>
	      Object.keys(sendOptions);
	    
	    const getRenderedContent = (content, options) => {
	      const keys = getKeysFromOptions(options);
	    
	      return keys.reduce(
	        (contentString, key) =>
	          contentString.replace(new RegExp(`\{${key}\}`, 'gi'), options[key]),
	        content.toString()
	      );
	    };
	    
	    module.exports = (filePath, options, callback) => {
	      fs.readFile(filePath, (err, content) => {
	        if (err) return callback(err);
	        const rendered = getRenderedContent(content, options);
	        return callback(null, rendered);
	      });
	    };
	    
	```

* **cristianc** (4) [491729](https://platzi.com/comentario/491729/) 

	**Destructuring** es una sintaxis que nos permite extraer datos de objetos o arrays.
	
	Ejemplo:
	``` 
	       test : {
	          a : "hola", 
	          b : "mundo"
	       }
	    //Los nombres de las variables tienen que ser las llaves del objeto o el array
	    const  {a, b } =  test
	    console.log(a +' '+ b)//hola mundo
	    
	```

* **john jairo lopez ramirez** (3) [726256](https://platzi.com/comentario/726256/) 

	Sinceramente no me han gustado estas clases, el profesor parece que tuviera afan o algo asimilar, no entiendo porque explica las cosas dando a entender que uno domina al 100% el tema, mas que una explicaci√≥n es como si fuera un relato.

* **Victor Lozada** (3) [531314](https://platzi.com/comentario/531314/) 

	Genial estas dos clases sobre templates engines, aunque estoy viendo el curso casi tres meses despu√©s de que fue lanzado me gustar√≠a ver mas proyectos por parte de Guillermo aqu√≠ en platzi ! üëçüèª

* **Sebasti√°n Arias** (3) [509374](https://platzi.com/comentario/509374/) 

	Me hubiera gustado que se utilize un template engine mejor mantenido por la comunidad, ya que en [npmjs.com](http://npmjs.com) se ve que Pug no tiene mantenimiento desde aproximadamente 1 a√±o:
	
	![Screenshot from 2019-02-12 21-14-48.png](https://static.platzi.com/media/user_upload/Screenshot%20from%202019-02-12%2021-14-48-371274cb-ec2d-4a10-9548-7e0dd1be00cf.jpg)
	
	Como opci√≥n me hubiera gustado ver algo de handlebars que esta siendo mantenido activamente y tiene mas descargas semanales:
	
	![Screenshot from 2019-02-12 21-17-57.png](https://static.platzi.com/media/user_upload/Screenshot%20from%202019-02-12%2021-17-57-3d3128fe-180a-4052-936d-284ffe794536.jpg)
	
	Fuente [npmjs.com](http://npmjs.com)

* **Eduardo Hidalgo D√≠az Rugama** (3) [449621](https://platzi.com/comentario/449621/) 

	Vaya, me cost√≥ trabajo hacer que me corra el ejercicio, tuve un mont√≥n de errores de sintaxis. Les dejo aqu√≠ el c√≥digo del ejercicio limpio para que nadie se vaya a frustrar porque se le fue una coma o una letra:
	
	archivo index.js
	``` 
	    const express = require('express');
	    const app = express();
	    const expressJsx = require('./express-jsx');
	    
	    app.engine("jsx", expressJsx);
	    app.set('views', './views');
	    app.set('view engine', 'jsx');
	    
	    app.get('/', function (req, res) {
	        res.render('index', {hello: "hola", world: "mundo"});
	    })
	    
	    const server = app.listen(8000, function() {
	        console.log('Listening http://localhost: ' + server.address().port);
	    })
	    
	```
	
	archivo express-jsx.js
	``` 
	    const fs = require('fs');
	    
	    functiongetKeysFromOptions(options) {
	        const { settings, _locals, ...objectKeys } = options;
	    
	        returnObject.keys(objectKeys);
	    }
	    
	    functiongetRenderedContent(content, options) {
	        const keys = getKeysFromOptions(options);
	        let contentString = content.toString();
	    
	        for (let key of keys) {
	            contentString = contentString.replace(
	                newRegExp(`\{${key}\}`, "gi"),
	                options[key]
	            );
	        }
	    
	        return contentString;
	    }
	    
	    functionexpressJsx(filePath, options, callback) {
	        fs.readFile(filePath, function (err, content) {
	            if (err) {
	                callback(err);
	            }
	    
	            const rendered = getRenderedContent(content, options);
	    
	            console.log(rendered);
	            return callback(null, rendered);
	        });
	    }
	    
	    module.exports = expressJsx;
	    
	```

	* **glrodasz** [449621] (4)

		En este branch del repo deberia funcionar sin problema: <https://github.com/glrodasz/platzi-express/tree/que-es-un-template-engine/template-engine>

* **Brayan Murcia Sanchez** (2) [568458](https://platzi.com/comentario/568458/) 

	porque, si estamos usando el node demon, no se actualizo el valor de la variable automaticamente cuando el profe cambio en el json?

	* **Eduardo Hidalgo D√≠az Rugama** [568458] (2)

		Nodemon no actualiza el servidor cuando archivos .json cambian. Solo con ciertos tipos de archivos, mayormente un archivo .js es lo que activa el reload de nodemon.

	* **marcelobaez** [568458] (3)

		Por defecto, como te mencionaron, nodemon no monitorea cambios en archivos que no sean .js (tipicos de Node). De todas maneras puedes indicar con un flag que deseas monitorear otras extensiones asi:
		``` 
		    nodemon -e js,jade,json
		    
		```

* **Mauricio Ch√°vez Olea** (2) [517983](https://platzi.com/comentario/517983/) 

	Les comparto un poco de lo que yo hice. En lugar de usar JSX, us√© Jinja 2 (Python) como template engine.
	
	Igual les comparto el [enlace a mi repositorio](https://github.com/mauricio-chavez/express-jinja) si quieren checarlo, o hacer un fork para hacer su propia versi√≥n, incluso un pull request para agregarle m√°s funcionalidad üòÑ
	
	![Captura de pantalla 2019-02-22 a la\(s\) 0.59.04.png](https://static.platzi.com/media/user_upload/Captura%20de%20pantalla%202019-02-22%20a%20la%28s%29%200.59.04-f2db1d8a-ed97-44a2-93b9-8e03cf8b450a.jpg) ![Captura de pantalla 2019-02-22 a la\(s\) 1.02.25.png](https://static.platzi.com/media/user_upload/Captura%20de%20pantalla%202019-02-22%20a%20la%28s%29%201.02.25-df068f50-580a-4c99-b9be-bf31acdbdd9c.jpg)

* **cristianc** (2) [491727](https://platzi.com/comentario/491727/) 

	Destructuring es una sintaxis que nos permite extraer datos de objetos o arrays. Ejemplo: test : { a : "hola", b : "mundo" } //Los nombres de las variables tienen que ser las llaves del objeto o el array const {a,b} = test console.log(a +' '+ b)//hola mundo

* **Brayan Murcia Sanchez** (2) [57717](https://platzi.com/comentario/568458/) 
porque, si estamos usando el node demon, no se actualizo el valor de la variable automaticamente cuando el profe cambio en el json?

	* **Eduardo Hidalgo D√≠az Rugama** [57717] (2)

		Nodemon no actualiza el servidor cuando archivos .json cambian. Solo con ciertos tipos de archivos, mayormente un archivo .js es lo que activa el reload de nodemon.

* **juanvalero252** (1) [1018092](https://platzi.com/comentario/1018092/) 

	Me gustar√≠a conocer Alternativas para las expresiones regulares ya que no las he estudiado todav√≠a. me gustaria que las clases tengan mas detalles que sumen al aprendizaje! PD: Buen profesor.

* **Alejandro Gonz√°lez Reyes** (1) [767673](https://platzi.com/comentario/767673/) 

	En un principio sent√≠ innecesario hacer uso de la expresion regular. Sin embargo, al tratar de renderizar la misma variable en distintas partes de mi plantilla, solo renderizaba la primer coincidencia.  
	Investigando un poco, ahora entiendo el porque de la expresi√≥n regular. Gracias a sus flags g, le indican que debe buscar el patron a nivel global, y no quedarse solo con la primera coincidencia.

* **Sebasti√°n Pineda Duque** (1) [632770](https://platzi.com/comentario/632770/) 

	La clase es interesante, y muy bien por el profesor y Platzi explicarnos lo que hay detr√°s de estos sistemas. Quiz√° para alguno de nosotros que no tenemos mucho rodaje en JavaScript se nos dificulte, pero con el paso del tiempo entenderemos a la perfecci√≥n lo que nos explic√≥ Guillermo üòÉ

## 0070. Usando Pug como template engine [16114](https://platzi.com/clases/1437-express-js/16114-usando-pug-como-template-engine/)

### Descripci√≥n:


Aprenderemos a definir Pug como nuestro template engine por defecto.

### Comentarios:

* **Diego Cruz** (21) [449896](https://platzi.com/comentario/449896/) 

	En pug para asignar la variable el igual debe quedar pegado a la etiqueta de lo contrario no funciona
	``` 
	    // Funciona
	                p= team.country
	     // No funciona
	                p = team.league
	    
	```

	* **tzalejo** [449896] (2)

		Gracias!!no encontrar el error!y con esto lo solucione‚Ä¶  
		Saludos

	* **heysoypaez** [449896] (2)

		Tambi√©n me pas√≥ el error, ¬°¬°¬° Gracias por compartir !!!

* **Juan Pablo Calle Garc√≠a** (5) [551445](https://platzi.com/comentario/551445/) 

	Es muy importante que los Pugs esten identados, de otra forma te dara un error.

* **Sebasti√°n Arias** (5) [509386](https://platzi.com/comentario/509386/) 

	Me hubiese gustado ver mas de Handlebars (u otro template engine) que sea mejor mantenido y m√°s usado que Pug, estoy al tanto de que los dos hacen y cumplen el trabajo, pero es importante tambien tener en cuenta que los paquetes que usemos en nuestro proyecto deben ser contar con ese respaldo por parte de la comunidad y sobre todo de sus manteiners.
	
	![handlebars.png](https://static.platzi.com/media/user_upload/handlebars-30266968-87d7-41df-9d32-539f373ed40b.jpg) ![pug.png](https://static.platzi.com/media/user_upload/pug-5a01e595-3a6a-4886-ab0a-16c62b581260.jpg)

	* **esdraspavon** [509386] (1)

		Existe un articulo en el curso (es el siguiente) para que puedas utilizar Handlebars en el proyecto!

* **cristianc** (5) [491798](https://platzi.com/comentario/491798/) 

	 **Caracter√≠sticas b√°sicas de PUG**
	
	-PUG es sensible a la identacion es decir para anidar etiquetas una dentro de otra se utilizan la identacion y no se cierran las etiquetas.
	``` 
	    ul
	          li Item A
	          li Item B
	    
	```
	
	* Los atributos de las etiquetas van entre par√©ntesis
	
	
	``` 
	    link(href='/css/styles.css', rel='stylesheet')
	    
	```
	
	* El texto en las etiquetas puede ser escrito en 3 formas diferentes
	
	
	``` 
	    p  
	      | Hola mundo
	    p.  
	      Hola mundo
	    p Hola mundo
	    
	```
	
	* Las clases y ID‚Äôs utilizan la sintaxis de CSS
	
	
	``` 
	    div.container
	    div#container
	    
	```
	
	* Las variables se crean de la siguiente forma
	
	
	``` 
	    - let engine = "PUG"
	    
	```
	
	* Para escapar y traer una variable se usa
	
	
	``` 
	    p El motor de vistas es #{engine}
	    
	```

* **Damian Spizzirri** (4) [686079](https://platzi.com/comentario/686079/) 

	El framework con el logo mas divertido que en visto hasta ahora. Me encanta la cara del perrito jajajaja.

* **Jhon Alexander Perez Valencia** (4) [611824](https://platzi.com/comentario/611824/) 
	
	![pug.PNG](https://static.platzi.com/media/user_upload/pug-73a909d5-b0e3-413d-bb0b-6b58ddadc5f9.jpg)

* **Juli√°n Andr√©s Vela Salazar** (4) [459023](https://platzi.com/comentario/459023/) 

	Hola donde puedo encontrar el branch de este proyecto? va demasiado rapido el tutor imposible seguirlo

	* **glrodasz** [459023] (4)

		Hola, este es el repositorio: <https://github.com/glrodasz/platzi-express> cada clase esta en un branch y esta clase pertenece a este branch: <https://github.com/glrodasz/platzi-express/tree/usando-pug-como-template>

* **camiladi** (3) [452271](https://platzi.com/comentario/452271/) 

	¬øesto es a lo que llaman **server side render**?

	* **glrodasz** [452271] (9)

		Si, y no. Definitivamente es Server Side Rendering, pero antes de que existieran las SPA, era la manera por defecto de crear apps web. Es lo que se conoce somo Server-Side apps. El termino SSR aplicado a las SPA es un poco mas complejo que esto, y requiere que los templates de SPA se hagan render tanto en el cliente como en el servidor.

* **Elmer16** (2) [650963](https://platzi.com/comentario/650963/) 

	Entonces en lugar de usar pug, podr√≠a usar react o HTML puro???

	* **Diego Alexander Forero Higuera (Platzi)** [650963] (3)

		Si, no hay ning√∫n problema.

	* **Andres Roberto Coello Goyes** [650963] (1)

		Lo puedes hacer pero recuerda que PUG permite incluir o heredar archivos, en html tiene que copiar y pegar en head y el footer. eso no es escalable

* **Juli√°n Andr√©s Vela Salazar** (2) [48785](https://platzi.com/comentario/459023/) 
Hola donde puedo encontrar el branch de este proyecto? va demasiado rapido el tutor imposible seguirlo

	* **glrodasz** [48785] (4)

		Hola, este es el repositorio: <https://github.com/glrodasz/platzi-express> cada clase esta en un branch y esta clase pertenece a este branch: <https://github.com/glrodasz/platzi-express/tree/usando-pug-como-template>

* **camiladi** (2) [48210](https://platzi.com/comentario/452271/) 
¬øesto es a lo que llaman server side render?

	* **glrodasz** [48210] (9)

		Si, y no. Definitivamente es Server Side Rendering, pero antes de que existieran las SPA, era la manera por defecto de crear apps web. Es lo que se conoce somo Server-Side apps. El termino SSR aplicado a las SPA es un poco mas complejo que esto, y requiere que los templates de SPA se hagan render tanto en el cliente como en el servidor.

* **fernan942** (1) [1066469](https://platzi.com/comentario/1066469/) 

	Alguien me puede ayudar con este error. Si bien dice que no puede ver view products en el directorio de views, lo cual no es asi. No se que otra cosa sera‚Ä¶
	
	Error: Failed to lookup view ‚Äúproducts‚Äù in views directory "/home/gerry/projects/expresJS/ecommerce/views"  
	at Function.render (/home/gerry/projects/expresJS/ecommerce/node_modules/express/lib/application.js:580:17)  
	at ServerResponse.render (/home/gerry/projects/expresJS/ecommerce/node_modules/express/lib/response.js:1012:7)  
	at /home/gerry/projects/expresJS/ecommerce/routes/products.js:16:9  
	at Layer.handle [as handle_request] (/home/gerry/projects/expresJS/ecommerce/node_modules/express/lib/router/layer.js:95:5)  
	at next (/home/gerry/projects/expresJS/ecommerce/node_modules/express/lib/router/route.js:137:13)  
	at Route.dispatch (/home/gerry/projects/expresJS/ecommerce/node_modules/express/lib/router/route.js:112:3)  
	at Layer.handle [as handle_request] (/home/gerry/projects/expresJS/ecommerce/node_modules/express/lib/router/layer.js:95:5)  
	at /home/gerry/projects/expresJS/ecommerce/node_modules/express/lib/router/index.js:281:22  
	at Function.process_params (/home/gerry/projects/expresJS/ecommerce/node_modules/express/lib/router/index.js:335:12)  
	at next (/home/gerry/projects/expresJS/ecommerce/node_modules/express/lib/router/index.js:275:10)

* **jesus-olivares661** (1) [970460](https://platzi.com/comentario/970460/) 

	porque estas creando todas esas carpetas y no usas en generate app de express con eso listo‚Ä¶?

	* **Santiago Rincon** [970460] (1)

		Para que se entienda como funciona (?)

	* **jesus-olivares661** [970460] (1)

		Porque ya vi todo eso en el curso de node‚Ä¶ Deber√≠a explicar la extructura de carpetas de express y el framework en s√≠‚Ä¶

* **Andres Roberto Coello Goyes** (1) [944372](https://platzi.com/comentario/944372/) 

	```
	    const express = require('express');
	    const app = express();
	    const path = require('path');
	    const productRouter = require('./routes/productos');
	    
	    app.set("views", path.join(__dirname, "views"));
	    app.set("view engine", "pug");
	    
	    app.use('/yo', productRouter);
	    
	    app.listen(3001, function(){
	        console.log('puerto 3001 levantado');
	    })
	    
	```

* **Alejandro Gonz√°lez Reyes** (1) [768139](https://platzi.com/comentario/768139/) 

	Sin duda. Me gusta trabajar con Express y Laravel
	``` 
	    const express = require('express')
	    // Modulo nativo para trabajar con rutas de directorioss 
	    const path = require('path')
	    const app = express()
	    
	    // Requerir mis m√≥dulos de ruta
	    const productsRouter = require('./routes/products')
	    
	    // Establecer el directorio de las vistas
	    app.set('views', path.join(__dirname, 'views'))
	    // Asociar al motor de plantillas los archivos con extensi√≥n .pug
	    app.set('view engine', 'pug')
	    
	    // Registrar un router en express
	    app.use('/products', productsRouter)
	    
	    const server = app.listen(3000, function () {
	      console.log(`Server Listening in http://localhost:${server.address().port}`)
	    })
	    
	    // Exportar mi instancia del servidor. Buenas Pr√°cticas para testing o requerir en otros modulos.
	    module.exports = server
	    
	```

	* **jesus-olivares661** [768139] (1)

		Hola, tengo una pregunta‚Ä¶  
		Que ventajas vez de express con respecto a laravel‚Ä¶?

* **DavidArmandoVelazquez** (1) [80064](https://platzi.com/comentario/951940/) 
Hola, quiero renderizar data filtrada por medio de un input, pero no encuentro la manera, hice un archivo .js en public donde se hace una...

## 0080. Usando Handlebars como template engine [15703](https://platzi.com/clases/1437-express-js/15703-usando-handlebars-como-template-engine/)

### Descripci√≥n:


# Usando Handlebars como template engine

Para poder hacer uso de Handlebars en nuestro proyecto de Express.js lo √∫nico que debemos hacer es instalar como dependencia la librer√≠a `consolidate` y registrarla como engine.

Tenienendo una aplicacion de Express.js basica:
``` 
    const express = require("express");
    
    const app = express();
    
    app.get("/", function(req, res) {
      res.render("index", { hello: "hola", world: "mundo" });
    });
    
    const server = app.listen(3000, function() {
      console.log(`Listening http://localhost:${server.address().port}`);
    });
    
```

Justo antes de las definiciones de rutas agregamos:
``` 
    const engines = require('consolidate');
    
    app.engine('hbs', engines.handlebars)
    
    app.set('views', './views')
    app.set('view engine', 'hbs')
    
```

De esta manera podemos crear un nuevo template llamado `index.hbs` en la carpeta `views`.
``` 
    <h1>{{hello}} {{world}}h1>
    
```

Y eso es todo, ya podemos usar nuestros templates hecho con Handlebars.

### Comentarios:

* **Hector Jose Flores Colmenarez** (18) [454556](https://platzi.com/comentario/454556/) 

	Importante aclarar aqu√≠ que si usas consolidate debes instalar tambi√©n el m√≥dulo nativo de handlebars para que funcione estos pasos, ya que consolidate es un wrapper.
	
	`npm i -S handlebars`

	* **Sebasti√°n Pineda Duque** [454556] (1)

		¬øA qu√© se refiere con wrapper?

	* **glrodasz** [454556] (4)

		PinedaS, un wrapper, es como una envoltura. Imagina que tienes un codigo en jQuery y necesitas ejecutarlo en React, puedes hacer como una funci√≥n intermedia que se encargue de comunicar jQuery con React.

	* **Deyvis Neyser Valdez Gavilan** [454556] (2)

		Tengo entendido que los m√≥dulos nativos no necesitan ser instalados, solo requeridos con require()?. Si estoy mal, corregidme!. Gracias.

* **Fernando Azuaje** (8) [553535](https://platzi.com/comentario/553535/) 

	Si quieren realizar el ejemplo de la clase anteriror usando handlebars, quedaria asi la vista de productos:
	``` 
	    <ul>
	        {{#each products}}
	        <li>
	        <strong>{{name}}</strong> 
	        <p>{{price}}</p>
	        </li>
	        {{/each}}
	    </ul>
	    <p>Comprar</p>
	    
	```

* **Alejandro Gonz√°lez Reyes** (3) [768166](https://platzi.com/comentario/768166/) 

	En su momento hab√≠a escuchado de la librer√≠a Consolidate.js y sus beneficios para usar un motor de plantillas diferentes en Express. Nunca me atrev√≠ a usarla, pero siguiendo este tutorial, otros en la red y sobre todo la explicaci√≥n de como generar nuestro propio motor de plantillas para Express. Me ayud√≥ mucho a comprender como trabaja esto dentro de la caja y he logrado hacer un ejemplo funcionando al 100%
	``` 
	    const express = require('express')
	    const consolidate = require('consolidate')
	    // No es necesario requerirlo como un modulo en la aplicaci√≥n, pero internamente Consolidate lo requiere para poder generar el envoltorio que dote de compatibilidad con express. Por tanto es necesario instalarlo como una dependencia del proyecto
	    
	    // const handlebars = require('handlebars')
	    const path = require('path')
	    
	    constapp = express()
	    
	    // Registrar el motor de plantillas Handlebars a trav√©s del Consolidate
	    // Consolidate dota de una API a nuestro motor de plantillas compatible con Express
	    app.engine('hbs', consolidate.handlebars)
	    
	    // Registrar el directorio de vistas y la extensi√≥n de archivos que renderizar√° nuestro motor de plantillas
	    app.set('views', path.join(__dirname, 'views'))
	    app.set('view engine', 'hbs')
	    
	    app.get('/', function (req, res) {
	      res.render('bienvenidos', {
	        titulo: 'Motor de Plantillas Handlebars',
	        contenido: 'Handlebars no viene por defecto como un motor de plantillas registrado en Express. En este sentido, es importante hacer uso dela librer√≠a consolidate quese encarga de servir como un wrapper ofreciendo la firma que express necesita para registrar un motor de plantillas.',
	        notas: 'Es necesario instalar el modulo que contiene el core de handlebars. Para que consolidate internamente lo registre y se lo pase a Express para que pueda renderizar las vistas indicadas'
	      })
	    })
	    
	    const server = app.listen(8000, function () {
	      console.log(`Appen http://localhost:${server.address().port}`)
	    })
	    
	    module.exports = server
	    
	```

* **Freddy C√≥rdova Arana** (2) [490604](https://platzi.com/comentario/490604/) 

	Pasos muy sencillos, muchas gracias üòÉ

* **Jhonnattan Rivera** (1) [1038711](https://platzi.com/comentario/1038711/) 

	la verdad no me gusta usar los generadores de plantillas porque usan muchos recursos del servidor, pero si que facilita el trabajo. yo me cierro solo envio y recepcion de JSON

## 0090. Creando nuestro layoutde productos usando Pug [15704](https://platzi.com/clases/1437-express-js/15704-creando-nuestro-layout-de-productos-usando-pug/)

### Descripci√≥n:


Para implementar _templates_ con PUG, s√≥lo bastar√° con instalar PUG con la instrucci√≥n **`npm i -D pug`** y definir el uso del _view engine_ respectivo usando los _middlewares_ de manera similar a como vimos antes con _Handlebars_.

PUG incluye instrucciones que facilitan el trabajo con las vistas:

* **`extends`** : define un _template_ base del que extiende el _template_ actual.
* **`include`** : define la inclusi√≥n o importaci√≥n de otro _template_.
* **`block`** : define un _placeholder_ para el contenido de bloques en los que se insertar√°n partes de un _template_.



Para m√°s informaci√≥n sobre el uso de PUG, Bulma y FontAwesome, recuerden consultar los enlaces adicionales de esta clase.

### Links:

* [Bulma: an alternative to Bootstrap](https://bulma.io/alternative-to-bootstrap/)

### Comentarios:

* **oteka21** (22) [450590](https://platzi.com/comentario/450590/) 

	alguien mas pens√≥ en esta Bulma?
	
	![](https://vignette.wikia.nocookie.net/dragonball/images/b/b9/Bulma_DB_Artwork_Inicio.png/revision/latest?cb=20170709213656&path-prefix=es)

	* **Juli√°n Andr√©s Vela Salazar** [450590] (2)

		Jajajaja tal cual

	* **onlinejaime** [450590] (1)

		Mi perrita, en paz descanse, tambi√©n se llamaba Bulma. Y, ay amigos, en car√°cter era igualita a la Bulma de Bola de Drag√≥n‚Ä¶ De ah√≠ su nombre.

* **Carlos David Sanchez Moreno** (13) [501147](https://platzi.com/comentario/501147/) 

	Bulma:
	``` 
	    https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.css
	    
	```
	
	Font Awesome: en CSS
	``` 
	    https://use.fontawesome.com/releases/v5.7.1/css/all.css
	    
	```

* **doblesesays** (8) [486833](https://platzi.com/comentario/486833/) 

	Hab√≠a le√≠do sobre Bulma pero nunca lo hab√≠a usado. Es agradable que en los tutoriales utilicen herramientas alternativas a las t√≠picas y que probablemente la mayor√≠a de nosotros ya conocemos (en este caso Bootstrap).

	* **Freddy C√≥rdova Arana** [486833] (2)

		Estoy de acuerdo, siempre es bueno conocer otras alternativas.

* **Gerardo Manuel Reyes Fern√°ndez** (5) [474487](https://platzi.com/comentario/474487/) 

	Prefiero HTML limpio que pug.  
	Me gusta que la etiqueta de cierre sea el limitador del scope de cada elemento.

	* **Freddy C√≥rdova Arana** [474487] (2)

		me too

	* **Carlos David Sanchez Moreno** [474487] (3)

		El problema con HTML puro es que al hacer proyectos grandes terminas repitiendo grandes cantidades de c√≥digo.

	* **Jorge Alberto Guevara Boh√≥rquez** [474487] (2)

		Creo que el tema de la indentaci√≥n de PUG es lo que me puede confundir. Pero vale la pena aprenderlo. Sobre todo para ahorrar gran cantidad de c√≥digo y errores de sintaxis en HTML.

	* **Elias Ojeda Medina** [474487] (2)

		A mi no me termina de convencer PUG, prefiero React con Jsx

* **Sebasti√°n Pineda Duque** (3) [633335](https://platzi.com/comentario/633335/) 

	Me gustar√≠a un curso de Pug en Platzi.

* **Freddy C√≥rdova Arana** (3) [490807](https://platzi.com/comentario/490807/) 

	Links de las imagenes:
	
	[Red shoes](https://images.unsplash.com/photo-1525966222134-fcfa99b8ae77?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=0e44599932dce6b8440e26fb91e10a69&auto=format&fit=crop&w=800&q=60)  
	[Black bike](https://images.unsplash.com/photo-1532298229144-0ec0c57515c7?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=53d820e6622fadd53b8638d60f468ccd&auto=format&fit=crop&w=800&q=60)

* **Wilson Marino Pablo Mendez** (2) [842507](https://platzi.com/comentario/842507/) 

	```
	    .card(style="overflow:hidden; border-radius:5px")
	    
	```
	``` 
	    img(src= product.imagestyle="height:100%; object-fit:cover; object-position:50% 30%")
	    
	```

* **Alejandro Gonz√°lez Reyes** (2) [768218](https://platzi.com/comentario/768218/) 

	Al inicio no le encontraba sentido a los motores de plantillas, pero cuando llegu√© por primera vez a los frameworks vi todo su potencial.  
	Pug es excelente, para mi es mas limpio. sin embargo cuando quieres dejar espacios en blanco al final o al inicio se pone rejego. Es importante analizar correctamente la documentaci√≥n

* **Milton Cesar Catalan Parra** (2) [577750](https://platzi.com/comentario/577750/) 

	Error: Cannot find module 'boom‚Äô  
	at Function.Module._resolveFilename (internal/modules/cjs/loader.js:582:15)  
	at Function.Module._load (internal/modules/cjs/loader.js:508:25)  
	at Module.require (internal/modules/cjs/loader.js:637:17)  
	at require (internal/modules/cjs/helpers.js:22:18)  
	at Object.<anonymous> (C:\Users\Milton\Desktop\express\ecommerce\index.js:4:14)  
	at Module._compile (internal/modules/cjs/loader.js:701:30)  
	at Object.Module._extensions‚Ä¶js (internal/modules/cjs/loader.js:712:10)  
	at Module.load (internal/modules/cjs/loader.js:600:32)  
	at tryModuleLoad (internal/modules/cjs/loader.js:539:12)  
	at Function.Module._load (internal/modules/cjs/loader.js:531:3)  
	[nodemon] app crashed - waiting for file changes before starting‚Ä¶

	* **glrodasz** [577750] (1)

		boom ahora esta '@hapi/boom"

* **Carlos Enrique Gonzalez Pe√±a** (2) [451501](https://platzi.com/comentario/451501/) 

	Donde esta el enlace al github de este proyecto?

	* **Juan Antonio Baracat** [451501] (3)

		<https://github.com/glrodasz/platzi-express>

* **matheoNieto** (1) [788546](https://platzi.com/comentario/788546/) 

	El motor de plantilla de pug es muy sensillo y amigable. Me encanta!!

* **Favio Sauto** (1) [764869](https://platzi.com/comentario/764869/) 

	Me gusta mucho Pug, lo veo como el Sass de HTML (usando los archivos con extensi√≥n .sass en lugar de .scss) tanto en Sass como en Pug se tiene que prestar atenci√≥n a la identaci√≥n, que creo que es uno de los principales problemas de los que empiezan a aprender Pug. Intenten crear un peque√±o proyecto usando .sass y Pug para que vean que si usan ambos al mismo tiempo es una cosas muy sencilla! üòÅ

* **Sabrina Valerio Hidalgo** (1) [735322](https://platzi.com/comentario/735322/) 

	Pug no es lo m√≠o! Handlebars me gusta mucho m√°s.

* **Carlos Enrique Gonzalez Pe√±a** (1) [48153](https://platzi.com/comentario/451501/) 
Donde esta el enlace al github de este proyecto?

	* **Juan Antonio Baracat** [48153] (3)

		<https://github.com/glrodasz/platzi-express>

## 0100. Manejo de archivos est√°ticos [15705](https://platzi.com/clases/1437-express-js/15705-manejo-de-archivos-estaticos/)

### Descripci√≥n:


### Comentarios:

* **Julio J Y√©pez** (9) [454060](https://platzi.com/comentario/454060/) 

	Si el m√©todo para usar _middlewares_ en Express es **`app.use()`** , ¬øsignifica entonces que Express tambi√©n maneja las rutas como si fueran _middlewares_?

	* **glrodasz** [454060] (12)

		Exactamente! Practicamente **todo** en Express es un middleware!

* **Luis Daniel Becerra Avellaneda** (9) [449613](https://platzi.com/comentario/449613/) 

	Por si no logran descargar la carpeta public del sistema de archivos de Platzi, el repositorio del curso esta en [Github](https://github.com/glrodasz/platzi-express) y esta ordenado en ramas.

* **Alejandro Gonz√°lez Reyes** (3) [768235](https://platzi.com/comentario/768235/) 

	No cabe duda que los libros que le√≠ acerca de Express para realizar aplicaciones MEAN, me ha servido de mucho.  
	Probar√© el siguiente a√±o en buscar alg√∫n trabajo que requiera desarrolladores en este tipo de herramientas  
	![2019-10-05-152112_1366x768_scrot.png](https://static.platzi.com/media/user_upload/2019-10-05-152112_1366x768_scrot-1e73cd27-b7f7-427a-b2aa-1e4978dfeae7.jpg)

* **juand_silva** (3) [684160](https://platzi.com/comentario/684160/) 

	Y para los que odiamos los espacios en blanco en VSCODE y lo tenemos configurado para quitar esos espacios autom√°ticamente al guardar, ponemos:
	``` 
	    &nbsp;
	    
	```

* **Alejandro Gonz√°lez Reyes** (2) [768237](https://platzi.com/comentario/768237/) 

	Un aporte para la clase
	``` 
	    const express = require('express')
	    // Modulo nativo para trabajar con rutas de directorioss 
	    const path = require('path')
	    const app = express()
	    
	    // Registrar middleware de archivoes est√°ticos
	    
	    // Al asociarles una ruta, generamos autom√°ticamente un acceso directo a dicho directorio. De esta forma podemos acceder a este material desde cualquier parte del proyecto sin preocuparnos por la ubicaci√≥n donde nos econtremons, solo hace falta declarar /static/nombreArchivo.ext
	    app.use('/static', express.static(path.join(__dirname, 'public')))
	    
	    // Requerir mis m√≥dulos de ruta
	    const productsRouter = require('./routes/products')
	    
	    // Establecer el directorio de las vistas
	    app.set('views', path.join(__dirname, 'views'))
	    // Asociar al motor de plantillas los archivos con extensi√≥n .pug
	    app.set('view engine', 'pug')
	    
	    // Registrar un router en express
	    app.use('/products', productsRouter)
	    
	    const server = app.listen(3000, function () {
	      console.log(`Server Listening in http://localhost:${server.address().port}`)
	    })
	    
	    // Exportar mi instancia del servidor. Buenas Pr√°cticas para testing o requerir en otros modulos.
	    module.exports = server
	    
	```

* **Gerardo Manuel Reyes Fern√°ndez** (2) [567076](https://platzi.com/comentario/567076/) 

	Si est√°s usando angular
	
	Generar el proyecto con el comando  
	express --no-view nombre-proyecto
	
	Tu carpeta dist requiere ser renombrada a public y sustituir la carpeta public que existe en express por esta
	
	Estas l√≠neas funcionan para no tener que necesitar el hash location strategy
	``` 
	    app.use('*', function(res, res){
	        res.sendFile(path.resolve('public/index.html'))
	        }
	    );
	    
	```
	
	Este c√≥digo se coloca al final de tus rutas para que no omita tus rutas de api.

	* **Gerardo Manuel Reyes Fern√°ndez** [567076] (1)

		√âste c√≥digo le dice a express que toda ruta no declarada en tu api la maneje angular

* **lucascartisano** (1) [984781](https://platzi.com/comentario/984781/) 

	Eso de que express es muy inteligente y sabe lo que queremos hacer no me cierra, como funciona app.use? que es? cuales son los parametros obligatorios y opcionales? de que tipo pueden ser? cuales son los valores por defecto? Ac√° no aclara mucho, solo puedo copiar y pegar, no me explica para que pueda entender y aplicar a mi criterio, deja muchas cosas en el aire el curso

	* **Vissstors** [984781] (1)

		Como puedes leer [aqu√≠](https://expressjs.com/es/4x/api.html#app.use), en la documentaci√≥n, ver√°s que un app.use utiliza como parametros obligatorios un path y al menos un callback (que pueden ser funciones middleware, una serie de funciones middlewares o un arreglos de √©stos). Esto quiere decir que Express montar√° una funci√≥n middleware sobre un path especifico, esto es, la funci√≥n middleware que agregues, se ejecutar√° cuando estes navegando y la barra de direcciones indique la base del path que colocaste en el app.use.  
		Por ejemplo, en el caso de esta clase, el profe usa: app.use("/static", express.static(path.join(__dirname, ‚Äúpublic‚Äù))), lo que le indica a express que cuando le indiques que algo est√° en /static/‚Ä¶ , √©ste buscar√° en la carpeta public.
		
		Eso es todo. Cualquier cosa, no dudes en consultar!!

* **Matias Sebastian Perez** (1) [494998](https://platzi.com/comentario/494998/) 

	No entiendo para que sirve:
	``` 
	    app.use('/static', express.static(path.join(__dirname, "public")))
	    
	```
	
	Lo borr√© y el proyecto da el mismo resultado

	* **cristianc** [494998] (5)

		Es un _middleware_ para ayudarte a crear una ruta de acceso inmediato a todos tus archivos est√°ticos como im√°genes o scripts. As√≠ puedes acceder a ellos desde cualquier archivo en tu proyecto sin importar la ubicaci√≥n en donde est√©s, simplemente utilizando el prefijo que definas en este caso ** /static/nombre-archivo**

	* **cristianc** [494998] (2)

		Te recomiendo que revises el llamado a las rutas de las im√°genes en el layout y footer porque si no existe el _middleware_ las imagenes no tienen que servir.

* **Gerardo Manuel Reyes Fern√°ndez** (1) [474494](https://platzi.com/comentario/474494/) 

	Esto sirve tambi√©n para los archivos de producci√≥n que salen de angular o react con webpack o vue?  
	Para levantarlos dentro de la misma instancia?

	* **alesanabriav (Platzi)** [474494] (3)

		Si Gerar, sirve para los archivos de producci√≥n que entrega por ejemplo webpack

	* **Gerardo Manuel Reyes Fern√°ndez** [474494] (1)

		Genial!! .  
		Gracias @alesanabriav.

* **Alejandro Gonz√°lez Reyes** (1) [70060](https://platzi.com/comentario/768312/) 
const fs = require('fs') function markdownEngine(filePath, options, callback) { fs.readFile(filePath, function (err, content) { ...

* **Alejandro Gonz√°lez Reyes** (1) [70059](https://platzi.com/comentario/768311/) 
He intentado hacer el reto, pero es evidente que me hace falta conocimiento en Expresiones Regulares. Tengo una propuesta, haber si me pu...

	* **Erik Ochoa** [70059] (2)

		Te recomiendo [regex101](https://regex101.com) para evaluaci√≥n de expresiones regulares y por supuesto este [curso](https://platzi.com/clases/expresiones-regulares/) en Platzi.
		
		Yo hice esta expresi√≥n regular que hace match cuando encuentra de uno hasta seis ‚Äú#‚Äù consecutivos. No s√© si sea lo que buscas pero te puede servir de base. Vela [aqu√≠](https://regex101.com/r/w2RlDy/1).

* **Gerardo Manuel Reyes Fern√°ndez** (1) [50003](https://platzi.com/comentario/474494/) 
Esto sirve tambi√©n para los archivos de producci√≥n que salen de angular o react con webpack o vue? Para levantarlos dentro de la misma in...

	* **alesanabriav (Platzi)** [50003] (3)

		Si Gerar, sirve para los archivos de producci√≥n que entrega por ejemplo webpack

# Creando un API Restful [3075]

## 0110. Anatom√≠a de una API RESTful e implementaci√≥n CRUD [15706](https://platzi.com/clases/1437-express-js/15706-anatomia-de-una-api-restful-e-implementacion-crud/)

### Descripci√≥n:


### Links:

* [Postman | API Development Environment](https://www.getpostman.com/)

* [
	The Best APIs are Built with Swagger Tools | Swagger
](https://swagger.io/)

### Comentarios:

* **Eduardo Hidalgo D√≠az Rugama** (11) [449642](https://platzi.com/comentario/449642/) 

	Por si alguno le interesa, existe [Insomnia](https://insomnia.rest/) como alternativa ‚ÄúRest Client‚Äù de Postman. Postman es muy bueno, pero Insomnia es m√°s simple (;

	* **FranLMSP** [449642] (2)

		Yo lo he usado, es bastante bueno

	* **Sebastian Cardoso Castillo** [449642] (2)

		A mi me gusta Insomnia.

* **Byhako** (4) [452342](https://platzi.com/comentario/452342/) 

	¬øPorqu√© no podemos usar la sintaxis de ES6 para importar/exportar los m√≥dulos?
	
	Osea, usar `import` en lugar de `require`.

	* **camiladi** [452342] (7)

		Por lo que estuve viendo, se debe a que **import** y **require** funcionan internamente de manera diferente, aqu√≠ una explicaci√≥n detallada.
		
		<https://medium.com/the-node-js-collection/an-update-on-es6-modules-in-node-js-42c958b890c>
		
		Ahora el asunto viene que hasta Node.js v11.5.0 (corr√≠janme si me equivoco) esta sintaxis para importar c√≥digo de ES6 no ten√≠a soporte de manera nativa (Si lo pod√≠as usar con Babel). Reci√©n en esta versi√≥n (v11.5.0) se est√° ofreciendo un soporte _experimental_ que puedes ver en el siguiente link: <https://nodejs.org/api/esm.html>

	* **glrodasz** [452342] (5)

		Exacto, de manera nativa solo esta disponible mediante un flag, si quieres hacerlo tendrias que usar babel.

	* **ma_angelica_romero** [452342] (1)

		Gracias por la explicaci√≥n

	* **crloshro** [452342] (1)

		Si se puede, el problema es que la version de node aun no soporta ES6 pero en babel hay una forma de configurar webpack 4.0 para que entienda el ES6 si quieres escribeme y te explico como

* **ricardochl** (3) [491373](https://platzi.com/comentario/491373/) 

	Codigos de respuesta HTTP
	
	<https://uniwebsidad.com/tutoriales/los-codigos-de-estado-de-http?from=librosweb>

* **Alejandro Gonz√°lez Reyes** (2) [768427](https://platzi.com/comentario/768427/) 

	Investigando me queda la duda si es buena idea declarar una ruta con el verbo PUT, se supone que una actualizaci√≥n por lo general es para ciertas partes del contenido, lo que con PATCH ser√≠a mas que excelente. Sin embargo, con PUT terminar√≠a creando el recurso si este no existe al consultarlo.
	``` 
	    const express = require('express')
	    const router = express.Router()
	    
	    // Requerir mi Mock de productos
	    const productMock = require('../../utils/mocks/products')
	    
	    // Declaramos EndsPoints con base al esquema de rutas propuestos para una API
	    router.get('/', function (req, res) {
	      // Esta ruta podr√≠a recibir queryString, quiz√° para filtrar o paginar productos
	      const { query } = req.query
	    
	      res.status(200).json({
	        data: productMock,
	        message: 'products listed'
	      })
	    })
	    
	    router.get('/:productId', function (req, res) {
	      // Esta ruta podr√≠a recibir mas de un parametro de consutla, en este caso me interesa el marcador productId que funge como id del producto para buscarlo en la base de datos
	      const { productId } = req.params
	    
	      res.status(200).json({
	        data: productMock[0],
	        message: 'product retrivied'
	      })
	    })
	    
	    router.post('/', function (req, res) {
	      // Esta ruta deber√≠a considerar el cuerpo de la petici√≥n, al ser POST se espera data proveniente de un formulario para ingresarla en la base de datos
	    
	      res.status(201).json({
	        data: productMock[1],
	        message: 'product created'
	      })
	    })
	    
	    router.patch('/:productId', function (req, res) {
	      // Esta ruta se le ha declarado como PATCH, la intensi√≥n es que modifique parte del contenirdo del recurso, y si no lo encuentra mande un error 404. Es decir, no es la intensi√≥n mandar toda la data para crearlo si no existe (PUT)
	      const { productId } = req.params
	    
	      res.status(200).json({
	        data: productMock[2],
	        message: 'product updated'
	      })
	    })
	    
	    router.delete('/:productId', function (req, res) {
	      const { productId } = req.params
	    
	      res.status(200).json({
	        data: productMock[3],
	        message: 'product deleted'
	      })
	    })
	    
	    module.exports = router
	    
	    
	```

* **Jose Daniel Barr√≠a Reyes** (2) [701422](https://platzi.com/comentario/701422/) 

	Termina de hablar del funcionamiento de REST

* **Sebas Qui** (2) [690591](https://platzi.com/comentario/690591/) 

	Va demaciado rapido.

* **Andres Roberto Coello Goyes** (2) [682505](https://platzi.com/comentario/682505/) 

	tengo un problema, tengo un proyecto de express donde hace una peticion api a MySQL y funciona se ve asi ![api.png](https://static.platzi.com/media/user_upload/api-02e8a237-5d98-46c9-88e0-0393c595f766.jpg)  
	tengo que consumir esa api con una aplicacion de react. pero cuando subo a produccion en heroku dice que no encuentra el archivo 404![he.png](https://static.platzi.com/media/user_upload/he-7cea08e9-82c1-45e8-ae70-5806c38072bb.jpg)  
	alguna solucion‚Ä¶???

	* **Diego Alexander Forero Higuera (Platzi)** [682505] (3)

		Hola, eso no es un error 404, hay un error en la aplicaci√≥n, probablemente sea algo de la configuraci√≥n, revisa los logs con el comando que menciona `heroku logs --tail` para ver los logs y comparte aqu√≠ para poder ayudarte.

	* **Andres Roberto Coello Goyes** [682505] (2)

		Es que yo no utilizo heroku en la consola‚Ä¶ solo creo una aplicacion y los archivos lo toma de GItHub, asi es como lo ago cuando trabajo en PHP pero es una novedad para node.js‚Ä¶  
		¬øQue podria hacer?

	* **Diego Alexander Forero Higuera (Platzi)** [682505] (2)

		Tienes que entrar o ver los logs usando la consola, PHP la verdad funciona muy diferente a como funcionan otros lenguajes como python, js, etc, necesitas verificar cual es el problema, puede ser que no est√©n instaladas las dependencias necesarias.

	* **Andres Roberto Coello Goyes** [682505] (2)

		El error era el puerto, tenia en mi index definido el puerto 7000, pero heroku es el que da el puerto haci que cambien a  
		app.set(‚Äòport‚Äô, process.env.PORT || 7000);  
		y solucionado‚Ä¶ gracias‚Ä¶

	* **Andres Roberto Coello Goyes** [682505] (2)

		no veo como salir de esta‚Ä¶  
		![fetxh.png](https://static.platzi.com/media/user_upload/fetxh-eaae02eb-8087-4b9f-a09a-1c630cb8c732.jpg)  
		cuando realizo la peticion me aparece este error‚Ä¶ he leido sobre el problema pero no me queda claro como resolverlo‚Ä¶

	* **Diego Alexander Forero Higuera (Platzi)** [682505] (2)

		Debes enviar en el header de la petici√≥n desde el localhost al Access-Control: Allow-Origin, o correr tu aplicaci√≥n que esta corriendo en localhost desde otro dino en heroku

	* **Andres Roberto Coello Goyes** [682505] (2)

		Puedes enviarme un ejemplo‚Ä¶  
		He intentado en hader pero me da como resultado un stado Opaco‚Ä¶ ya no tengo error pero tampoco se ve los datos‚Ä¶  
		üôè

	* **Andres Roberto Coello Goyes** [682505] (2)

		```
		    `![1.png](https://static.platzi.com/media/user_upload/1-013eb120-a508-4571-9ec1-91a938e7058d.jpg)
		    
		    noce como deberia ir especificado en header...
		```

	* **Diego Alexander Forero Higuera (Platzi)** [682505] (2)

		Prueba esto
		``` 
		    var misCabeceras = new Headers()
		    misCabeceras.append('Access-Control-Allow-Origin': 'http://localhost:4000')
		    misCabeceras.append('Access-Control-Allow-Headers': 'Content-Type')
		    misCabeceras.append('Access-Control-Allow-Methods': 'GET')
		    
		    var miInit = {
		        method: 'GET',
		        headers: misCabeceras,
		        mode: 'no-cors',
		        cache: 'default',
		    }
		    
		    const respuesta = ....
		    
		```

	* **Andres Roberto Coello Goyes** [682505] (2)
![opaque.png](https://static.platzi.com/media/user_upload/opaque-9b4e3c32-44fd-4919-a4eb-405ce680677b.jpg)
		
		Este es el resultado‚Ä¶ me dice type ‚Äúopaco‚Äù

	* **Diego Alexander Forero Higuera (Platzi)** [682505] (2)

		Pero en el body te llegan los datos que necesitas o no esta llegando nada???

	* **Andres Roberto Coello Goyes** [682505] (2)

		No me llegaba nada, pero lo solucione con el cors de heroku‚Ä¶ gracias‚Ä¶

* **isaacarismendi** (2) [589962](https://platzi.com/comentario/589962/) 

	Si un cliente hace un llamada a mi api pero a mitad del camino lo aborta, como puedo hacer en Nodejs/express para que no siga procesando la petici√≥n ?

	* **glrodasz** [589962] (4)

		Tienes que manejar timeouts: <https://expressjs.com/en/resources/middleware/timeout.html>

* **edesalla17** (2) [461676](https://platzi.com/comentario/461676/) 

	buena explicaci√≥n en cada item del curso!

* **isaacarismendi** (2) [59324](https://platzi.com/comentario/589962/) 
Si un cliente hace un llamada a mi api pero a mitad del camino lo aborta, como puedo hacer en Nodejs/express para que no siga procesando ...

	* **glrodasz** [59324] (4)

		Tienes que manejar timeouts: <https://expressjs.com/en/resources/middleware/timeout.html>

* **marymoon** (1) [836319](https://platzi.com/comentario/836319/) 

	en la function get ** / ** est√° mal destructurado revicen eso.
	
	Debe ser
	``` 
	    const { query } = req;
	    
	```

* **onlinejaime** (1) [725901](https://platzi.com/comentario/725901/) 

	Me he vuelto loco dos horas con un error‚Ä¶  
	Al final he detectado un error en el v√≠deo (no entiendo que al profesor le funcione la app con ese error‚Ä¶)
	
	En el minuto 12:04 la const no es productMocks‚Ä¶ No puede serlo porque sin√≥ aparece un error de que no se utiliza y nunca carga los productos‚Ä¶ Deber√≠a seguir siento products, ya que en el render as√≠ est√° inicializada.

	* **Alejandro Gonz√°lez Reyes** [725901] (2)
Si desde mi tel√©fono lo v√≠ de inmediato, pero funciona debido a que jam√°s hace una petici√≥n a esa ruta, de lo contrario se rompe la app

* **Sebastian Cardoso Castillo** (1) [679351](https://platzi.com/comentario/679351/) 

	Yo tengo la API en otro server solito. ¬øEstar√° bien as√≠?

* **Maria Gutierrez** (1) [545547](https://platzi.com/comentario/545547/) 


* **tzalejo** (1) [542325](https://platzi.com/comentario/542325/) 

	Uh que macana que no hay una descripci√≥n de lo que da en esta sesi√≥n.

* **Matias Sebastian Perez** (1) [495008](https://platzi.com/comentario/495008/) 

	Genial explicacion, muy buen profesor!

* **Fredy Ricardo Cort√©s Ram√≠rez** (1) [68003](https://platzi.com/comentario/732721/) 
Me gustar√≠a saber un poco de las API, tengo entendido que √©stas se buscan crear cuando necesitamos comunicar aplicaciones a datos que ten...

	* **Edward Steven Ramos Palacios** [68003] (2)

		Puedes darle seguridad a tu API con tokens. Y en tu backend te aseguras que sea un token v√°lido. Hay muchas formas de implementarlo, pero la mas tradicional, la que encuentras en las APIS de pago, es esa, te dan un token con el que debes realizar tus request para que sean v√°lidos.

* **Byhako** (1) [48217](https://platzi.com/comentario/452342/) 
¬øPorqu√© no podemos usar la sintaxis de ES6 para importar/exportar los m√≥dulos? Osea, usar import en lugar de require<...

	* **camiladi** [48217] (7)

		Por lo que estuve viendo, se debe a que **import** y **require** funcionan internamente de manera diferente, aqu√≠ una explicaci√≥n detallada.
		
		<https://medium.com/the-node-js-collection/an-update-on-es6-modules-in-node-js-42c958b890c>
		
		Ahora el asunto viene que hasta Node.js v11.5.0 (corr√≠janme si me equivoco) esta sintaxis para importar c√≥digo de ES6 no ten√≠a soporte de manera nativa (Si lo pod√≠as usar con Babel). Reci√©n en esta versi√≥n (v11.5.0) se est√° ofreciendo un soporte _experimental_ que puedes ver en el siguiente link: <https://nodejs.org/api/esm.html>

## 0120. Implementando nuestra capa de Servicios [15729](https://platzi.com/clases/1437-express-js/15729-implementando-nuestra-capa-de-servicios/)

### Descripci√≥n:


### Links:

* [Taylor Otwell ?? on Twitter: "I really think the acronym "MVC" has become incredibly unhelpful in development, and instead we should just teach "separation of concerns"."](https://twitter.com/taylorotwell/status/262290285499936768)

* [Por qu√© Laravel NO es un framework MVC y t√∫ deber√≠as olvidarte de MVC ‚Äì Styde.net](https://styde.net/porque-laravel-no-es-mvc-y-tu-deberias-olvidarte-de-mvc/)

* [Ryan Florence - ‚ÄπRethinker stop={false}/‚Ä∫ - YouTube](https://www.youtube.com/watch?v=kp-NOggyz54)

* [
	
    Relative Path - Visual Studio Marketplace

](https://marketplace.visualstudio.com/items?itemName=jakob101.RelativePath)

* [GitHub - glrodasz/platzi-express at implementando-nuestra-capa-de-servicios](https://github.com/glrodasz/platzi-express/tree/implementando-nuestra-capa-de-servicios)

### Comentarios:

* **Antonio Luis Gil Rodr√≠guez** (10) [453426](https://platzi.com/comentario/453426/) 

	Parece que en las √∫ltimas versiones de express viene incorporado el bodyParser y solo har√≠a falta hacer lo siguiente, sin necesidad de instalar otra dependencia:
	
	`app.use(express.json());`

	* **glrodasz** [453426] (6)

		Si, pero revisa que no recibas un mensaje warning por usar la version integrada. En versiones anteriores fue removida y luego la volvieron a incluir en el core de express.

* **Antonio Luis Gil Rodr√≠guez** (10) [453416](https://platzi.com/comentario/453416/) 

	Me gusta mucho esta arquitectura, y es muy dif√≠cil encontrar tutoriales o cursos que la pongan en pr√°ctica. Yo es la que implemento siempre, ser√° por mi pasado en Java, pero creo que es la que tiene m√°s sentido.  
	Lo √∫nico que mejorar√≠a, pero es algo personal, es indicar la responsabilidad del archivo en su nombre, como por ejemplo, `product.routes.js`, `product.service.js` etc‚Ä¶

	* **Freddy C√≥rdova Arana** [453416] (1)

		Estoy de acuerdo contigo, tambi√©n le pongo los nombres de acuerdo a su responsabilidad. Es cuesti√≥n de gustos.

	* **tzalejo** [453416] (1)

		pensaba exactamente lo mismo!

	* **nneiran** [453416] (1)

		muy acertado tu comentario

* **Gerardo Manuel Reyes Fern√°ndez** (6) [474520](https://platzi.com/comentario/474520/) 

	El m√©todo `HTTP PUT` √∫nicamente permite reemplazar completamente un documento.  
	El m√©todo `HTTP PATCH` aplica modificaciones parciales a un recurso.

* **cristianc** (5) [501871](https://platzi.com/comentario/501871/) 

	El paquete que hay que instalar no es body-parser en vez de body-parse ?

	* **Javier Serrano Lule** [501871] (1)

		Yo ten√≠a entendido lo mismo üòï

* **Sneider Sanchez** (3) [665768](https://platzi.com/comentario/665768/) 

	Mi cerebro explot√≥.

* **cesarcubillos** (2) [890155](https://platzi.com/comentario/890155/) 

	Me sirvi√≥ pero con body-parser, no con body-parse

* **Javier Serrano Lule** (2) [583277](https://platzi.com/comentario/583277/) 

	¬øSon lo mismo?
	
	`const {body: product} = request` a `const product = request.body.product`
	
	¬øAlguien que sepa una fuente para comprender un poco mejor los destructuring?

	* **alesanabriav (Platzi)** [583277] (2)

		destructuring te ayuda a llamar las propiedades, sin necesidad de crear una variable como en tu segundo ejemplo y si son lo mismo‚Ä¶al final te ayuda a ahorrar lineas de c√≥digo.

	* **ivanruiz__** [583277] (2)

		Si son lo mismo, y yo recomandar√≠a el destructurar de la siguiente forma para poder crear diferentes variables sin perder la legibilidad:
		``` 
		    const { 
		    	body: product,
		    	x,
		    	y,
		    	z
		    } = request.body;
		    
		```

	* **Javier Serrano Lule** [583277] (1)

		Muchas gracias!!

	* **Carlos Martinez** [583277] (3)

		este post esta muy bueno, explica la destructuracion con muchos ejemplos <https://codeburst.io/es6-destructuring-the-complete-guide-7f842d08b98f>

* **Carlos Azaustre** (2) [452548](https://platzi.com/comentario/452548/) 

	No he visto a√∫n el resto del curso, pero tengo una duda.  
	¬øNo ser√≠a mejor que las vistas utilizaran el API para traer los datos en lugar de los servicios?

	* **glrodasz** [452548] (2)

		¬øPorque seria mejor? La idea de tener estas capas es tener el codigo desacoplado. Si le das esa responsabilidad a la vista, luego no podrias reutilizar tu logica de datos en otros servicios √≥ en el caso que propones en otras vistas, te tocaria duplicar tu codigo o moverlo a utilidades que eventualmente se van a convertir en servicios.

	* **Julio J Y√©pez** [452548] (2)

		‚Ä¶ de hecho, en las vistas no deber√≠a haber ning√∫n tipo de l√≥gica de negocios, s√≥lo lo necesario para el renderizado. Es como lo veo.

	* **Carlos Azaustre** [452548] (4)

		@glrodasz no digo que sea mejor, pero ya que tenemos un API que nos permite comunicarnos con los servicios y estos con la DB, me parec√≠a que estaba a√∫n m√°s desacoplado:
		``` 
		    vista <--> API <--> Servicios <--> DB (lib)
		    
		```
		
		Ahora mismo es:
		``` 
		    Vista <--> Servicios <--> DB (lib)
		    API <--> Servicios <--> DB (lib)
		    
		```
		
		Aunque entiendo que al tener en una misma aplicaci√≥n el renderizado de vistas y el API, puede tener m√°s l√≥gica. Y dejar el API para aplicaciones SPA, M√≥viles e h√≠bridas.

	* **glrodasz** [452548] (1)

		@czaustre ya entiendo lo que quieres decir, el tema es que aqui nuestra vista realmente es manejada por el controlador y como se hace desde el servidor no tiene sentido llamar api pues el puede acceder a los servicios directamente. Seria un poco redundante y m√°s que le agregarias un tiempo de carga extra.
		
		El API siempre se hace para integrar apps externas, en este caso una SPA podria considerarse una app externa en si.

* **Santiago Soto Montenegro** (2) [448821](https://platzi.com/comentario/448821/) 

	 **PATCH** : Actualizar un recurso completamente, por ejemplo actualizar todo el producto con ID espec√≠fico.
	
	**PUT** : Para actualizar ciertos atributos del recurso, por ejemplo s√≥lo actualizar el precio de un producto.

	* **David Vargas Dom√≠nguez** [448821] (8)

		Creo que es al rev√©s
		
		lo que hace PATCH es aplicar modificaciones parciales al producto en este caso
		
		<https://developer.mozilla.org/es/docs/Web/HTTP/Methods/PATCH>

* **Javier Serrano Lule** (2) [58880](https://platzi.com/comentario/583277/) 
¬øSon lo mismo? const {body: product} = request a const product = request.body.product ¬øAlguien que sepa una fu...

	* **alesanabriav (Platzi)** [58880] (2)

		destructuring te ayuda a llamar las propiedades, sin necesidad de crear una variable como en tu segundo ejemplo y si son lo mismo‚Ä¶al final te ayuda a ahorrar lineas de c√≥digo.

* **Vissstors** (1) [1036448](https://platzi.com/comentario/1036448/) 

	Dejo mi soluci√≥n al desafio de crear un endpoint con la acci√≥n HTTP PATCH:
	``` 
	    router.patch('/:productId', asyncfunction (req, res, next) {
	      const { productId } = req.params
	      const { body: changedAttributes } = req
	    
	      try {
	        const patchedProduct = await productService.patchProduct({ productId, changedAttributes })
	    
	        res.status(200).json({
	          data: patchedProduct,
	          message: 'product patched'
	        })
	      } catch (err) {
	        next(err)
	      }
	    })
	    
	```
	
	Recordar que la acci√≥n PATCH se diferencia de la acci√≥n PUT en que este √∫ltimo sirve para modificar por completo un recurso especifico, mientras que PATCH servir√° para modificar parte de un recurso especifico.

* **Andres Roberto Coello Goyes** (1) [944667](https://platzi.com/comentario/944667/) 

	 **npm install body-parse --save**
	``` 
	    const bodyParse = require('body-parse');
	    app.use(body-parse.json());
	    
	```

* **Wilson Marino Pablo Mendez** (1) [842688](https://platzi.com/comentario/842688/) 

	Que bonito es trabajar con **OOP**

* **Alejandro Gonz√°lez Reyes** (1) [768541](https://platzi.com/comentario/768541/) 

	@glrodasz
	
	express.json()  
	Si, pero revisa que no recibas un mensaje warning por usar la version integrada. En versiones anteriores fue removida y luego la volvieron a incluir en el core de express.
	
	A que warning te refieres, le√≠ la documentaci√≥n y no menciona nada al respecto.

* **Sebastian Cardoso Castillo** (1) [679399](https://platzi.com/comentario/679399/) 

	Estoy algo confundido porque yo tengo una API donde solo intercambio json. En otro server tengo la vista donde llamo al servicio de la API.

* **Brian Bentancourt** (1) [521784](https://platzi.com/comentario/521784/) 

	```
	    npm i -S body-parse
	    
	```

* **Edwin Valencia** (1) [515265](https://platzi.com/comentario/515265/) 
Desde qu√© version Express soporta async/await ? No encuentro esa informaci√≥n

	* **diego.corbinaud** [515265] (2)

		es node el que los soporta

* **ivan_acg** (1) [507487](https://platzi.com/comentario/507487/) 

	Esta clase es demaciado genial , todo en este curso es genial . Enserio , este profesor la rompe.

* **doblesesays** (1) [487370](https://platzi.com/comentario/487370/) 

	Esperaba que en alg√∫n punto se explicara como funciona lo de req, res y sobre todo next. Se va a hacer m√°s adelante o es en otro curso?

	* **Mitchell Contreras** [487370] (1)

		en este video hablan sobre eso  
		<https://platzi.com/clases/1437-express-js/15735-que-es-un-middleware-y-que-tipos-existen/>.  
		La explicaci√≥n completa sobre esto se puede encontrar en la documentaci√≥n oficial:  
		<https://expressjs.com/es/guide/writing-middleware.html>  
		dentro de el esta los link donde explican **req, res**

	* **glrodasz** [487370] (2)

		Tambien en esa lectura hablamos solo del **req object** : <https://platzi.com/clases/1437-express-js/16085-request-object/>

* **muxproo** (1) [477941](https://platzi.com/comentario/477941/) 

	Como se le llama a este tipo de arquitectura

	* **Eduardo Hidalgo D√≠az Rugama** [477941] (1)

		MVC. La que usa el profesor durante el curso de Express es ‚ÄúMVC‚Äù

	* **glrodasz** [477941] (1)

		Realmente no conozco un nombre propio, pero se podria decir que es una extension de MVC.

	* **juand_silva** [477941] (1)

		No he encontrado informaci√≥n muy clara al respecto de esta aquitectura, pero yo la llamar√≠a MVCE Modelo Vista Controlador Extendido

	* **Federico Gonzalez** [477941] (1)

		Se llama Service Layer. El creador es Martin Fowler

* **Antonio Luis Gil Rodr√≠guez** (1) [454479](https://platzi.com/comentario/454479/) 

	¬øEs recomendable crear los m√©todos de ProductService est√°ticos para no tener que instanciarlo?

	* **glrodasz** [454479] (2)

		Depende el uso que les vayas a dar. Yo los no los pongo estaticos porque en un futuro quizas pueda recibir opciones de configuraci√≥n en el contructor, y esto es muy problable que suceda a medida que sube la complejidad y tama√±o de la app.

* **doblesesays** (1) [51088](https://platzi.com/comentario/487370/) 
Esperaba que en alg√∫n punto se explicara como funciona lo de req, res y sobre todo next. Se va a hacer m√°s adelante o es en otro curso?

	* **Mitchell Contreras** [51088] (1)

		en este video hablan sobre eso  
		<https://platzi.com/clases/1437-express-js/15735-que-es-un-middleware-y-que-tipos-existen/>.  
		La explicaci√≥n completa sobre esto se puede encontrar en la documentaci√≥n oficial:  
		<https://expressjs.com/es/guide/writing-middleware.html>  
		dentro de el esta los link donde explican **req, res**

* **muxproo** (1) [50288](https://platzi.com/comentario/477941/) 
Como se le llama a este tipo de arquitectura

	* **Eduardo Hidalgo D√≠az Rugama** [50288] (1)

		MVC. La que usa el profesor durante el curso de Express es ‚ÄúMVC‚Äù

* **Antonio Luis Gil Rodr√≠guez** (1) [48435](https://platzi.com/comentario/454479/) 
¬øEs recomendable crear los m√©todos de ProductService est√°ticos para no tener que instanciarlo?

	* **glrodasz** [48435] (2)

		Depende el uso que les vayas a dar. Yo los no los pongo estaticos porque en un futuro quizas pueda recibir opciones de configuraci√≥n en el contructor, y esto es muy problable que suceda a medida que sube la complejidad y tama√±o de la app.

## 0130. Recapitulando el proyecto [15730](https://platzi.com/clases/1437-express-js/15730-recapitulando-el-proyecto/)

### Descripci√≥n:


### Comentarios:

* **Antonio Luis Gil Rodr√≠guez** (4) [454720](https://platzi.com/comentario/454720/) 

	¬øPara qu√© sirve exactamente el archivo `package-lock.json`? ¬øC√∫al es su utilidad?  
	¬øPodr√≠as dar una explicaci√≥n m√°s extensa?  
	Gracias!!

	* **glrodasz** [454720] (5)

		Hola Antonio, **package-lock.json** es muy similar a lo que hace el archivo **yarn.lock**. (Cuando usamos yarn) Se crear para que la instalaci√≥n de paquetes sea la misma independientemente de la maquina donde se instalen. Sin este archivo lo que podia pasar es que en tu maquina local se instalara una version diferente a la de tu maquina de producci√≥n, ocasionando inconsistencias y muchas veces problemas.

	* **Daniel .** [454720] (3)

		El package.json contiene las dependencias principales del proyecto, el package-lock.json contiene el arbol de dependencias de las dependencias del package.json.

	* **juand_silva** [454720] (1)

		No sab√≠a eso, yo lo que hac√≠a era que lo ignoraba y mis despendencias las instalaba con el flag `-E` para que me instale una versi√≥n exacta y no tener problemas con las diferentes versiones.  
		**Entonces lo mejor es no ignorar este archivo?**

* **camiladi** (3) [452744](https://platzi.com/comentario/452744/) 

	Otra cosa que me gustar√≠a aportar, es que a partir de la v4.16 de Express.js podemos usar
	``` 
	    app.use(express.json())
	    
	    
	```
	
	para parsear el request del body sin tener que descargar body-parser otra vez, ya que express.json() lo utiliza internamente
	
	<https://stackoverflow.com/questions/47232187/express-json-vs-bodyparser-json>

	* **glrodasz** [452744] (3)

		Si, pero verifica que posiblemente vas a tener un warning en la consola al usarlo de esta manera. Aun se recomienda usar bodyParser por separado.

* **David Vargas Dom√≠nguez** (3) [450101](https://platzi.com/comentario/450101/) 

	<https://www.md5hashgenerator.com/>
	
	Por si quieren crear uno para el product_id

* **gosunkugi** (2) [629438](https://platzi.com/comentario/629438/) 

	DIOOOOOS esto va a mil >___<

* **camiladi** (2) [452739](https://platzi.com/comentario/452739/) 

	aun no me queda muy claro por qu√© pasamos en **productServices.getProducto({ productoId})**
	
	¬øpor que pasan un objeto? creo que es lo mismo pasar una simple variable. ¬øo no?

	* **camiladi** [452739] (3)

		auto respuesta. Encontr√© la l√≥gica al ver que uno de las variables eran Arrays, entiendo que es m√°s f√°cil manejar as√≠ los datos
		``` 
		    const tags = [1, 2, 3, 4]
		    
		    constobject = { tags }
		    
		    // es lo mismo que hacer
		    
		    const object2 = {
		    	tags : [1, 2, 3, 4]
		    }
		    
		    
		```

	* **glrodasz** [452739] (5)

		Es porque estamos haciendo destructuring en los parametros de la funcion: <https://davidwalsh.name/destructuring-function-arguments>
		
		La diferencia es que pasando argumentos tienes que respestar el orden, mientras que con un objeto no seria necesario. Si el dia de ma√±ana tienes que agregar mas, el orden no importa.

	* **Freddy C√≥rdova Arana** [452739] (3)

		wow, que √∫til es leer los comentarios üòÑ

* **Pacool84** (1) [1057930](https://platzi.com/comentario/1057930/) 

	Nunca hab√≠a visto que pusieran musica en un curso de PLATZI, Esta genial!!!

* **Andres Roberto Coello Goyes** (1) [944775](https://platzi.com/comentario/944775/) 

	 **<https://www.getpostman.com/downloads/>**  
	para que pruebes tu api rest

* **DavidArmandoVelazquez** (1) [895360](https://platzi.com/comentario/895360/) 

	Alguien sabe donde puedo encontrar buena info sobre como usar postman?  
	Saludos!

	* **Cesar Galindo** [895360] (2)

		mira lanzaron un nuevo curso
		
		<https://platzi.com/clases/postman/>

* **Adrian Martin** (1) [885196](https://platzi.com/comentario/885196/) 

	Buenas chicos me da este error y no consigo solucionarlo, ¬øalguien sabe como  
	?
	``` 
	    internal/modules/cjs/loader.js:628
	        throw err;
	        ^
	    
	    Error: Cannot find module '../../services/products'
	    Require stack:
	    - C:\Users\PC-CINO\Desktop\ecommercee\routes\products.js
	    - C:\Users\PC-CINO\Desktop\ecommercee\index.js
	        at Function.Module._resolveFilename (internal/modules/cjs/loader.js:625:15)
	        at Function.Module._load (internal/modules/cjs/loader.js:527:27)
	        at Module.require (internal/modules/cjs/loader.js:683:19)
	        at require (internal/modules/cjs/helpers.js:16:16)
	        at Object.<anonymous> (C:\Users\PC-CINO\Desktop\ecommercee\routes\products.js:4:25)
	        at Module._compile (internal/modules/cjs/loader.js:776:30)
	        at Object.Module._extensions..js (internal/modules/cjs/loader.js:787:10)
	        at Module.load (internal/modules/cjs/loader.js:643:32)
	        at Function.Module._load (internal/modules/cjs/loader.js:556:12)
	        at Module.require (internal/modules/cjs/loader.js:683:19) {
	      code:'MODULE_NOT_FOUND',
	      requireStack: [
	        'C:\\Users\\PC-CINO\\Desktop\\ecommercee\\routes\\products.js',
	        'C:\\Users\\PC-CINO\\Desktop\\ecommercee\\index.js'
	      ]
	    }
	    [nodemon] app crashed - waiting for file changes before starting...
	    
	```

	* **DavidArmandoVelazquez** [885196] (1)

		Parece ser que es un error en la ruta, revisa que las rutas de los modulos que importas sean correctas.

	* **FabianIgnacio** [885196] (1)

		Como dice el compa√±ero, quita un nivel‚Ä¶ deber√≠a funcionar c:

* **Alejandro Gonz√°lez Reyes** (1) [768743](https://platzi.com/comentario/768743/) 

	Mi aportaci√≥n a la clase con explicaciones puntuales
	``` 
	    const express = require('express')
	    const path = require('path')
	    
	    // Requerir mis m√≥dulos de ruta
	    const productsRouter = require('./routes/site/products')
	    const productsApiRouter = require('./routes/api/products')
	    
	    // instanciar mi app
	    const app = express()
	    
	    
	    //Registrar middlewares globales
	    
	    // Analizar solicitudes entrantes en formato json
	    app.use(express.json())
	    // Analizar solicitudes entrantes enctype="application/x-www-form-urlencoded" 
	    app.use(express.urlencoded())
	    
	    
	    // Configurar motor de plantillas
	    app.set('views', path.join(__dirname, 'views'))
	    app.set('view engine', 'pug')
	    
	    // Registrar las rutas de mi aplicaci√≥n
	    app.use('/products', productsRouter)
	    app.use('/api/products', productsApiRouter)
	    
	    // Redireccionar al Home del sitio
	    app.get('/', function(req, res){
	      res.redirect('/products')
	    })
	    
	    // Registrar middleware de archivos estaticos
	    app.use('/static', express.static(path.join(__dirname, 'public')))
	    
	    // Inicializar el servidor de mi aplicaci√≥n
	    const server = app.listen(3000, function(){
	      console.log(`Server Listening in http://localhost:${server.address().port}`)
	    })
	    
	    // Exportar mi la instancia de mi aplicaci√≥n.
	    module.exports = app
	    
	    
	```

* **Alejandro Gonz√°lez Reyes** (1) [768588](https://platzi.com/comentario/768588/) 

	Soluci√≥n al reto.
	``` 
	    router.patch('/:productId', asyncfunction (req, res, next) {
	      // Esta ruta se le ha declarado como PATCH, la intensi√≥n es que modifique parte del contenirdo del recurso, y si no lo encuentra mande un error 404. Es decir, no es la intensi√≥n mandar toda la data para crearlo si no existe (PUT)
	      const { productId } = req.params
	      // Saco la informaci√≥n que se encuentra en el cuerpo de la petici√≥n y la nombre como product.
	      const { body: product } = req
	    
	      try {
	        // Solicito a mi product service la actualizaci√≥n del producto que coincide con el id especificado
	        const updatedProduct = await productService.updateProduct({ productId, product })
	    
	        res.status(200).json({
	          data: updatedProduct,
	          message: 'product updated'
	        })
	      } catch (error) {
	        next(error)
	      }
	    })
	    
	```
	
	Sin embargo, me gustar√≠a ver un ejemplo de ambos verbos implementados. ya que por lo general cuando se actualiza un recurso se hace en algunos de sus paths no en todos.

* **diego.corbinaud** (1) [607909](https://platzi.com/comentario/607909/) 

	Tengo un problema con con respecto al async y me dice lo siguiente:
	``` 
	    Downloads/platzi-express-recapitulando-el-proyecto/ecommerce/routes/views/products.js:7
	    router.get("/", async function(req, res, next) {
	                    ^^^^^
	    SyntaxError: missing ) after argument list
	        at Object.exports.runInThisContext (vm.js:78:16)
	        at Module._compile (module.js:543:28)
	        at Object.Module._extensions..js (module.js:580:10)
	        at Module.load (module.js:488:32)
	        at tryModuleLoad (module.js:447:12)
	        at Function.Module._load (module.js:439:3)
	        at Module.require (module.js:498:17)
	        at require (internal/module.js:20:19)
	        at Object.<anonymous> (/Users/diegocorbinaud/Downloads/platzi-express-recapitulando-el-proyecto/ecommerce/index.js:4:24)
	        at Module._compile (module.js:571:32)```
	    
	    descargue la clase de los recursos pensando que era yo el problema pero me pasa lo mismo :c 
	    
	    Aiuda!
	    
	```

	* **Danniel Sequera** [607909] (1)

		Puedes compartir el c√≥digo del archivo que te est√° dando ese error(routes/views/products.js) para ver mejor que puede estar pasando.

	* **marygaby1308** [607909] (1)

		Revisa antes tu version de node.

* **doblesesays** (1) [488490](https://platzi.com/comentario/488490/) 

	No veo en archivos los json para la colecci√≥n y el entorno de postman‚Ä¶?

	* **glrodasz** [488490] (3)

		Hola, aqui te comparto una copia: <https://drive.google.com/file/d/1k0MlLB9Ehcvy7u6Dsamzp3AtpzjZCOjq/view?usp=sharing>

* **doblesesays** (1) [51199](https://platzi.com/comentario/488490/) 
No veo en archivos los json para la colecci√≥n y el entorno de postman‚Ä¶?

	* **glrodasz** [51199] (3)

		Hola, aqui te comparto una copia: <https://drive.google.com/file/d/1k0MlLB9Ehcvy7u6Dsamzp3AtpzjZCOjq/view?usp=sharing>

* **Antonio Luis Gil Rodr√≠guez** (1) [48458](https://platzi.com/comentario/454720/) 
¬øPara qu√© sirve exactamente el archivo package-lock.json? ¬øC√∫al es su utilidad? ¬øPodr√≠as dar una explicaci√≥n m√°s extensa? Gr...

	* **glrodasz** [48458] (5)

		Hola Antonio, **package-lock.json** es muy similar a lo que hace el archivo **yarn.lock**. (Cuando usamos yarn) Se crear para que la instalaci√≥n de paquetes sea la misma independientemente de la maquina donde se instalen. Sin este archivo lo que podia pasar es que en tu maquina local se instalara una version diferente a la de tu maquina de producci√≥n, ocasionando inconsistencias y muchas veces problemas.

* **camiladi** (1) [48265](https://platzi.com/comentario/452739/) 
aun no me queda muy claro por qu√© pasamos en productServices.getProducto({ productoId}) ¬øpor que pasan un objeto? creo q...

	* **camiladi** [48265] (3)

		auto respuesta. Encontr√© la l√≥gica al ver que uno de las variables eran Arrays, entiendo que es m√°s f√°cil manejar as√≠ los datos
		``` 
		    const tags = [1, 2, 3, 4]
		    
		    constobject = { tags }
		    
		    // es lo mismo que hacer
		    
		    const object2 = {
		    	tags : [1, 2, 3, 4]
		    }
		    
		    
		```

## 0140. Request object [16085](https://platzi.com/clases/1437-express-js/16085-request-object/)

### Descripci√≥n:


# Request Object

El objeto `req` (Request) en Express representa el llamado HTTP y tiene diferentes propiedades del llamado, como la cadena de texto query (Query params), los par√°metros de la URL (URL params), el cuerpo (Body), los encabezados (HTTP headers), etc.

Para acceder al `req` basta con acceder al primer par√°metro de nuestros router handlers (router middleware) √≥ middlewares.

Como por ejemplo as√≠ lo hemos visto siempre:
``` 
    app.get('/user/:id', function(req, res) {
      res.send('user ' + req.params.id);
    });
    
```

Pero tambi√©n funcionar√≠a sin problemas:
``` 
    app.get('/user/:id', function(request, response) {
      response.send('user ' + request.params.id);
    });
    
    
```

## Exploremos las propiedades m√°s importantes

### req.body

Contiene los pares de llave-valor de los datos enviados el cuerpo (body) del llamado (request). Por defecto es `undefined` pero es establecido cuando se usa alg√∫n ‚Äúbody-parser‚Äù middleware como `body-parser` y `multer`.

En **Postman** cuando hacemos un request y enviamos datos en la pesta√±a **Body** , estos middlewares son los que nos ayudan a entender el tipo de datos que vamos a recibir en el `req.body`.

Aqu√≠ podemos ver como se pueden usar estos middlwares para establecer el valor del `req.body`:
``` 
    const app = require('express')();
    const bodyParser = require('body-parser');
    const multer = require('multer');
    const upload = multer(); // Para datos tipo multipart/form-data
    
    app.use(bodyParser.json()); // Para datos tipo application/json
    app.use(bodyParser.urlencoded({ extended: true })); // Para datos tipo application/x-www-form-urlencoded
    
    app.post('/profile', upload.array(), function (req, res, next) {
      console.log(req.body);
      res.json(req.body);
    });
    
```

> M√°s informaci√≥n sobre los diferentes formatos que puede tener el body: <https://developer.mozilla.org/es/docs/Web/HTTP/Methods/POST>

### req.params

Esta propiedad contiene un objeto con las propiedades equivalentes los par√°metros nombrados en la ruta. Por ejemplo si tenemos una ruta de la forma `/user/:name` entonces la propiedad `name` esta disponible como `req.params.name` y alli podremos ver su valor, supongamos que llam√°ramos la ruta con `/user/glrodasz`, entonces el valor de `req.params.name` seria `glrodasz`. Este objeto por defecto tiene el valor de un objeto vac√≠o `{}`.
``` 
    // GET /user/glrodasz
    req.params.name
    // => "glrodasz"
    
```

### req.query

Esta propiedad contiene un objeto con las propiedades equivalentes a las cadenas de texto query de la ruta. Si no hay ninguna cadena de texto query tendr√° como valor por defecto un objeto vac√≠o `{}`.
``` 
    req.query.q
    // => "tobi ferret"
    
    // GET /shoes?order=desc&shoe[color]=blue&shoe[type]=converse
    req.query.order
    // => "desc"
    
    req.query.shoe.color
    // => "blue"
    
    req.query.shoe.type
    // => "converse"
    
```

> M√°s informaci√≥n sobre los query strings en: <https://es.wikipedia.org/wiki/Query_string> y <https://tools.ietf.org/html/rfc3986#section-3.4>

### Comentarios:

* **Navarrock33** (1) [617417](https://platzi.com/comentario/617417/) 

	Tengo un error, en req. query, lo toma con undefine, hago console log, y efectivamente me arroja undefine, pero si hago console log de req solamente, me imprime todo el req, con los valores de query, esto es para el API, para el router en views, si funciona, aunguna idea de a que se deba?

	* **Felipe Concha Almeida** [617417] (1)

		Yo tengo la misma duda

	* **SaFeRamirez** [617417] (1)

		Pon el c√≥digo para ver cual puede ser el error

	* **Alejandro Gonz√°lez Reyes** [617417] (1)

		en este ejemplo como hago destructuring solo filtrar√≠a los productos con la variable tags.  
		si quieres ver todas las variables que pasas en la URL puedes usar console.log(req.query). tal como lo tengo en el ejemplo
		``` 
		    router.get('/', asyncfunction (req, res, next) {
		      // Esta ruta podr√≠a recibir queryString, quiz√° para filtrar o paginar productos
		      const { tags } = req.query
		    
		      console.log('req.query', req.query)
		    
		      // Siempre es importante controlar el error en nuestras promesas
		      try {
		        // Invocar mi product service para obtener todos los productos filtrados por los tags se√±alados.
		        const products = await productService.getProducts({ tags })
		    
		        res.status(200).json({
		          data: products,
		          message: 'products listed'
		        })
		      } catch (error) {
		        next(error)
		      }
		    })
		    
		```

	* **nikosantis** [617417] (1)

		Para imprimir el console tuve que usar:  
		`console.log('req:' + JSON.stringify(req.query))`

	* **FabianIgnacio** [617417] (1)

		const { query: tags } = req;

# Conectando Express.js con servicios externos [3086]

## 0150. Conexi√≥n a Mongodb en Express.js [16111](https://platzi.com/clases/1437-express-js/16111-conexion-a-mongodb-en-expressjs/)

### Descripci√≥n:


# C√≥mo Crear y Configurar tu Base de Datos con MongoDB

**MongoDB compr√≥ mLab.**

**MongoDB Atlas** es un servicio de bases de datos como servicio que nos permite configurar nuestras bases de datos para entornos de pruebas o producci√≥n con diferentes proveedores de nube. Adem√°s de todas sus caracter√≠sticas, Atlas se destaca por ser un servicio mantenido oficialmente por el equipo que desarrolla MongoDB.

**mLab** tambi√©n era un servicio de bases de datos con Mongo. Pero fue adquirido por MongoDB a inicios del 2019 para darle m√°s fuerza a MongoDB Atlas y unir fuerzas con el anterior equipo de mLab.

* [MongoDB comprar√° mLab y su servicio de base de datos en la nube](https://www.silicon.es/mongodb-comprara-mlab-y-su-servicio-de-base-de-datos-en-la-nube-2383965)



## Usa MongoDB Atlas en lugar de mLab

Para crear tu cuenta y base de datos con MongoDB Atlas solo debes seguir esta clase:

* [Creaci√≥n de una BD en MongoAtlas](https://platzi.com/clases/1646-backend-nodejs/22033-creacion-de-una-bd-en-mongoatlas/)



Recuerda que los nombres de tus bases de datos y clusters deben ser los mismos en el servicio de Atlas y en tu c√≥digo.

### Comentarios:

* **rs-mario** (7) [518423](https://platzi.com/comentario/518423/) 

	Mongodb compro a mlab, ya no es de la misma forma üò¶

* **faridmurzone** (7) [456306](https://platzi.com/comentario/456306/) 

	* [https://chrome.google.com/webstore/detail/lastpass-free-password-ma/hdokiejnpimakedhajhdlcegeplioahd?hl=es-419](url)
	* [https://mlab.com/](url)
	* [https://robomongo.org/](url)
	
	
	``` 
	    mongodb://<dbuser>:<dbpassword>@<host>:<port>/<dbname>```
	    
	```

	* **silvermiguel96** [456306] (1)

		Gracias ! por los links.

* **silvermiguel96** (6) [470747](https://platzi.com/comentario/470747/) 

	Les comparto este v√≠deo donde pueden instalar de una forma mas simple el robomongo.
	
	Recuerden que es solo para usuarios linux.
	
	<https://vimeo.com/234457798>
	
	Si tiene dudas me pueden copiar !

	* **glrodasz** [470747] (1)

		Gracias por el aporte!

* **David Ruiz** (5) [521215](https://platzi.com/comentario/521215/) 

	En este [video](https://www.youtube.com/watch?v=KKyag6t98g8) explican como crear la base de datos desde MongoDB Atlas, ya que mlab fue adquirido por MongoDB.

	* **David Ruiz** [521215] (5)

		En vez de usar Robo3t, MongoDB Atlas ofrece otra alternativa llamada Compass.

* **zefe** (2) [531517](https://platzi.com/comentario/531517/) 

	Alternativa a Robo 3T(antes robomongo) [MongoDB Compass](https://www.mongodb.com/products/compass)

* **Zacar√≠as Samaniego** (2) [499790](https://platzi.com/comentario/499790/) 

	Me parece que est√° mal el t√≠tulo del video, porque ac√° lo que hacen es conectarse a una DB con un administrador de bases de datos, no veo la relaci√≥n con Express.js

* **doblesesays** (2) [488996](https://platzi.com/comentario/488996/) 

	Para los que como yo tienen problemas ejecutando Robomongo (por cuestiones de la versi√≥n de W, la de 32bits). Use sin problemas: <https://nosqlbooster.com/downloads>
	
	Incluso configuro la conexi√≥n autom√°ticamente, porque ten√≠a la Mongo URI en mi cilpboard cuando abr√≠ el programa y la detecto solito.

* **tzalejo** (1) [545932](https://platzi.com/comentario/545932/) 

	Buenas, no puedo conectarme mongoAtlas con robo3T, alguien pudo hacerlo??  
	Yo hice la configuraci√≥n, viendo otros videos, pero a la hora de conectarme con robo3T me tira "Failed to connect to ‚Ä¶"  
	Saludos

	* **glrodasz** [545932] (1)

		Hola @tzalejo, podrias darme un poco m√°s de informaci√≥n, como cual es el error completo, que versiones estas usando de mongo y del driver, y un link al repo, para revisar que el codigo este ok.

	* **tzalejo** [545932] (1)

		Gracias por Guillermo por contestar, el tema como conteste en otro foro, puedo conectarme con la aplicaci√≥n a mongoDb-Atlas pero con robo3t no lo pude hacer‚Ä¶es algo que estoy haciendo mal en la conexion de robo3T
		
		[conexion a la aplicacion url](https://drive.google.com/open?id=1985awBOEeGrbHGfnq64M7RL4zzIzJcR9)  
		[error con la configuracion](https://drive.google.com/open?id=1yEw-kVtKOuqwpy0F05uJ2IurdZUu2BdG)  
		[mi autenticacion](https://drive.google.com/open?id=1jDIv0-2JD6P-PPcf0j_1yG8Gi8pO3qXf)
		
		Saludos  
		pd:  
		S.O: MacOS Mojave v 10.14.3  
		Robo 3T 1.2.1

	* **AlexGarrixen** [545932] (3)

		Hola tzalejo,lo he conectado de la suguiente forma :
		
		**Conexion**
		
		![config1.png](https://static.platzi.com/media/user_upload/config1-8a33ea6c-4c54-4506-b18c-8e7c48b6887a.jpg)
		
		NAME -> Tu base de datos  
		ADDRESS -> Direccion de grupo primario que lo encuentras al entrar a tu cluster y veras esto.
		
		![atlas1.png](https://static.platzi.com/media/user_upload/atlas1-7712d45a-c413-4d27-ba4f-df597d4d3579.jpg)
		
		Selecciona el que tiene la etiqueta **PRIMARY** y veras algo como esto.
		
		![atlas2.png](https://static.platzi.com/media/user_upload/atlas2-5437c921-ec2c-42d1-86fc-42a3930d5ec3.jpg)
		
		Tomas esa direccion y la pones en el campo ADDRESS
		
		**Autentication**
		
		![config2.png](https://static.platzi.com/media/user_upload/config2-85181b6b-f4a8-4f3c-8628-6d0b72065b45.jpg)
		
		DATABASE -> Tu bd  
		USERNAME -> Usuario de la bd que creaste  
		PASSWORD -> Contrase√±a del usuario que creaste
		
		**SSL**  
		Seleciona el certificado autoconfirmado como metodo de autenticacion
		
		![config 3.png](https://static.platzi.com/media/user_upload/config%203-8af640d0-998c-4bad-90d2-c4fef9536ab2.jpg)
		
		**Configurar IPS**  
		Deberas permitir(agreagar) acceso desde cualquier lugar,esto lo puedes hacer en la seccion de SEGURIDAD de tu cluster en las ips blancas
		
		![ipblancas.png](https://static.platzi.com/media/user_upload/ipblancas-5b913c84-696d-45d0-9e13-23dbc51aa716.jpg) ![config 4.png](https://static.platzi.com/media/user_upload/config%204-4864c46a-01c9-4942-a427-5e991bfb218d.jpg)

	* **Alejandro Gonz√°lez Reyes** [545932] (1)

		En robomongo desactiva la opci√≥n de SSL. y listo

* **Jos√© Edmundo Prado Astucuri** (1) [63455](https://platzi.com/comentario/658886/) 
Y en caso quisiera usar Sql server o Mysql? que deber√≠a de hacer, alg√∫n ejemplo?

	* **Diego Alexander Forero Higuera (Platzi)** [63455] (2)

		Hola. Debes cambiar el driver de conexi√≥n aqu√≠ encuentras los ejemplos para usar varias bases de datos con express.js <https://expressjs.com/en/guide/database-integration.html>

* **Guillermo Cevallos** (1) [61381](https://platzi.com/comentario/620914/) 
Hola!, Tengo este error ah alguien le salio y pudo solucionar? { Error: querySrv EREFUSED _mongodb._tcp.redsocialdev-v43ei.mongodb.net at...

	* **glrodasz** [61381] (1)

		Podrias darme m√°s informaci√≥n sobre que servidio de mongo estas usando? o como estas configurando tus parametros de conexi√≥n?

* **tzalejo** (1) [55858](https://platzi.com/comentario/545932/) 
Buenas, no puedo conectarme mongoAtlas con robo3T, alguien pudo hacerlo?? Yo hice la configuraci√≥n, viendo otros videos, pero a la hora d...

	* **glrodasz** [55858] (1)

		Hola @tzalejo, podrias darme un poco m√°s de informaci√≥n, como cual es el error completo, que versiones estas usando de mongo y del driver, y un link al repo, para revisar que el codigo este ok.

## 0160. Conectando nuestros servicios con mongo DB [16112](https://platzi.com/clases/1437-express-js/16112-conectando-nuestros-servicios-con-mongo-db/)

### Descripci√≥n:


### Comentarios:

* **FerJPi** (7) [483952](https://platzi.com/comentario/483952/) 

	Si alguien mas tiene problemas para conectarse a MongoDB. Tiene que cambiar la URI como sigue:
	``` 
	    const MONGO_URI = `mongodb://${USER}:${PASSWORD}@${config.dbHost}:${config.dbPort}/${DB_NAME}?ssl=true&authSource=admin&retryWrites=true`
	    
	```
	
	La base de datos va despues del puerto y en el authSource es admin.  
	Espero esto le sea de ayuda a alguien

	* **kmarquez** [483952] (1)

		Gracias, me salvaste el dia, ya da por muerto este curso jajajajaja.

	* **Fernando Azuaje** [483952] (1)

		un abrazo hermano me salvaste

* **sock_osg** (5) [482398](https://platzi.com/comentario/482398/) 

	Para los que no quieran crear una cuenta en mLab y si lo hacen solo para pruebas en local pueden usar docker, con esto crean una imagen del contenedor de mongoDb
	``` 
	    docker run--name mongoDb -p 27017:27017 -d mongo
	    
	```
	
	Despues toca crear el usuario, sus credenciales y los grant a mano pero sirve que aprender la consola de mongo.

* **marygaby1308** (4) [698858](https://platzi.com/comentario/698858/) 

	Cuando tapas el password arriba pero igual se ve en la linea de abajo
	
	> *)

* **Gerardo Manuel Reyes Fern√°ndez** (4) [474671](https://platzi.com/comentario/474671/) 

	[3:26 otra vez el ultra instinto](https://platzi.com/clases/1437-express-js/16112-conectando-nuestros-servicios-con-mongo-db/?time=205)

	* **Gerardo Manuel Reyes Fern√°ndez** [474671] (2)

		hay que ver el video en 2X

	* **glrodasz** [474671] (3)

		En teoria iba a durar solo 5 minutos. üôà

* **Jos√© Miguel Paredes Chanquin** (4) [449066](https://platzi.com/comentario/449066/) 

	Para poder seguir esta clase:
	
	Llink de mLab
	
	<https://mlab.com>
	
	  1. Registrarse.
	  2. Crear una base de datos Gratuita.
	  3. Crear usuario y contrase√±a para esa base de datos.
	
	

	* **onlinejaime** [449066] (1)

		Esto no funciona ya‚Ä¶ mLab es parte de MongoDB Atlas

* **juanortiz** (3) [565849](https://platzi.com/comentario/565849/) 

	esto me ayudo a mi
	``` 
	    const MONGO_URI = `mongodb+srv://${USER}:${PASSWORD}@${
	      config.dbHost
	    }/${DB_NAME}?retryWrites=true`;
	    
	```
	
	con mongodb+srv ya no es necesario el puerto

* **Jos√© Ricardo Romo Guti√©rrez** (3) [471852](https://platzi.com/comentario/471852/) 

	me sorprende lo que va del curso hasta ahora, ya se ve la complejidad, me recuerda al curso avanzado de nodeJS. Pero Seguimos adelante, muy buen profesor.

	* **glrodasz** [471852] (1)

		Gracias, cualquier duda que tengas es bienvenida!

* **Alejandro Gonz√°lez Reyes** (2) [769253](https://platzi.com/comentario/769253/) 

	Si tienen problemas de al realizar la conexi√≥n
	``` 
	    const MONGO_URI = `mongodb+srv://${USER}:${PASS}@${config.dbHost}/${DB_NAME}?retryWrites=true&w=majority`;
	    
	```

* **cesarUmeres** (2) [612435](https://platzi.com/comentario/612435/) 

	habra algun ejemplo para saber como conectarlo a mysql please

	* **oobie92** [612435] (1)

		Que tal, puedes ver mi repositorio para que te des una idea de como puedes conectarlo con Sequilize:
		
		[Index](https://github.com/oobie92/shopmate/blob/master/api/index.js)  
		[Setup para configurar relaciones, etc](https://github.com/oobie92/shopmate/blob/master/api/db/setup.js)  
		[Inicializacion con Sequelize](https://github.com/oobie92/shopmate/blob/master/api/db/db.js)  
		[Setup](https://github.com/oobie92/shopmate/blob/master/api/db/config.js)
		
		La estructura depende mucho de tu organizacion.
		
		Espero te sirva! :{)
		
		Saludos!

* **Diego Osorio** (2) [536498](https://platzi.com/comentario/536498/) 
como debo escribir el MONGO_URI para que se conecte en mongo atlas ?

	* **juand_silva** [536498] (1)

		Es igual, solo te debes dirigir al cluster de atlas del proyecto y en la pesta√±a **connect** escoges el el m√©todo **connect your application** y en la pesta√±a **drivers** escoges **node.js** copias el string de conexi√≥n y sigues los m√©todos del profesor o si lo prefieres copias el ejemplo full y haces una conexi√≥n custom:
		``` 
		    const MONGO_URI =`mongodb+srv://${USER}:${PASSWORD}@${DB_HOST}/${DB_NAME}?retryWrites=true&w=majority`// prettier-ignore
		    
		```

* **Armando Aguilar L.** (2) [517914](https://platzi.com/comentario/517914/) 

	Creo que es demaciado codigo para una simple conexion a mongo

* **Gerardo Manuel Reyes Fern√°ndez** (2) [474719](https://platzi.com/comentario/474719/) 
<h1>Variables de entorno:</h1>
	
	  1. Usar el comando `npm i -S dotenv`
	  2. Importarlo de esta manera `require('dotenv').config();`  
	3.Agregar archivo `.env.example` para poner todos los campos que vamos a guardar en las variables (solo a manera de ejemplo)  
	4.Agregar y a√±adir variable de entorno en el archivo `.env`  
	5.A√±adir nuestro archivo `.env` al archivo `.gitignore` **
	
	
	
	** Importante ya que si subimos el proyecto a un repositorio p√∫blico podr√≠a comprometer nuestra informaci√≥n

* **Juli√°n Andr√©s Vela Salazar** (2) [459199](https://platzi.com/comentario/459199/) 

	Es una alternativa pero era mejor hacerla con mongoose

	* **glrodasz** [459199] (11)

		Te comparto una respuesta que deje en un comentario similar:
		
		> Mongoose como ODM (Object Document Mapper) es muy completo y eficiente. Sin embargo, al igual que pasa con los ORM (Object Relational Mapper) en las bases de datos relacionales, saber un ODM/ORM nos sesga un poco de como funciona la base de datos realmente. Mi recomendaci√≥n es siempre tratar de aprender las bases. Esta bien usar un ODM/ORM para empezar pero a medida que quieres volverte mas experto ve a las bases, ya que asi podras aprovechar las librerias/herramientas mejor.

* **Pacool84** (1) [1059481](https://platzi.com/comentario/1059481/) 

	La musica es lo mejor !!! üòÉ

* **DavidArmandoVelazquez** (1) [900154](https://platzi.com/comentario/900154/) 

	Hola,
	
	A la hora de leer las credenciales desde el archivo de configuraci√≥n para usarlas en el MONGO_URI, el profesor usa destructuring en la constante, pero con el nombre ‚Äúconfig‚Äù que es el objeto que creamos en el archivo, lo ideal ser√≠a desestructurar cada atributo del objeto en la constante, por ejemplo,
	``` 
	    const { dbUser, dbPassword, dbName } = require('../config');
	    
	```
	
	. Lo comento porque me caus√≥ confusi√≥n, pero me sirvi√≥ para comprender un poco mejor este tema del destructuring.
	
	Saludos

* **onlinejaime** (1) [737866](https://platzi.com/comentario/737866/) 

	Ok‚Ä¶ He encontrado el error, pero no s√© arreglarlo. El problema es que ‚Äòdotenv‚Äô no lee el fichero ‚Äò.env‚Äô y en el fichero de lib/mongo no lee ninguna de las variables‚Ä¶ Haciendo el console.log() para que aparezca en consola poniendo cada variable con el valor real s√≠ funciona y, de hecho, en Postman tambi√©n‚Ä¶ Donde no funciona es cuando tiene que leer el config y el .env
	
	¬øAlguna idea?

* **onlinejaime** (1) [737838](https://platzi.com/comentario/737838/) 

	Esto es lo que me aparece en Postman:
	
	<pre>MongoParseError: URI does not have hostname, domain name and tld<br> at parseSrvConnectionString

* **onlinejaime** (1) [737810](https://platzi.com/comentario/737810/) 

	MONGO_URI mongodb+srv://undefined:undefined@undefined/undefined?retryWrites=true  
	Listening <http://localhost:8000>
	
	Esto es lo que yo consigo‚Ä¶ Que me aparezca que todo est√° indefinido‚Ä¶ No entiendo el porqu√©‚Ä¶

	* **DavidArmandoVelazquez** [737810] (1)

		Probablemente ya lo solucionaste pero por si no‚Ä¶
		
		Lo que pasa es que no est√° reconociendo el objeto config que tiene las variables. A m√≠ me pas√≥ igual y tuve que exportar el objeto con:
		``` 
		    module.exports = config
		    
		```
		
		y en el archivo mongo importarlo sin desestructurar:
		``` 
		    constconfig = require('../config')
		    
		```

* **Damian Spizzirri** (1) [706046](https://platzi.com/comentario/706046/) 

	Para que agregamos eso de `products || []` ?? Si products ya es un array vacio? No entendi esa sutileza.

	* **onlinejaime** [706046] (1)

		products es en s√≠ un array, pero para evitar que lance un error, si al devolvernos los productos no hay ninguno, evitamos el error con un array vac√≠o.

* **Damian Spizzirri** (1) [706033](https://platzi.com/comentario/706033/) 

	Cree una base local, le agregue a la base un usuario, (usando Robo3T) pero la querer conectarme me daba error. Modifique la URL sacandole el usuario y la clave y conecto. Alguien me sabe guiar y decirme como crear el usuario y clave. Evidentemente lo hice mal.

* **juand_silva** (1) [686040](https://platzi.com/comentario/686040/) 

	Leyendo documentaci√≥n de Mongo, me parece que falta el m√©todo para cerrar la conexion a la BD. ¬øno?  
	Todos sabemos los errores que se pueden generar al dejar la conexi√≥n abierta en una BD.
	``` 
	    db.close();
	    
	```

	* **juand_silva** [686040] (1)

		**No me iba a quedar con la duda** Resulta cuando iniciaba el servidor y le daba refresh a la p√°gina, me sal√≠a un mesaje como el sieguiente:
		``` 
		    Listening http://localhost:8000
		    Connected succesfully to mongo
		    the options [servers] is not supported
		    the options [caseTranslate] is not supported
		    the options [dbName] is not supported
		    the options [srvHost] is not supported
		    the options [credentials] is not supported
		    
		```
		
		Consultando en la documentaci√≥n de [mongo Node.js Driver](https://mongodb.github.io/node-mongodb-native/3.3/) , estos mensajes deprecados se dan porque se est√° llamando al `client.connect()` varias veces, como se ve en la promesa del `mongo.js`. No se recomienda hacer este llamado varias veces porque puede tener un comportamiento Undefined y es importante que una vez que se resuelva la promesa de `connect()` el cliente permanece conectado hasta que se cierre la conexi√≥n.
		
		Esta fue la soluci√≥n que pude encontrar. No se si alguien tenga otra mejor:
		``` 
		    const MongoClient = require('mongodb').MongoClient;
		    const { config } = require('../config');
		    
		    // encode to characters specials in DBUser and DBPass
		    const USER = encodeURIComponent(config.dbUser);
		    const PASSWORD = encodeURIComponent(config.dbPassword);
		    const DB_NAME = config.dbName;
		    const DB_HOST = config.dbHost;
		    
		    // variable connect MongoDB Atlas
		    const MONGO_URI =`mongodb+srv://${USER}:${PASSWORD}@${DB_HOST}/${DB_NAME}?retryWrites=true&w=majority`// prettier-ignore
		    
		    class MongoLib {
		      constructor() {
		        this.client = new MongoClient(MONGO_URI, { useNewUrlParser: true });
		        this.dbName = DB_NAME;
		        this.connect();
		      }
		    
		      async connect() {
		        returnthis.client.connect();
		      }
		    
		      async checkConnetion() {
		        if (this.client.isConnected()) {
		          console.log('Connected succesfully to mongo');
		          return;
		        } else {
		          try {
		            awaitthis.connect();
		          } catch (error) {
		            console.log(error)
		          }
		          console.log('Reconnected to MongoDB...');
		          return;
		        }
		      }
		    
		      async getAll(collection, query) {
		        awaitthis.checkConnetion();
		        returnthis.client
		          .db(this.dbName)
		          .collection(collection)
		          .find(query)
		          .toArray();
		      }
		    }
		    
		    module.exports = MongoLib;
		    
		    
		```

	* **giothcode** [686040] (1)

		Lo solucione asi, por cada instancia de la clase se inicializa el m√©todo connection para que as√≠ se puede cargar en el client.db la base de datos, si lo usas en el service no es necesario llamar de nuevo a connect sino usar el directamente el client de la instancia.  
		**mongo.js**
		``` 
		    const { config } = require("../config");
		    const { MongoClient } = require("mongodb");
		    
		    const DB_NAME = config.dbName;
		    const MONGO_URI = `mongodb://${config.dbHost}:${config.dbPort}/${DB_NAME}`;
		    
		    class MongoLib {
		      constructor() {
		        this.client = new MongoClient(MONGO_URI, {
		          useNewUrlParser: true,
		          useUnifiedTopology: true
		        });
		        this.dbName = DB_NAME;
		        this.connection();
		      }
		    
		      connection = () => {
		        returnnew Promise((resolve, reject) => {
		          this.client.connect(error => {
		            if (error) {
		              reject(error);
		            } else {
		              console.log("Conectado a mongo!");
		              let db = this.client.db(this.dbName);
		              resolve(db);
		            }
		          });
		        });
		      };
		      getAll = (collection, query) => {
		        returnthis.client
		          .db(this.dbName)
		          .collection(collection)
		          .find(query)
		          .toArray();
		      };
		    }
		    
		    module.exports = MongoLib;
		    
		```
		
		**services/products.js**
		``` 
		    const productMocks = require("../util/mocks/products");
		    
		    const MongoLib = require("../lib/mongo");
		    
		    classProductsService{
		      constructor() {
		        this.collections = "products";
		        this.mongodb = new MongoLib();
		      }
		    
		      getProducts({ tags }) {
		        const query = tags && { tags: { $in: tags } };
		    // USO PROPUESTO POR EL PROFE
		        // const products = this.mongodb.getAll(this.collections,query)
		    
		    // USO DEL CLIENTE SIN LLAMAR DE NUEVO A CONNECT
		        const products = this.mongodb.client
		          .db(this.dbName)
		          .collection('products')
		          .find(query)
		          .toArray();
		        returnPromise.resolve(products || []);
		      }
		      getProduct({ productId }) {
		        returnPromise.resolve(productMocks[0]);
		      }
		      createProduct({ product }) {
		        returnPromise.resolve(productMocks[0]);
		      }
		      updateProducts({ productId, product }) {
		        returnPromise.resolve(productMocks[0]);
		      }
		      deleteProducts({ productId }) {
		        returnPromise.resolve(productMocks[0]);
		      }
		    }
		    
		    module.exports = ProductsService;
		    
		```
		
		De esta forma si revisas en estado del servidor de mongo ya no se generan tantas conexiones sino solo la propia de la clase y las nuevas instancias, antes se generaba una conexi√≥n por cada llamada al m√©todo getAll

* **SaFeRamirez** (1) [677742](https://platzi.com/comentario/677742/) 

	Encode para problemas de caracteres especiales en el usuario y la contrase√±a

* **Brian Bentancourt** (1) [670288](https://platzi.com/comentario/670288/) 

	Estoy teniendo este error
	``` 
	    MongoNetworkError: failed to connect to server [cluster0-shard-00-00-f79wv.mongodb.net:27017] onfirst connect [MongoError: Authentication failed.]```
	    
	```

	* **Enrique Devars** [670288] (1)

		Significa que tu usuario y contrase√±a no son correctas. Esto puede ser por que no les aplicaste uriEncode, intenta algo as√≠:
		``` 
		    const USER = encodeURIComponent(config.dbUser);
		    const PASSWORD = encodeURIComponent(config.dbPassword);
		    
		    
		```

* **JUAN SILVA** (1) [669161](https://platzi.com/comentario/669161/) 

	Felicito al maestro glrodasz por que es de los pocos que responden las preguntas y dudas

* **jorge william rea√±o reyes** (1) [662851](https://platzi.com/comentario/662851/) 

	P√ÄRA LO QUE HAN TENIDO PROBLEMA PARA CONECTAR A MONGO AQUI LES DEJO MI CONECCION CON LA VERSION 3.2 DE MONGO
	``` 
	    const MongoClient = require("mongodb").MongoClient;
	    const { config } = require("../config/index.js");
	    
	    const USER = encodeURIComponent(config.dbUser);
	    const PASSWORD = encodeURIComponent(config.dbPassword);
	    
	    const DB_NAME = config.dbName;
	    const MONGO_URI = `mongodb+srv://${USER}:${PASSWORD}@cluster0-f79wv.mongodb.net/${DB_NAME}?retryWrites=true&w=majority`// prettier-ignore
	    classMongoLib{
	      constructor() {
	        this.client = new MongoClient(MONGO_URI, { useNewUrlParser: true });
	        this.dbName = DB_NAME;
	      }
	    
	      connect() {
	        returnnewPromise((resolve, reject) => {
	          this.client.connect(error => {
	            if (error) {
	              reject(error);
	            } else {
	              resolve(this.client.db(this.dbName));
	            }
	          });
	        });
	      }
	    
	      getAll(collection, query) {
	        returnthis.connect().then(db => {
	          return db
	            .collection(collection)
	            .find(query)
	            .toArray();
	        });
	      }
	    }
	    
	    module.exports = MongoLib;
	    
	    
	```

* **tzalejo** (1) [546323](https://platzi.com/comentario/546323/) 

	La verdad que no pude conectar mLab con robo 3T, y tuve que usar el mongo local, tendr√© alg√∫n inconveniente mas adelante??

	* **zefe** [546323] (3)

		A me funciono asi:
		
		const MONGO_URI = `mongodb+srv://${USER}:${PASSWORD}@${config.dbHost}/${DB_NAME}?retryWrites=true`;

	* **glrodasz** [546323] (2)

		@tzalejo, Podrias confirmar si con ese formato de URI, te conecta?

	* **tzalejo** [546323] (1)

		Hola glrodasz, con robo 3T no se me conecto pero con la aplicaci√≥n si lo hizo‚Ä¶osea agregue manualmente algunos documentos y la pagina me lo mostr√≥ correctamente. Algo estoy haciendo mal en mi conexi√≥n con robo 3T.

	* **AlexGarrixen** [546323] (1)

		Hola tzalejo yo lo he conectado sin problemas,lo hecho de la siguiente forma :
		
		**Conexion**
		
		NAME ->Nombre de la bd a conectar  
		ADDRESS -> Host(se encuentra en la URI)  
		PORT -> Port((se encuentra en la URI))
		
		![robot3tconexion1.png](https://static.platzi.com/media/user_upload/robot3tconexion1-75c24f3e-da93-44eb-81ad-470509034cbb.jpg)
		
		**Autorizacion**  
		DATABASE->Nombre de la bd a conectar  
		USERNAME -> usuario que creaste(no usuario de login,seccion USERS en tu db)  
		PASSWORD -> password del usuario creado(no password login)
		
		**Seccion Users**  
		![mlab.png](https://static.platzi.com/media/user_upload/mlab-edef749d-d782-4ea6-b070-d709ab76145b.jpg)
		
		![robot3tauth.png](https://static.platzi.com/media/user_upload/robot3tauth-188ae4c3-18f9-42bc-aefe-a08a20496ae0.jpg)
		
		**Confirmacion de conexion**  
		![robot3confirm.png](https://static.platzi.com/media/user_upload/robot3confirm-f752c51f-003e-403c-b380-cdc103e234f0.jpg)

* **Victor Lozada** (1) [531870](https://platzi.com/comentario/531870/) 

	He buscado por todas partes y no consigo nada sobre este warning que me aparece en la consola al correr `npm run dev`
	``` 
	    the options [0] is not supported
	    the options [1] is not supported
	    the options [2] is not supported
	    the options [3] is not supported
	    the options [4] is not supported
	    the options [5] is not supported
	    the options [6] is not supported
	    the options [7] is not supported
	    the options [servers] is not supported
	    the options [caseTranslate] is not supported
	    the options [username] is not supported
	    the server/replset/mongos/db options are deprecated, all their options are supported atthe top level ofthe options object [poolSize,ssl,sslValidate,sslCA,sslCert,sslKey,sslPass,sslCRL,autoReconnect,noDelay,keepAlive,keepAliveInitialDelay,connectTimeoutMS,family,socketTimeoutMS,reconnectTries,reconnectInterval,ha,haInterval,replicaSet,secondaryAcceptableLatencyMS,acceptableLatencyMS,connectWithNoPrimary,authSource,w,wtimeout,j,forceServerObjectId,serializeFunctions,ignoreUndefined,raw,bufferMaxEntries,readPreference,pkFactory,promiseLibrary,readConcern,maxStalenessSeconds,loggerLevel,logger,promoteValues,promoteBuffers,promoteLongs,domainsEnabled,checkServerIdentity,validateOptions,appname,auth,user,password,authMechanism,compression,fsync,readPreferenceTags,numberOfRetries,auto_reconnect,minSize,monitorCommands,retryWrites,useNewUrlParser]
	    
	```
	
	alguna idea de que podr√° ser ?

	* **Diego Alexander Forero Higuera (Platzi)** [531870] (2)

		Al parecer la versi√≥n que tienes instalada de MongoLib no es completamente compatible con la versi√≥n de mongodb que tienes instalada, puedes compartir las versiones tanto de las librer√≠a como del mongodb para ver si es por ese lado el problema.

	* **glrodasz** [531870] (1)

		Puedes intentar instalar las versiones exactas que manejo en el curso y verificar si te sale el mismo error, para descartar el tema de las versiones.

	* **kmarquez** [531870] (1)

		tengo la misma inconsistencia, probe con la version del curso y la actual y de igual manera sale. Por ahi estuve investigando y dice que eso sucede cuando se ejecuta mas de una vez la conexion a la base de datos y es recomendado que cuando se resuelva la perticion cerrar el cliente de mongoDB. Pero de igual forma no he podido solucionarlo.

	* **glrodasz** [531870] (1)

		Bueno, creo saber que fue lo que pas√≥, mLab a Diciembre 28 la version de MongoDB que habia era la 3.2, pero actualmente estamos en la version 3.6. Revisando mi cuenta de mLab, efectivamente las bases de datos subieron de version, para ser m√°s exactos esta usando la version 3.6.6. En teoria el driver que usamos para el curso es compatible pero quizas hay que hacer cambios en la conexion o queries.
		
		Sin embargo, puede que sea un problema directo del driver, y no hay mucho que hacer hasta que saquen un udpate.
		
		Notas:  
		<https://docs.mlab.com/db-version-requirements/#v36>  
		<https://docs.mongodb.com/manual/release-notes/3.6/>  
		<https://docs.mongodb.com/manual/release-notes/3.2/>

	* **kmarquez** [531870] (1)

		Gracias por la explicaci√≥n üòéüòéüòé.

	* **Victor Lozada** [531870] (2)

		@glrodasz pienso tambien que es un problema del driver, ya que como mlab cambio toda su interfaz decidi usar mi instalacion de mongo localmente y ocurria lo mismo !

* **jonnyalexbh** (1) [529308](https://platzi.com/comentario/529308/) 

	Hola, me saca el siguiente error ‚ÄúMongoError: MongoClient must be connected before calling MongoClient.prototype.db‚Äù la verdad mlab no me dejo ingresar, estoy trabajando con Mongo Atlas

	* **Diego Alexander Forero Higuera (Platzi)** [529308] (1)

		Aseg√∫rate de tener los datos de conexi√≥n correctos y realizar la conexi√≥n antes de interactuar con la base de datos.

	* **kmarquez** [529308] (1)

		esta conexion me ayudo  
		const MONGO_URI = `mongodb://${USER}:${PASSWORD}@${config.dbHost}:${config.dbPort}/${DB_NAME}?ssl=true&authSource=admin&retryWrites=true`
		
		conexion publicada por **FerJPi**

	* **Nathaly Stefani Ria√±o Bejarano** [529308] (1)

		Hola, tuve el mismo problema, me pude conectar creando un usuario administrador desde mongodb atlas y modificando MONGO_URI como se indica en otros comentarios.

* **dcortesnet** (1) [524894](https://platzi.com/comentario/524894/) 

	Para que sirven los tags que le pasas por par√°metro? me perd√≠ esa parte

	* **Diego Alexander Forero Higuera (Platzi)** [524894] (1)

		Son los par√°metros o filtros por los que se va a buscar los productos.

* **Reddy Abel Tintaya Conde** (1) [502305](https://platzi.com/comentario/502305/) 

	funcionaria si sigo un proceso similar para Postgres?

	* **Augusto Lopez** [502305] (3)

		Aqu√≠ tiene tienes toda la documentaci√≥n de como integrar [node-postgres](https://node-postgres.com/). Saludos!

* **mario-salinas** (1) [453976](https://platzi.com/comentario/453976/) 

	a mi me gener√≥ problemas con la URI pero us√© la que brinda la documentaci√≥n de mLab  
	![Captura de pantalla 2018-12-21 a la\(s\) 11.14.33 a. m..png](https://static.platzi.com/media/user_upload/Captura%20de%20pantalla%202018-12-21%20a%20la%28s%29%2011.14.33%20a.%20m.-fb6979de-a4dc-4c3c-9aca-aa3b21e507cd.jpg)

	* **glrodasz** [453976] (2)

		Es exactamente la misma URI que estamos implementando, depronto esta mal generado?
		
		Puedes verificar la estructura aqu√≠: <https://github.com/glrodasz/platzi-express/blob/master/ecommerce/lib/mongo.js#L9>

* **Exequiel Quiroga** (1) [451783](https://platzi.com/comentario/451783/) 

	En una API, ¬øes mejor hacer una conexi√≥n persistente a la base de datos o una conexi√≥n por cada petici√≥n? ¬øCual ser√≠a una buena practica? Si es una conexi√≥n por cada petici√≥n ¬øtiene perdida de velocidad de respuesta?  
	En mi caso estoy utilizando una librer√≠a llamada [mongoose](https://mongoosejs.com/)

	* **Carlos Enrique Gonzalez Pe√±a** [451783] (2)

		La mejor forma es hacer una conexi√≥n por cada petici√≥n, desconozco que tal funciona mongoose pero la seguridad pude quedar comprometida con una conexi√≥n persistente.  
		Actualmente las REST tienen la desventaja de conexi√≥n por petici√≥n, pero te recomiendo que veas un poco de GraphQL, este fue pensado para solventar esto sin comprometer la seguridad en la DB

	* **glrodasz** [451783] (3)

		Depende mucho del proposito de tu aplicaci√≥n y que tantas peticiones se hacen a la BD. Idealmente se puede implementar el patron singleton para mantener solo una conexion abierta. Te recomiendo que mires como lo hacen en el curso de MongoDB de Platzi, esto es solo una introducci√≥n a MongoDB.

* **Christian Motta** (1) [66159](https://platzi.com/comentario/703969/) 
Hola @glrodasz. Me gustar√≠a saber qu√© prettier extension usas pasa VSC. Gracias

	* **glrodasz** [66159] (2)

		Hola hipercubus, esta es la extension: <https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode>

* **Jos√© Edmundo Prado Astucuri** (1) [63456](https://platzi.com/comentario/658889/) 
Buenas noches, alguna documentaci√≥n o url, para poder conectarme a Sql server?

	* **Diego Alexander Forero Higuera (Platzi)** [63456] (1)

		<https://expressjs.com/en/guide/database-integration.html> Aqu√≠ encuentras la informaci√≥n para conectarte a SQL Server.

* **tzalejo** (1) [55887](https://platzi.com/comentario/546323/) 
La verdad que no pude conectar mLab con robo 3T, y tuve que usar el mongo local, tendr√© alg√∫n inconveniente mas adelante??

	* **zefe** [55887] (3)

		A me funciono asi:
		
		const MONGO_URI = `mongodb+srv://${USER}:${PASSWORD}@${config.dbHost}/${DB_NAME}?retryWrites=true`;

* **Victor Lozada** (1) [54593](https://platzi.com/comentario/531870/) 
He buscado por todas partes y no consigo nada sobre este warning que me aparece en la consola al correr npm run dev th...

	* **Diego Alexander Forero Higuera (Platzi)** [54593] (2)

		Al parecer la versi√≥n que tienes instalada de MongoLib no es completamente compatible con la versi√≥n de mongodb que tienes instalada, puedes compartir las versiones tanto de las librer√≠a como del mongodb para ver si es por ese lado el problema.

* **Reddy Abel Tintaya Conde** (1) [52205](https://platzi.com/comentario/502305/) 
funcionaria si sigo un proceso similar para Postgres?

	* **Augusto Lopez** [52205] (3)

		Aqu√≠ tiene tienes toda la documentaci√≥n de como integrar [node-postgres](https://node-postgres.com/). Saludos!

* **Exequiel Quiroga** (1) [48176](https://platzi.com/comentario/451783/) 
En una API, ¬øes mejor hacer una conexi√≥n persistente a la base de datos o una conexi√≥n por cada petici√≥n? ¬øCual ser√≠a una buena practica?...

	* **Carlos Enrique Gonzalez Pe√±a** [48176] (2)

		La mejor forma es hacer una conexi√≥n por cada petici√≥n, desconozco que tal funciona mongoose pero la seguridad pude quedar comprometida con una conexi√≥n persistente.  
		Actualmente las REST tienen la desventaja de conexi√≥n por petici√≥n, pero te recomiendo que veas un poco de GraphQL, este fue pensado para solventar esto sin comprometer la seguridad en la DB

## 0170. Implementando acciones CRUD en MongoDB [15732](https://platzi.com/clases/1437-express-js/15732-implementando-acciones-crud-en-mongodb/)

### Descripci√≥n:


### Links:

* [MongoDB CRUD Operations ‚Äî MongoDB Manual](https://docs.mongodb.com/manual/crud/)

* [Collection Methods ‚Äî MongoDB Manual](https://docs.mongodb.com/manual/reference/method/js-collection/)

* [GitHub - karlseguin/the-little-mongodb-book: The Little MongoDB Book](https://github.com/karlseguin/the-little-mongodb-book)

### Comentarios:

* **roganoalien** (4) [450181](https://platzi.com/comentario/450181/) 

	Por qu√© este y los anteriores cursos de mongoDB, al momento de crear un CRUD lo hacen de una forma irreal y nada √∫til para productivo ni para un cliente? Creo que est√°n decayendo la calidad de los cursos en Platzi, preferir√≠a tener menos al a√±o pero que los hagan completos y apegados a la realidad y que actualicen los que est√°n obsoletos.

	* **glrodasz** [450181] (8)

		Este curso es de Express.js lo que se ve de MongoDB es una introducci√≥n para saber como manejarlo a travez del framework.
		
		Si puedes ser mas especifico respecto a porque consideras que esta creado de una manera irreal, con gusto te ayudo a responder tus dudas.
		
		Aqui esta el link del curso de MongoDB: <https://platzi.com/cursos/mongodb-redis/>

	* **muxproo** [450181] (1)

		Interesante y cual seria la formas m√°s real y m√°s √∫til de usar grub con Mongodb alguna tutorial.

	* **glrodasz** [450181] (1)

		La verdad no sabria exactamente a que se refiere. (Por eso pido un ejemplo concreto) He trabajado mucho con Mongo en producci√≥n y todo depende 100% de la logica de negocio, de saber como y que tipo de respuesta resolver.
		
		En el mundo de las aplicaciones que necesitan escalarse y alta disponibilidad ni siqueira se hace uso de un solo motor de base de datos, suele proponerse una combinaci√≥n entre un sistema relacional y no-relacional. De nuevo, depende mucho del tipo de aplicaci√≥n y sus necesidades.

	* **maxhadortiz93** [450181] (3)

		Creo que entiendo a que se refiere el amigo, digamos que desea un poco mas de complejidad, un caso mas cercano al campo real, pero resulta que no es la forma correcta de ense√±ar, puesto que si se atiende un problema especifico ‚Äúreal‚Äù, este no seria de f√°cil entendimiento para los que deseamos saber el camino de lo b√°sico a lo complejo. Ya depender√° de cada uno de nosotros como analicemos las necesidades de la aplicaci√≥n en concreto.

* **Carlos Martinez** (3) [690338](https://platzi.com/comentario/690338/) 

	estuve viendo que cada vez que se hacia una acci√≥n CRUD se conectaba con el cliente de mongoDB, por lo que he le√≠do no es recomendable conectarse tantas veces, sino hacer 1 sola conexi√≥n y mantener 1 instancia activa de mongoDB mientras el usuario est√© activo, asi que por lo que v√≠ en el curso de esenciales de nodejs en la cual el profesor Emir Salazar recomendaba 1 sola instancia, le hice modificaciones a el archivo donde nos conectamos a mongo, ahora solo se conecta 1 vez con mongo cuando arranca el index.js de la app y se mantiene la instancia. quedando asi el archivo mongo.js:
	``` 
	    // carlos eduardo
	    // @carlosEdua -> github
	    // @cems -> platzi 
	    // standart class to connect, use and disconnect mongoDB with
	    // one instance 
	    
	    const { MongoClient } = require("mongodb");
	    const { 
	        dbName,
	        dbUSer,
	        dbPassword
	    } = require("../config/config");
	    
	    const URI = `mongodb+srv://${dbUSer}:${dbPassword}@${dbName}-ydbgb.mongodb.net/test?retryWrites=true&w=majority`;
	    
	    // *****  global instance of mongo  *****
	    let INSTANCE = null;
	    // **************************************
	    
	    class MongoLib{
	        constructor(){
	            // crear un cliente de mongoDB, mas no conectarse a√∫n
	            this.client = new MongoClient(URI, { useNewUrlParser: true});
	            this.dbName = dbName;
	            this.instance = INSTANCE;
	            this.db = INSTANCE ? INSTANCE.db(dbName) : null;
	        }
	    
	        async connect(){
	            try {
	                // conectarse al cliente
	                const clientConnected = awaitthis.client.connect();
	                // referenciar instancia
	                this.instance = clientConnected;
	                INSTANCE = clientConnected;
	                // obtener la base de datos
	                // this.db = await this.instance.db(this.dbName);
	                console.log("base de datos conectada!!!");
	                // return true for run the app
	                returntrue;
	            } catch (err) {
	                returnnewError(err)
	            }
	        }
	    
	        async disconnect(){
	            try {
	                if(this.instance) awaitthis.instance.close();
	            } catch (err) {
	                returnError(err)
	            }
	        }
	    
	        // ===================   CRUD   ====================
	        // ## create ##
	        createOne(collection, query){
	            const {instance, dbName} = this;
	            return instance.db(dbName).collection(collection).insertOne(query);
	        }
	    
	        createMany(collection, arr){
	            const {instance, dbName} = this;
	            return instance.db(dbName).collection(collection).insertMany(arr);
	        }
	        // ## find ##
	        getAll(collection, query){
	            const {instance, dbName} = this;
	            return instance.db(dbName).collection(collection).find(query).toArray();    
	        }
	    
	        getOne(collection, query){
	            const {instance, dbName} = this;
	            return instance.db(dbName).collection(collection).findOne(query);
	        }
	        // ## update ##
	        updateOne(collection, query, newValue){
	            const {instance, dbName} = this;
	            return instance.db(dbName).collection(collection).updateOne(query, newValue);
	        }
	    
	        updateMany(collection, query){
	            const {instance, dbName} = this;
	            return instance.db(dbName).collection(collection).updateMany(query);
	        }
	        // ## delete ##
	        deleteOne(collection, query){
	            const {instance, dbName} = this;
	            return instance.db(dbName).collection(collection).deleteOne(query);
	        }
	    
	        deleteMany(collection, query){
	            const {instance, dbName} = this;
	            return instance.db(dbName).collection(collection).deleteMany(query);
	        }
	        // ## drop ##
	        dropCollection(collection){
	            const {instance, dbName} = this;
	            return instance.db(dbName).collection(collection).drop();
	        }
	    
	    }
	    
	    module.exports = MongoLib;
	    
	```
	
	en la carpeta services el archivo products.js quedar√≠a asi:
	``` 
	    // script para comunicarse con las librer√≠as de BDD y mandarselo
	    // al controlador
	    // aqui se controla la logica de negocio para los productos
	    // tal como: crear, pedir, actualizar y borrar
	    
	    const MongoLib = require("../mongo/mongo");
	    const { ObjectID } = require("mongodb");
	    
	    class productService{
	        constructor(collection){
	            this.mongo = new MongoLib();
	            this.collection = collection;
	        }
	        // ==================   get products  ==================
	        async getProducts({tags, productName}){
	            // ver si se busca por tags o productName y en caso de no tener
	            // asignar un objeto vacio
	            const byTags = tags ? { tags : { $in: JSON.parse(tags) }} : null;
	            const byName = productName ? { productName: newRegExp(productName)} : null;
	            const query = (byTags || byName) || {};
	    
	            const products = awaitthis.mongo.getAll(this.collection, query);
	            return products;
	        }
	    
	        async getProduct(id){
	            const ID = new ObjectID(id); 
	            const product = awaitthis.mongo.getOne(this.collection, { _id: ID});
	            return product;
	        }
	    
	        // ====================  create products  ===================
	        async createProduct({ body }){
	            const productCreated = awaitthis.mongo.createOne(this.collection, body);
	            return productCreated;
	        }
	        
	        // ====================  update products  ===================
	        async updateOneProduct(id, newValues){
	            const ID = new ObjectID(id);
	            // por si se actualiza m√°s de 1 campo
	            let newValuesObject = {};
	            for( let key in newValues){
	                newValuesObject[key] = newValues[key];
	            }
	            const productUpdated = awaitthis.mongo.updateOne(
	                this.collection, { _id: ID }, { $set: newValuesObject}
	                );
	            return productUpdated;
	        }
	    
	        // =================  remove products  ==================
	        async removeProduct(id){
	            const ID = new ObjectID(id);
	            const productDeleted = awaitthis.mongo.deleteOne(this.collection, { _id: ID});
	            return productDeleted;
	        }
	    
	    
	    }
	    
	    module.exports = productService;
	    
	```
	
	y las rutas de la API la tengo asi:
	``` 
	    const router = require("express").Router();
	    const ProductServices = require("../../services/products");
	    
	    
	    // get all products
	    router.get("/", async (req, res, next ) => {
	        // nueva instancia de los servicios para comunicarse
	        // con la instancia ya creada de mongoDB
	        const productServices = new ProductServices("products");
	        const { tags, productName } = req.query;
	        try {
	            const products = await productServices.getProducts({tags, productName});
	            res.send(products);
	        } catch (err) {
	            next(err);
	        }
	    })
	    
	    // get one product
	    router.get("/:productId", async (req, res, next ) => {
	        const { productId } = req.params;
	        const productServices = new ProductServices("products");
	        try {
	            const products = await productServices.getProduct(productId);
	            res.send(products);
	        } catch (err) {
	            next(err);
	        }
	    })
	    
	    // create a product
	    router.post("/", async (req, res, next ) => {
	        const productServices = new ProductServices("products");
	        const  product = req.body;
	        try {
	            const productCreated = await productServices.createProduct({body: product});
	            res.send(productCreated);
	        } catch (err) {
	            next(err);
	        }
	    })
	    
	    // update a product
	    router.put("/:productId", async (req, res, next ) => {
	        const productServices = new ProductServices("products");
	        const newProductValues = req.body;
	        const { productId } = req.params;
	        try {
	            const productUpdated = await productServices.updateOneProduct(productId, newProductValues);
	            res.send(productUpdated);
	        } catch (err) {
	            next(err);
	        }
	    })
	    
	    // delete a product
	    router.delete("/:productId", async (req, res, next ) => {
	        const productServices = new ProductServices("products");
	        const { productId } = req.params;
	        try {
	            const productErased = await productServices.removeProduct(productId);
	            res.send(productErased);
	        } catch (err) {
	            next(err);
	        }
	    })
	    
	    module.exports = router;
	    
	```
	
	por ultimo el index.js queda de la siguiente manera:
	``` 
	    const express = require("express");
	    const hbs = require("express-handlebars");
	    const viewRoutes = require("./routes/views/products");
	    const apiRoutes = require("./routes/api/productsApi");
	    const path = require("path");
	    const MongoLib = require("./mongo/mongo");
	    // app
	    const app = express();
	    const mongo = new MongoLib();
	    // middlewares
	    app.use(express.json());
	    
	    // set view engine
	    app.engine('hbs', hbs({
	        extname: 'hbs', 
	        defaultLayout: "index.hbs",
	        layoutsDir: path.join(__dirname, 'views/'),
	        partialsDir  : [
	            //  path to your partials
	            path.join(__dirname, 'views/partials'),
	        ]
	    }));
	    app.set("views", "./views");
	    app.set("view engine", "hbs");
	    // routes
	    app.use("/products", viewRoutes);
	    app.use("/api/products", apiRoutes);
	    // redirect
	    app.use("/", (req,res) => {
	        res.redirect("/products");
	    })
	    
	    // run the server
	    functionrun(){
	        app.listen( process.env.PORT || 4500, () => {
	            console.log("server created");
	        })
	    }
	    // iniciar conexi√≥n con mongoDB e iniciar servidor si
	    // la conexi√≥n fu√© exitosa 
	    mongo.connect()
	        .then( () => {
	            run();
	            // desconectar mongoDB si se cierra el programa
	            process.on("SIGINT", mongo.disconnect);
	            process.on("SIGTERM", mongo.disconnect);
	        })
	        .catch( err => console.log("DB not connected ", err));
	    
	```
	
	creo que es una mejor implementaci√≥n pero eso ya depende del proyecto y de cada quien.

* **Antonio G√°miz Delgado** (3) [508495](https://platzi.com/comentario/508495/) 

	A alguien le salta un warning de mongodb al hacer dos conexiones simultaneas?
	
	Este es el warning:  
	the options [servers] is not supported  
	the options [caseTranslate] is not supported  
	the options [username] is not supported  
	the server/replset/mongos/db options are deprecated, all their options are supported at the top level of the options object [poolSize,ssl,sslValidate,sslCA,sslCert,sslKey,sslPass,sslCRL,autoReconnect,noDelay,keepAlive,keepAliveInitialDelay,connectTimeoutMS,family,socketTimeoutMS,reconnectTries,reconnectInterval,ha,haInterval,replicaSet,secondaryAcceptableLatencyMS,acceptableLatencyMS,connectWithNoPrimary,authSource,w,wtimeout,j,forceServerObjectId,serializeFunctions,ignoreUndefined,raw,bufferMaxEntries,readPreference,pkFactory,promiseLibrary,readConcern,maxStalenessSeconds,loggerLevel,logger,promoteValues,promoteBuffers,promoteLongs,domainsEnabled,checkServerIdentity,validateOptions,appname,auth,user,password,authMechanism,compression,fsync,readPreferenceTags,numberOfRetries,auto_reconnect,minSize,monitorCommands,retryWrites,useNewUrlParser]

	* **kmarquez** [508495] (1)

		X2

	* **mario-salinas** [508495] (1)

		a mi me pasa lo mismo

	* **Javier Serrano Lule** [508495] (1)

		Igual a m√≠

	* **juand_silva** [508495] (1)

		Para los que les sale este error: es porque se est√° llamando el m√©todo `client.connect()` m√∫ltiples veces. Lo cual mongo no recomienda, mejor es utilizar `async await` y generar una clase connect que pueda ser instanciada. Para evitar este error.

* **Armando De La Vega** (3) [449326](https://platzi.com/comentario/449326/) 

	Cual es tu opinion acerca de mongoose? ¬øPorque no lo usas en tu proyecto?

	* **glrodasz** [449326] (11)

		Mongoose como ODM (Object Document Mapper) es muy completo y eficiente. Sin embargo, al igual que pasa con los ORM (Object Relational Mapper) en las bases de datos relacionales, saber un ODM/ORM nos sesga un poco de como funciona la base de datos realmente. Mi recomendaci√≥n es siempre tratar de aprender las bases. Esta bien usar un ODM/ORM para empezar pero a medida que quieres volverte mas experto ve a las bases, ya que asi podras aprovechar las librerias/herramientas mejor.

* **Victor Lozada** (2) [531895](https://platzi.com/comentario/531895/) 

	en la linea 57:
	``` 
	              .updateOne({ _id: ObjectId(id) }, { $set: data }, { upsert: true })
	    
	```
	
	al colocar `upsert:true`, no se supondr√≠a que mongo crear√≠a un nuevo documento (con la data enviada) en caso de no encontrar el documento con ese `_id` respectivo? esto estaria bien implementado? ya que se supone que el metodo `update` es solo para actualizar y no para crear

	* **Diego Alexander Forero Higuera (Platzi)** [531895] (3)

		En la documentaci√≥n oficial <https://docs.mongodb.com/manual/reference/method/db.collection.updateOne/> explica como funciona, si no encuentra un documento que cumpla con el filter lo va a crear y si lo encuentra lo actualiza, por defecto es false por lo tanto siempre va a intentar actualizar y si no hay algo que coincida con el filtro va a fallar.

	* **Nathaly Stefani Ria√±o Bejarano** [531895] (2)

		Muy buena apreciaci√≥n, de hecho cuando desde postman elimina el registro del ‚Äòbutaco blanco‚Äô y lo vuelve a crear y lo actualiza, como no cambi√≥ el productId en el environment por el nuevo id del ‚Äòbutaco blanco‚Äô, entonces se crea un nuevo documento para ‚Äòblack bike‚Äô.

* **Alejandro Gonz√°lez Reyes** (2) [70167](https://platzi.com/comentario/769860/) 
Tenemos un problema con la re-conexi√≥n a la base de datos. sucede que cuando se corta el internet, lanza un error del que jam√°s se puede ...

	* **glrodasz** [70167] (2)

		Si, en el curso de Backend con Node.js de la Escuela de JavaScript hice una mejora en la implementaci√≥n de la libreria de Mongo. ¬øPuedes intentar esta versi√≥n para probar que funcione? <https://github.com/glrodasz/platzi-backend-node/blob/master/movies-api/lib/mongo.js>

* **Pacool84** (1) [1059546](https://platzi.com/comentario/1059546/) 

	La musicaaaaa!!! Me anima a seguir adelante

* **Ezequiel Freire** (1) [916141](https://platzi.com/comentario/916141/) 

	Hola, como estan?, a alguien le paso este error al querer utilizar el update?
	``` 
	    MongoError: Modifiers operate on fields but we found type null instead. For example: {$mod: {<field>: ...}} not {$set: null}
	    
	```

	* **Ezequiel Freire** [916141] (1)

		Ya encontre el problema, me faltaba utilizar el body en la ruta de update.
		``` 
		    router.put('/:id', asyncfunction(req, res, next){
		        const { id } = req.params;
		        const { body: product } = req;
		        console.log('req', req.params, req.body)
		    
		        try {
		            const updateProduct = await productService.updateProduct({ 
		                id,
		                product // Esto faltaba
		            });
		        
		            res.status(200).json({
		                data: updateProduct,
		                message: 'product updated'
		            });
		        } catch (error) {
		            next(error);
		        }
		    });
		    
		```

* **Wilson Marino Pablo Mendez** (1) [848491](https://platzi.com/comentario/848491/) 

	Excelente curso!!

* **jenapi** (1) [842267](https://platzi.com/comentario/842267/) 

	Hey tengo este error, pls ayuda Obi-Wan Kenobi. Eres mi √∫nica esperanza :
	
	TypeError: Cannot read property ‚Äòcreate‚Äô of undefined
	``` 
	    		const createProductId = await 	this.mongoDB.create(this.collection, product);
	    
	```
	
	esta es la linea donde me sale.

* **rafaelrb40** (1) [794944](https://platzi.com/comentario/794944/) 

	En node tambien existe la inyeccion de dependencias como en java o entros lenguajes?.  
	Digo esto por las ventajas que esto reporta. Gracias

* **onlinejaime** (1) [758778](https://platzi.com/comentario/758778/) 

	Me sale esto en Postman, ¬øalguna idea de c√≥mo solucionarlo?:
	``` 
	    {
	        "statusCode": 500,
	        "error": "Internal Server Error",
	        "message": "An internal server error occurred",
	        "stack": "Error: Argument passed in must be a single String of 12 bytes or a string of 24 hex characters\n    at new ObjectID (D:\\platzi-express-que-es-un-template-engine\\e-commerce\\node_modules\\bson\\lib\\bson\\objectid.js:59:11)\n    at ObjectID (D:\\platzi-express-que-es-un-template-engine\\e-commerce\\node_modules\\bson\\lib\\bson\\objectid.js:40:43)\n    at connect.then.db (D:\\platzi-express-que-es-un-template-engine\\e-commerce\\lib\\mongo.js:44:55)\n    at <anonymous>\n    at process._tickDomainCallback (internal/process/next_tick.js:228:7)"
	    }
	    
	```

* **juand_silva** (1) [688650](https://platzi.com/comentario/688650/) 

	El m√©todo POST me responde la **data** con demasiados datos no solo el **_id** XD

* **Enrique Devars** (1) [676447](https://platzi.com/comentario/676447/) 

	```
	    TypeError: Cannot readproperty'_id' of undefined
	    
	```
	
	Si alguien llega a tener este error recurden tener hasta arriba de su aplicaci√≥n el middleware de body parser.

	* **Yoneiker Plaza** [676447] (1)

		Hola, a que te refieres con tenerla hasta arriba de nuestra aplicacion?

* **antonioramoscoronado** (1) [675119](https://platzi.com/comentario/675119/) 

	Hola, como podr√≠a realizar un POST de m√∫ltiples productos al mismo tiempo?

	* **Enrique Devars** [675119] (1)

		Puedes enviar un array de objetos y usar en Mongo el m√©todo de insertMany(). Te dejo un tutorial que hice donde explico algunas cosas b√°sicas de MongoDB. Lo puedes ver [aqu√≠](https://platzi.com/tutoriales/1533-mongodb/4102-cosas-basicas-de-un-crud-en-mongodb/)

* **Danniel Sequera** (1) [612497](https://platzi.com/comentario/612497/) 

	Imagen del ejemplo para crear el producto: [https://images.unsplash.com/photo-1503602642458-232111445657?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=bf884ad570b50659c5fa2dc2cfb20ecf&auto=format&fit=crop&w=800&q=60](https://images.unsplash.com/photo-1503602642458-232111445657?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=bf884ad570b50659c5fa2dc2cfb20ecf&auto=format&fit=crop&w=800&q=60)

* **Juli√°n Cipagauta** (1) [529652](https://platzi.com/comentario/529652/) 

	Una consulta, por m√°s que intento, reviso el c√≥digo y pruebo otros request HTTP, cuando uso el get con tags solo me devuelve []. Ya revise que el valor del filtro fuera el mismo que el del objeto. Tambi√©n que se obtuviera correctamente con el req.query. Tambi√©n revise la sintaxis con la documentaci√≥n de mongodb, e incluso prob√© guardar el resultado del query ( db.collection(products).find(query).toArray() ), en una variable y luego mostrarla por consola y me dec√≠a ‚ÄúPromise { <pending> }‚Äù, ¬øAlguien me podr√≠a ayudar?

	* **Diego Alexander Forero Higuera (Platzi)** [529652] (1)

		Hola comparte tu c√≥digo para ayudarte a encontrar el problema y solucionarlo.

	* **glrodasz** [529652] (1)

		Es muy probable que necesites ‚Äúresolver‚Äù tu promesa, es decir llamar el **.then** o si es **async** , hacer el **await**. Por favor, compartemos la parte de codigo con la que necesitas ayuda.

* **pipegarcial159** (1) [526363](https://platzi.com/comentario/526363/) 

	Cordial saludo muy chevere el curso hasta el momento.
	
	Tengo una duda, el profesor glrodasz crea una clase de conexi√≥n y en el Servicio Products en el constructor la inicializa. Al tener varias entidades por ende varios servicios se crea una conexi√≥n por cada constructor, esto puede tener alg√∫n problema en el rendimiento de la aplicaci√≥n?
	
	¬øNo ser√≠a mejor crear una conexi√≥n √∫nica con una especie de singleton desde el punto de inicio de la app en tu caso index.js y en los modelos crear los m√©todos para el manejo del crud directamente para el menejo de los datos?
	
	Quedo muy atento muchas gracias.

	* **glrodasz** [526363] (1)

		Hola Pipe, depende mucho del tipo de aplicaci√≥n pero si, generalmente crear un Singleton es una buena idea para la conexi√≥n de la base de datos. En el curso nos enfocamos mas en la integraci√≥n, pero te recomiendo que lo verifiques en el curso de MongoDB de Platzi.

* **dcortesnet** (1) [525216](https://platzi.com/comentario/525216/) 

	Todo bien el curso a la perfecci√≥n !

* **OscarGuadarrama72** (1) [514862](https://platzi.com/comentario/514862/) 

	El curso de mongoDb parece no existir ¬øalguien sabe algo? o solo esta mal link??  
	Gracias

	* **ebar0n (Platzi)** [514862] (1)

		Hola, en la seccion de carreras puedes ver los cursos de los a√±os pasados de mongo db, probablemente como estan renovando el curso, te aparece fecha proxima de lanzamiento, pero antes de que salga, de igual forma puedes ver los cursos anteriores.

	* **mariandrea (Platzi)** [514862] (1)

		Hola! ac√° puedes acceder al curso <https://platzi.com/cursos/mongodb/>

* **FerJPi** (1) [484183](https://platzi.com/comentario/484183/) 

	Yo hice todo el ejercicio conectado directamente a MongoDB, se evita uno del man-in-the-middle

* **Antonio Luis Gil Rodr√≠guez** (1) [454783](https://platzi.com/comentario/454783/) 

	@glrodasz ¬øPuedes compartir las request de Postman?  
	Thanks!

	* **glrodasz** [454783] (2)

		Hola, voy a hablar para que agreguen los recursos, mientras tanto te comparto esta carpeta: <https://drive.google.com/drive/folders/133qV3HDYfZBrxCJAoyay7WnvO3q1t4V1?usp=sharing>

* **onlinejaime** (1) [69548](https://platzi.com/comentario/758760/) 
¬øPor qu√© no me sale la vista de productos en la web, si todo est√° correcto (obviamente no‚Ä¶)? Conexi√≥n a mongoDB correcta, funciones igual...

	* **glrodasz** [69548] (1)

		¬øTienes el link del repositorio del proyecto?

* **Victor Lozada** (1) [54596](https://platzi.com/comentario/531895/) 
en la linea 57: .updateOne({ _id: ObjectId(id) }, { $set: data }, { upsert: true }) a...

	* **Diego Alexander Forero Higuera (Platzi)** [54596] (3)

		En la documentaci√≥n oficial <https://docs.mongodb.com/manual/reference/method/db.collection.updateOne/> explica como funciona, si no encuentra un documento que cumpla con el filter lo va a crear y si lo encuentra lo actualiza, por defecto es false por lo tanto siempre va a intentar actualizar y si no hay algo que coincida con el filtro va a fallar.

* **Juli√°n Cipagauta** (1) [54413](https://platzi.com/comentario/529652/) 
Una consulta, por m√°s que intento, reviso el c√≥digo y pruebo otros request HTTP, cuando uso el get con tags solo me devuelve []. Ya revis...

	* **Diego Alexander Forero Higuera (Platzi)** [54413] (1)

		Hola comparte tu c√≥digo para ayudarte a encontrar el problema y solucionarlo.

* **pipegarcial159** (1) [54159](https://platzi.com/comentario/526363/) 
Cordial saludo muy chevere el curso hasta el momento. Tengo una duda, el profesor glrodasz crea una clase de conexi√≥n y en el Servicio Pr...

	* **glrodasz** [54159] (1)

		Hola Pipe, depende mucho del tipo de aplicaci√≥n pero si, generalmente crear un Singleton es una buena idea para la conexi√≥n de la base de datos. En el curso nos enfocamos mas en la integraci√≥n, pero te recomiendo que lo verifiques en el curso de MongoDB de Platzi.

* **Antonio Luis Gil Rodr√≠guez** (1) [48466](https://platzi.com/comentario/454783/) 
@glrodasz ¬øPuedes compartir las request de Postman? Thanks!

	* **glrodasz** [48466] (2)

		Hola, voy a hablar para que agreguen los recursos, mientras tanto te comparto esta carpeta: <https://drive.google.com/drive/folders/133qV3HDYfZBrxCJAoyay7WnvO3q1t4V1?usp=sharing>

* **AlexGarrixen** (0) [62580](https://platzi.com/comentario/642563/) 
Hola,estoy implementando socket.io,pero me gustaria saber si es una buena idea implemetarlo asi ? Lo que h...

	* **Diego Alexander Forero Higuera (Platzi)** [62580] (2)

		En teor√≠a no deber√≠as hacer un get adicional, la idea de usar sockets es que cuando se actualiza la informaci√≥n el socket haga push de la informaci√≥n a todos los clientes conectados.

## 0180. Configurar una cuenta en Amazon AWS [15731](https://platzi.com/clases/1437-express-js/15731-configurar-una-cuenta-en-amazon-aws/)

### Descripci√≥n:


Para crear una cuenta en Amazon AWS lo primero que debemos hacer es entrar a <https://aws.amazon.com/es/> y arriba a la derecha hacer click en el bot√≥n de `Inscribirse`.

![amazon-aws-landing.png](https://static.platzi.com/media/user_upload/amazon-aws-landing-532882b7-8f52-4798-ae39-fdabafd77556.jpg)

All√≠ ingregamos los datos como nuestra direcci√≥n de correo, contrase√±a, etc y le damos click en continuar.

![amazon-aws-signup.png](https://static.platzi.com/media/user_upload/amazon-aws-signup-7da08d0b-3ad4-4590-a00d-8acf492c2e19.jpg)

Sigue las instrucciones de la suscripci√≥n, te recomiendo que selecciones en el apartado tipo de cuenta **Personal**.

**Es necesario un n√∫mero de tarjeta de cr√©dito** para poder crear una cuenta de AWS. Amazon no te efectuara ning√∫n cargo siempre y cuando no sobrepases los l√≠mites de la capa gratuita.

**Te recomiendo** que uses una tarjeta cr√©dito prepagada que suelen expirar al a√±o de esta manera si olvidas cambiarla o removerla no incurrir√°s en gastos innecesarios.

El siguiente paso es verificaci√≥n de tu identidad por lo que vas a recibir una llamada de Amazon **generalmente en ingl√©s** pero lo √∫nico que debes hacer es introducir los 4 d√≠gitos que te aparecen en la pantalla durante la llamada.

![amazon-aws-call.png](https://static.platzi.com/media/user_upload/amazon-aws-call-901fd16a-aaad-4d9e-9c99-c3bc46ce6b34.jpg)

Al ingresar los n√∫meros correctos telef√≥nicamente ver√°s una pantalla de √©xito y solo debes darle click en el bot√≥n `Continuar`.

Finalmente te pedir√° elegir el plan que vamos a usar, en este caso seleccionaremos `Gratis`.

![amazon-aws-plan.png](https://static.platzi.com/media/user_upload/amazon-aws-plan-fc2ea14b-d04e-4e73-8724-a3bf23789b59.jpg)

> Tener en cuenta que la capa gratuita solo es v√°lida durante el primer a√±o (12 meses), pero algunos consumos de los servicios permanecen gratuitos para siempre, m√°s informaci√≥n en: <https://aws.amazon.com/es/free/>

Con esto lo √∫nico que hace falta es ingresar a la consola mediante el bot√≥n `Inicie sesi√≥n en la consola` o en la URL <https://console.aws.amazon.com>.

## Uso de los servicios de Amazon AWS

Para empezar a usar los servicios de Amazon es posible que tome al menos 24 horas para que la cuenta este completamente activa, parte del proceso sera una autorizaci√≥n por $1 USD en tu tarjeta de cr√©dito con el fin de verificar si es v√°lida, pero no ser√° cargado ning√∫n valor.

### Comentarios:

* **Daniel .** (3) [475573](https://platzi.com/comentario/475573/) 

	Tambi√©n pueden solicitar una cuenta en amazon educate, adem√°s de la cuenta gratuita tienen acceso a cursos de aws

	* **carlosextra1** [475573] (1)

		Tiene un costo extra?

* **maxhadortiz93** (2) [500321](https://platzi.com/comentario/500321/) 

	Yo uso actualmente heroku, tiene un buen servicio y es economico.

	* **NATALIAGJ** [500321] (1)

		En heroku se pueden desplegar aplicaciones rest?

	* **Giorgio Ventura** [500321] (1)

		Si Natalia, el uso de Heroku es muy f√°cil. En la misma documentaci√≥n te brinda un detalle del paso a paso.

* **carlosextra1** (1) [489660](https://platzi.com/comentario/489660/) 

	Si quiero montar unable aplicacion MEAN . Los servicios que usaria seran siempre gratuitos?

	* **NovoPles** [489660] (5)

		Para montar una aplicaci√≥n MEAN yo suelo usar 3 servicios que son permanentemente gratuitos:
		
		<https://cloud.mongodb.com/> (DB)  
		<https://cloudno.de/> (Backend)  
		<https://www.netlify.com/> (Frontend)

# Middlewares: En el medio del request [3087]

## 0190. Qu√© es un middleware y qu√© tipos existen [15735](https://platzi.com/clases/1437-express-js/15735-que-es-un-middleware-y-que-tipos-existen/)

### Descripci√≥n:


### Comentarios:

* **Eduardo Hidalgo D√≠az Rugama** (4) [449558](https://platzi.com/comentario/449558/) 

	los middlewares que actualmente sufren mantenimiento de express son los siguientes:
	
	<https://expressjs.com/en/resources/middleware.html>
	
	* body-parser
	* compression
	* connect-rid
	* cookie-parser
	* cookie-session
	* cors
	* csurf
	* errorhandler
	* method-override
	* morgan
	* multer
	* response-time
	* serve-favicon
	* serve-index
	* serve-static
	* session
	* timeout
	* vhost
	
	

* **doblesesays** (2) [490335](https://platzi.com/comentario/490335/) 

	<https://expressjs.com/es/guide/using-middleware.html>

* **juand_silva** (1) [689716](https://platzi.com/comentario/689716/) 

	Alg√∫n **middleware 3rd party** de express.js para formatear a XML que me puedan recomendar y lo hayan probado?

## 0200. Manejo de errores usando un middleware [15736](https://platzi.com/clases/1437-express-js/15736-manejo-de-errores-usando-un-middleware/)

### Descripci√≥n:


### Links:

* [Express error handling](http://expressjs.com/en/guide/error-handling.html)

### Comentarios:

* **Antonio Luis Gil Rodr√≠guez** (17) [454808](https://platzi.com/comentario/454808/) 

	Como curiosidad, la palabra ‚ÄúMiddleware‚Äù no tiene plural‚Ä¶ Como ‚ÄúSoftware‚Äù y al parecer todas las palabras que terminan en ‚Äú-ware‚Äù

* **Schenier Aldair L√≥pez Uriarte** (2) [965757](https://platzi.com/comentario/965757/) 

	req.xhr siempre me da `falso` alg√∫n por el cual ocurre esto??

	* **cesar-a-guerron** [965757] (1)

		En el minuto 9:20 te explica la configuraci√≥n para que cambie a true .

* **dcortesnet** (2) [525247](https://platzi.com/comentario/525247/) 

	Que framework recomiendan para agilizar el proceso de construcci√≥n de un api rest? sails es una buena opci√≥n?

	* **ebar0n (Platzi)** [525247] (1)

		Hola, preguntas en NodeJS?
		
		para escribir en Javascript?

	* **Diego Alexander Forero Higuera (Platzi)** [525247] (1)

		Aqu√≠ tienes una lista de varios frameworks que te pueden servir para crear api rest <https://checklyhq.com/blog/2018/12/node.js-api-and-web-frameworks-for-2019/>

* **esdraspavon** (1) [855462](https://platzi.com/comentario/855462/) 

	El template de error:
	``` 
	    extends layout
	    
	    block content
	        .container.main-content
	            article.message.is-danger
	                .message-body
	                    h1.title.has-text-danger= error.message
	                    h2.subtitle.has-text-danger= error.status
	                    if error.stack
	                        pre.content.is-small #{error.stack}
	    
	```

* **Matias Sebastian Perez** (1) [496376](https://platzi.com/comentario/496376/) 

	Importa el orden en el cual paso los error handlers en el index?

	* **cristianc** [496376] (2)

		Si de igual forma que importa el orden en las rutas

* **Mitchell Contreras** (1) [489307](https://platzi.com/comentario/489307/) 
Tengo una duda para levantar el servidor usa el comando $npmd ese es un comando propio o alguna configuraci√≥n del npm?

* **Jos√© Ricardo Romo Guti√©rrez** (1) [475321](https://platzi.com/comentario/475321/) 

	hace como dos clases me aparece un error con el cliente de mongo, descargue la rama correspondiente a esta clase y aun asi persiste el error
	``` 
	    MongoError: MongoClient must be connected before calling MongoClient.prototype.db
	    
	```
	
	por favor me pueden ayudar con eso ?

	* **Jos√© Ricardo Romo Guti√©rrez** [475321] (4)

		update: olvide incluir el archivo .env donde estaban los datos de conexion a la base de datos üòÑ

	* **glrodasz** [475321] (2)

		Me alegro que se pudiese resolver!

* **Jos√© Ricardo Romo Guti√©rrez** (1) [50057](https://platzi.com/comentario/475321/) 
hace como dos clases me aparece un error con el cliente de mongo, descargue la rama correspondiente a esta clase y aun asi persiste el er...

	* **Jos√© Ricardo Romo Guti√©rrez** [50057] (4)

		update: olvide incluir el archivo .env donde estaban los datos de conexion a la base de datos üòÑ

## 0210. Validaci√≥n de datos usando un middleware [15738](https://platzi.com/clases/1437-express-js/15738-validacion-de-datos-usando-un-middleware/)

### Descripci√≥n:


### Links:

* [Closures | MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)

### Comentarios:

* **Pacool84** (1) [1060278](https://platzi.com/comentario/1060278/) 

	Para comprender a fondo los clocures y scopes  
	<https://platzi.com/clases/scope/>

* **chipercristiandi** (1) [949049](https://platzi.com/comentario/949049/) 

	Hola, hay un framework llamado fasitify, el cual realiza este tipo de valicaciones como feature en sus rutas utilizando JSON Schema, ademas de otros features bastante interesantes‚Ä¶ aqu√≠ les dejo un demo <https://dev.to/cristiandi/demo-api-using-fastify-48jo>

* **Wilson Marino Pablo Mendez** (1) [848948](https://platzi.com/comentario/848948/) 

	[video about closure in youtube](https://www.youtube.com/watch?v=dJ3Onk2WRLs)

* **onlinejaime** (1) [747553](https://platzi.com/comentario/747553/) 

	En el v√≠deo he visto los productos‚Ä¶ ¬ø¬ø¬øSe supone que tenemos que pasarlos desde los archivos que nos dio a nuestra base de datos de MongoDB??? Porque no lo dice en ning√∫n momento‚Ä¶ Creo‚Ä¶ ¬ø?

	* **esdraspavon** [747553] (1)

		debes crearlos con el metodo de POST que hicimos en una clase anterior

* **Matias Sebastian Perez** (1) [498208](https://platzi.com/comentario/498208/) 

	Forma de hacer if en una sola linea

* **Matias Sebastian Perez** (1) [498207](https://platzi.com/comentario/498207/) 

	Como se llama esa forma de hacer los if del minuto 2:45

	* **Eduardo Hidalgo D√≠az Rugama** [498207] (6)

		Se llaman ‚Äúoperadores ternarios‚Äù o en ingl√©s ‚Äúternary operator‚Äù.

	* **Matias Sebastian Perez** [498207] (1)

		Muchas gracias!

* **Matias Sebastian Perez** (1) [51974](https://platzi.com/comentario/498207/) 
Como se llama esa forma de hacer los if del minuto 2:45

	* **Eduardo Hidalgo D√≠az Rugama** [51974] (6)

		Se llaman ‚Äúoperadores ternarios‚Äù o en ingl√©s ‚Äúternary operator‚Äù.

## 0220. Implementando Sentry para el manejo de log de errores [15737](https://platzi.com/clases/1437-express-js/15737-implementando-sentry-para-el-manejo-de-log-de-erro/)

### Descripci√≥n:


Para empezar a usar **Sentry** lo primero que debemos hacer es crear una cuenta usando el link <https://sentry.io/signup/>. Para agilizar este paso recomiendo que usen su cuenta de GitHub como m√©todo de inscripci√≥n y sigan los pasos.

Al ingresar al dashboard de Sentry lo que podemos hacer es ir directamente onboarding haciendo click en la alerta amarilla que aparece en la parte superior o mediante el link `https://sentry.io/onboarding/<organizaci√≥n>/`.

![sentry-dashboard.png](https://static.platzi.com/media/user_upload/sentry-dashboard-fde24127-5512-4a17-8499-1a928d4da3f2.jpg)

All√≠ nos pedir√° que seleccionemos un **lenguage** y un **team** , para el lenguaje seleccionaremos `Server > Node.js` le daremos un nombre al proyecto dejaremos el **team** que tiene por defecto y a continuaci√≥n haremos click en `Create Project`.

![sentry-create-project.png](https://static.platzi.com/media/user_upload/sentry-create-project-7743c9ae-f7b2-4096-bd02-70462188613d.jpg)

Despu√©s de ello nos entregara unas instrucciones para configurar Sentry. Lo que haremos es instalar la dependencia de Sentry e inicializar su configuraci√≥n en el archivo `/utils/middlewares/errorsHandlers.js`.

> Recordemos que no debemos dejar ninguna key, secret o identificador quemado en nuestro c√≥digo por lo que la recomendaci√≥n es moverlo a variables de entorno y configuraci√≥n usando el archivo .env.
``` 
    // .env.example y .env
    
    SENTRY_DNS=
    SENTRY_ID=
    
```
``` 
    // config/index.js
    
    require("dotenv").config();
    
    const config = {
      sentryDns: process.env.SENTRY_DNS,
      sentryId: process.env.SENTRY_ID
    };
    
    module.exports = { config: config };
    
```
``` 
    // utils/middlewares/errorsHandlers.js
    
    const Sentry = require("@sentry/node");
    const { config } = require("../../config");
    
    Sentry.init({ dsn: `https://${config.sentryDns}@sentry.io/${config.sentryId}` });
    
```

Y dentro de nuestro middleware `logErrors` agregamos el capturador de errores de Sentry:
``` 
    // utils/middlewares/errorsHandlers.js
    
    function logErrors(err, req, res, next) {
      Sentry.captureException(err);
      console.error(err.stack);
      next(err);
    }
    
```

Le damos click en `All done!` y nos reenviara al dashboard d√≥nde podremos monitorear los errores que ocurren en nuestra aplicaci√≥n.

De esta manera cualquier error que ocurra en nuestra aplicaci√≥n desplegada en producci√≥n estar√° registrado en Sentry y podremos revisarlos y corregirlos proactivamente.

> Si quieres obtener m√°s informaci√≥n sobre c√≥mo capturar eventos y mensajes manualmente puedes consultarlo aqu√≠ <https://docs.sentry.io/error-reporting/capturing/?platform=node>

### Comentarios:

* **Roberto Zapata** (5) [486495](https://platzi.com/comentario/486495/) 

	Las im√°genes de referencia de Sentry no aparecen por un error 404.

	* **mariandrea (Platzi)** [486495] (1)

		corregido, gracias!

* **tzalejo** (3) [549326](https://platzi.com/comentario/549326/) 

	Genial, no conoc√≠a estas tipos de herramientas para el monitoreo de app en producci√≥n‚Ä¶!
	
	pd: dejo un articulo sobre Sentry‚Ä¶  
	[Sentry](https://www.paradigmadigital.com/dev/sentry-aliado-la-monitorizacion-aplicaciones-web/)

* **doblesesays** (2) [490435](https://platzi.com/comentario/490435/) 

	Sentry tambi√©n tiene la opci√≥n de proyectos Express‚Ä¶ Porque no usar ese en lugar de Node?

## 0230. Qu√© es Joi y Boom y c√≥mo configurar Joi [15739](https://platzi.com/clases/1437-express-js/15739-que-es-joi-y-boom-y-como-configurar-joi/)

### Descripci√≥n:


### Links:

* [GitHub - hapijs/joi: Object schema validation](https://github.com/hapijs/joi)

* [joi/API.md at v14.1.0 ¬∑ hapijs/joi ¬∑ GitHub](https://github.com/hapijs/joi/blob/v14.1.0/API.md)

### Comentarios:

* **Marco Antonio Macedo Preciado** (4) [676987](https://platzi.com/comentario/676987/) 

	 **Importante:**  
	Joi ha sido descontinuado y ya no recibe soporte, por lo que seguir us√°ndolo puede provocar errores y fallas en la seguridad.  
	Ha sido remplazado por @hapi/joi, su uso ha cambiado m√°s bien poco.  
	<https://www.npmjs.com/package/@hapi/joi>

	* **onlinejaime** [676987] (2)

		Pues por ese cambio, si sigo al pie de la letra el v√≠deo, me sale el siguiente error en Postman:
		``` 
		    {
		        "err": "Joi.validate is not a function"
		    }```
		    
		    Alguna idea de c√≥mo cambiar lo que dice el v√≠deo a @hapi/joi ???
		```

	* **esdraspavon** [676987] (1)

		al utilizar @hapi/joi, tambien se deben realizar algunos cambios en el codigo:
		``` 
		    schemas/products.js
		    
		    const Joi = require("@hapi/joi");
		    
		    const createProductSchema = Joi.object({
		    	...
		    });
		    
		    const updateProductSchema = Joi.object({
		    	...
		    });
		    
		    
		```
		
		* 
		
		``` 
		    middlewares/validationHandler.js
		    
		    functionvalidate(data, schema) {
		      const { error } = schema.validate(data);
		      returnerror;
		    }
		    
		    
		```

	* **DavidArmandoVelazquez** [676987] (2)

		Los schemas los dejas igual
		``` 
		    const joi = require("@hapi/joi");
		    
		    const projectIdSchema = joi.string().regex(/[0-9a-fA-F]{24}$/);
		    const projectTagSchema = joi.array().items(joi.string().max(30));
		    
		    const createProjectSchema = {
		      name: joi
		        .string()
		        .max(50)
		        .required(),
		      description: joi
		        .string()
		        .min(20)
		        .max(1000000)
		        .required(),
		      image: joi.string().required(),
		      link: joi.string().required(),
		      tags: projectTagSchema
		    };
		    
		    const updateProjetSchema = {
		      name: joi.string().max(50),
		      description: joi
		        .string()
		        .min(20)
		        .max(1000000),
		      image: joi.string(),
		      link: joi.string(),
		      tags: projectTagSchema
		    };
		    
		    module.exports = {
		      projectIdSchema,
		      projectTagSchema,
		      createProjectSchema,
		      updateProjetSchema
		    };
		    
		    
		```
		
		bueno, yo solo modifique los atributos del objeto para que se adapte a el schema que estoy usando.
		
		Lo que cambia es la funcion que retorna el clousure
		``` 
		    functionvalidate(data, schema) {
		      const { error } = joi.object(schema).validate(data);
		      returnerror;
		    }
		    
		```
		
		espero te sirva

* **Fernando Azuaje** (2) [559026](https://platzi.com/comentario/559026/) 

	Hola esta brutal este curso, pero hasta ahora me encuentro con una duda, exactamente en que consiste parametro que le pasamos al metodo regex() ?
	``` 
	    regex(/^[0-9a-fA-F]{24}$/)```
	    
	```

	* **Daniel Ram√≠rez Mendoza** [559026] (5)

		El regex es de expresiones regulares lo que quiere decir ^[0-9a-fA-F] es que el string puede tener valores del 0-9 y de la a-f sea min√∫sculas o may√∫sculas esto es porque el valor est√° en haxadecimal (0-f) y {24} es que debe tener una longitud de 24 caracteres. te recomiendo est√° pagina para que escribas tus expresiones y veas que vas a obtener: <https://regexr.com/>

* **Erick Lugo** (2) [457052](https://platzi.com/comentario/457052/) 

	¬øComo se llama el plugin que utilizas en VS Code para se√±alar el cuerpo de las funciones (la linea amarilla) ?
	
	Saludos.

	* **glrodasz** [457052] (7)

		Se llama **Bracket Pair Colorizer**

	* **Erick Lugo** [457052] (1)

		@glrodasz Gracias! üòÉ

* **Fernando Azuaje** (2) [56978](https://platzi.com/comentario/559026/) 
Hola esta brutal este curso, pero hasta ahora me encuentro con una duda, exactamente en que consiste parametro que le pasamos al metodo r...

	* **Daniel Ram√≠rez Mendoza** [56978] (5)

		El regex es de expresiones regulares lo que quiere decir ^[0-9a-fA-F] es que el string puede tener valores del 0-9 y de la a-f sea min√∫sculas o may√∫sculas esto es porque el valor est√° en haxadecimal (0-f) y {24} es que debe tener una longitud de 24 caracteres. te recomiendo est√° pagina para que escribas tus expresiones y veas que vas a obtener: <https://regexr.com/>

* **Brayan Murcia Sanchez** (1) [670205](https://platzi.com/comentario/670205/) 

	me esta trabajando bien la validacion de campos, pero cyuando recibo una repsuesta me llega un html completo, no me esta enviando el json como error, alguna idea del porque?  
	![](https://ibb.co/ftcP284)

	* **Brayan Murcia Sanchez** [670205] (1)

		<https://ibb.co/ftcP284>

	* **mariaguadalupelopezflores79** [670205] (3)

		No se si resolvieron tu duda pero tendr√≠as que a√±adir la cabecera X-Requested-With y el valor XMLHttpRequest para que te regrese la respuresta como json.

* **tzalejo** (1) [549389](https://platzi.com/comentario/549389/) 

	La verdad que este curso, me esta ayudando mucho‚Ä¶ @glrodasz los paquetes que usas en el curso son muy buenos, interesantes y √∫tiles. Creo que voy a empezare hacer alg√∫n documente con la descripci√≥n de cada uno, as√≠ a la hora de empezar un proyecto tener un panorama de que paquetes necesitare.  
	Saludos.

* **pedroumba** (1) [530181](https://platzi.com/comentario/530181/) 

	La validacion de rpoductID, tambien se puede hacer con:
	``` 
	    joi.string().hex().length(24)
	    
	```

* **Diego Andres Imbus Guzman** (1) [494331](https://platzi.com/comentario/494331/) 

	Cuando quiero implementar un esquema con m√°s de 6 elementos me sale el siguiente error AssertionError [ERR_ASSERTION]: Invalid schema content: me podr√≠an ayudar por favor?

	* **Diego Andres Imbus Guzman** [494331] (1)

		aparentemente usar palabras reservadas de Joi como ‚Äòemail‚Äô o ‚Äòimage‚Äô genera error

* **Antonio Luis Gil Rodr√≠guez** (1) [455101](https://platzi.com/comentario/455101/) 

	Creo que un error de validaci√≥n deber√≠a devolver el status 400 ‚ÄúBad request‚Äù en vez de un 500. Se puede especificar el statusCode para que lo coja el errorHandler?

	* **Antonio Luis Gil Rodr√≠guez** [455101] (3)

		Ok, ya vi que se implement√≥ este cambio en el siguiente video con Boom. üòâ

## 0240. Configurando Boom y nuestra p√°gina 404 [15740](https://platzi.com/clases/1437-express-js/15740-configurando-boom-y-nuestra-pagina-404/)

### Descripci√≥n:


### Links:

* [GitHub - hapijs/boom: HTTP-friendly error objects](https://github.com/hapijs/boom)

* [Understanding Browser HTTP Accept Headers: Firefox, Internet Explorer, Opera, and WebKit (Safari / Chrome)](https://www.newmediacampaigns.com/blog/browser-rest-http-accept-headers)

### Comentarios:

* **jesus-olivares661** (2) [1014765](https://platzi.com/comentario/1014765/) 

	Me hubiera Gustado que los comentarios que agrega en el c√≥digo de los videos tambien estuvieran en el c√≥digo que bajamos en la seccion de enlaces.

* **tzalejo** (2) [550014](https://platzi.com/comentario/550014/) 

	Buenas este video se me complico un poco‚Ä¶con conceptos que que no conozco, por ejemplo:  
	1-mutar  
	2- return {‚Ä¶err,stack}  
	3-rapeado(no estoy seguro como se escribe): si esta instanciado boom???  
	4- const {  
	output: {statusCode, payload}  
	} = err;  
	que hace?  
	desde ya muchas gracias!pido disculpa si son conceptos b√°sico que estoy desconociendo.  
	Saludos.

	* **marcelobaez** [550014] (8)

		Primero de todo te recomiendo que si te cuestan algunos conceptos del lenguaje, tomes el curso de Fundamentos de Javascript (por cierto esta fenomenal!). Asi y todo voy a intentar despejarte algunas dudas:  
		1 y 2 - Mutar significa cambiar/alterar. La inmutabilidad es uno de los pilares de la programaci√≥n Funcional, por ello el profesor recomienda utilizar el spread operator de Javascript para generar un nuevo objeto y a la vez indica la equivalencia de utilizar Object.assign.  
		3 - Wrappear es ‚Äúenvolver‚Äù.  
		4 - Object destructuring es una caracteristica a√±adida a ECMAScript 2015. El profe aprovecha esto para generar un objeto a partir de las propiedades de otro existente.
		
		Espero haber podido orientarte un poco mas

* **tzalejo** (2) [56225](https://platzi.com/comentario/550014/) 
Buenas este video se me complico un poco‚Ä¶con conceptos que que no conozco, por ejemplo: 1-mutar 2- return {‚Ä¶err,stack} 3-rapeado(no estoy...

	* **marcelobaez** [56225] (8)

		Primero de todo te recomiendo que si te cuestan algunos conceptos del lenguaje, tomes el curso de Fundamentos de Javascript (por cierto esta fenomenal!). Asi y todo voy a intentar despejarte algunas dudas:  
		1 y 2 - Mutar significa cambiar/alterar. La inmutabilidad es uno de los pilares de la programaci√≥n Funcional, por ello el profesor recomienda utilizar el spread operator de Javascript para generar un nuevo objeto y a la vez indica la equivalencia de utilizar Object.assign.  
		3 - Wrappear es ‚Äúenvolver‚Äù.  
		4 - Object destructuring es una caracteristica a√±adida a ECMAScript 2015. El profe aprovecha esto para generar un objeto a partir de las propiedades de otro existente.
		
		Espero haber podido orientarte un poco mas

* **onlinejaime** (1) [758789](https://platzi.com/comentario/758789/) 

	Lo peor no son los miles de errores que salen y que ni se comentan‚Ä¶ El problema es que te descargas la carpeta ‚Äòmaster‚Äô para ver d√≥nde puedes tener el error y‚Ä¶ Ni siquiera funciona!!!
	
	Esto es lo que aparece cuando intentas levantar la app que viene de la carpeta del profe‚Ä¶
	``` 
	    [nodemon] 1.18.6
	    [nodemon] to restart at any time, enter `rs`
	    [nodemon] watching: *.*
	    [nodemon] starting `node index index.js`    
	    events.js:183
	          throw er; // Unhandled 'error' event
	          ^
	    
	    Error: listen EADDRINUSE :::8000
	        at Object._errnoException (util.js:992:11)
	    at _exceptionWithHostPort (util.js:1014:20)
	    at Server.setupListenHandle [as _listen2] (net.js:1355:14)
	    at listenInCluster (net.js:1396:12)
	    at Server.listen (net.js:1480:7)
	    at Function.listen (C:\platzi-express-configurando-boom-y-nuestra-pagina-404\ecommerce\node_modules\express\lib\application.js:618:24)
	    at Object.<anonymous> (C:\platzi-express-configurando-boom-y-nuestra-pagina-404\ecommerce\index.js:58:20)
	    at Module._compile (module.js:652:30)
	    at Object.Module._extensions..js (module.js:663:10)
	    at Module.load (module.js:565:32)
	    [nodemon] app crashed - waiting for file changes before starting...
	    
	```

* **David Vargas Dom√≠nguez** (1) [462068](https://platzi.com/comentario/462068/) 

	Cuando hago un request a la api para que me salga 404 sucede que estos dos me salen falsos !req.accepts(‚Äúhtml‚Äù) || req.xhr; y hace render a la p√°gina 404 en vez de darme el json
	
	Ser√° una configuraci√≥n de postman?
	``` 
	    app.use(function(req, res, next) {
	      if (isRequestAjaxOrApi(req)) {
	        const {
	          output: { statusCode, payload }
	        } = boom.notFound();
	    
	        res.status(statusCode).json(payload);
	      }
	    
	      res.status(404).render("404");
	    });
	    
	    functionisRequestAjaxOrApi(req) {
	      console.log(req.xhr);
	    
	      return !req.accepts("html") || req.xhr;
	    }
	    
	    module.exports = isRequestAjaxOrApi;
	    
	    
	```

	* **glrodasz** [462068] (4)

		Para que **req.xhr** se marque como verdadero, necesitas agregar el header: `X-Requested-With: XMLHttpRequest` en tu peticion de postman.
		
		Para que **!req.accepts(‚Äúhtml‚Äù)** se marque como verdadero, necesitas agregar en el header: `Content-Type: application/json`.
		
		Cuando usas librerias de AJAX, como jQuery.ajax, axios, etc. generalmente suelen agregar el segundo header por ti, ya que por defecto esperan una respuesta de tipo JSON.

## 0250. Middlewares populares [15742](https://platzi.com/clases/1437-express-js/15742-middlewares-populares/)

### Descripci√≥n:


### Links:

* [Express body-parser middleware](http://expressjs.com/en/resources/middleware/body-parser.html)

* [Express cors middleware](http://expressjs.com/en/resources/middleware/cors.html)

* [Express morgan middleware](http://expressjs.com/en/resources/middleware/morgan.html)

* [GitHub - helmetjs/helmet: Help secure Express apps with various HTTP headers](https://github.com/helmetjs/helmet)

* [GitHub - devoidfury/express-debug: Debug toolbar middleware for developing applications in express (node.js)](https://github.com/devoidfury/express-debug)

* [GitHub - ericf/express-slash: Express middleware for people who are anal about trailing slashes.](https://github.com/ericf/express-slash)

* [GitHub - jaredhanson/passport: Simple, unobtrusive authentication for Node.js.](https://github.com/jaredhanson/passport)

### Comentarios:

* **Damian Spizzirri** (2) [708826](https://platzi.com/comentario/708826/) 

	En la documentacion de express-slash me encontre con esto
	
	* If you‚Äôre a good person, then you enable Express‚Äô ‚Äústrict routing‚Äù because you understand the difference between /about and /about/
	
	* // Because you‚Äôre the type of developer who cares about this sort of thing!  
	`app.enable('strict routing');`
	
	
	
	
	Jajajaja este tipo tiene que ser mi amigo.
	
	[](https://www.npmjs.com/package/express-slash)

* **David Behar** (1) [1069206](https://platzi.com/comentario/1069206/) 

	## Middlewares populares de express:
	
	* express.json o body-parser.json: Sirve para que nuestras requests entiendan json
	* cors: Middleware de seguridad que sirve para que los requests sean aceptados de ciertos dominios espec√≠ficos
	* morgan: Middleware para el manejo de logs
	* helmet: Middleware de seguridad
	* express-debug: El debugger predeterminado de express para debuggear tu aplicaci√≥n
	* express-slash: Permite aceptar urls sin el slash (‚Äô/‚Äô)
	* passport: Para autentifaci√≥n y autorizaci√≥n
	
	

* **juand_silva** (1) [689811](https://platzi.com/comentario/689811/) 

	Hola, alguien sabe de alg√∫n middleware para hacer peticiones en XML?

* **Alvaro   Gonzalez** (1) [448094](https://platzi.com/comentario/448094/) 

	Cuando consumo mi api desde un mobile, cual seria el origen, y como puedo permitir esos request ‚Ä¶?

	* **glrodasz** [448094] (2)

		Cada lenguaje nativo (Java/Swift) tiene sus librerias para hacer request HTTP. CORS es un mecanismo que solo aplica para peticiones que se hacen desde un navegador por lo que no tendrias problemas en mobile.
		
		M√°s info sobre HTTP request:  
		<https://developer.apple.com/documentation/foundation/urlrequest>  
		<https://developer.android.com/training/volley/simple>

# Autenticaci√≥n en Express.js [3088]

## 0260. JSON Web Tokens [15741](https://platzi.com/clases/1437-express-js/15741-json-web-tokens/)

### Descripci√≥n:
Aprenderemos que es un JSON Web token y como esta construido.

### Comentarios:

* **herbert vargas** (5) [539120](https://platzi.com/comentario/539120/) 

	hola, creo que este video deberia ir de primero en el modulo

	* **ebar0n (Platzi)** [539120] (1)

		Hola, gracias por tu sugerencia, puedes escribirla a [team@platzi.com](mailto:team@platzi.com)

	* **mariandrea (Platzi)** [539120] (2)

		Hola! tienes toda la raz√≥n, ya qued√≥ corregido el orden

* **SaFeRamirez** (2) [65051](https://platzi.com/comentario/685340/) 
¬øNo es mejor encriptar el JWT? Para que no pueda ver la info nadie diferente a las personas autorizadas.

	* **Eduardo Hidalgo D√≠az Rugama** [65051] (2)

		si. Justamente la p√°gina oficial de JWT habla sobre ello. El payload y el header son visibles, pero no puedes hace uso del token.
		
		Lo ideal es pasar tu token entero por un sistema de encriptaci√≥n para resguardar los datos sensibles.
		
		<https://jwt.io/introduction/>

* **Andres Roberto Coello Goyes** (1) [946571](https://platzi.com/comentario/946571/) 

	**<https://jwt.io/>**

* **Jos√© Ricardo Romo Guti√©rrez** (1) [475687](https://platzi.com/comentario/475687/) 

	tengo que averiguar mas acerca de los jwt

	* **glrodasz** [475687] (1)

		Cualquier pregunta/duda me lo puedes dejar saber.

	* **Carlos Enrique Gonzalez Pe√±a** [475687] (5)

		Mira el curso de OAuth 2.0 el cual tambi√©n es de Guillermo, aqu√≠ explica tambi√©n los JWT y nos ense√±a a implementarlos sin el uso de passport, asimismo tambi√©n esta el curso de Node Avanzado donde tambi√©n los utilizamos de una manera distinta pero similar con el profe Julian

## 0270. Configuraci√≥n y uso de Passport.js [15744](https://platzi.com/clases/1437-express-js/15744-configuracion-y-uso-de-passportjs/)

### Descripci√≥n:


### Links:

* [Passport.js](http://www.passportjs.org/)

* [passport-http](http://www.passportjs.org/packages/passport-http)

* [GitHub - kelektiv/node.bcrypt.js: bcrypt for NodeJs](https://github.com/kelektiv/node.bcrypt.js#usage)

* [GitHub - glrodasz/platzi-express at configuracion-y-uso-de-passportjs](https://github.com/glrodasz/platzi-express/tree/configuracion-y-uso-de-passportjs)

### Comentarios:

* **Daniel .** (13) [475839](https://platzi.com/comentario/475839/) 

	Para evitar la fatiga
	``` 
	    npm i -S passport passport-http passport-jwt jsonwebtoken bcrypt
	    
	    
	```

* **Juan Camilo Angel Fandi√±o** (4) [579797](https://platzi.com/comentario/579797/) 

	Para generar el JWT_SECRET:
	``` 
	    node-e"console.log(require('crypto').randomBytes(256).toString('base64'));"```
	    
	```

* **crarrivillaga** (3) [477021](https://platzi.com/comentario/477021/) 

	Que tal, alguien mas ha tenido problemas al instalar bcrypt?
	
	Al ejecutar el comando me aparece este error. Es algo largo pero bueno x.x
	
	`> bcrypt@3.0.3 install C:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt
	
	> node-pre-gyp install --fallback-to-build
	
	node-pre-gyp WARN Using needle for node-pre-gyp https download  
	node-pre-gyp WARN Tried to download(404): <https://github.com/kelektiv/node.bcrypt.js/releases/download/v3.0.3/bcrypt_lib-v3.0.3-node-v57-win32-x64-unknown.tar.gz>  
	node-pre-gyp WARN Pre-built binaries not found for bcrypt@3.0.3 and node@8.11.2 (node-v57 ABI, unknown) (falling back to source compile with node-gyp)  
	gyp ERR! configure error  
	gyp ERR! stack Error: Command failed: C:\Users\Carlos\AppData\Local\Programs\Python\Python36-32\python.EXE -c import sys; print ‚Äú%s.%s.%s‚Äù % sys.version_info[:3];  
	gyp ERR! stack File ‚Äú<string>‚Äù, line 1  
	gyp ERR! stack import sys; print ‚Äú%s.%s.%s‚Äù % sys.version_info[:3];  
	gyp ERR! stack ^  
	gyp ERR! stack SyntaxError: invalid syntax  
	gyp ERR! stack  
	gyp ERR! stack at ChildProcess.exithandler (child_process.js:275:12)  
	gyp ERR! stack at emitTwo (events.js:126:13)  
	gyp ERR! stack at ChildProcess.emit (events.js:214:7)  
	gyp ERR! stack at maybeClose (internal/child_process.js:925:16)  
	gyp ERR! stack at Process.ChildProcess._handle.onexit (internal/child_process.js:209:5)  
	gyp ERR! System Windows_NT 10.0.17134  
	gyp ERR! command ‚ÄúC:\Program Files\nodejs\node.exe‚Äù ‚ÄúC:\Users\Carlos\AppData\Roaming\npm\node_modules\npm\node_modules\node-gyp\bin\node-gyp.js‚Äù ‚Äúconfigure‚Äù ‚Äú‚Äìfallback-to-build‚Äù ‚Äú‚Äìmodule=C:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt\lib\binding\bcrypt_lib.node‚Äù ‚Äú‚Äìmodule_name=bcrypt_lib‚Äù ‚Äú‚Äìmodule_path=C:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt\lib\binding‚Äù ‚Äú‚Äìnapi_version=3‚Äù ‚Äú‚Äìnode_abi_napi=napi‚Äù ‚Äú‚Äìnapi_build_version=0‚Äù "‚Äìnode_napi_label=node-v57"  
	gyp ERR! cwd C:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt  
	gyp ERR! node -v v8.11.2  
	gyp ERR! node-gyp -v v3.8.0  
	gyp ERR! not ok  
	node-pre-gyp ERR! build error  
	node-pre-gyp ERR! stack Error: Failed to execute ‚ÄòC:\Program Files\nodejs\node.exe C:\Users\Carlos\AppData\Roaming\npm\node_modules\npm\node_modules\node-gyp\bin\node-gyp.js configure --fallback-to-build --module=C:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt\lib\binding\bcrypt_lib.node --module_name=bcrypt_lib --module_path=C:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt\lib\binding --napi_version=3 --node_abi_napi=napi --napi_build_version=0 --node_napi_label=node-v57‚Äô (1)  
	node-pre-gyp ERR! stack at ChildProcess.<anonymous> (C:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt\node_modules\node-pre-gyp\lib\util\compile.js:83:29)  
	node-pre-gyp ERR! stack at emitTwo (events.js:126:13)  
	node-pre-gyp ERR! stack at ChildProcess.emit (events.js:214:7)  
	node-pre-gyp ERR! stack at maybeClose (internal/child_process.js:925:16)  
	node-pre-gyp ERR! stack at Process.ChildProcess._handle.onexit (internal/child_process.js:209:5)  
	node-pre-gyp ERR! System Windows_NT 10.0.17134  
	node-pre-gyp ERR! command ‚ÄúC:\Program Files\nodejs\node.exe‚Äù ‚ÄúC:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt\node_modules\node-pre-gyp\bin\node-pre-gyp‚Äù ‚Äúinstall‚Äù "‚Äìfallback-to-build"  
	node-pre-gyp ERR! cwd C:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt  
	node-pre-gyp ERR! node -v v8.11.2  
	node-pre-gyp ERR! node-pre-gyp -v v0.12.0  
	node-pre-gyp ERR! not ok  
	Failed to execute ‚ÄòC:\Program Files\nodejs\node.exe C:\Users\Carlos\AppData\Roaming\npm\node_modules\npm\node_modules\node-gyp\bin\node-gyp.js configure --fallback-to-build --module=C:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt\lib\binding\bcrypt_lib.node --module_name=bcrypt_lib --module_path=C:\xampp\htdocs\platzi-expressjs\ecommerce\node_modules\bcrypt\lib\binding --napi_version=3 --node_abi_napi=napi --napi_build_version=0 --node_napi_label=node-v57‚Äô (1)  
	npm WARN ecommerce@1.0.0 No description  
	npm WARN ecommerce@1.0.0 No repository field.  
	npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.4 (node_modules\fsevents):  
	npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.2.4: wanted {‚Äúos‚Äù:‚Äúdarwin‚Äù,‚Äúarch‚Äù:‚Äúany‚Äù} (current: {‚Äúos‚Äù:‚Äúwin32‚Äù,‚Äúarch‚Äù:‚Äúx64‚Äù})
	
	npm ERR! code ELIFECYCLE  
	npm ERR! errno 1  
	npm ERR! bcrypt@3.0.3 install: `node-pre-gyp install --fallback-to-build`npm ERR! Exit status 1  
	npm ERR!  
	npm ERR! Failed at the bcrypt@3.0.3 install script.  
	npm ERR! This is probably not a problem with npm. There is likely additional logging output above.  
	npm ERR! A complete log of this run can be found in:  
	npm ERR! C:\Users\Carlos\AppData\Roaming\npm-cache_logs\2019-01-13T03_57_45_176Z-debug.log`
	
	Gracias de antemano.

	* **crarrivillaga** [477021] (3)

		Para los que tengan un error igual o similar a este, estuve buscando en Google y vi que recomendaban esta dependencia <https://www.npmjs.com/package/bcryptjs>
		
		Aparentemente es la misma que la que se usa en el video

	* **crloshro** [477021] (1)

		Compa√±ero primero debes ingresar al powershell o al cmd en modo administrador y ejecutar este codigo:
		
		npm install --global --production windows-build-tools
		
		y luego si instalar bcrypt cualquier info aqui esta :
		
		[](https://github.com/kelektiv/node.bcrypt.js/wiki/Installation-Instructions#microsoft-windows)

	* **crloshro** [477021] (1)

		<https://github.com/kelektiv/node.bcrypt.js/wiki/Installation-Instructions#microsoft-windows>

* **saidcortescalderon** (2) [592814](https://platzi.com/comentario/592814/) 

	Al ver la documentacion de boom dicen que el m√≥dulo se ha movido y ahora est√° disponible en @hapi / boom.  
	como puedo Actualizar las dependencias?  
	ya que esta versi√≥n ya no se mantiene y puede contener errores y problemas de seguridad.

	* **glrodasz** [592814] (1)

		Tendrias que remover boom con `npm remove boom`, instalar esta nueva version: `npm install @hapi/boom` remplazar donde la estes importando ahora por @hapi/boom: `import boom from '@hapi/boom'`

* **Willian de la Espriella** (2) [564278](https://platzi.com/comentario/564278/) 

	si el tiempo de expiraci√≥n maximo del jwt debe ser de 15m, como se pueden mantener la session de usuarios en ejemplo una app movil?, para que el usuario no tenga que logearse a cada rato

	* **Angel Hernandez** [564278] (1)

		F√°cil üòÑ lo que debes hacer es actualizar el token cada vez que el usuario env√≠e o reciba informaci√≥n, de esta manera el token solo se vencer√° cuando el usuario por ejemplo cierre la app o se quede sin Internet, se vencer√°n los 15 minutos, el token no ser√° actualizado y deber√° iniciar sesi√≥n de nuevo

	* **glrodasz** [564278] (1)

		Hola @willian-de-la-espriella para ellos lo que puedes usar es refresh tokens:
		
		<https://auth0.com/docs/tokens/refresh-token/current>  
		<https://oauth.net/2/grant-types/refresh-token/>

* **SaFeRamirez** (2) [65126](https://platzi.com/comentario/686374/) 
¬øCu√°l es la mejor pr√°ctica para actualizar el token autom√°ticamente? ¬øEso de cambiar el token cada vez que se pida info o se envi√© es v√°l...

	* **glrodasz** [65126] (1)

		Si, es una manera de hacerlo, hay una tecnica que se llama refresh tokens o otra llamada Silent Auth. Aqu√≠ hay un ejemplo de refresh tokens: <https://solidgeargroup.com/refresh-token-with-jwt-authentication-node-js>

* **saidcortescalderon** (2) [59554](https://platzi.com/comentario/592814/) 
Al ver la documentacion de boom dicen que el m√≥dulo se ha movido y ahora est√° disponible en @hapi / boom. como puedo Actualizar las depen...

	* **glrodasz** [59554] (1)

		Tendrias que remover boom con `npm remove boom`, instalar esta nueva version: `npm install @hapi/boom` remplazar donde la estes importando ahora por @hapi/boom: `import boom from '@hapi/boom'`

* **Willian de la Espriella** (2) [57381](https://platzi.com/comentario/564278/) 
si el tiempo de expiraci√≥n maximo del jwt debe ser de 15m, como se pueden mantener la session de usuarios en ejemplo una app movil?, para...

	* **Angel Hernandez** [57381] (1)

		F√°cil üòÑ lo que debes hacer es actualizar el token cada vez que el usuario env√≠e o reciba informaci√≥n, de esta manera el token solo se vencer√° cuando el usuario por ejemplo cierre la app o se quede sin Internet, se vencer√°n los 15 minutos, el token no ser√° actualizado y deber√° iniciar sesi√≥n de nuevo

* **Andres Roberto Coello Goyes** (1) [946713](https://platzi.com/comentario/946713/) 

	```
	    constboom = require("@hapi/boom");
	    
	```

* **Wilson Marino Pablo Mendez** (1) [852625](https://platzi.com/comentario/852625/) 

	Yo use
	``` 
	    npm install -S bcryptjs
	    
	```
	
	Por el momento todo anda bien

* **jjorgewill** (1) [672962](https://platzi.com/comentario/672962/) 

	Holla, tal vez a alguien le suceda, yo tube que modificar el codigo del api/auth.js debido a que cuando el usuario estaba mal me salia  
	(node:32704) UnhandledPromiseRejectionWarning: TypeError: Cannot read property ‚Äòusername‚Äô of undefined
	``` 
	    api.post("/token", async function(req, res, next) {
	      passport.authenticate("basic", function(error, user) { 
	        try {
	          if (error || !user) {
	            next(boom.unauthorized());
	            return res.status(401).json({ error: "Unauthorized" });
	          }else{
	            req.login(user, { session: false }, async function(error) {
	              if (error) {
	                next(error);
	              }
	              const payload = { sub: user.username, email: user.email };
	              const token = jwt.sign(payload, config.authJwtSecret, {
	                expiresIn: "15m"
	              });
	    
	              return res.status(200).json({ access_token: token });
	            });
	    
	          }
	        } catch (error) {
	          next(error);
	        }
	      })(req, res, next);
	    });
	    
	    
	```

	* **huascarm** [672962] (2)

		pero para que poner return res.status ‚Ä¶ (si con next(boom.unathorized) ya estamos enviando el error al errorHandlers)
		
		yo simplemente puse return;
		``` 
		    api.post('/token', (req, res, next)=>{
		    	passport.authenticate('basic', (err, user)=>{
		    		try {
		    			if(err || !user){
		    				next(boom.unauthorized());
		    				return;
		    			}
		    
		```

* **Matias Sebastian Perez** (1) [500824](https://platzi.com/comentario/500824/) 

	No entiendo que es lo que sucede cuando se escribe esto
	
	`passport.authenticate( bla - bla - bla )( req, res, next );`

* **Mitchell Contreras** (1) [492051](https://platzi.com/comentario/492051/) 

	Nos podrias dar el nombre de los componentes vscode que usas, en este caso estoy interesado en: el que muestra la ruta del directorio de los archivos y con el que haces la busqueda para el require

	* **Matias Sebastian Perez** [492051] (3)

		El addon de la busqueda para el require se llama Relative Path

	* **Julio J Y√©pez** [492051] (1)

		Ctrl + P √≥ Cmd + P

* **Mitchell Contreras** (1) [491875](https://platzi.com/comentario/491875/) 

	Alguien ha tenido un error al ejecutar el seed.  
	me aparece ‚ÄúMongoError: collection name must be a String‚Äù pero es como algo interno de la dependencia mongodb. porque revisando los parametros del proyecto funciona.  
	creo que es algo del metodo find de la implementaci√≥n. üò¶

	* **Brayan Murcia Sanchez** [491875] (1)

		hola, se que es un poco tarde pero, este problema esta indicando que antes de realizar la consulta debe asegurarse que la conexi√≥n se realice al storage de mongo, y esto es por la URI, por alg√∫n motivo que aun desconozco, la version gratuta solo me permitio la conexion cin la URI version 2.2 de NODE, en el aparado de CONNECTION-FROM APP en el cluster le deja copiar el URI completo segun la version, esta seleccionada por default la 3.0, a mi me genero este.
		``` 
		    const MONGO_URI = `mongodb://${USER}:${PASSWORD}@artaxcluster-shard-00-00-sm9be.mongodb.net:27017,artaxcluster-shard-00-01-sm9be.mongodb.net:27017,artaxcluster-shard-00-02-sm9be.mongodb.net:27017/test?ssl=true&replicaSet=ArtaxCluster-shard-0&authSource=admin&retryWrites=true&w=majority`
		    
		```

* **Carlos Enrique Gonzalez Pe√±a** (1) [451922](https://platzi.com/comentario/451922/) 

	Hola  
	Cual es la utilidad de Boom? veo que la requieres en la parte de arriba.

	* **Exequiel Quiroga** [451922] (2)

		Es una utilidad para el manejo de errores. [Boom](https://github.com/hapijs/boom)

	* **Carlos Enrique Gonzalez Pe√±a** [451922] (1)

		Gracias!

	* **glrodasz** [451922] (3)

		Si, en la clase de manejo de errores vemos un ejemplo y su implementacion.

* **Alver Ortega** (1) [81580](https://platzi.com/comentario/984599/) 
si yo tengo una api que se consume desde una app y web cual es la mejor manera de ponerla segura teniendo en cuenta que desde la web no s...

	* **Angel Hernandez** [81580] (1)

		Usando certificados de seguridad SSL, es lo mas practico, tambien puedes usar algun cifrado de punto a punto para asegurar aun mas la conexion

* **Schenier Aldair L√≥pez Uriarte** (1) [80951](https://platzi.com/comentario/970063/) 
No lo entiendo‚Ä¶ Se supone que el ‚Äúsecreto‚Äù de JWT es el que hace que la firma del mismo sea v√°lido o no, pues he pegado el token que me o...

* **Ezequiel Salda√±a** (1) [76553](https://platzi.com/comentario/889263/) 
Veo que se declaran 2 funciones con async, pero no veo que se use await. Faltan esos awaits?

* **Carlos Enrique Gonzalez Pe√±a** (1) [48192](https://platzi.com/comentario/451922/) 
Hola Cual es la utilidad de Boom? veo que la requieres en la parte de arriba.

	* **Exequiel Quiroga** [48192] (2)

		Es una utilidad para el manejo de errores. [Boom](https://github.com/hapijs/boom)

## 0280. Asegurando nuestra API e identificando rutas sensibles [15743](https://platzi.com/clases/1437-express-js/15743-asegurando-nuestra-api-e-identificando-rutas-sensi/)

### Descripci√≥n:


### Links:

* [GitHub - auth0/node-jsonwebtoken: JsonWebToken implementation for node.js http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html](https://github.com/auth0/node-jsonwebtoken#usage)

* [Documentation](http://www.passportjs.org/docs/)

* [passport-jwt](http://www.passportjs.org/packages/passport-jwt/)

### Comentarios:

* **doblesesays** (3) [491790](https://platzi.com/comentario/491790/) 

	Cuando se usa DELETE la variable productId queda con un identificador que ya no existe en la bd, as√≠ que se debe cambiar para poder usar esa variable en los otros request, entre las formas de automatizar eso me pareci√≥ mejor agregar el siguiente script en el POST (crear) product:
	
	`const jsonData = JSON.parse(responseBody); pm.environment.set("productId", jsonData.data);`
	
	As√≠ cuando se hace POST se setea autom√°ticamente la variable productId con el identificador del producto creado.
	
	Otra forma es agregando un script en el DELETE para que haga una consulta a todos los product y le setee el primero eje: [product]
	``` 
	    consturl = pm.variables.get("url");
	    pm.sendRequest(url+"/api/products", function (err, response) {
	        const [product] = response.json().data;
	        if (product) {
	            pm.environment.set("productId", product._id);
	        }
	    });```
	    
	```

	* **onlinejaime** [491790] (1)

		¬øPuedes decir d√≥nde exactamente ir√≠a ese c√≥digo?

* **Pacool84** (2) [1060665](https://platzi.com/comentario/1060665/) 

	Aqui clases que ayudaran a la autentificacion con redes sociales
	
	<https://platzi.com/clases/1649-passport/22003-autenticacion-con-google-usando-openid-connect/>
	
	<https://platzi.com/clases/1649-passport/22005-autenticacion-con-twitter/>
	
	<https://platzi.com/clases/1649-passport/22006-autenticacion-con-facebook/>

* **Francisco Soto** (2) [885660](https://platzi.com/comentario/885660/) 

	Hola estimado,una consulta como puedo hacer para que mis peticiones utilizando fetch o axios desde mi backend a una API externa vallan actualizando cada vez que allan nuevos datos o cambios desde la API externa?.
	
	Las peticiones est√°n siempre a la escucha de los cambios?
	
	Gracias

	* **Schenier Aldair L√≥pez Uriarte** [885660] (1)

		Si la APi es tuya puedes realizar t√∫ mismo la conexi√≥n con tu backend para ‚Äònotificar‚Äô de que hay nuevos cambios. Si no es el caso lo suyo ser√≠a que est√©s constantemente haciendo ‚Äòfetch‚Äô a la APi para traer los datos, ¬øEl problema? Que se har√≠an peticiones incluso cuando no hay cambios. La verdad esto es algo que yo tambi√©n tengo en dudas en c√≥mo se har√≠a pero no le he encontrado ninguna otra manera, si ves que encuentras algo podr√≠as tambi√©n compartir algo de c√≥digo para ver c√≥mo lo has hecho.  
		Saludos!

* **gosunkugi** (2) [658876](https://platzi.com/comentario/658876/) 

	virgen santa ‚Ä¶ estoy mareado ~__~  
	a ver cuando este desarrollando mi app les cuento c√≥mo me va

	* **Wilson Marino Pablo Mendez** [658876] (1)

		X2 en los √∫ltimos minutos del video jajajaja

* **Armando122333** (2) [492326](https://platzi.com/comentario/492326/) 

	¬øComo puedo envolver el Unauthorized que me devulve cuando el JWT es invalido en un error de boom?
	
	Necesito que se muestre en un formato JSON gracias.

	* **glrodasz** [492326] (3)

		Tienes que intervenir la respuesta de error tu mismo en el middleware. Busca la sesion** Custom Callbacks** aqu√≠: <http://www.passportjs.org/docs/>

	* **AlexGarrixen** [492326] (1)

		Hola,yo hago lo siguiente :
		``` 
		    const express = require('express')
		    const router = express.Router()
		    
		    const passport = require('passport')
		    const boom = require('boom')
		    
		    const services = require('../services')
		    const products = new services()
		    
		    require('../utils/auth/jwt')
		    router.get('/', async (req,res,next) => {
		      passport.authenticate('jwt',(err,user) => {
		        try 
		        {
		          if(err || !user)
		          {
		    	//1) : Puedes devolver el error de boom pasandoselo a next(esto deber√≠a devolver un json) y opcionalmente mandar un mensaje como parametro a boom
		             next(boom.unauthorized('No tienes autorizacion')
		    //*********************************************//
		    	// 2) : O puedes enviar un simple json 
		    	res.status(401).json({
		              message : 'No tienes autorizacion',
		              payload : []
		            })
		          }
		    
		          req.login(user,{session : false}, async err => {
		    
		            if(err)
		            {
		              next(err)
		            }
		    
		            const products = await products.getAll()
		            res.status(200).json({
		              products
		            })
		          })
		      
		        }
		        catch(e)
		        {
		          next(e)
		        }
		      })(req,res,next)
		    })
		    
		    
		    module.exports = router
		    
		```

* **SaFeRamirez** (2) [65123](https://platzi.com/comentario/686323/) 
¬øporque el require del JWT Strategy no se almacena en una variable o constante? ¬øacaso es otro tipo de requerir archivos?

	* **glrodasz** [65123] (1)

		Cuando no se almacena en una variable o constante lo que estamos haciendo es simplemente ejecutar el codigo que se encuentra en ese archivo. En este caso lo que estamos haciendo es ejecutar la definici√≥n de la estrategia que posteriormente agregamos a Passport.js.

* **Rigo Antonio Galicia Barrera** (1) [721174](https://platzi.com/comentario/721174/) 

	Alguien me puede ayudar, me esta mostrando el siguiente error.
	``` 
	    /Users/idt/Documents/Investigation/curso-platzi-express/node_modules/passport-jwt/lib/strategy.js:50
	            throw new TypeError('JwtStrategy requires a verify callback');
	            ^
	    
	    TypeError: JwtStrategy requires a verify callback
	        at new JwtStrategy (/Users/idt/Documents/Investigation/curso-platzi-express/node_modules/passport-jwt/lib/strategy.js:50:15)
	        at Object.<anonymous> (/Users/idt/Documents/Investigation/curso-platzi-express/utils/auth/strategies/jwt.js:8:3)
	        at Module._compile (internal/modules/cjs/loader.js:778:30)
	        at Object.Module._extensions..js (internal/modules/cjs/loader.js:789:10)
	        at Module.load (internal/modules/cjs/loader.js:653:32)
	    
	```

* **Damian Spizzirri** (1) [716054](https://platzi.com/comentario/716054/) 

	Porque pone [user] ?? que hace esa anotacion con corchetes??

	* **chipercristiandi** [716054] (1)

		Hola, es array destructuring, por ejemplo:  
		const [ a ] = [ 1, 2, 3, 4, 5 ];  
		console.log(a); // va a mostrar 1
		
		Eso quiere decir que a vale lo que tenga el arreglo en la posici√≥n 0.

* **MauricioHernanCabrera** (1) [610037](https://platzi.com/comentario/610037/) 

	Cargar variable de entorno de los datos de una respuesta

	* **esdraspavon** [610037] (1)

		Interesante

* **Favio N√°quira** (1) [609767](https://platzi.com/comentario/609767/) 

	Sinceramente, este es un trucazo!! muy √∫til para poder sacarle el provecho a Postman

* **Armando122333** (1) [51487](https://platzi.com/comentario/492326/) 
¬øComo puedo envolver el Unauthorized que me devulve cuando el JWT es invalido en un error de boom? Necesito que se muestre en un formato ...

	* **glrodasz** [51487] (3)

		Tienes que intervenir la respuesta de error tu mismo en el middleware. Busca la sesion** Custom Callbacks** aqu√≠: <http://www.passportjs.org/docs/>

# Testing [3089]

## 0290. Creando tests para nuestros endpoints [15746](https://platzi.com/clases/1437-express-js/15746-creando-tests-para-nuestros-endpoints/)

### Descripci√≥n:


### Comentarios:

* **sock_osg** (6) [488829](https://platzi.com/comentario/488829/) 

	Hola, que pasa con los endpoints que tiene autenticacion? aplica tambien hacer un mock del strategy para que deje pasar un token? o cual es la practica aqui?

	* **nneiran** [488829] (1)

		misma pregunta‚Ä¶

* **Ezequiel Guerra** (4) [498249](https://platzi.com/comentario/498249/) 

	```
	    sudo npm i -D supertest mocha sinon proxyquire 
	    
	```

* **JUAN SILVA** (1) [675136](https://platzi.com/comentario/675136/) 

	buen dia me lanza este error ‚ÄúError: Cannot find module ‚Äò‚Ä¶/utils/testServer‚Äô‚Äù no se como resolverlo

* **Schenier Aldair L√≥pez Uriarte** (1) [80965](https://platzi.com/comentario/970455/) 
Error: Timeout of 2000ms exceeded. For async tests and hooks, ensure "done()" is called; if returning a Promise, ensure it resolves...

* **DavidArmandoVelazquez** (1) [79363](https://platzi.com/comentario/939050/) 
¬øSe modifico la ruta products.js del api por que usar la ruta products.js de views cuando esa instancia es la ruta y no la funcionalidad ...

## 0300. Creando tests para nuestros servicios [15745](https://platzi.com/clases/1437-express-js/15745-creando-tests-para-nuestros-servicios/)

### Descripci√≥n:


### Links:

* [Stubs - Sinon.JS](https://sinonjs.org/releases/latest/stubs/)

### Comentarios:

* **SaFeRamirez** (1) [679397](https://platzi.com/comentario/679397/) 

	¬øPor qu√© usar mocks?, cuando puedo validar el servicio directamente y probar que funciona la configuraci√≥n del server etc.

	* **ricardocelis (Platzi)** [679397] (4)

		es una buena practica que entre otras cosas te permite asegurarte de que si falla, el error esta en la parte que esta testeando por que el mock siempre va a estar bien, asi modularizas las pruebas y pruebas exactamente los servicios.

* **maxhadortiz93** (1) [503032](https://platzi.com/comentario/503032/) 

	Excelente aporte amigo, una pregunta no pueden hacerse unas pruebas gen√©ricas como tal para no colocar ni siquiera informaci√≥n sensible en los campos de los test?

	* **Eduardo Hidalgo D√≠az Rugama** [503032] (3)

		Puedes inyectar tus pruebas de testings con datos sensibles pero falsos, o inyectarlos con datos reales pero que no est√©n hardcodeados. Si quieres poner un dato como por ejemplo una cuenta bancaria, puedes probar con 4444111111111111 que es un dato sensible falso.
		
		Por otro lado, podr√≠as correr tus pruebas con datos reales obtenidos de la base de datos, pero sin exponer esos datos. La primera opci√≥n es mejor.

	* **glrodasz** [503032] (1)

		Me gustaria entender a que te refieres con respecto al uso de informaci√≥n sensible. Como explica Eduardo siempre esta la posibilidad de usar otro tipo de informaci√≥n, hay librerias como <https://github.com/marak/Faker.js/> que nos ayuda a generar informaci√≥n dado un esquema.

	* **SaFeRamirez** [503032] (1)

		¬øPorque no usar el servicio sin mocks?

* **maxhadortiz93** (1) [52273](https://platzi.com/comentario/503032/) 
Excelente aporte amigo, una pregunta no pueden hacerse unas pruebas gen√©ricas como tal para no colocar ni siquiera informaci√≥n sensible e...

	* **Eduardo Hidalgo D√≠az Rugama** [52273] (3)

		Puedes inyectar tus pruebas de testings con datos sensibles pero falsos, o inyectarlos con datos reales pero que no est√©n hardcodeados. Si quieres poner un dato como por ejemplo una cuenta bancaria, puedes probar con 4444111111111111 que es un dato sensible falso.
		
		Por otro lado, podr√≠as correr tus pruebas con datos reales obtenidos de la base de datos, pero sin exponer esos datos. La primera opci√≥n es mejor.

## 0310. Creando tests para nuestras utilidades [15748](https://platzi.com/clases/1437-express-js/15748-creando-tests-para-nuestras-utilidades/)

### Descripci√≥n:


### Comentarios:

## 0320. Agregando coverage para ver la calidad de nuestras pruebas [15747](https://platzi.com/clases/1437-express-js/15747-agregando-coverage-para-ver-la-calidad-de-nuestras/)

### Descripci√≥n:


Lo primero es agregar `nyc` como dependencia de desarrollo el CLI tool de `istanbuljs` <https://github.com/istanbuljs/nyc:>
``` 
    npm i -D nyc
    
```

Luego creamos un nuevo script llamado `test:cover` en nuestro `package.json`:
``` 
      "scripts": {
        "test": "mocha --exit",
        "test:cover": "nyc npm run test"
      }
    
    
```

Adem√°s agregamos una propiedad de configuraci√≥n al final de nuestro `package.json`:
``` 
      "nyc": {
        "all": true,
        "include": ["routes", "services", "lib", "utils"]
      }
    
```

> Esto con el fin de que incluya y haga un reporte optimo de la cobertura de nuestros tests.

Finalmente agregaremos los archivos de nyc a nuestro archivo `.gitignore` pues no es algo que necesitamos en nuestro repositorio.
``` 
    node_modules
    .env
    .nyc_output
    
```

Ahora para corroborar cu√°l es el nivel de cobertura de nuestros tests solo debemos ejecutar `npm run test:cover`.

### Comentarios:

* **Junior Usca H.** (5) [451286](https://platzi.com/comentario/451286/) 

	La url del repositorio de nyc es <https://github.com/istanbuljs/nyc>

* **Enrique Devars** (1) [60424](https://platzi.com/comentario/605248/) 
A que hace referencia exactamente el termino de coverage?

	* **alesanabriav (Platzi)** [60424] (1)

		A la cantidad de c√≥digo cubierto por los tests

## 0330. Debugging e inspect [15749](https://platzi.com/clases/1437-express-js/15749-debugging-e-inspect/)

### Descripci√≥n:


### Links:

* [Debugging Express](https://expressjs.com/en/guide/debugging.html)

### Comentarios:

* **doblesesays** (7) [492986](https://platzi.com/comentario/492986/) 

	En Windows:
	``` 
	    "dev:debug": "set DEBUG=express:*,app:*& npm run dev",
	     "debug": "set DEBUG=express:*,app:*& npm run start"
	    
	```

* **Jonathan Jim√©nez** (3) [462163](https://platzi.com/comentario/462163/) 

	He escrito un tutorial, sobre como configurar el depurador de vscode, para hacer debug de nuestro c√≥digo, os dejo el enlace por si hay alg√∫n interesado: [](https://platzi.com/tutoriales/1437-express-js/3352-configurar-debugger-en-vscode/)
	
	saludos,

	* **Jonathan Jim√©nez** [462163] (1)

		[url](https://platzi.com/tutoriales/1437-express-js/3352-configurar-debugger-en-vscode/)

	* **glrodasz** [462163] (1)

		Excelente tutorial!

	* **tzalejo** [462163] (1)

		gracias por compartirlo!!..

* **Marco Antonio Macedo Preciado** (3) [64837](https://platzi.com/comentario/682650/) 
¬øPorque hacer los tests al final del desarrollo? ¬øNo hubiera sido mejor hacerlos desde el comienzo? ü§î

	* **glrodasz** [64837] (2)

		Claro, lo ideal es hacerlos a medida que se va desarrollando. Pero el objetivo de este curso era dedicar una clase al tema. Por otro lado, lo ideal es hacer tests de todos los archivos posibles.

* **nneiran** (1) [1037446](https://platzi.com/comentario/1037446/) 

	El debug es vital, que bien que lo hayas mencionado üòÉ

* **juand_silva** (1) [691570](https://platzi.com/comentario/691570/) 

	Excelente esa herramienta de NODE INSPECT, hasta para optimizar el c√≥digo.

* **Alejo Cuello** (1) [81480](https://platzi.com/comentario/982173/) 
Hola, cuando descargo la carpeta con todos los archivos, ejecuto npm install y me sale este error: npm ERR! code E404 npm ERR! 404 ...

* **nikosantis** (1) [74611](https://platzi.com/comentario/856176/) 
Hola, no me aparecen con colores el debug. Y comienza con la fecha: Mon, 09 Dec 2019 00:58:51 GMT ‚Ä¶ sin colores

	* **Erik Ochoa** [74611] (1)

		Eso seguro es porque el profesor usa [Oh My Zsh](https://ohmyz.sh/), ac√° puedes ver c√≥mo instalarlo:
		
		* [Para Windows con WSL](https://platzi.com/clases/1650-prework/21960-configuracion-de-zsh-para-windows-con-linux-shell/)
		* [Para macOS](https://platzi.com/clases/1650-prework/21959-configuracion-de-la-terminal-mac-9/)
		
		

* **Marco Antonio Macedo Preciado** (1) [64836](https://platzi.com/comentario/682647/) 
¬øPara que nos servir√≠a hacer debug de una aplicaci√≥n en producci√≥n?

	* **glrodasz** [64836] (2)

		El debugging se hace para detectar errores. Por ejemplo tienes un bug en producci√≥n pero no sabes que sucede, revisar los logs que imprime toda la capa del debug te podria ayudar a ver que es lo que esta pasando.

* **Milton Cesar Catalan Parra** (1) [63022](https://platzi.com/comentario/649979/) 
Buenas tardes, alguine me puede ayudar con este error: Error: Cannot find module 'C:\Users\Milton\Desktop\ProyectoCoderEnv\index.js‚Äô at F...

	* **AlexGarrixen** [63022] (1)

		Hola miltoncat checa que en tu script estes llamando al index.js o verifica que no este mal escrito alguna ruta de alg√∫n modulo que estes requiriendo dentro del index.js

# Deployment [3090]

## 0340. Buenas pr√°cticas para el despliegue en producci√≥n [15750](https://platzi.com/clases/1437-express-js/15750-buenas-practicas-para-el-despliegue-en-produccion/)

### Descripci√≥n:


### Links:

* [Removing sensitive data from a repository - GitHub Help](https://help.github.com/articles/removing-sensitive-data-from-a-repository/)

### Comentarios:

* **David Behar** (1) [1069929](https://platzi.com/comentario/1069929/) 

	## [Los 10 Principales Riesgos de Seguridad para las aplicaciones WEB seg√∫n OWASP](https://owasp.org/www-project-top-ten/)

* **Carlos Enrique Gonzalez Pe√±a** (1) [474473](https://platzi.com/comentario/474473/) 

	Hola.  
	Ya no esta el enlace a como limpiar el historial de GitHub, lo podr√≠an volver a poner
	
	Gracias!

	* **glrodasz** [474473] (6)

		Este es el link: <https://help.github.com/articles/removing-sensitive-data-from-a-repository/>

	* **Carlos Enrique Gonzalez Pe√±a** [474473] (1)

		Gracias!

## 0350. npm script [15752](https://platzi.com/clases/1437-express-js/15752-npm-script/)

### Descripci√≥n:


### Links:

* [GitHub - jakubpawlowicz/clean-css-cli: The command line interface to clean-css CSS optimizer](https://github.com/jakubpawlowicz/clean-css-cli)

* [webpack](https://webpack.js.org/)

* [Performance Best Practices Using Express in Production](https://expressjs.com/en/advanced/best-practice-performance.html#set-node_env-to-production)

* [Performance Best Practices Using Express in Production](https://expressjs.com/en/advanced/best-practice-performance.html#cache-request-results)

* [Cache-Control | MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control)

### Comentarios:

* **onlinejaime** (4) [767851](https://platzi.com/comentario/767851/) 

	 **PARA LOS QUE USAN WINDOWS:**
	
	Instala npm -S cross-env
	
	En los scripts pon:
	``` 
	    "scripts": {
	        "start": "cross-env NODE_ENV=production node index",
	        "build": "cd public/assets && cleancss -o main.min.css main.css",
	    
	```
	
	O no funcionar√° correctamente‚Ä¶

## 0360. A√±adiendo manejo de cache y seguridad con helmet [16113](https://platzi.com/clases/1437-express-js/16113-anadiendo-manejo-de-cache-y-seguridad-con-helmet/)

### Descripci√≥n:


### Comentarios:

* **Junior Usca H.** (3) [451304](https://platzi.com/comentario/451304/) 

	Esta es la pagina de helmet <https://helmetjs.github.io/> y su repositorio <https://github.com/helmetjs/helmet>

* **doblesesays** (2) [493116](https://platzi.com/comentario/493116/) 

	En el inspector de Chrome, en la pesta√±a Application hay una secci√≥n ‚ÄúCache‚Äù con ‚ÄúCache Storage‚Äù y ‚ÄúApplication Cache‚Äù, pens√© que cuando estuvi√©ramos almacenando cache, ah√≠ aparecer√≠a algo relacionado a eso pero siempre se mantiene vac√≠o, sin cambios‚Ä¶ En qu√© casos se utiliza esa secci√≥n?

	* **Eduardo Hidalgo D√≠az Rugama** [493116] (2)

		aqui puedes encontrar documentaci√≥n sobre todos los almacenamientos de cach√© y sesiones de chrome <https://developers.google.com/web/tools/chrome-devtools/manage-data/local-storage?hl=es>
		
		A mi no me gusta la documentaci√≥n de google. Es mala e ineficiente, pero lo comparto por si contiene la respuesta que necesitas.

* **oobie92** (1) [62203](https://platzi.com/comentario/635724/) 
En que escenarios seria bueno utilizar redis como cache? Saludos!

	* **Anibal E. Vald√©s Y√°√±ez** [62203] (1)

		Para las sesiones de usuario por ejemplo, en que si el programa falla o manejas varias instancias, los usuarios no deben logearse nuevamente si se levanta autom√°ticamente el servicio o se redirecciona a otra instancia respectivamente. En general, donde desees persistencia sobre el cache vol√°til de RAM.

* **doblesesays** (1) [51556](https://platzi.com/comentario/493116/) 
En el inspector de Chrome, en la pesta√±a Application hay una secci√≥n ‚ÄúCache‚Äù con ‚ÄúCache Storage‚Äù y ‚ÄúApplication Cache‚Äù, pens√© que cuando ...

	* **Eduardo Hidalgo D√≠az Rugama** [51556] (2)

		aqui puedes encontrar documentaci√≥n sobre todos los almacenamientos de cach√© y sesiones de chrome <https://developers.google.com/web/tools/chrome-devtools/manage-data/local-storage?hl=es>
		
		A mi no me gusta la documentaci√≥n de google. Es mala e ineficiente, pero lo comparto por si contiene la respuesta que necesitas.

## 0370. C√≥mo usar las variables de entorno para diferente ambientes [15751](https://platzi.com/clases/1437-express-js/15751-como-usar-las-variables-de-entorno-para-diferente-/)

### Descripci√≥n:


Ya vimos c√≥mo en nuestro ambiente local podemos hacer uso de las variables de entorno usando el archivo `.env` y la libreria `dotenv`. Generalmente lo que se recomienda es usar el mismo para los diferentes ambientes como **Staging (Pruebas)** y **Producci√≥n**.

Para ello se debe acceder al servidor remoto:

  1. Duplicar el archivo `.env.example` y renombrarlo por `.env`.
  2. Cargar las respectivos valores de las variables de entorno.
  3. Usar valores y servicios diferentes para cada ambiente, esto quiere decir que las credenciales de desarrollo, staging y producci√≥n deben ser completamente diferentes.
  4. Si se quiere tener un backup de estos valores se recomienda usar las notas seguras de aplicaciones como [1Password](https://1password.com/) o [LastPass](https://www.lastpass.com/).



> Como lo hemos dicho antes, no se debe hacer commit del archivo .env y este debe estar en el .gitignore, ademas se recomienda manejar solo un archivo .env. M√°s informaci√≥n: <https://github.com/motdotla/dotenv#faq>

## Cuando no es posible acceder al servidor remoto

Algunos servicios como [Heroku](https://www.heroku.com/) o [Now](https://zeit.co/now) no nos permiten acceder a un servidor remoto pues la administraci√≥n del servidor es controlada por los mismos servicios, sin embargo cada servicio tiene sus mecanismos para establecer las variables de entorno:

* [Configuraci√≥n de variables de entorno en Heroku](https://devcenter.heroku.com/articles/config-vars)
* [Configuraci√≥n de variables de entorno en Now](https://zeit.co/blog/environment-variables-secrets)



## Variables de entorno de forma nativa

El uso del archivo `.env` junto con la librer√≠a `dotenv` es un mecanismo que nos facilita la configuraci√≥n de variables de entorno pero si por alguna raz√≥n las quisi√©ramos cargar de manera nativa, es decir desde el sistema operativo, recomiendo este tutorial de [Digital Ocean](https://www.digitalocean.com/community/tutorials/how-to-read-and-set-environmental-and-shell-variables-on-a-linux-vps)

### Comentarios:

## 0380. Habilitando CORS en producci√≥n [15753](https://platzi.com/clases/1437-express-js/15753-habilitando-cors-en-produccion/)

### Descripci√≥n:


El Intercambio de Recursos de Origen Cruzado (Cross-Origin Resource Sharing) es un mecanismo que agrega unos encabezados (Headers) adicionales HTTP para permitir que un user agent (generalmente un navegador) obtenga permisos para acceder a los recursos de un servidor en un origin distinto (dominio) del que pertenece.

**Por ejemplo una solicitud de origen cruzado seria** hacer una petici√≥n AJAX desde una aplicaci√≥n que se encuentra en <https://dominio-a.com> para cargar el recurso <https://api.dominio-b.com/data.json>.

> Por razones de seguridad, los navegadores restringen las solicitudes HTTP de origen cruzado iniciadas dentro de un script.

Si necesitamos permitir request desde un dominio diferente al del servidor podemos usar el middleware `cors` para permitirlo, pero es importante no dejarlo expuesto a todos los dominios.

## Habilitar CORS para todos los request (No recomendado en producci√≥n)
``` 
    const express = require("express");
    const cors = require("cors");
    const app = express();
    
    app.use(cors());
    
    app.get("/products/:id", function(req, res, next) {
      res.json({ msg: "This is CORS-enabled for all origins!" });
    });
    
    app.listen(8000, function() {
      console.log("CORS-enabled web server listening on port 8000");
    });
    
```

## Habilitar CORS para los request especificos de un cliente (Recomendado para producci√≥n)
``` 
    const express = require("express");
    const cors = require("cors");
    const app = express();
    
    const corsOptions = { origin: "http://example.com" };
    
    app.use(cors(corsOptions));
    
    app.get("/products/:id", function(req, res, next) {
      res.json({ msg: "This is CORS-enabled for only example.com." });
    });
    
    app.listen(8000, function() {
      console.log("CORS-enabled web server listening on port 8000");
    });
    
```

Debemos tener en cuenta que para aplicaciones server-side es poco probable que necesiten el uso de CORS debido a que las aplicaciones conviven en el mismo dominio. Sin embargo, es buena practica habilitarlo para los llamados externos de nuestra API.

M√°s informaci√≥n sobre el middleware cors en <https://expressjs.com/en/resources/middleware/cors.html>

### Comentarios:

* **DavidArmandoVelazquez** (2) [969604](https://platzi.com/comentario/969604/) 

	no entiendo, meh

	* **Jhonnattan Rivera** [969604] (2)

		una solicitud directa es cuando un usuario (navegador) llama a tu web.  
		una solicitud cruzada es cuando un usuario (navegador) llama a otro sistema y este sistema llama a tu web.  
		entonces con cors tu puedes decirle que en sistemas cruzados, solo se permite el acceso a determinados ip o direcciones web.  
		tambien puedes bloquearle el acceso a todo el mundo y permitir solo un ip especifico.

* **JaimeRamos** (1) [839945](https://platzi.com/comentario/839945/) 

	muy buen art√≠culo.

* **Walter Ugalde A** (1) [463010](https://platzi.com/comentario/463010/) 

	```
	    // Importar la libreria de cors
	    const cors = require('cors')
	    
	    //Configuracion del cors
	    const ALLOWED_ORIGINS = ['https://miAPI.com', 'http://localhost:8080']
	    app.use(cors({
	        origin: function (origin, callback) {
	            if(!origin) return callback(null, true)
	            if(ALLOWED_ORIGINS.indexOf(origin) ===-1)
	                return callback(newError(`Origen no permitido ${origin}, bloqueado, por seguridad`), false)
	            return callback(null, true)
	        }
	    }))
	    
	```
	
	> > Tengo esa confugraci√≥n, fue necesario agregar ¬®http://localhost:8080" ya que por medio de una app hecha en ionic que corre desde mobiles no me permitia conectarme.
	
	Hay alguna forma de hacer eso mejor, que agregando <http://localhost:8080> ?

	* **glrodasz** [463010] (1)

		El problema es que Ionic esta generando una aplicaci√≥n mobile hibrida, por lo que por debajo esta funcionando como un cliente de navegador.
		
		Lo que puedes hacer es usar proxy server con ionic: <https://blog.ionicframework.com/handling-cors-issues-in-ionic/>

* **Walter Ugalde A** (1) [49122](https://platzi.com/comentario/463010/) 
// Importar la libreria de cors const cors = require('cors') //Configuracion del cors const ALLOWED_ORIGINS = ['https://miAPI.com'...

	* **glrodasz** [49122] (1)

		El problema es que Ionic esta generando una aplicaci√≥n mobile hibrida, por lo que por debajo esta funcionando como un cliente de navegador.
		
		Lo que puedes hacer es usar proxy server con ionic: <https://blog.ionicframework.com/handling-cors-issues-in-ionic/>

## 0390. C√≥mo funciona y por qu√© es importante el uso de HTTPS [15754](https://platzi.com/clases/1437-express-js/15754-como-funciona-y-por-que-es-importante-el-uso-de-ht/)

### Descripci√≥n:


El Protocolo seguro de transferencia de hipertexto (HTTPS) es un protocolo HTTP que funciona en el puerto 443 y utiliza un cifrado basado en SSL (Secure Sockets Layer) / TLS (Transmission Layer security) con el fin de crear un canal de comunicaci√≥n seguro entre el cliente y el servidor.

## Por qu√© usar HTTPS

Una de las razones por la cual siempre debemos usar sitios con HTTPS es que sin este cualquier individuo podr√≠a efectuar ataques conocidos como [man-in-the-middle](https://en.wikipedia.org/wiki/Man-in-the-middle_attack) o [eavesdropping](https://en.wikipedia.org/wiki/Eavesdropping) y obtener nuestro usuario y contrase√±a en el momento en que intentamos acceder a este servicio que no tiene HTTPS establecido.

## C√≥mo funciona

  1. El cliente env√≠a un mensaje al servidor y este responde con su certificado p√∫blico.
  2. El cliente comprueba que este certificado sea valido y toma la llave p√∫blica.
  3. El cliente genera una cadena llamada `pre-master secret` y la encripta usando la llave publica del servidor y se lo env√≠a.
  4. El servidor usa su llave privada para comprobar el `pre-master secret`.
  5. En ese momento tanto el cliente como el servidor usan el `pre-master secret` para generar un `master secret` que es usado como una llave sim√©trica.
  6. Teniendo este par de llaves ya se pueden enviar mensajes seguros entre ellos.



## C√≥mo habilitar HTTPS en nuestro servidor

Dependiendo el servicio de hosting que estemos usando puede ofrecernos o no una instalaci√≥n de certificados de seguridad SSL/TLS que pueden tener alg√∫n costo. Sin embargo existen servicios como [Let‚Äôs Encrypt](https://letsencrypt.org/) que permiten la instalaci√≥n de este certificado completamente gratis. Servicios como Now y Heroku ofrecen HTTPS por defecto.

M√°s informaci√≥n:

* <https://letsencrypt.org/how-it-works/> <https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-16-04>

* <https://devcenter.heroku.com/articles/ssl>

* <https://devcenter.heroku.com/articles/automated-certificate-management>

* <https://zeit.co/docs/v1/features/certs>




### Comentarios:

## 0400. Desplegando con Now y detectando vulnerabilidades con npm audit [15756](https://platzi.com/clases/1437-express-js/15756-desplegando-con-now-y-detectando-vulnerabilidades-/)

### Descripci√≥n:


### Links:

* [ZEIT](https://zeit.co/)

* [ZEIT ‚Äì Pricing](https://zeit.co/pricing)

### Comentarios:

* **Daniel .** (6) [476121](https://platzi.com/comentario/476121/) 

	Para evitar la fatiga
	``` 
	    now -e DB_USER=@octolion-db-user -e DB_PASSWORD=@octolion-db-password -e DB_HOST=@octolion-db-host -e DB_PORT=@octolion-db-port -e DB_NAME=@octolion-db-name -e AUTH_ADMIN_USERNAME=@auth-admin-username -e AUTH_PASSWORD=@auth-admin-password -e AUTH_ADMIN_EMAIL=@auth-admin-email -e AUTH_JWT_SECRET=@auth-jwt-secret
	    
	```

* **capacita.ti** (2) [603839](https://platzi.com/comentario/603839/) 

	Excelente el curso, vengo del futuro. Tengo una consulta al desplegar, en vez de visualizar la plantilla html de /productos visualizo el c√≥digo del index.js. Buscando en su documentaci√≥n se requiere el now.json pero a√∫n as√≠ no me va, que debe ir exactamente si aplico a este proyecto? Saludos.

	* **capacita.ti** [603839] (5)

		Resuelto: crear archivo now.json y colocar
		``` 
		    {
		      "version": 2,
		      "builds": [
		        { "src": "./index.js", "use": "@now/node-server" }
		      ],
		      "routes": [
		        { "src": "/.*", "dest": "/" }
		      ],
		      "env": {
		        "DB_USER": "@octolion-db-user",
		        "DB_PASSWORD": "@octolion-db-password",
		        "DB_HOST": "@octolion-db-host",
		        "DB_NAME": "@octolion-db-name",
		        "AUTH_ADMIN_USERNAME": "@auth-admin-username",
		        "AUTH_PASSWORD": "@auth-admin-password",
		        "AUTH_ADMIN_EMAIL": "@auth-admin-email",
		        "AUTH_JWT_SECRET": "@auth-jwt-secret"
		      }
		    }
		    
		```
		
		Adjunto un link de referencia  
		<https://spectrum.chat/zeit/now/now-2-0-and-express-with-multiple-routing~9d4bde34-ecd5-4ae2-91e6-b1b7b89d2997>

	* **Andres David rodriguez** [603839] (1)

		como pudiste subirlo? ami me da error, puedes subir el repositorio para ver el c√≥digo

	* **glrodasz** [603839] (3)

		Gracia **capacita.ti** , creo que lo que te hizo falta fue definir que el destino era /index.js en la ruta.
		
		Aqu√≠ esta la version de **now.json** actualizada y funcionando: <https://github.com/glrodasz/platzi-express/blob/master/ecommerce/now.json>

* **doblesesays** (2) [493762](https://platzi.com/comentario/493762/) 

	<https://octolion.herokuapp.com/products>

* **capacita.ti** (1) [60317](https://platzi.com/comentario/603839/) 
Excelente el curso, vengo del futuro. Tengo una consulta al desplegar, en vez de visualizar la plantilla html de /productos visualizo el ...

	* **capacita.ti** [60317] (5)

		Resuelto: crear archivo now.json y colocar
		``` 
		    {
		      "version": 2,
		      "builds": [
		        { "src": "./index.js", "use": "@now/node-server" }
		      ],
		      "routes": [
		        { "src": "/.*", "dest": "/" }
		      ],
		      "env": {
		        "DB_USER": "@octolion-db-user",
		        "DB_PASSWORD": "@octolion-db-password",
		        "DB_HOST": "@octolion-db-host",
		        "DB_NAME": "@octolion-db-name",
		        "AUTH_ADMIN_USERNAME": "@auth-admin-username",
		        "AUTH_PASSWORD": "@auth-admin-password",
		        "AUTH_ADMIN_EMAIL": "@auth-admin-email",
		        "AUTH_JWT_SECRET": "@auth-jwt-secret"
		      }
		    }
		    
		```
		
		Adjunto un link de referencia  
		<https://spectrum.chat/zeit/now/now-2-0-and-express-with-multiple-routing~9d4bde34-ecd5-4ae2-91e6-b1b7b89d2997>

## 0410. Automatizar el chequeo de vulnerabilidades con snyk [15755](https://platzi.com/clases/1437-express-js/15755-automatizar-el-chequeo-de-vulnerabilidades-con-sny/)

### Descripci√≥n:


Para usar snyk lo primero es crear una cuenta en <https://app.snyk.io/signup> para agilizar el proceso recomiendo usar la cuenta de GitHub.

![snyk-landing.png](https://static.platzi.com/media/user_upload/snyk-landing-df4f3181-6315-4f56-9eeb-e15f3d5892b6.jpg)

Despu√©s de la creaci√≥n de la cuenta nos redireccionara a las integraciones o podemos ir directamente mediante el link `https://app.snyk.io/org/<usuario>/integrations`.

Seleccionamos la integraci√≥n con GitHub (o con el servicio m√°s adecuado para nuestro proyecto) y all√≠ nos aseguramos de conectar nuestra cuenta con GitHub, otorgando los permisos necesarios.

![snyk-integrations.png](https://static.platzi.com/media/user_upload/snyk-integrations-7b06cc67-8b0a-4ca1-88de-d5031bb4c9f7.jpg)

Por ultimo necesitamos agregar el repositorio de nuestro proyecto para que haga la revisi√≥n autom√°tica de vulnerabilidades en cada Pull request, mediante el bot√≥n `Add your GitHub repositories to Snyk`.

All√≠ buscaremos el repositorio de nuestro proyecto, lo seleccionamos y le damos en el buton `Add 1 selected repository to Snyk`.

Cuando termine la integraci√≥n podemos dirigirnos al dashboard de nuestros proyectos haciendo click en la pesta√±a `Projects` o mediante el link `https://app.snyk.io/org/<usuario></usuario>/projects` y verificar el estado de nuestras dependencias:

![snyk-projects.png](https://static.platzi.com/media/user_upload/snyk-projects-caa0fdf8-fafd-4ac1-8317-60f3088852a1.jpg)

En lo posible debemos evitar tener vulnerabilidades High (H) o Medium (M) para corregirlas le damos click en `View report and fix`.

> Tener en cuenta que algunas vulnerabilidades no tienen soluci√≥n en el momento por lo que toca estar pendiente de un posible fix o cambiar de librer√≠a.

### Comentarios:

## 0420. Conclusiones [15757](https://platzi.com/clases/1437-express-js/15757-cierre-del-curso0203/)

### Descripci√≥n:


### Comentarios:

* **Alvaro   Gonzalez** (5) [448143](https://platzi.com/comentario/448143/) 

	Genial el curso.

	* **Junior Usca H.** [448143] (5)

		Si bastante completo y complejo

* **Victor Lozada** (4) [532064](https://platzi.com/comentario/532064/) 

	Quedo bastante bueno el curso ! espero ver mas de parte de Guillermo aqui en platzi

* **Jos√© Ricardo Romo Guti√©rrez** (3) [480096](https://platzi.com/comentario/480096/) 

	Lo mejor del curso para mi fue la construccion de la arquitectura mvc extendida. Me falta leer mas sobre seguridad. Pero genial curso, lo estan haciendo bien

	* **glrodasz** [480096] (2)

		Te recomiendo mi curso sobre autenticacion: <https://platzi.com/clases/autenticacion-oauth/>

* **Daniel .** (3) [475959](https://platzi.com/comentario/475959/) 

	Uff! bastante que aprender.
	
	Gracias por el curso!

* **edesalla17** (3) [462245](https://platzi.com/comentario/462245/) 
Fantabuloso! Gracias :)

* **Junior Usca H.** (3) [451350](https://platzi.com/comentario/451350/) 

	La url del repositorio <https://github.com/glrodasz/platzi-express>

* **doblesesays** (2) [493767](https://platzi.com/comentario/493767/) 

	¬°Muchas Gracias!

* **Francisco Martin Nacimiento** (1) [1029857](https://platzi.com/comentario/1029857/) 

	Un crack el profesor!

* **Juan mora** (1) [679000](https://platzi.com/comentario/679000/) 

	Bastante informaci√≥n y muy √∫til,  
	Gracias.

* **Brayan Murcia Sanchez** (1) [569341](https://platzi.com/comentario/569341/) 

	un curso genial!

* **Carlos Enrique Gonzalez Pe√±a** (1) [474500](https://platzi.com/comentario/474500/) 

	Hola Gullermo, esta fenomenal el curso, una duda.  
	Mi despliegue en producci√≥n sera en un servidor de windows y sera una REST en express con muchas de las recomendaciones y buenas particas que comentas en este curso y el de OAuth.  
	Ahora bien la duda surge en, cual es la mejor recommendation para el despliegue de Express en Windows?  
	Si tienes alg√∫n tutorial o algo a la mano que me puedas proporcionar te lo agradecer√≠a mucho a ti o a los alumnos de Platzi
	
	Saludos!

	* **Eduardo Hidalgo D√≠az Rugama** [474500] (2)

		no ‚Äúdespliegues express en windows‚Äù. Un despliegue (o mejor dicho, un deploy") debe ser agnostico de un Sistema Operativo.
		
		¬øComo le haces si un usuario tiene mac? ¬øComo le haces si un usuario tiene Linux? debes encontrar la manera de poder hacer el deploy de tu sistema y que sea consumible por cualquier usuario con la mejor cantidad de dependencias.
		
		Al hacer deploy en servicios IaaS o SaaS como [Now.sh](http://Now.sh), digital ocean, AWS, Google, etc, ellos te proveen la infraestructura y no te tienes que preocupar de nada mas.
		
		Solo envias y recibes peticiones de puertos y urls.
		
		¬øQuieres desplegar en windows de igual manera? usa Node.js. Node es un servidor, igual que Nginx, igual que ISS de windows.

	* **glrodasz** [474500] (2)

		Si definitivamente tu servidor maneja Windows Server, es indifirente si la app es de Express, Koa, Hapi, etc. Lo que tienes que solucionar es como desplegar una aplicacion en Node.
		
		M√°s info:  
		<https://www.hanselman.com/blog/InstallingAndRunningNodejsApplicationsWithinIISOnWindowsAreYouMad.aspx>

	* **Juan Carrillo** [474500] (2)

		Excelente curso, informaci√≥n completa y muy estructurada. Gracias!

* **Carlos Enrique Gonzalez Pe√±a** (1) [50006](https://platzi.com/comentario/474500/) 
Hola Gullermo, esta fenomenal el curso, una duda. Mi despliegue en producci√≥n sera en un servidor de windows y sera una REST en express c...

	* **Eduardo Hidalgo D√≠az Rugama** [50006] (2)

		no ‚Äúdespliegues express en windows‚Äù. Un despliegue (o mejor dicho, un deploy") debe ser agnostico de un Sistema Operativo.
		
		¬øComo le haces si un usuario tiene mac? ¬øComo le haces si un usuario tiene Linux? debes encontrar la manera de poder hacer el deploy de tu sistema y que sea consumible por cualquier usuario con la mejor cantidad de dependencias.
		
		Al hacer deploy en servicios IaaS o SaaS como [Now.sh](http://Now.sh), digital ocean, AWS, Google, etc, ellos te proveen la infraestructura y no te tienes que preocupar de nada mas.
		
		Solo envias y recibes peticiones de puertos y urls.
		
		¬øQuieres desplegar en windows de igual manera? usa Node.js. Node es un servidor, igual que Nginx, igual que ISS de windows.

