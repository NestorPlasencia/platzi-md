[Curso Avanzado de PHP 1462](https://platzi.com/cursos/php-avanzado)

# Introducci√≥n [3200]

## 0010. Introducci√≥n [16280](https://platzi.com/clases/1462-php-avanzado/16280-introduccion9360/)

### Descripci√≥n:


En este curso aprender√°s t√©cnicas y principios de programaci√≥n, conceptos avanzados del lenguaje PHP adem√°s de arquitectura y patrones de dise√±o.  
Trabajaremos sobre un proyecto ya construido en el [Curso de introducci√≥n a PHP](https://platzi.com/clases/php/).  
Los conocimientos previos que debes tener para tomar este curso son: Fundamentos de programaci√≥n, fundamentos de PHP, bases de datos, Javascript, HTML, CSS y Git.

### Comentarios:

* **Miriam Fern√°ndez** (5) [690236](https://platzi.com/comentario/690236/) 

	[Repo del curso](https://github.com/hectorbenitez/curso-introduccion-php)

* **balachvinic** (4) [461292](https://platzi.com/comentario/461292/) 

	Aprend√≠ bastante en el curso de fundamentos de PHP y en este no espero menos, vamo a darle bro

* **EliecerDavid** (2) [459720](https://platzi.com/comentario/459720/) 

	Al fin el se libero el curso avanzado üòÉ

* **Paul Cortes** (1) [1127111](https://platzi.com/comentario/1127111/) 

	Excelente vamos a empezar!!! se ve muy prometedor

* **jorge-gianareas** (1) [978622](https://platzi.com/comentario/978622/) 

	Trabajaremos sobre un proyecto ya construido en el Curso de introducci√≥n a PHP.

* **lucas-moreno375** (1) [968758](https://platzi.com/comentario/968758/) 

	 **vamos a empezar!!**

* **Kenet Chungandro** (1) [962284](https://platzi.com/comentario/962284/) 

	Empezamos!

* **joseantonioquintanilla** (1) [939906](https://platzi.com/comentario/939906/) 

	Empezamos üòÑ

* **andresoler90** (1) [939109](https://platzi.com/comentario/939109/) 

	Vamos a empezar‚Ä¶ !

* **Pablo Juarez Castillo** (1) [624557](https://platzi.com/comentario/624557/) 

	Ok es parecido al primer curso

* **Jorge Eliecer Rangel Jimenez** (1) [537016](https://platzi.com/comentario/537016/) 

	Avanzar en la programaci√≥n con PHP üòÉ

* **Rene Ismael Barrios Rojas** (1) [460974](https://platzi.com/comentario/460974/) 

	wow por fin lo estaba esperando, despu√©s de terminar el de Net Core.

* **gydoar** (1) [460635](https://platzi.com/comentario/460635/) 

	Sorprendeme

* **cryptolatin** (1) [460425](https://platzi.com/comentario/460425/) 

	ya llego

* **Jhoan Steve Sandoval Meneses** (1) [460081](https://platzi.com/comentario/460081/) 

	por fin !!!

* **Bryan Estiven Silva Mercado** (1) [460072](https://platzi.com/comentario/460072/) 

	Cas√≠ reci√©n termine PHP as√≠ que me viene de maravilla

* **Japheth Calzada L√≥pez** (1) [459887](https://platzi.com/comentario/459887/) 

	Esperaba este curso üòÉ

* **Josu√© Ricardo Cando Obaco** (1) [459832](https://platzi.com/comentario/459832/) 

	Comencemos a ampliar nuestro conocimiento en PHP.

* **andresnakanishi** (1) [459802](https://platzi.com/comentario/459802/) 

	Se me hace un buen profe, y lo bueno es que se le entiende.

* **jesus-alejandro-montoya** (1) [79102](https://platzi.com/comentario/933692/) 
Alguno tiene el proyecto del curso de introducci√≥n a php, sino que por un tema de formateo del equipo se me perdi√≥, si alguien me puede a...

	* **CarlosAlba** [79102] (2)

		Hola!
		
		Te refieres a [este](https://github.com/hectorbenitez/curso-introduccion-php/archive/master.zip?t=1579427778780)?

# Herramientas [3193]

## 0020. IDEs [16205](https://platzi.com/clases/1462-php-avanzado/16205-ides/)

### Descripci√≥n:


Durante tu vida como desarrollador, escuchar√°s el t√©rmino de **IDE** que significa **Entorno de desarrollo integrado** y el t√©rmino de editor de c√≥digo fuente. La principal diferencia entre estos dos es que un **IDE** normalmente cuenta con m√°s caracter√≠sticas como herramientas para administrar bases de datos, controlador de versiones (Git), debug o depuraci√≥n y al tiempo incluye un editor de c√≥digo fuente.

Es importante que sepas que tu **IDE** ser√° una herramienta que usar√°s d√≠a a d√≠a as√≠ que debes conocerla muy bien y sentirte c√≥modo con ella. Explora sus atajos y ventajas frente a otras herramientas.

### Links:

* [PhpStorm: The Lightning-Smart IDE for PHP Programming by JetBrains](https://www.jetbrains.com/phpstorm/)

* [Sequel Pro](https://www.sequelpro.com/)

* [Visual Studio Code - Code Editing. Redefined](https://code.visualstudio.com/)

* [MySQL :: MySQL Workbench](https://www.mysql.com/products/workbench/)

### Comentarios:

* **Bryan Estiven Silva Mercado** (5) [460074](https://platzi.com/comentario/460074/) 

	Yo he usado PHPStorm es bastante bueno , lo que si tiene es un consumo de RAM considerable si no cuentan con mucha memoria

	* **hectorbenitez** [460074] (1)

		Buen punto @bryan_ec, algo importante para considerarse

	* **lucasmartinezesper** [460074] (1)

		A tenerlo en cuenta a ese punto!

* **Bryan Estiven Silva Mercado** (3) [460735](https://platzi.com/comentario/460735/) 

	Atajos de teclados para phpstorm [link](https://github.com/jatubio/5minutos_laravel/wiki/PHPStorm.-Hotkeys-en-windows)

	* **lucasmartinezesper** [460735] (1)

		Muchas gracias!

* **Miguel Gil Rosas** (3) [459762](https://platzi.com/comentario/459762/) 

	Si estudian en alguna entidad (universidad, instituto, escuela, etc‚Ä¶) que les provea de una cuenta de correo electr√≥nico institucional pueden conseguir un a√±o de licencia educativa para PHPStorm u otra herramienta de JetBrains gratis.

	* **lucasmartinezesper** [459762] (1)

		Si, generalmente esas empresas de software hacen descuentos a licencias para estudiantes.

* **EliecerDavid** (3) [459724](https://platzi.com/comentario/459724/) 

	a darle una oportunidad a PHPStorm, un IDE muy potente

* **carlosmora_biz** (2) [642422](https://platzi.com/comentario/642422/) 

	Una herramienta muy intersante pero creo que poco conocida es [dbeaver](https://dbeaver.io/).
	
	Sirve para varios motores y es gratuita.

* **Christian Galicia Garcia** (2) [460657](https://platzi.com/comentario/460657/) 

	Prefiero NetBeans

	* **hectorbenitez** [460657] (2)

		Es una buena opci√≥n, y es gratis üòÑ al final lo importante es que tu estes contento con tu elecci√≥n

	* **lucasmartinezesper** [460657] (1)

		Lo importante es que sirva con tu forma de trabajar.

* **Paul Cortes** (1) [1127118](https://platzi.com/comentario/1127118/) 

	Excelente me gusta PhpStorm, un dato para todos, los que tengan cuenta de estudiante de alguna universidad que tenga el dominio .edu en el correo pueden obtener PhpStorm licenciado gratutiamente

* **jorge-gianareas** (1) [978625](https://platzi.com/comentario/978625/) 

	Es importante que sepas que tu IDE ser√° una herramienta que usar√°s d√≠a a d√≠a as√≠ que debes conocerla muy bien y sentirte c√≥modo con ella. Explora sus atajos y ventajas frente a otras herramientas.

* **jorge-gianareas** (1) [978623](https://platzi.com/comentario/978623/) 

	Durante tu vida como desarrollador, escuchar√°s el t√©rmino de IDE que significa Entorno de desarrollo integrado y el t√©rmino de editor de c√≥digo fuente. La principal diferencia entre estos dos es que un IDE normalmente cuenta con m√°s caracter√≠sticas como herramientas para administrar bases de datos, controlador de versiones (Git), debug o depuraci√≥n y al tiempo incluye un editor de c√≥digo fuente.

* **Kenet Chungandro** (1) [962296](https://platzi.com/comentario/962296/) 

	Bueno en mi caso me acostumbr√© al VS code, y a esto le sumo mysql workbench.  
	Empezamos con el curso üòÉ

* **andresoler90** (1) [939113](https://platzi.com/comentario/939113/) 

	Tambi√©n utilizo IDE Phpstorm y SqlYog como gestor de DB.

* **joaquinecheverria** (1) [898942](https://platzi.com/comentario/898942/) 

	Yo utilizo PHPStorm, se me hace muy bueno

* **A√±aqui Apolinar Morales** (1) [882689](https://platzi.com/comentario/882689/) 

	Hola cambie de sistema operativo a ubuntu, hay alguna fomra de usar la bd grafica ?

* **Juan Jos√© Bueno** (1) [867088](https://platzi.com/comentario/867088/) 

	Una recomendaci√≥n para los que usen Visual Studio Code, la extensi√≥n Intellephense aplica mucho de los automatismos que se encuentran en PHPStorm (el cual es el mejor IDE de PHP) y puede volver VS en algo en el que no extra√±ar√°n PHPStorm.

* **diegomedflo** (1) [865411](https://platzi.com/comentario/865411/) 

	Termin√© mi p√°gina web que funciona con PHP. Ahora quiero subirla pero tengo una duda existencial. Siempre mencionan que una cosa es backend y otra cosa es frontend. Que el frontend es html y el backend en este caso seria PHP. Pero, osea no es tal as√≠, el index.php puede ser el frontend. Mi duda es, ¬øcomo se sube backend y frontend al hosting? Yo tengo mi p√°gina principal: index.php, un formulario: form.php, y la salida: resultado.php. En esta ultima p√°gina es donde se ejecuta un c√≥digo que esta dentro de este archivo recibiendo variables de form.php por el m√©todo post. Ahora, este archivo form.php debe ir en alg√∫n lugar especial para el backend? De ser as√≠, ya que en este archivo hay c√≥digo HTML, se convertir√≠a en el nuevo frontend? Este archivo deber√≠a ser solo como una funci√≥n y luego mandarle el resultado a otra p√°gina y esta reci√©n se muestra?  
	Alguien que me aclare la duda por favor, en Internet no encuentro ninguna explicaci√≥n sobre ello.

	* **Juan Jos√© Bueno** [865411] (2)

		La separaci√≥n de frontend y backend no es siempre tan clara y es por eso que hay formas de organizar el c√≥digo para que la divisi√≥n sea m√°s clara. Te dar√© 2 ejemplos.
		
		  1. Aplicaciones front y back separadas.  
		Un repo de frontend, con l√≥gica escrita con javascript para que por medio de peticiones por AJAX traigan los datos a partir de una ubicaci√≥n remota.  
		Un repo de backend, la cual recibe peticiones tipo REST con las que ejecuta c√≥digo que procesa la petici√≥n, calcula los datos y los retorna en forma de JSON que el repo 1 podr√≠a leer con facilidad.
		
		
		
		En este caso, frontend como backend est√°n muy claramente separados.
		
		  1. Un repositorio con l√≥gica front y backend.  
		Ahora, tienes un repositorio que tiene un archivo con todo lo visual y poca l√≥gica (por ejemplo ciclos o condicionales) para decidir qu√© le muestras al usuario, por otro lado tienes otro archivo que tiene las conexiones a la base de datos y que alimenta este archivo. Este tipo de aplicaciones son mixtas y requieren disciplina de parte de los desarrolladores en mantener las responsabilidades claras, por ejemplo, no incluir la conexi√≥n de la base de datos en el formulario de registro.
		
		
		
		Es en esos casos donde una organizaci√≥n de c√≥digo tipo Modelo-Vista-Controlador es muy √∫til para separar f√≠sicamente las diferentes l√≥gicas.
		
		Pero debido a la flexibilidad del c√≥digo, (al fin y al cabo todo lo aguanta el codigo), vos pod√©s tener todo junto, lo cual suele ser incorrecto, pero no por necesidad de que se ejecute o no, sino de ser organizado.

* **Josu√© Isaac Fuentes L√≥pez** (1) [577252](https://platzi.com/comentario/577252/) 

	para mysql se puede usar workbench

	* **lucasmartinezesper** [577252] (1)

		Si, es muy buena herramienta!

* **Jorge David Duque Agudelo** (1) [573586](https://platzi.com/comentario/573586/) 

	Hasta el momento he trabajado con Visual Studio Code y PhpStorm para trabajar con PHP, y ambos me han funcionado perfecto.

## 0030. Virtualizaci√≥n [16204](https://platzi.com/clases/1462-php-avanzado/16204-virtualizacion/)

### Descripci√≥n:


Cuando trabajas con m√∫ltiples proyectos, el hacerlo con tu m√°quina ya no es tan f√°cil ya que muchas veces necesitas diferentes versiones de PHP o tu equipo puede tener diferentes sistemas operativos, diferentes versiones de PHP o diferentes versiones de la base de datos lo cual puede ser bastante problem√°tico. Para solucionar esto usamos la virtualizaci√≥n que nos permite crear entornos virtuales dentro de nuestro equipo que nos ayudan a tener un entorno de desarrollo ideal.

Existen dos vertientes principales: **Vagrant** y **Docker**. **Vagrant** genera m√°quinas virtuales completas en las cuales podemos instalar PHP, bases de datos, Apache, entre otras. La otra vertiente es **Docker** con la cual se generan peque√±os contenedores dentro de una m√°quina virtual los cuales contienen la instalaci√≥n de PHP o la base de datos, logrando que trabajen en conjunto.

* Descargaremos Vagrant y lo instalaremos <https://www.vagrantup.com/>
* Utilizaremos la imagen de Laravel Homestead siguiendo los pasos que aqu√≠ se describen: <https://laravel.com/docs/5.7/homestead>. Las im√°genes de Vagrant las llamaremos box o cajas, Homestead es una de ellas.
* Cuando inicializamos Homestead, lo que hacemos es crear un nuevo archivo de configuraci√≥n ‚ÄúHomestead.yaml‚Äù.
* Al editar el archivo ‚ÄúHomestead.yaml‚Äù, tenemos informaci√≥n de la ip que no es el localhost por ser m√°quina virtual. Aqu√≠ igualmente ligamos nuestra carpeta de proyecto a la carpeta de la m√°quina virtual; tambi√©n podemos a√±adir bases de datos y diferentes proyectos dentro de la misma m√°quina o box.
* Cuando usas el comando ‚Äúvagrant up‚Äù se crear√° una m√°quina virtual vagrant si no existe; si existe se reiniciar√° la m√°quina existente. Se ejecutar√° tambi√©n el aprovisionamiento que es configurar o instalar cualquier cosa que se necesite.



### Links:

* [Vagrant by HashiCorp](https://www.vagrantup.com/)

* [Enterprise Container Platform | Docker](https://www.docker.com/)

* [Laravel Homestead - Laravel - The PHP Framework For Web Artisans](https://laravel.com/docs/5.7/homestead)

* [Curso de Git y GitHub Profesional | Platzi | Materiales](https://platzi.com/clases/git-github/)

* [GitHub - hectorbenitez/curso-introduccion-php](https://github.com/hectorbenitez/curso-introduccion-php/)

### Comentarios:

* **hectorbenitez** (8) [463831](https://platzi.com/comentario/463831/) 

	Hola a todos! no es estrictamente necesario que utlicen virtualizacion para continuar el curso, pero definitivamente es un tema que tenemos que conocer üòÉ Saludos a todos!

	* **FedeFenker** [463831] (1)

		cuando prendo mi pc voy a la terminal voy a la carpeta platzi/homestead y hago vagrant up  
		me sale el error 502 bad gateway

	* **Bernardino Villagra Baez** [463831] (1)

		Muy bien, me parece genial conocer estos temas para agilizar y mejorar nuestro entorno de desarrollo.

	* **lucasmartinezesper** [463831] (1)

		Claro, debemos conocer para trabajar en equipos mayores o grandes ligas, creo que si una persona desarrolla sola sus proyectos no hace mucha falta.

* **Israel Elias Laura Rosas** (5) [499943](https://platzi.com/comentario/499943/) 

	Es mi impresion o debieron cortar la parte en la que al levantar vagrant falla. ?

	* **Juan Felipe Zuluaga G√≥mez** [499943] (4)

		Yo prefiero que falle en el video, al menos as√≠ veo que es una posibilidad as√≠ se sigan los pasos. Pienso que es lo bueno de platzi, te muestra una situaci√≥n normal de un d√≠a a d√≠a cuando desarrollas, y no te muestra todo con florecitas

	* **lucasmartinezesper** [499943] (1)

		Mejor si falla y se ve en el video, porque si te falla a ti no sabr√°s porqu√©, siempre de las fallas se aprende m√°s. Saludos.

* **Oscar Hernando Cabrera Plazas** (4) [772021](https://platzi.com/comentario/772021/) 

	Si al tratar de levantar la maquina les sale este error: Check your Homestead.yaml file, the path to your private key does not exist sigan estos pasos y listo.  
	<https://ekiketa.es/fallo-en-homestead-check-your-homestead-yaml-file-the-path-to-your-private-key-does-not-exist/>

* **Nycgia** (4) [460557](https://platzi.com/comentario/460557/) 

	Para los que tengan problemas con la private key, pueden ejecutar este comando y se las genera.
	
	ssh-keygen -t rsa -b 4096 -C ["tucorreo@mail.com](mailto:%22tucorreo@mail.com)"

	* **Nycgia** [460557] (2)

		Y tambi√©n recuerden tener instalado el virtualizador que utilizar√°n, sino les dar√° problemas.

	* **zarza-raul** [460557] (1)

		dice check homestead.yaml file the path to your private key does not exist

	* **gabobardales** [460557] (2)

		Me sirvio pero dentro del curso de servidores explica un poco sobre el tema, por eso aveces el orden los cursos son importantes

	* **lucasmartinezesper** [460557] (1)

		Gracias por el aporte!

* **Jairo Andres Grajales Salinas** (2) [1091233](https://platzi.com/comentario/1091233/) 

	Debe instalar [laradock](http://laradock.io/)

* **Jairo Andres Grajales Salinas** (2) [1074828](https://platzi.com/comentario/1074828/) 

	Lo mejor y lo que m√°s se est√° usando en ambientes de desarrollo es Docker, es un buen momento de aprenderlo.

* **andresoler90** (2) [941171](https://platzi.com/comentario/941171/) 

	Si les genera error al ejecutar init.bat.  
	bash: init.bat: command not found![](![Captura.PNG](https://static.platzi.com/media/user_upload/Captura-2ab06adb-2789-4e24-99ea-300c3441f3c5.jpg)  
	Solucion:  
	No ejecutes eso en git bash. Ejec√∫telo en la l√≠nea de comando de Windows. O mejor a√∫n, simplemente haga doble clic init.baty lo ejecutar√° en relaci√≥n con su directorio de inicio de Windows.  
	fuente: [(<https://stackoverflow.com/questions/42775652/homestead-nor-homestead-yaml-is-showing-up-after-running-bash-init-bat>)]

	* **gerql14** [941171] (2)

		Tambi√©n se puede ejecutar el comando  
		**bash[init.sh](http://init.sh)**  
		dentro del git bash

* **Luis Andr√©s Arce C√°rdenas** (2) [601123](https://platzi.com/comentario/601123/) 

	¬øAlguien utiliz√≥ Docker para crear un contenedor para PHP y Composer?. Si alguien tiene una idea o pudiera explicarme como lo hizo lo agradecer√≠a mucho.

	* **Alan Riveros** [601123] (2)

		Te paso el enlace a un proyectito que hice hace mil a√±os Seguramente te va a ser de ayuda [Docker-For-PHP](https://github.com/alanRiveros/DockerDev)

	* **Luis Andr√©s Arce C√°rdenas** [601123] (1)

		Muchas gracias, te has ganado el cielo hermano.

	* **lucasmartinezesper** [601123] (1)

		Vamos a probar ese repo @alanRiveros

* **Bernardino Villagra Baez** (2) [539782](https://platzi.com/comentario/539782/) 

	Siempre es importante leernos la documentaci√≥n de cada herramienta que vamos a estar utilizando.

	* **lucasmartinezesper** [539782] (1)

		El profesor siempre da ese consejo y esta en toda su verdad.

* **Harry Saenz Arias** (2) [505813](https://platzi.com/comentario/505813/) 

	Que tengo que hacer en este caso? ![Captura de pantalla 2019-02-08 a las 22.54.01.png](https://static.platzi.com/media/user_upload/Captura%20de%20pantalla%202019-02-08%20a%20las%2022.54.01-f99404d0-bb1f-473e-be6d-382c22d84880.jpg)

	* **nerio.lorona** [505813] (2)

		Es necesario generar la ssh-keygen, como dijo @Nycgia  
		-ssh-keygen -t rsa -b 4096 -C ["tucorreo@mail.com](mailto:%22tucorreo@mail.com)"
		
		Puedes especificar una nueva ruta para guardarlo, o dejarlo por defecto, al dejarlo por defecto no necesitas cambiar en Homestead.yaml.

	* **lucasmartinezesper** [505813] (1)

		Revisa tu configuracion SSH de Vagrant

	* **Kenet Chungandro** [505813] (1)

		debes generar tu llave ssh con el nombre que se especifica en la configuraci√≥n de Homestead.yml

* **Paul Cortes** (1) [1127233](https://platzi.com/comentario/1127233/) 

	Excelente, para el desarrollo local y por integracion continua prefiero [LARADOCK](http://laradock.io/), sin embargo por velocidad y practicidad en Windows uso [Laragon](https://laragon.org/) que tambien es un software muy f√°cil de manejar en Windows, sin embargo cuando trabajo en proyectos donde algunos en ocasiones trabajamos en otros sistemas como GNU\Linux o Mac OSX prefiero Laradock

* **juliotobar** (1) [1110966](https://platzi.com/comentario/1110966/) 

	Si a alguien le ayuda aqui dejo un post que me sirvio para la configuraci√≥n Homestead.yaml en windows  
	(<https://medium.com/@eaimanshoshi/i-am-going-to-write-down-step-by-step-procedure-to-setup-homestead-for-laravel-5-2-17491a423aa>)

* **juand_silva** (1) [1082483](https://platzi.com/comentario/1082483/) 

	Docker sin dudarlo es lo mejor!

* **Alexander Daniel Linares R√≠os** (1) [1074787](https://platzi.com/comentario/1074787/) 

	creo que para todos, no hacer este paso y si el problema es php, lo ideal seria usar wampserver, <http://www.wampserver.com/en/>, que es lo mismo que xampp, la diferencia es que tu decides con que versi√≥n de php quieres usar, y si quieres cambiar otra versi√≥n de php el da la opci√≥n de escoger y si no la posees tambi√©n te da la opci√≥n de descargar

	* **Robinson Pulgarin Torres** [1074787] (1)

		Hola Alexander, la √∫ltima vez que utilic√© Wampserver me present√≥ muchos inconvenientes de configuraci√≥n; actualmente no s√© si ha mejorado, espero que s√≠, sin embargo, recomiendo aprender siempre de nuevas herramientas y tener a la mano varias opciones.

* **Omar Augusto Samudio Duarte** (1) [1074573](https://platzi.com/comentario/1074573/) 

	Yo uso XAMPP un compilado .exe muy comodo ‚Ä¶a un solo click

* **Oscar Lopez** (1) [1016214](https://platzi.com/comentario/1016214/) 

	No entiendo, como se relaciona esto con Virtual Box, por ejemplo podr√≠as usar virtual box en vez de vagrant no?

* **jorge-gianareas** (1) [978632](https://platzi.com/comentario/978632/) 

	Descargaremos Vagrant y lo instalaremos <https://www.vagrantup.com/>  
	Utilizaremos la imagen de Laravel Homestead siguiendo los pasos que aqu√≠ se describen: <https://laravel.com/docs/5.7/homestead>. Las im√°genes de Vagrant las llamaremos box o cajas, Homestead es una de ellas.  
	Cuando inicializamos Homestead, lo que hacemos es crear un nuevo archivo de configuraci√≥n ‚ÄúHomestead.yaml‚Äù.  
	Al editar el archivo ‚ÄúHomestead.yaml‚Äù, tenemos informaci√≥n de la ip que no es el localhost por ser m√°quina virtual. Aqu√≠ igualmente ligamos nuestra carpeta de proyecto a la carpeta de la m√°quina virtual; tambi√©n podemos a√±adir bases de datos y diferentes proyectos dentro de la misma m√°quina o box.  
	Cuando usas el comando ‚Äúvagrant up‚Äù se crear√° una m√°quina virtual vagrant si no existe; si existe se reiniciar√° la m√°quina existente. Se ejecutar√° tambi√©n el aprovisionamiento que es configurar o instalar cualquier cosa que se necesite.

* **jorge-gianareas** (1) [978631](https://platzi.com/comentario/978631/) 

	Existen dos vertientes principales: Vagrant y Docker. Vagrant genera m√°quinas virtuales completas en las cuales podemos instalar PHP, bases de datos, Apache, entre otras. La otra vertiente es Docker con la cual se generan peque√±os contenedores dentro de una m√°quina virtual los cuales contienen la instalaci√≥n de PHP o la base de datos, logrando que trabajen en conjunto.

* **jorge-gianareas** (1) [978629](https://platzi.com/comentario/978629/) 

	Cuando trabajas con m√∫ltiples proyectos, el hacerlo con tu m√°quina ya no es tan f√°cil ya que muchas veces necesitas diferentes versiones de PHP o tu equipo puede tener diferentes sistemas operativos, diferentes versiones de PHP o diferentes versiones de la base de datos lo cual puede ser bastante problem√°tico. Para solucionar esto usamos la virtualizaci√≥n que nos permite crear entornos virtuales dentro de nuestro equipo que nos ayudan a tener un entorno de desarrollo ideal.

* **Kenet Chungandro** (1) [971852](https://platzi.com/comentario/971852/) 

	 **Ojo!** para evitar cualquier error, para este video antes que nada toca tener instalado virtualbox y creada una llave ssh, esto evitar√° errores comunes como que no encuentra la llave p√∫blica que se especifica en el Homestead.yml, o que no encuentra el VboxManage(virtualbox)

* **A√±aqui Apolinar Morales** (1) [882703](https://platzi.com/comentario/882703/) 

	Pra instalar vagrant en ubuntu es con el sigueinte comando: sudo apt install vagrant

* **Carlos Andres Casta√±eda Osorio** (1) [777269](https://platzi.com/comentario/777269/) 

	Por tener un caracter especial en el nombre de usuario del sistema operativo (CARLOS CASTA **√ë** EDA en mi caso), en el CMD abierto como administrador toca realizar este paso previo
	``` 
	    set VAGRANT_HOME=C:\HashiCorp\Vagrant
	    
	```
	
	Adem√°s en el archivo de configuraci√≥n _Homestead.yaml_ se debe cambiar las rutas a absolutas y todas las copiarlas a rutas que no est√©n relacionadas con nombres de caracteres especiales (Por ejemplo: C:\vagrant.ssh ). Esta soluci√≥n me funcion√≥ luego de mucho intentar, si alguien tiene una mejor soluci√≥n por aportar BIENVENIDA!.

* **Carlos Andres Casta√±eda Osorio** (1) [777237](https://platzi.com/comentario/777237/) 

	Ojo con esta aclaraci√≥n de Vagrant, llevo d√≠as sacandome los ojos con que mi nombre de usuario tenga ‚Äú√ë‚Äù
	``` 
	    Windows users should not use the ~/ path syntax and instead should use the fullpathto their project, such as C:\Users\user\Code\project1.
	    
	```

	* **Leo Moon** [777237] (1)

		Una opci√≥n muy sencilla es utilizar un directorio diferente al de usuario creado por el sistema directamente en directorio ra√≠z por ejemplo /proyectos

* **jangove** (1) [714334](https://platzi.com/comentario/714334/) 

	Estoy haciendo un proyecto en laravel 5.4.36 quiero compilar el comando PRESET . -> no esta definidio sera por version ??

	* **lucasmartinezesper** [714334] (1)

		No estoy muy seguro, deber√≠as revisar la documentaci√≥n a fondo. Suerte!

* **Jhonny Stiven Agudelo Tenorio** (1) [707839](https://platzi.com/comentario/707839/) 

	There was an error while executing `VBoxManage`, a CLI used by Vagrant  
	for controlling VirtualBox. The command and stderr is shown below.
	
	Command: [‚Äústartvm‚Äù, ‚Äú1459b777-5d02-439b-a040-73e8ea1e016a‚Äù, ‚Äú‚Äìtype‚Äù, ‚Äúheadless‚Äù]
	
	Stderr: VBoxManage.exe: error: Call to WHvSetupPartition failed: ERROR_SUCCESS (Last=0xc000000d/87) (VERR_NEM_VM_CREATE_FAILED)  
	VBoxManage.exe: error: Details: code E_FAIL (0x80004005), component ConsoleWrap, interface IConsole

	* **lucasmartinezesper** [707839] (1)

		Revisa la instalaci√≥n de Vagrant.

	* **Jaime Uriel Diaz Garcia** [707839] (1)

		tengo el mismo problema alguien sabe como solucionarlo

	* **Kenet Chungandro** [707839] (1)

		Quiere decir que no encontr√≥ el archivo VBoxManage.exe y eso pasa cuando no has instalado el virtualbox previamente, me pas√≥ igual y lo resolv√≠ instalando virtualbox y volviendo a ejecutar el comando **vagran up** , antes de ejecutarlo es recomendable de que reinicies la m√°quina.

* **Miriam Fern√°ndez** (1) [707775](https://platzi.com/comentario/707775/) 

	Cual es la diferencia entre Vagrant y Docker? Porque no se hace en docker?

	* **lucasmartinezesper** [707775] (1)

		En este caso con Vagrant estas levantando una imagen completa para el desarrollo de una sola vez gracias a Homestead. Docker es por contenedor. Se puede hacer de las dos formas, esta ha sido r√°pida.

* **Pablo Juarez Castillo** (1) [624574](https://platzi.com/comentario/624574/) 

	Ok a comenzar

	* **lucasmartinezesper** [624574] (1)

		toda la suerte!

* **zarza-raul** (1) [556323](https://platzi.com/comentario/556323/) 

	solo puedo instalar vagrant 2.0.2 y necesito 2.1.0 pero no la puedo instalar estoy en lubuntu üò¶

	* **zarza-raul** [556323] (1)

		olvidenlo, solo instale una versi√≥n no tan nueva xD

	* **lucasmartinezesper** [556323] (1)

		Cual es el error?

* **Daniel Mendez** (1) [547345](https://platzi.com/comentario/547345/) 

	hola ayuda porfa!  
	cuando pongo el comando vagrant box add laravel/homestead me sale lo siguiente:
	
	![Captura de pantalla 2019-03-28 a la\(s\) 10.25.01 p. m..png](https://static.platzi.com/media/user_upload/Captura%20de%20pantalla%202019-03-28%20a%20la%28s%29%2010.25.01%20p.%20m.-483eb392-aea8-4e0c-8de1-c5216d100098.jpg)

	* **Jorge Alejandro Soto Govea** [547345] (1)

		Ese error es porque en tu archivo de Homestead.yaml tienes un error de sintaxis. Mira esta [referencia](https://stackoverflow.com/questions/37773743/vagrant-up-throws-parse-error)

	* **lucasmartinezesper** [547345] (1)

		Revisa el archivo de configuraci√≥n

* **Daniel Mendez** (1) [523259](https://platzi.com/comentario/523259/) 

	Hola disculpen? En el caso que yo este utilizando ya virtualbox centos7 porque estoy en un computadora window? siempre se puede usar vagrant y hacer todo el proceso?

	* **ebar0n (Platzi)** [523259] (1)

		Hola, si ya tienes centos 7 virtualizado, puedes trabjar alli mismo, pero si quieres usar vagrant, te recomiendo hacerlo en windows y no dentro de centos7, ya que eso agregaria una capa mas de virtualizacion, y pondria todo mas lento.

	* **lucasmartinezesper** [523259] (1)

		Igual, es recomendable solo una capa de Virtualizaci√≥n, en este caso de win para Vagrant

* **Juan Pena Verd√∫** (1) [522962](https://platzi.com/comentario/522962/) 

	Sin duda, para los usuarios de Windows <https://laragon.org/>

	* **Juan Pena Verd√∫** [522962] (1)

		Laragon is very powerful. It can be used as an isolated & portable development environment for many stacks:
		
		PHP  
		Node.js/MEAN  
		Ruby on Rails  
		Python/Django  
		Python/Flask  
		Java/Spring  
		Java/SpringBoot  
		Go  
		Laragon also supports many database servers:
		
		MySQL/MariaDB  
		MongoDB  
		Postgres  
		<https://laragon.org/docs/powerful.html>

	* **lucasmartinezesper** [522962] (1)

		Fantastico aporte! a probar.

* **Gabriel Amaya Bobadilla** (1) [522282](https://platzi.com/comentario/522282/) 

	Al momento de usar
	``` 
	    vagrantbox add laravel/homestead
	    
	```
	
	hay alguna diferencia si utilizo Hyper-V?

	* **hectorbenitez** [522282] (2)

		todo depende de cual herramienta de virtualizacion estaras usando, si no usaras virtualbox, usa el que mas te guste

* **Milton Cesar Catalan Parra** (1) [495084](https://platzi.com/comentario/495084/) 

	Hola todos, tengo un problema con la virtualizacion trabajo en windows y cuando coloco el comando vagrant up me dice este error "An error occurred while downloading the remote file. The error  
	message, if any, is reproduced below. Please fix this error and try  
	again.
	
	Couldn‚Äôt open file /C:/Users/Milton/Desktop/PHPAvanzado/base"  
	La carpeta base , no entiendo como la agrego.  
	Gracias

* **lucas-guzman** (1) [480554](https://platzi.com/comentario/480554/) 

	Cuando intento descargar el homestead me da el siguiente error
	
	OpenSSL SSL_read: SSL_ERROR_SYSCALL, errno 10054
	
	Esto ocurre una vez que elijo la opci√≥n 3 (virtual box)
	
	Agradezco la ayuda  
	Saludos!

	* **hectorbenitez** [480554] (1)

		Revisa que tengas la ultima version de Vagrant y VirtualBox

	* **ianmarcelostuardo** [480554] (2)

		Amigo, tuve 2 veces el mismo problema y lo solucion√© volviendo a ejecutar el comando. Pasa que la descarga es interrumpida por problemas de red, y por eso marca error. Saludos!

	* **lucasmartinezesper** [480554] (1)

		Revisa las versiones

* **bryan.a.sanchez.98** (1) [479886](https://platzi.com/comentario/479886/) 

	vagrant cuando lo suba en productivo tengo que subirlo es decir usar vagran en productivo ?

	* **Diego Alexander Forero Higuera (Platzi)** [479886] (1)

		No, el uso de vagrant es simular lo mejor posible tu entorno de producci√≥n, pero en producci√≥n el ideal es instalar todo directamente en el sistema, php, mysql y todo lo que necesites.

	* **lucasmartinezesper** [479886] (1)

		No, Vagrant es un entorno para que puedas trabajar desde tu computadora como si estuvieras en producci√≥n, a diferencia de wamp server u otro servidor es que si tus compa√±eros de trabajo tienen la misma imagen de virtualizaci√≥n que vos entonces todos tienen las mismas condiciones de entorno (php, base de datos, etc)

* **Robert Stoelzaed** (1) [475349](https://platzi.com/comentario/475349/) 

	Hola, al ejecutar vagrant up, me sale este error.  
	‚ûú homestead git:(master) vagrant up  
	The provider ‚Äòvirtualbox‚Äô that was requested to back the machine  
	‚Äôhomestead-7‚Äô is reporting that it isn‚Äôt usable on this system. The  
	reason is shown below:
	
	Vagrant could not detect VirtualBox! Make sure VirtualBox is properly installed.  
	Vagrant uses the `VBoxManage` binary that ships with VirtualBox, and requires  
	this to be available on the PATH. If VirtualBox is installed, please find the  
	`VBoxManage` binary and add it to the PATH environmental variable.
	
	Alguna soluci√≥n?

	* **hectorbenitez** [475349] (4)

		Necesitas instalar Virtual Box  
		<https://www.virtualbox.org/>

	* **lucasmartinezesper** [475349] (1)

		Instala Virtual Box‚Ä¶üôåüëå  
		El error dice ‚Äú¬°Vagrant no pudo detectar VirtualBox! Aseg√∫rese de que VirtualBox est√© instalado correctamente.‚Äù

* **Robert Stoelzaed** (1) [475192](https://platzi.com/comentario/475192/) 

	Si a alguien le da alg√∫n error al instalar homestead, prueben con esto:  
	cd  
	cd .vagrant.d/tmp/  
	rm -rf ~/.vagrant.d/tmp/  
	vagrant box add --insecure laravel/homestead  
	Esto elimina un archivo temporal que se crea al intentar instalar homestead la primera vez y luego se reinstala con el par√°metro --insecure.

* **Facundo R√≠os** (1) [469549](https://platzi.com/comentario/469549/) 

	Buenas, estaba probando la instalaci√≥n de la maquina virtual pero me dice que es privada y me saca.

	* **Diego Alexander Forero Higuera (Platzi)** [469549] (1)

		En que parte te da el error?, seguiste los pasos como los indica el profesor?, si puedes compartir capturas de pantalla del error es probable que te podamos ayudar.

	* **lucasmartinezesper** [469549] (1)

		Comparte el error para guiar las soluciones.

* **Alejandro Estupi√±an** (1) [463500](https://platzi.com/comentario/463500/) 

	No me deja editar el archivo yaml

	* **Mariana Valencia** [463500] (2)

		Si est√°s usando Windows a m√≠ tambi√©n me daba ese error, te aconsejo que intentes editarlo no por consola sino con cualquier editor de c√≥digo que tengas a mano.

	* **lucasmartinezesper** [463500] (1)

		Revisa los comandos de consola de edici√≥n de archivos o bien edita el archivo con tu IDE.

* **andresnakanishi** (1) [459821](https://platzi.com/comentario/459821/) 

	Sinceramente no conoc√≠a Vagrant, parece interesante.

	* **Japheth Calzada L√≥pez** [459821] (1)

		ni yo

	* **lucasmartinezesper** [459821] (1)

		Quiz√°s porque no se te dio la necesidad de utilizarlo. Pero esta bueno saber para qu√© sirve llegado el caso se requiera.

* **A√±aqui Apolinar Morales** (1) [76361](https://platzi.com/comentario/885833/) 
Me sale este error en consola y no se como corregirlo, me podrian explicar The specified checksum type is not supported by Vagrant:...

	* **tzalejo** [76361] (1)

		Hola, probaste en actualizar Vagrant?
		``` 
		    vagrantbox update
		    
		```
		
		Saludos

* **OSCAR RIGOBERTO VILLA COVARRUBIAS** (1) [63629](https://platzi.com/comentario/662354/) 
vagrant requeire liciencia o es gratuito??

	* **Nicol√°s Marulanda P.** [63629] (1)

		Hola, es gratuito, tiene licencia MIT.
		
		<https://github.com/hashicorp/vagrant/blob/master/LICENSE>

* **Danniel Sequera** (1) [61588](https://platzi.com/comentario/624218/) 
Pipol, una pregunta. ¬øEn qu√© ruta de carpetas se descarga la imagen de Vagrant? Es decir, el archivo que se descargar cuando ejecutamos e...

* **Luis Andr√©s Arce C√°rdenas** (1) [60130](https://platzi.com/comentario/601123/) 
¬øAlguien utiliz√≥ Docker para crear un contenedor para PHP y Composer?. Si alguien tiene una idea o pudiera explicarme como lo hizo lo agr...

	* **Alan Riveros** [60130] (2)

		Te paso el enlace a un proyectito que hice hace mil a√±os Seguramente te va a ser de ayuda [Docker-For-PHP](https://github.com/alanRiveros/DockerDev)

* **zarza-raul** (1) [56744](https://platzi.com/comentario/556323/) 
solo puedo instalar vagrant 2.0.2 y necesito 2.1.0 pero no la puedo instalar estoy en lubuntu üò¶

	* **zarza-raul** [56744] (1)

		olvidenlo, solo instale una versi√≥n no tan nueva xD

* **Daniel Mendez** (1) [55967](https://platzi.com/comentario/547345/) 
hola ayuda porfa! cuando pongo el comando vagrant box add laravel/homestead me sale lo siguiente:

	* **Jorge Alejandro Soto Govea** [55967] (1)

		Ese error es porque en tu archivo de Homestead.yaml tienes un error de sintaxis. Mira esta [referencia](https://stackoverflow.com/questions/37773743/vagrant-up-throws-parse-error)

* **Daniel Mendez** (1) [53903](https://platzi.com/comentario/523259/) 
Hola disculpen? En el caso que yo este utilizando ya virtualbox centos7 porque estoy en un computadora window? siempre se puede usar vagr...

	* **ebar0n (Platzi)** [53903] (1)

		Hola, si ya tienes centos 7 virtualizado, puedes trabjar alli mismo, pero si quieres usar vagrant, te recomiendo hacerlo en windows y no dentro de centos7, ya que eso agregaria una capa mas de virtualizacion, y pondria todo mas lento.

* **Gabriel Amaya Bobadilla** (1) [53810](https://platzi.com/comentario/522282/) 
Al momento de usar vagrant box add laravel/homestead hay alguna diferencia si utilizo Hyper-V?

	* **hectorbenitez** [53810] (2)

		todo depende de cual herramienta de virtualizacion estaras usando, si no usaras virtualbox, usa el que mas te guste

* **lucas-guzman** (1) [50505](https://platzi.com/comentario/480554/) 
Cuando intento descargar el homestead me da el siguiente error OpenSSL SSL_read: SSL_ERROR_SYSCALL, errno 10054 Esto ocurre una vez que e...

	* **hectorbenitez** [50505] (1)

		Revisa que tengas la ultima version de Vagrant y VirtualBox

* **Robert Stoelzaed** (1) [50061](https://platzi.com/comentario/475349/) 
Hola, al ejecutar vagrant up, me sale este error. ‚ûú homestead git:(master) vagrant up The provider ‚Äòvirtualbox‚Äô that was requested to ba...

	* **hectorbenitez** [50061] (4)

		Necesitas instalar Virtual Box  
		<https://www.virtualbox.org/>

## 0040. Configuraci√≥n de virtual host [16206](https://platzi.com/clases/1462-php-avanzado/16206-configuracion-de-virtual-host/)

### Descripci√≥n:


* El archivo host sirve para indicarle a nuestra computadora que cierta url est√° relacionada con cierta ip. Debes modificar este archivo si quieres que al escribir cierta url, el computador entienda una ip dada. En este caso usaremos la ip que tenemos en nuestro archivo ‚ÄúHomestead.yaml‚Äù y la url ser√° cursophp.test.
* El comando ‚Äúvagrant ssh‚Äù va a meterte dentro de la m√°quina virtual que creaste. Esto es bueno porque todo lo que usemos en un equipo de trabajo ser√° estandarizado, todo basado en Linux y con las mismas versiones.
* Homestead ya cuenta con **Composer** instalado por default, as√≠ que podemos traer todas las dependencias de nuestro proyecto con ‚Äúcomposer install‚Äù una vez que estemos en la carpeta de nuestro proyecto.
* Creamos una conexi√≥n ssh para la base de datos y creamos la tabla jobs. Con esto ya funcionar√° el proyecto del curso pasado, virtualizado.



### Comentarios:

* **Daniel Ram√≠rez Mendoza** (3) [474324](https://platzi.com/comentario/474324/) 

	El enlace al c√≥digo que deben de descargar de github: <https://github.com/hectorbenitez/curso-introduccion-php/tree/deploy>

	* **lucasmartinezesper** [474324] (1)

		Gracias por recordarlo!

* **Juanjosexdd7** (2) [674337](https://platzi.com/comentario/674337/) 

	en windows esto es horrible

	* **lucasmartinezesper** [674337] (2)

		Hay que buscar la vuelta hermano! adelante siempre!

	* **Michael Rodriguez** [674337] (1)

		Para eso es vagrant y laravel/homestead para facilitarnos la vida jejeje

* **Danilo Pazos** (2) [583308](https://platzi.com/comentario/583308/) 
Windows es malasio para desarrollo üò¨

	* **lucasmartinezesper** [583308] (2)

		No es malisimo, solo que tiene sus configuraciones, una vez que lo logras y pr√°cticas se hace h√°bito por ende m√°s f√°cil. Sigue adelante y no abandones.

	* **Kenet Chungandro** [583308] (1)

		Por lo general no se recomienda usar windows para el desarrollo por las limitaciones que tienes(pero si se puede), Linux o mac son mejores alternativas debido a que te da el control de todo üòÑ

* **koshiroanz** (2) [559410](https://platzi.com/comentario/559410/) 

	Para aquellos que quieran utilizar phpmyadmin. Les dejo un link donde podr√°n seguir los pasos: <https://github.com/grrnikos/pm>

	* **lucasmartinezesper** [559410] (1)

		Gracias por el aporte!

* **Paul Cortes** (1) [1127270](https://platzi.com/comentario/1127270/) 

	Excelente conocimientos b√°sico que se aprenden de red local dentro del PC, Ejemplo archivo HOST del sistema Good!!!

* **Juan David Rodriguez** (1) [1100230](https://platzi.com/comentario/1100230/) 

	Para las personas que utilizaron MySQL Workbench, la configuraci√≥n queda de la siguiente manera:  
	![imagen](https://i.imgur.com/CX6RECW.png)

* **jorge-gianareas** (1) [978639](https://platzi.com/comentario/978639/) 

	Creamos una conexi√≥n ssh para la base de datos y creamos la tabla jobs. Con esto ya funcionar√° el proyecto del curso pasado, virtualizado.

* **jorge-gianareas** (1) [978638](https://platzi.com/comentario/978638/) 

	Homestead ya cuenta con Composer instalado por default, as√≠ que podemos traer todas las dependencias de nuestro proyecto con ‚Äúcomposer install‚Äù una vez que estemos en la carpeta de nuestro proyecto.

* **jorge-gianareas** (1) [978637](https://platzi.com/comentario/978637/) 

	El comando ‚Äúvagrant ssh‚Äù va a meterte dentro de la m√°quina virtual que creaste. Esto es bueno porque todo lo que usemos en un equipo de trabajo ser√° estandarizado, todo basado en Linux y con las mismas versiones.

* **jorge-gianareas** (1) [978635](https://platzi.com/comentario/978635/) 

	El archivo host sirve para indicarle a nuestra computadora que cierta url est√° relacionada con cierta ip. Debes modificar este archivo si quieres que al escribir cierta url, el computador entienda una ip dada. En este caso usaremos la ip que tenemos en nuestro archivo ‚ÄúHomestead.yaml‚Äù y la url ser√° cursophp.test.

* **Kenet Chungandro** (1) [975030](https://platzi.com/comentario/975030/) 

	 **Tuve muchos problemas pero ya logr√© solucionarlo todo, mi caso es el siguiente:**
	
	* El curso de introducci√≥n de php lo maneje con una base de datos PostgreSql.
	
	
	
	Debido a eso no pod√≠a seguir los mismos pasos que el profe, mi soluci√≥n fue modificar los archivos de configuraci√≥n dentro de la maquina virtual, especificamente ‚Äú/etc/postgresql/11/main/pg_hba.conf‚Äù reemplazando en la √∫ltima l√≠nea el 27.0.0.1/32 por all, quedando as√≠ **host all all all md5**. Esto lo que hace es que acepte las conexiones remotas las cuales las hice con pgadmin4 desde Ubuntu.

* **Jes√∫s Abano Ferrara** (1) [959083](https://platzi.com/comentario/959083/) 

	No s√© si hice algo mal, pero solo cambie los datos del **.env** y funcion√≥ la base de datos. Creando la tabla **jobs** no funcionaba.

* **gerql14** (1) [954281](https://platzi.com/comentario/954281/) 

	Me di cuenta que vagrant no est√° tomando el .htaccess  
	Por lo tanto no est√° tomando los estilos
	
	El redireccionamiento a /public se hace debido a la configuracion del archivo .yaml, m√°s no porque est√© tomando el .htaccess

	* **Michael Rodriguez** [954281] (1)

		tenes mal confiura el Homestead.yaml ,debes tener cuidado de entender esta configuracion
		
		folders:  
		\- map: c:\wamp64\www  
		to: /home/vagrant/code
		
		sites:  
		\- map: miproyecto.test  
		to: /home/vagrant/code/miproyecto/public

	* **gerql14** [954281] (0)

		Hola @mmrodriguez1987  
		Gracias por responder.
		
		Si tengo configurado de esa forma el .yaml
		
		Pero me di cuenta que los estilos no estan cargando
		
		Y de hecho, puse un nuevo .htacces para probar, con lo siguiente
		
		RewriteEngine On  
		RewriteRule index.html <http://www.google.com> [R]
		
		Y no lo est√° tomando

	* **Kenet Chungandro** [954281] (2)

		Lo que pasa es que vagrant en un entorno completo y las configuraciones en el apache deben estar diferentes a las quue tienes en el sistema principal, si manejas linux al instalar apache2 las ‚Äúrutas m√°gicas‚Äù que son lo que conocemos como los .htaccess no estan habilitadas, es decir puedes crear los archivos pero apache no las leer√°, para eso hay que configurar un archivo de apache en el cu√°l se especifica que esten habilitados los .htaccess

	* **gerql14** [954281] (0)

		Hola @kenet-chungandro, gracias por comentar  
		Entiendo, entonces se debe de agregar una configuraci√≥n m√°s, en √©ste caso ese archivo.  
		Podr√≠as indicarme como configurarlo, o como se llama dicho archivo?  
		Gracias nuevamente, saludos

* **Jhonny Stiven Agudelo Tenorio** (1) [710734](https://platzi.com/comentario/710734/) 

	No input file specified. me aparece asi ¬øsaben por que? gracias

	* **samuelrc** [710734] (3)

		Hola Jhonny.  
		Comprob√° que las rutas en las secciones folders y sites del archivo homestead.yalm esten correctas tanto las de tu equipo local como la de la m√°quina virtual de vagrant. Luego de corregirlo usa el comando vagrant reload --provision o vagrant up --provision (seg√∫n si ya ejecutaste o no el comando vagrant up).

	* **Mois√©s Cede√±o** [710734] (1)

		Muchas gracias, Samuel. Funciona perfecto para mi.

* **Miriam Fern√°ndez** (1) [690220](https://platzi.com/comentario/690220/) 

	Cuando instala con composer el proyecto que framework viene asociado?

	* **codeisaac** [690220] (1)

		Ninguno, solo librerias que se usaron para crear este perfil que muestra.  
		Todo esta en el curso basico de php por si gustas verlo a mas detalle.

	* **lucasmartinezesper** [690220] (1)

		Lo que hace composer en la instalaci√≥n dentro de la m√°quina virtual es traer todas las dependencias que tiene configurado.

* **Jose Israel Alvarez Garcia** (1) [649353](https://platzi.com/comentario/649353/) 

	Es incre√≠ble esto de la virtualizacion. Para windows prefiero usar Laragon, un servidor local con todo. Nodejs, composer, gui para base de datos como Heidi, etc. Y hasta Host virtuales. Ya que windows es muy molesto de repente con todo esto. Saludos.

	* **lucasmartinezesper** [649353] (1)

		Si es muy buena opci√≥n por la variedad de recursos ya instalados:  
		Pueden revisarlo aqu√≠:
		
		<https://laragon.org/>

* **Kevin William Roberts Costa** (1) [637226](https://platzi.com/comentario/637226/) 

	me qued√≥ pendiente la base de datos. Cuando se configura db cursophp???

	* **Diego Alexander Forero Higuera (Platzi)** [637226] (2)

		Homestead configura la base de datos de forma automatica con el nombre del proyecto, por eso solo hace falta conectarse. <https://laravel.com/docs/5.8/homestead#configuring-homestead> busca Connecting To Databases

	* **Kevin William Roberts Costa** [637226] (1)

		No pude crear nuevamente la instancia con el archivo yaml actualizado, prob√© provisonar nuevamente pero no funcion√≥

	* **Diego Alexander Forero Higuera (Platzi)** [637226] (2)

		Hola, te sale alg√∫n error al lanzar la instancia de homestead?

	* **Kevin William Roberts Costa** [637226] (1)

		Ten√©s raz√≥n Gollum, me falt√≥ configurar bien el archivo de configuraci√≥n. Gracias!

* **Gonzalo Cofr√©** (1) [582031](https://platzi.com/comentario/582031/) 

	C√≥mo solucionaron el problema del ‚ÄúNo route‚Äù?

	* **anibalrojas (Platzi)** [582031] (1)

		Ya revisaste los hilos que est√°n en los aportes de esta clase, em particular: <https://platzi.com/comentario/477909/> y <https://platzi.com/comentario/487882/> donde hay troubleshootings b√°sicos. Si necesitas m√°s ayuda no dejes de preguntar.

	* **Gabriel Montes** [582031] (1)

		Para solucionarlo solo debes mirar la ruta que le estas indicando en tu archivo index.php, all√≠ se establecio la ruta correcta para acceder en mi caso yo habia especificado la ruta como ‚Äú/platzi/php/‚Äù solo debia agregarsela a todo el link ‚Äúcursophp.test/platzi/php/‚Äù

	* **Juan David Rodriguez** [582031] (1)

		Cuando est√°bamos desarrollando el curso b√°sico de PHP, yo utilic√© xampp, en la ruta base de direccionamiento tuve que a√±adir una ruta base (la carpeta que se crea en htdocs), en mi caso ‚ÄúCursoPHP‚Äù, solo hay que quitar esa ruta base que se a√±adi√≥ y ya funciona correctamente.  
		En la carpeta "controller " esta "AuthController.php"  
		En la carpeta ‚Äúpublic‚Äù esta "index.php"  
		En la carpeta ‚ÄúViews‚Äù estan:
		
		* addJob.php
		* addProject.php
		* addUser.php
		* admin.php
		* login.php
		
		

* **EnriqueAL** (1) [576250](https://platzi.com/comentario/576250/) 

	Me da este error y no se realmente como resolverlo.  
	**No input file specified. **  
	he estado siguiendo todos los tal cual, espero que alguien pueda ayudarme

	* **Diego Alexander Forero Higuera (Platzi)** [576250] (1)

		Hola, puedes compartir el stack trace completo del error para entender mejor que pasa y poder ayudarte.

	* **jose-daniel-martinez-m** [576250] (1)

		Ese error significa que no se est√° entregando ningun archivo para que el servidor lo ejecute. Posiblemente tienes mal escrita la direcci√≥n hacia la carpeta ‚Äúpublic‚Äù en el archivo Homestead.yaml (en la parte de ‚Äúsites‚Äù). Revisa bien y despues usa el comando ‚Äúvagrant reload‚Äù

	* **jose-daniel-martinez-m** [576250] (1)

		Yo estaba escribiendo el nombre de la carpeta que puse a compartir despues de la parte de la direccion code as√≠:
		``` 
		    sites:
		        - map: portalst.test
		          to: /home/vagrant/code/++**workbench**++/portalst/public
		    
		```
		
		la forma correcta es sin poner esa carpeta pues es remplazada por la carpeta ‚Äúcode‚Äù as√≠:
		``` 
		    sites:
		        - map: portalst.test
		          to:/home/vagrant/code/portalst/public
		    
		```

	* **lucasmartinezesper** [576250] (1)

		Revisa cuidadosamente el archivo Homestead.yaml y luego recarga la maquina virtual.

* **Gero Barbieri** (1) [576214](https://platzi.com/comentario/576214/) 

	Alguien pudo solucionar el problema del No Route?

	* **Diego Alexander Forero Higuera (Platzi)** [576214] (1)

		Hola puedes compartir capturas del error o m√°s informaci√≥n para poder ayudarte.

	* **lucasmartinezesper** [576214] (1)

		SIn capturas y debug no se puede acerca una soluci√≥n.

	* **Kenet Chungandro** [576214] (1)

		Por lo general el error se debe a la especificaci√≥n de arranque del proyecto, es decir, debes tener en cuenta que el proyecto siempre arranque desde la carpeta /public con el archivo index.php, de no ser el caso siempre te dar√° el ‚Äúno route‚Äù

* **carmenvilla** (1) [565507](https://platzi.com/comentario/565507/) 

	es necesario utilizar maquina virtual hacer este curso ya que no cuento con un equipo lo suficientemente bueno para hacerlo a penas y anda con 2 pesta√±as del navegador y el visual studio code

	* **Diego Alexander Forero Higuera (Platzi)** [565507] (1)

		No necesitas una maquina virtual, si usas xampp o wamp en windows vas a poder seguir el curso sin problema.

	* **lucasmartinezesper** [565507] (1)

		No hace falta, recuerda que las m√°quinas virtuales son para que vos o otro miembro del equipo de trabajo pueda tener el mismo entorno de desarrollo a partir de una imagen √∫nica y evitar conflictos. Siempre tienes que tener en cuenta la necesidad para ver con que herramienta la cubres.

* **grupocentrico** (1) [564017](https://platzi.com/comentario/564017/) 

	En verdad, no aportan mucha ayuda para los usuarios de windows‚Ä¶ personalmente creo que es un fracaso este curo para los que usamos windows

	* **Diego Alexander Forero Higuera (Platzi)** [564017] (1)

		Cu√©ntanos que problemas tienes y con gusto te ayudamos a solucionarlos. Yo soy usuario de linux desde hace ya casi 8 a√±os y no me arrepiento, para el desarrollo hace que todo sea m√°s sencillo y r√°pido, no pierdes tiempo configurando cosas raras para que funcionen las cosas en windows.

	* **lucasmartinezesper** [564017] (2)

		T√≥malo como desaf√≠o, en windows se puede pero hay que buscarle la vuelta y aprender‚Ä¶ Cuando lo resuelvas el conocimiento se habr√° adquirido de manera m√°s fuerte! sigue adelante.

* **zarza-raul** (1) [548349](https://platzi.com/comentario/548349/) 

	üò¶
	
	C:/HashiCorp/Vagrant/embedded/mingw32/lib/ruby/2.4.0/psych.rb:377:in `parse‚Äô: (<unknown>): did not find expected ‚Äò-‚Äô indicator while parsing a block collection at line 16 column 5 (Psych::SyntaxError)

	* **lucasmartinezesper** [548349] (1)

		Cuando te sale ese error?

* **Juan Felipe Lara Martinez** (1) [544006](https://platzi.com/comentario/544006/) 

	Hola!!! Se me estar presentando un problema al carga la pagina. No se que significa el error que me esta generando alguien me puede ayudar con estos???
	
	![](http://i64.tinypic.com/30909hw.png)

	* **Angel Hernandez** [544006] (1)

		Pareciera ser un error de permisos en los archivos, que contiene el archivo Loader en la l√≠nea 133?

* **tomasechague** (1) [543375](https://platzi.com/comentario/543375/) 

	que programa parecido a sequel pro recomiendan utilizar para windows?

	* **lucasmartinezesper** [543375] (2)

		Prueba con Workbench <https://www.mysql.com/products/workbench/>

* **Daniee** (1) [513224](https://platzi.com/comentario/513224/) 

	c√≥mo detenemos la m√°quina vagrant cuando no queramos utilizarla m√°s ? gran herramienta !

	* **Juan Felipe Lara Martinez** [513224] (1)

		vagrant halt nombredelamaquina -> este es para detener la maquina  
		vagrant destroy --force -> este es para eliminarla

	* **lucasmartinezesper** [513224] (1)

		Con el comando vagrant halt, si ejecutas vagrant destroy destruye todos los recursos que se crearon durante el proceso de creaci√≥n de la m√°quina. Despu√©s de ejecutar este comando, su computadora debe dejarse en un estado limpio, como si nunca hubiera creado la m√°quina invitada en primer lugar.

* **Kevin Kleber Rivamontan Alvarado** (1) [487882](https://platzi.com/comentario/487882/) 

	Ayuda, me sale ‚ÄúNo route‚Äù he clonado el repositorio y me fu√≠ a la rama Deploy, puse composer install, y me sale ‚ÄúNo route‚Äù a todas las direcciones que pongo estoy usando XAMPP ¬øme echan una mano?

	* **hectorbenitez** [487882] (1)

		Como es la ruta que usas en tu navegador?
		
		puedes hacer un var_dump de $request->getUri() para saber que es lo que viene en tu request

	* **Santiago Arboleda Londo√±o** [487882] (2)

		Tambi√©n revisa que no est√©s accediendo a ‚Äúplatziphp.test/jobs/‚Äù en vez de ‚Äúplatziphp.test/jobs‚Äù

	* **Kevin Kleber Rivamontan Alvarado** [487882] (1)

		Hola H√©ctor, gracias por responder, mi ruta es
		``` 
		    localhost/curso-avanzado-php/
		    
		    
		```
		
		y el var_dumb de $request->getUri() es
		``` 
		    object(Zend\Diactoros\Uri)#15 (9) { ["allowedSchemes":protected]=> array(2) { ["http"]=> int(80) ["https"]=> int(443) } ["scheme":"Zend\Diactoros\Uri":private]=> string(4) "http" ["userInfo":"Zend\Diactoros\Uri":private]=> string(0) "" ["host":"Zend\Diactoros\Uri":private]=> string(9) "localhost" ["port":"Zend\Diactoros\Uri":private]=> NULL ["path":"Zend\Diactoros\Uri":private]=> string(20) "/curso-avanzado-php/" ["query":"Zend\Diactoros\Uri":private]=> string(0) "" ["fragment":"Zend\Diactoros\Uri":private]=> string(0) "" ["uriString":"Zend\Diactoros\Uri":private]=> NULL }
		    
		```

* **Jonathan Aguasaco** (1) [481835](https://platzi.com/comentario/481835/) 

	Alguien sabe como es el modelo de la base de datos del curso php, al intentar accder, sin utilizar homestead, tengo del anterior curso pero al parecer me falto configurar algo adicional en la base de datos.  
	`
	``` 
	    <code> `CREATE TABLE `jobs` (
	      `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
	      `title` text NOT NULL,
	      `description` text NOT NULL,
	      `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
	      `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
	      PRIMARY KEY (`id`)
	    )
	    
	```

	* **cadesa** [481835] (1)

		Ah√≠ falta la columna deleted_at, la podes agregar con:
		``` 
		    Altertable jobs addcolumn deleted_at datetime
		    
		```

	* **lucasmartinezesper** [481835] (1)

		Revisa el repositorio del curso anterior y compara los archivos.

* **Joseph Alexander Whacheng Barreto** (1) [477909](https://platzi.com/comentario/477909/) 

	Holaa!! Clon√© el archivo de git y ahora me sale ‚ÄúNo Route‚Äù. No s√© por qu√© no capta la ruta. Estoy usando XAMPP. Me ayudan por favor?
	
	Al usar var_dump me sale lo siguiente
	
	No route  
	Notice: Trying to get property ‚Äòhandler‚Äô of non-object in C:\xampp\htdocs\curso-introduccion-php\public\index.php on line 132  
	NULL
	
	en todas las rutas me sale as√≠!

	* **hectorbenitez** [477909] (1)

		Puedes poner aqui la ruta a la que accedes, y ademas hacer var_dump de $_GET y de este elemento $request->getUri()->getPath(), tal vez con eso podemos darnos una idea de que esta fallando

	* **Joseph Alexander Whacheng Barreto** [477909] (1)

		me sale lo siguiente:  
		No route  
		Notice: Undefined index: /curso-introduccion-php/ in C:\xampp\htdocs\curso-introduccion-php\public\index.php on line 133  
		NULL
		
		public/index.php:
		``` 
		    <?php
		    
		    ini_set('display_errors', 1);
		    ini_set('display_starup_error', 1);
		    error_reporting(E_ALL);
		    
		    require_once'../vendor/autoload.php';
		    
		    session_start();
		    
		    $dotenv = new Dotenv\Dotenv(__DIR__ . '/..');
		    $dotenv->load();
		    
		    useIlluminate\Database\Capsule\ManagerasCapsule;
		    useAura\Router\RouterContainer;
		    
		    $capsule = new Capsule;
		    
		    $capsule->addConnection([
		        'driver'    => 'mysql',
		        'host'      => 'localhost',
		        'database'  => 'cursophp',
		        'username'  => 'root',
		        'password'  => '',
		        'charset'   => 'utf8',
		        'collation' => 'utf8_unicode_ci',
		        'prefix'    => '',
		    ]);
		    
		    // Make this Capsule instance available globally via static methods... (optional)
		    $capsule->setAsGlobal();
		    // Setup the Eloquent ORM... (optional; unless you've used setEventDispatcher())
		    $capsule->bootEloquent();
		    
		    $request = Zend\Diactoros\ServerRequestFactory::fromGlobals(
		        $_SERVER,
		        $_GET,
		        $_POST,
		        $_COOKIE,
		        $_FILES
		    );
		    
		    $routerContainer = new RouterContainer();
		    $map = $routerContainer->getMap();
		    $map->get('index', '/', [
		        'controller' => 'App\Controllers\IndexController',
		        'action' => 'indexAction'
		    ]);
		    $map->get('addJobs', '/jobs/add', [
		        'controller' => 'App\Controllers\JobsController',
		        'action' => 'getAddJobAction'
		    ]);
		    $map->post('saveJobs', '/jobs/add', [
		        'controller' => 'App\Controllers\JobsController',
		        'action' => 'getAddJobAction'
		    ]);
		    $map->get('addUser', '/users/add', [
		        'controller' => 'App\Controllers\UsersController',
		        'action' => 'getAddUser'
		    ]);
		    $map->post('saveUser', '/users/save', [
		        'controller' => 'App\Controllers\UsersController',
		        'action' => 'postSaveUser'
		    ]);
		    $map->get('loginForm', '/login', [
		        'controller' => 'App\Controllers\AuthController',
		        'action' => 'getLogin'
		    ]);
		    $map->get('logout', '/logout', [
		        'controller' => 'App\Controllers\AuthController',
		        'action' => 'getLogout'
		    ]);
		    $map->post('auth', '/auth', [
		        'controller' => 'App\Controllers\AuthController',
		        'action' => 'postLogin'
		    ]);
		    $map->get('admin', '/admin', [
		        'controller' => 'App\Controllers\AdminController',
		        'action' => 'getIndex',
		        'auth' => true
		    ]);
		    
		    $matcher = $routerContainer->getMatcher();
		    $route = $matcher->match($request);
		    
		    functionprintElement($job)
		    {
		        // if($job->visible == false) {
		        //   return;
		        // }
		    
		        echo'<li class="work-position">';
		        echo'<h5>' . $job->title . '</h5>';
		        echo'<p>' . $job->description . '</p>';
		        echo'<p>' . $job->getDurationAsString() . '</p>';
		        echo'<strong>Achievements:</strong>';
		        echo'<ul>';
		        echo'<li>Lorem ipsum dolor sit amet, 80% consectetuer adipiscing elit.</li>';
		        echo'<li>Lorem ipsum dolor sit amet, 80% consectetuer adipiscing elit.</li>';
		        echo'<li>Lorem ipsum dolor sit amet, 80% consectetuer adipiscing elit.</li>';
		        echo'</ul>';
		        echo'</li>';
		    }
		    
		    if (!$route) {
		    
		        echo'No route';
		    } else {
		        $handlerData = $route->handler;
		        $controllerName = $handlerData['controller'];
		        $actionName = $handlerData['action'];
		        $needsAuth = $handlerData['auth'] ?? false;
		    
		         $sessionUserId = $_SESSION['userId'] ?? null;
		         if ($needsAuth && !$sessionUserId) {
		             echo'Protected route';
		             die;
		         }
		    
		        $controller = new $controllerName;
		        $response = $controller->$actionName($request);
		    
		        foreach($response->getHeaders() as $name => $values)
		        {
		            foreach($values as $value) {
		                header(sprintf('%s: %s', $name, $value), false);
		            }
		        }
		        http_response_code($response->getStatusCode());
		        echo $response->getBody();
		    }
		    
		    var_dump($_GET[$request->getUri()->getPath()]);```
		    
		```

* **Joseph Alexander Whacheng Barreto** (1) [473492](https://platzi.com/comentario/473492/) 

	Hola buenas noches! El codigo de github no coincide o quiz√° estoy escogiendo mal el branch. ¬øMe indicari√°s el branch que debo agarrar por favor?

	* **Japheth Calzada L√≥pez** [473492] (1)

		si el branch master de hecho no trae nada

	* **Daniel Ram√≠rez Mendoza** [473492] (2)

		Tienes que escoger el branch deploy, ese es el que se queda al final del curso de introducci√≥n de php, igual te dejo el enlace: <https://github.com/hectorbenitez/curso-introduccion-php/tree/deploy>

	* **hectorbenitez** [473492] (3)

		Si, pueden usar el branch deploy y despues estan los branches que inician con el numero 2

	* **Joseph Alexander Whacheng Barreto** [473492] (1)

		Gracias! Ahora tengo otro problema, ya clon√© el archivo de git y ahora me sale ‚ÄúNo Route‚Äù. No s√© por qu√© no capta la ruta. Estoy usando XAMPP. Me ayudan por favor?

	* **lucasmartinezesper** [473492] (1)

		branch deploy

* **DESTRUN** (1) [462550](https://platzi.com/comentario/462550/) 

	Es necesario hacer toda la virtualizaci√≥n para el curso?

	* **hectorbenitez** [462550] (4)

		No es necesario, puedes trabajar en local o usando XAMPP/MAMPP o algun otro setup de desarrollo, recuerda que debes tener PHP 7+, MySQL y Apache como minimo

	* **lucasmartinezesper** [462550] (1)

		No, solo estas creando otra opci√≥n de entorno de desarrollo. Cuando trabajes en un equipo un poco grande te va servir estas clases de virtualizaci√≥n.

* **Gonzalo Cofr√©** (1) [58797](https://platzi.com/comentario/582031/) 
C√≥mo solucionaron el problema del ‚ÄúNo route‚Äù?

	* **anibalrojas (Platzi)** [58797] (1)

		Ya revisaste los hilos que est√°n en los aportes de esta clase, em particular: <https://platzi.com/comentario/477909/> y <https://platzi.com/comentario/487882/> donde hay troubleshootings b√°sicos. Si necesitas m√°s ayuda no dejes de preguntar.

* **zarza-raul** (1) [56070](https://platzi.com/comentario/548349/) 
üò¶ C:/HashiCorp/Vagrant/embedded/mingw32/lib/ruby/2.4.0/psych.rb:377:in `parse‚Äô: (<unknown>): did not find expected ‚Äò-‚Äô indicator wh...

	* **lucasmartinezesper** [56070] (1)

		Cuando te sale ese error?

* **Juan Felipe Lara Martinez** (1) [55689](https://platzi.com/comentario/544006/) 
Hola!!! Se me estar presentando un problema al carga la pagina. No se que significa el error que me esta generando alguien me puede ayuda...

	* **Angel Hernandez** [55689] (1)

		Pareciera ser un error de permisos en los archivos, que contiene el archivo Loader en la l√≠nea 133?

* **Kevin Kleber Rivamontan Alvarado** (1) [51136](https://platzi.com/comentario/487882/) 
Ayuda, me sale ‚ÄúNo route‚Äù he clonado el repositorio y me fu√≠ a la rama Deploy, puse composer install, y me sale ‚ÄúNo route‚Äù a todas las di...

	* **hectorbenitez** [51136] (1)

		Como es la ruta que usas en tu navegador?
		
		puedes hacer un var_dump de $request->getUri() para saber que es lo que viene en tu request

* **Joseph Alexander Whacheng Barreto** (1) [50284](https://platzi.com/comentario/477909/) 
Holaa!! Clon√© el archivo de git y ahora me sale ‚ÄúNo Route‚Äù. No s√© por qu√© no capta la ruta. Estoy usando XAMPP. Me ayudan por favor? Al u...

	* **hectorbenitez** [50284] (1)

		Puedes poner aqui la ruta a la que accedes, y ademas hacer var_dump de $_GET y de este elemento $request->getUri()->getPath(), tal vez con eso podemos darnos una idea de que esta fallando

* **Joseph Alexander Whacheng Barreto** (1) [49913](https://platzi.com/comentario/473492/) 
Hola buenas noches! El codigo de github no coincide o quiz√° estoy escogiendo mal el branch. ¬øMe indicari√°s el branch que debo agarrar por...

	* **Japheth Calzada L√≥pez** [49913] (1)

		si el branch master de hecho no trae nada

* **DESTRUN** (1) [49083](https://platzi.com/comentario/462550/) 
Es necesario hacer toda la virtualizaci√≥n para el curso?

	* **hectorbenitez** [49083] (4)

		No es necesario, puedes trabajar en local o usando XAMPP/MAMPP o algun otro setup de desarrollo, recuerda que debes tener PHP 7+, MySQL y Apache como minimo

* **jaimefer35** (0) [970361](https://platzi.com/comentario/970361/) 

	Saludos al momento de acceder a cursophp.test me sale el siguiente error, alguien sabe como solucionarlo, gracias
	
	![errordns.png](https://static.platzi.com/media/user_upload/errordns-16934d87-946b-4329-859b-7666a40b2b81.jpg)

	* **Kenet Chungandro** [970361] (1)

		Debes agregar la ruta al archivo hosts.

* **Japheth Calzada L√≥pez** (0) [460187](https://platzi.com/comentario/460187/) 

	![](![Screenshot_1.png](https://static.platzi.com/media/user_upload/Screenshot_1-bbc01b51-594f-4f24-aabc-c72a25ce7d35.jpg)  
	Pregunta, en teoria el servidor esta arriba pero no logro accesar a el, hay alguna manera de testear si el server esta arriba ? nunca habia usado vagrat

	* **Brian Urban** [460187] (2)

		Puedes abrir Virtualbox y ah√≠ debe aparecer la maquina virtual ejecut√°ndose. Debes cambiar la IP que est√°s usando en este momento, parece que ese es el problema.

	* **Japheth Calzada L√≥pez** [460187] (0)

		Si de hecho era la IP ya la cambie y se quito el error
		
		![](![Screenshot_2.png](https://static.platzi.com/media/user_upload/Screenshot_2-848fd877-32ef-45e0-b8ce-5511a12cf28b.jpg)
		
		Pero sigo sin poder arrancar el server

	* **Japheth Calzada L√≥pez** [460187] (0)

		La carpeta code me dice que no esta creada üòÆ pero si la cree en la configuraci√≥n, a alguien le sucede lo mismo ??
		
		![Screenshot_3.png](https://static.platzi.com/media/user_upload/Screenshot_3-f63a4b3d-56c6-4899-8894-af4990b4575c.jpg)

	* **Nycgia** [460187] (1)

		@japhethdeoz Revisa donde la creaste, en la documentaci√≥n de laravel nos dice que la creemos idealmente en el home para evitar problemas as√≠, intentalo nuevamente y nos comentas que tal.

	* **Japheth Calzada L√≥pez** [460187] (1)
![Screenshot_4.png](https://static.platzi.com/media/user_upload/Screenshot_4-267372d5-aa5b-429c-ad96-522b403c1e86.jpg)
		
		Fijate que el error radicaba en que estoy en windows entonces debia direccionarlo a C de esta manera se crea el espejo que comenta el profesor
		
		Sin embargo tengo ahora el error que no puedo entrar mediante cursophp.test ya hice la configuraci√≥n que aqui explica pero nada, en cuanto tenga algo les comento

	* **Japheth Calzada L√≥pez** [460187] (1)
![Screenshot_5.png](https://static.platzi.com/media/user_upload/Screenshot_5-37c1ddf4-dd2c-41e0-a7e9-ab0bb7ee0fa6.jpg)
		
		Ahora me sale este error, si encuentro algo les digo

	* **Jeith S Carrillo A** [460187] (1)

		te falta la parte de editar el archivo host de windows

# Caracter√≠sticas avanzadas del lenguaje [3194]

## 0050. Closures [16208](https://platzi.com/clases/1462-php-avanzado/16208-closures8895/)

### Descripci√≥n:


 **Closures:**

* Son conocidos como funciones an√≥nimas, permiten la creaci√≥n de funciones que no tienen un nombre espec√≠fico.
* Pueden ser asignadas a funciones, variables, o usadas como par√°metros y valores de retorno.
* Las variables pueden contener cualquier tipo de dato como enteros, cadenas y objetos, pero tambi√©n pueden contener funciones.
* Para usar variables del scope superior en los closures, es necesario usar el ‚Äúuse‚Äù y entre par√©ntesis las variables.



Al utilizar array filter lo que hacemos es que le pasamos un arreglo y corremos una funci√≥n sobre cada elemento del arreglo. Si lo que se regresa es true o verdadero, se dejar√° en el nuevo arreglo generado.

### Links:

* [PHP: Funciones an√≥nimas - Manual ](http://php.net/manual/es/functions.anonymous.php)

* [GitHub - hectorbenitez/curso-introduccion-php at 2.1-closures](https://github.com/hectorbenitez/curso-introduccion-php/tree/2.1-closures)

### Comentarios:

* **Bryan Estiven Silva Mercado** (5) [460166](https://platzi.com/comentario/460166/) 

	* Las funciones an√≥nimas, tambi√©n conocidas como cierres (closures), permiten la creaci√≥n de funciones que no tienen un nombre especificado.
	
	* sintaxis de un closure
	
	
	
	``` 
	     $filtro = function ($job) use($maxMount) {
	                return $job["months"] > $maxMount;
	            };
	    
	```
	
	* Para usar variables externas dentro de los closure usamos **use($variable)**
	
	

	* **lucasmartinezesper** [460166] (1)

		Buen aporte resumido!

* **Paul Cortes** (1) [1127315](https://platzi.com/comentario/1127315/) 

	Link a la documentacion de los [closures](**url**)

* **Paul Cortes** (1) [1127313](https://platzi.com/comentario/1127313/) 

	Excelente los Closures el scope nos deja mas claro que usamos dentro de cada funci√≥n an√≥nima y como debemos de decir que use lo que esta afuera es m√°s claro

* **Paul Cortes** (1) [1127283](https://platzi.com/comentario/1127283/) 

	Los cierres tambi√©n pueden heredar variables del √°mbito padre. Cualquier variable debe ser pasada al constructor de lenguaje use. Desde PHP 7.1, estas variables no deben incluir superglobals, $this, o variables con el mismo nombre que un par√°metro.

* **Paul Cortes** (1) [1127280](https://platzi.com/comentario/1127280/) 

	Los **Closures** : son como las funciones en **Javascript** , las puedes asignar pasar como par√°metros retornarlas,

* **jorge-gianareas** (1) [978647](https://platzi.com/comentario/978647/) 

	Al utilizar array filter lo que hacemos es que le pasamos un arreglo y corremos una funci√≥n sobre cada elemento del arreglo. Si lo que se regresa es true o verdadero, se dejar√° en el nuevo arreglo generado.

* **jorge-gianareas** (1) [978646](https://platzi.com/comentario/978646/) 

	Para usar variables del scope superior en los closures, es necesario usar el ‚Äúuse‚Äù y entre par√©ntesis las variables.

* **jorge-gianareas** (1) [978645](https://platzi.com/comentario/978645/) 

	Las variables pueden contener cualquier tipo de dato como enteros, cadenas y objetos, pero tambi√©n pueden contener funciones.

* **jorge-gianareas** (1) [978644](https://platzi.com/comentario/978644/) 

	Pueden ser asignadas a funciones, variables, o usadas como par√°metros y valores de retorno.

* **jorge-gianareas** (1) [978643](https://platzi.com/comentario/978643/) 

	Son conocidos como funciones an√≥nimas, permiten la creaci√≥n de funciones que no tienen un nombre espec√≠fico.

* **Kenet Chungandro** (1) [975477](https://platzi.com/comentario/975477/) 

	Tengo un problema, me sale error al usar el $jobs->toArray(), a alguien le pasa igual?
	
	**Esto me sale:**
	``` 
	    ( ! )Fatal error: Uncaught InvalidArgumentException: Trailing data in/home/vagrant/code/curso-introduccion-php/vendor/nesbot/carbon/src/Carbon/Traits/Creator.php on line 594
	    ( ! ) InvalidArgumentException: Trailing data in/home/vagrant/code/curso-introduccion-php/vendor/nesbot/carbon/src/Carbon/Traits/Creator.php on line 594
	    
	```
	
	**Mi c√≥digo:**
	``` 
	    $jobs = array_filter($jobs->toArray(), function($job){
	                return $job['months']>= 15;
	            });
	    
	```

	* **Kenet Chungandro** [975477] (1)

		Bueno para poder avanzar opte por crear el array con la colecci√≥n de objetos de manera manual:
		``` 
		      $jobs = Job::all();
		           
		      $jobArray = [];
		      foreach($jobs as $job){
		           array_push($jobArray, [
		                    'title'=> $job->title,
		                    'description'=>$job->description,
		                    'months'=>$job->months,
		                    'logo'=>$job->logo,
		                    'getDurationAsString'=>$job->getDurationAsString()
		            ]);
		      }
		    
		       $jobs = array_filter($jobArray, function($job){
		                return $job['months']>= 15;
		       });
		    
		```
		
		Y en la vista lo imprim√≠ as√≠:
		``` 
		    {% for job in jobs %}
		                  <liclass="work-position">
		                    <h5>{{ job.title }}</h5>
		                    <p>{{ job.description }}</p>
		                    <p>{{ job.getDurationAsString }}</p>
		                    <imgsrc="{{ job.logo }}"alt="error"width="200">
		                  </li>
		    {% endfor %}	
		    
		    
		```

* **lucasmartinezesper** (1) [766525](https://platzi.com/comentario/766525/) 

	No olvidemos profundizar sobre el tema, el profesor nos da una idea general en cuanto a su uso.
	
	Si investigan esta la clase predefinida tambien.
	
	<https://www.php.net/manual/es/functions.anonymous.php>  
	<https://www.php.net/manual/es/class.closure.php>
	
	Saludos y sigamos aprendiendo!

	* **Mois√©s Cede√±o** [766525] (1)

		As√≠ es compa√±ero, muy bien dicho. Gracias por los enlaces.

* **edg_colon** (1) [609436](https://platzi.com/comentario/609436/) 

	Genial, gracias Hector, tuve un problema con la aplicaci√≥n de mi trabajo, tenia que hacer un cambio y utilizar una variable que no estaba en el mismo scope usando closure (otro programador hizo esa funci√≥n), no supe porque no pude utilizar dicha variable, despu√©s tube recorrer el array retornado para hacer otra operaci√≥n ya estando en el mismo scope‚Ä¶  
	Esta clase luego me hizo recordar el problema y cual es la soluci√≥n, jamas lo olvidare‚Ä¶ jejeje

	* **lucasmartinezesper** [609436] (1)

		Lo bueno que con tus conocimiento de ese momento fuiste ingenioso para resolverlo. Luego se te present√≥ el caso que aprendiste de una manera m√°s ‚Äúf√°cil‚Äù a resolverlo. Sigue aprendiendo!

	* **Paul Cortes** [609436] (1)

		Esto es genial cuando sucede, porque cuando aprendes hay una vinculaci√≥n emocional al momento y esto nos hace aprender mucho mas f√°cil y con mas duraci√≥n en el tiempo lo que aprendemos

* **Jean Carlos Nu√±ez Hernandez** (1) [609386](https://platzi.com/comentario/609386/) 

	Esta funcionalidad es muy importante a la hora de iterar, lo cual es php iterar es demasiado usado

	* **edg_colon** [609386] (1)

		Muy parecido a los arrow functions (funciones flecha) en JavaScript, tambi√©n muy utilizados.

	* **lucasmartinezesper** [609386] (1)

		No solamente en PHP iterar es muy utilizado, en todos los lenguajes de programaci√≥n.

* **Cristian Yepes** (1) [603085](https://platzi.com/comentario/603085/) 

	La **filter function** no solo valida la propiedad que yo deseo para filtrar los registros que me retorna la consulta de la base de datos, sino que tambi√©n me elimina la propiedad por la que estoy filtrando, es decir, en este ejemplo que estamos filtrando por la propiedad ‚Äúmonths‚Äù no solo permite que se muestren los ‚Äújobs‚Äù que cumplan con la condici√≥n, sino que tambi√©n, ya no permite imprimir en pantalla el valor de ‚Äúmonths‚Äù de aquellos jobs.

	* **lucasmartinezesper** [603085] (1)

		Se crea otro array pero sin los elemento que no cumplan la condicion del ciclo. Si en a consulta SQL metes la condicion de alguna forma no ser√° necesario filtrar con PHP.

* **antoniofloresonline** (1) [586557](https://platzi.com/comentario/586557/) 

	Un poquito de psr2 seria genial teacher üòâ

	* **lucasmartinezesper** [586557] (1)

		Tal cual, seria lo mas optimo, pero recuerda que aqu√≠ est√°s aprendiendo, si al estudiante le mencionas en esta clase el PSR 2 habra mas preguntas sobre eso que del tema en principal. En el curso de introducci√≥n de PHP se mencionan los PSR y el profesor sugiere que lean todos.

	* **F√©lix Andersson** [586557] (1)

		Y en que se aplicar√≠a PSR-2 en esta clase?

* **Aar√≥n Anibal Ramirez Herrera** (1) [579669](https://platzi.com/comentario/579669/) 

	Me gust√≥ esta clase, me parece algo √∫til el closure y creo que lo empezar√© a implementar en mis proyectos, veremos como se pone el curso de momento vamos bien

	* **lucasmartinezesper** [579669] (1)

		Perfecto! esa es la idea! aprender y aplicar! sigue adelante.

* **Jos√© Tuzinkievicz** (1) [571677](https://platzi.com/comentario/571677/) 

	Excelente explicaci√≥n.

	* **lucasmartinezesper** [571677] (2)

		SIn dudas, no olvides de profundizar para adquirir m√°s conocimientos.

* **jangove** (1) [569431](https://platzi.com/comentario/569431/) 

	Estoy utilizndo visual code como se llama la extension para que me vizualize (title:‚ÄòProject‚Äô,
	
	Normalmente solo sale la sintaxis Project.  
	-> me refiero a la palabra title que aparece en letra color plomo!!!

	* **lucasmartinezesper** [569431] (1)

		Hay que buscar alguna extensi√≥n que tenga que ver con los parametros de funcion para PHP.

* **Juan Felipe Lara Martinez** (1) [509395](https://platzi.com/comentario/509395/) 

	Si alguno le sale este error:  
	![](http://subirimagen.me/uploads/20190212203815.png)  
	Debe agregar en la base de datos las tablas ‚Äúproject‚Äù y ‚Äúusers‚Äù. Adicional debe modificar el archivo .env.

	* **lucasmartinezesper** [509395] (1)

		Claro, esas tablas son las necesarias para el proyecto.

* **flavioaandres** (1) [464479](https://platzi.com/comentario/464479/) 

	Se√±ores, Iniciamos!! Todo comenz√≥ perfect.

	* **lucasmartinezesper** [464479] (1)

		Sigue adelante que seguir√° perfecto!

* **franklinrony** (1) [463446](https://platzi.com/comentario/463446/) 

	los closures son las funciones anonimas

	* **lucasmartinezesper** [463446] (1)

		Exacto, son funciones an√≥nimas (sin nombre) que las puedes guardar en una variable y ejecutarlas cuando te haga falta.

* **Japheth Calzada L√≥pez** (1) [462404](https://platzi.com/comentario/462404/) 

	Pregunta en que casos se recomienda usar los Closures ??

	* **Christian Valencia Cuero** [462404] (1)

		yo diria que para operaciones as√≠ncronas

	* **Japheth Calzada L√≥pez** [462404] (1)

		@chrisva en ese caso convendr√≠a hacerlo en JS ??

	* **Japheth Calzada L√≥pez** [462404] (1)

		@chrisva en ese caso convendr√≠a hacerlo en JS ??

	* **Jorge David Duque Agudelo** [462404] (1)

		Hasta el momento nunca los he creado en los proyectos que he empezado, pero son bastante usados por los ORM, como Eloquent al momento en que querramos a√±adir un c√≥digo extra a una funci√≥n dada por el package, por ejm a√±adir unf filtro personalizado al momento de obtener unos datos.

	* **walis85300 (Platzi)** [462404] (1)

		Se pueden aplicar cuando se necesiten implementar conceptos de programaci√≥n funcional. [Este art√≠culo est√° bueno](https://phptherightway.com/pages/Functional-Programming.html)

	* **lucasmartinezesper** [462404] (1)

		Tambi√©n por una cuesti√≥n de arquitectura del codigo, fijate en la clase como simplifica el c√≥digo el profesor.

* **carlosmora_biz** (1) [71016](https://platzi.com/comentario/787984/) 
La palabra reservada use es similar a public dentro de una funci√≥n para llamar una variable global dentro de la funci√≥n?

	* **cristhiancoaquira** [71016] (1)

		Es para accedear a variables de los contextos superiores.

## 0060. Type Hinting [16207](https://platzi.com/clases/1462-php-avanzado/16207-type-hinting/)

### Descripci√≥n:


 **Type Hinting** nos permite especificar el tipo de los par√°metros que recibe una funci√≥n y el tipo de los par√°metros de retorno de esa funci√≥n. Si ponemos que un valor de entrada debe ser entero pero recibe un arreglo, nos dar√° error lo cual ayuda a detectar posibles bugs desde el principio.

No todas las versiones anteriores de PHP contaban con **Type Hinting** , esto es s√≥lo desde la 7.1 y superiores, pudi√©ndose usar para clases, interfaces y tipos escalares.  
**Type Hinting** es una caracter√≠stica muy importante de PHP, ayuda a tener un c√≥digo m√°s limpio, entendible y detecta errores antes de que estos suban a producci√≥n.

### Links:

* [PHP: Argumentos de funciones - Manual ](http://php.net/manual/es/functions.arguments.php#functions.arguments.type-declaration)

* [Type Hinting ¬∑ hectorbenitez/curso-introduccion-php@73c0276 ¬∑ GitHub](https://github.com/hectorbenitez/curso-introduccion-php/commit/73c0276f029f6673b00e06c8bc2e3e2fb316633f)

### Comentarios:

* **Bryan Estiven Silva Mercado** (6) [460174](https://platzi.com/comentario/460174/) 

	Desde PHP 5 es posible utilizar el type hinting, o la determinaci√≥n de tipos, que permite especificar el tipo de datos que se espera de un argumento en la declaraci√≥n de una ** funci√≥n**. Cuando se llama a la funci√≥n, PHP comprobar√° si los argumentos **son del tipo especificado** , y si no lo son se **emitir√° un error** y la ejecuci√≥n se detendr√°.
	
	Cuando usarlos:
	
	Cuando queremos forzar a una funci√≥n a aceptar s√≥lo argumentos de un tipo. Su uso m√°s com√∫n es con objetos, indicando el nombre de la clase:
	``` 
	     public function postLogin(ServerRequest $request){
	    
	```

	* **Bryan Estiven Silva Mercado** [460174] (2)

		[info](https://diego.com.es/type-hinting-en-php)

	* **lucasmartinezesper** [460174] (1)

		Gracias por el aporte!

* **Kenet Chungandro** (2) [976106](https://platzi.com/comentario/976106/) 

	Esto tambi√©n lo vimos en el curso de introducci√≥n a php pero nunca est√° de m√°s recordarlo üòÉ

* **lucasmartinezesper** (2) [766534](https://platzi.com/comentario/766534/) 

	Recordemos que PHP es d√©bilmente tipeado por eso nos tenemos que encargar nosotros de hacer el type hinting si queremos forzar los tipos de datos.
	
	Profundicen mas en: <https://diego.com.es/type-hinting-en-php>
	
	Sigamos aprendiendo!

* **Emerson Cede√±o Salazar** (2) [486516](https://platzi.com/comentario/486516/) 

	fuera de _PhpStorm_ , en otras herramientas como **VSCode** o **Sublime Text** qu√© _addon / extension / package_ recomiendan para reproducir el efecto de que la misma herramienta agregue los `namespaces` necesarios seg√∫n el _type hinting_ que se est√© usando _(de ser necesario)_?

	* **Angel Cabrera** [486516] (3)

		La extensi√≥n **PHP Intelliphense** , a√±ade muchas de las funcionalidades de un ID de PHP a VS Code, desconozco si tambi√©n hay una versi√≥n para Sublime, pero recomiendo mucho esta extensi√≥n

	* **lucasmartinezesper** [486516] (1)

		Prueba con este hermano.
		
		<https://marketplace.visualstudio.com/items?itemName=MehediDracula.php-namespace-resolver>

* **Paul Cortes** (1) [1127388](https://platzi.com/comentario/1127388/) 

	**Type Hinting** es genial para los par√°metros, al usar un IDE que nos ayude a identificar tipos de variables tenemos cierta ventaja, sin embargo aun as√≠, el √∫nico pero que tengo de PHP es: al no haber declaraci√≥n de variables el IDE no puede detectar errores de **typo **en el c√≥digo al usar una variable, esto hace que nos retrasemos un poco si el c√≥digo no esta probado, por eso tambi√©n son muy importante las pruebas

* **Paul Cortes** (1) [1127357](https://platzi.com/comentario/1127357/) 

	Type Hinting es una caracter√≠stica muy importante de PHP, ayuda a tener un c√≥digo m√°s limpio, entendible y detecta errores antes de que estos suban a producci√≥n.

* **alexabellerman** (1) [1011554](https://platzi.com/comentario/1011554/) 

	En PHP 7.4 ya el lenguaje soporta tipado durante la declaraci√≥n de variables. Yay

* **jorge-gianareas** (1) [978651](https://platzi.com/comentario/978651/) 

	No todas las versiones anteriores de PHP contaban con Type Hinting, esto es s√≥lo desde la 7.1 y superiores, pudi√©ndose usar para clases, interfaces y tipos escalares.  
	Type Hinting es una caracter√≠stica muy importante de PHP, ayuda a tener un c√≥digo m√°s limpio, entendible y detecta errores antes de que estos suban a producci√≥n.

* **jorge-gianareas** (1) [978648](https://platzi.com/comentario/978648/) 

	Type Hinting nos permite especificar el tipo de los par√°metros que recibe una funci√≥n y el tipo de los par√°metros de retorno de esa funci√≥n. Si ponemos que un valor de entrada debe ser entero pero recibe un arreglo, nos dar√° error lo cual ayuda a detectar posibles bugs desde el principio.

* **Jorge David Duque Agudelo** (1) [573610](https://platzi.com/comentario/573610/) 

	¬øPor qu√© php no obliga a utilizar por defecto el Type Hinting?

	* **Diego Alexander Forero Higuera (Platzi)** [573610] (3)

		Porque es un lenguaje d√©bilmente tipado, el interprete asume el tipo de dato que esta almacenando y da ese tipo de dato a la variable, en lenguajes como Java o C que son fuertemente tipado si es obligatorio. Python y JavaScript son lenguajes tambi√©n d√©bilmente tipados.

	* **Mauro Chojrin** [573610] (3)

		Es un tema de compatibilidad hacia atr√°s. El type hintining se implement√≥ recientemente (Versi√≥n 5.3 en adelante si recuerdo bien).
		
		Hay muchas aplicaciones desarrolladas usando versiones anteriores y algo que la comunidad de PHP valora mucho es la gradualidad de los cambios.
		
		Es probable que en pr√≥ximas versiones se haga obligatorio

	* **lucasmartinezesper** [573610] (1)

		Porque es d√©bilmente tipado, si no declaras el tipo de valor PHP lo har√° por ti de la mejor manera posible. Puede ser por esto que quiz√°s luego tengas problemas en algunas validaciones. Por eso es recomendable usar type hinting.

* **A√±aqui Apolinar Morales** (1) [80154](https://platzi.com/comentario/953505/) 
Cuando intento ingreas a la ruta /auth me marca un 405 Alguien sabe por que sale este error, si ya tengo toda la configuracion bien?

	* **Mois√©s Cede√±o** [80154] (1)

		Revisa las rutas que est√°s usando y el m√©todo de /auth, seguramente lo tienes como GET y es POST o viceversa.
		
		El error 405 se produce cuando nuestros m√©todos son por ejemplo: GET pero lo invocamos como POST.
		
		<https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/405>

* **Gonzalo Vazquez** (1) [68694](https://platzi.com/comentario/744344/) 
No entend√≠ bien que hizo el parametro ServerRequest. Se notifica ‚Äúbad credentials‚Äù pero qu√© hace ServerRequest?

	* **Fran Delgado** [68694] (2)

		El parametro ServerRequest obliga a que cuando se recibe el dato en la funcion sea de ese tipo. De lo contrario lanzara un error. Por eso es muy util, porque PHP es un lenguaje dinamico en el que una variable puede cambiar de tipo lo cual puede provocar muchos errrores en tiempo de ejecucion.
		
		Bad Credentials sale porque los datos de acceso que ha utilizado Hector cuando ha hecho login no son los que tiene almacenados en la base de datos.

* **Jorge David Duque Agudelo** (1) [58150](https://platzi.com/comentario/573610/) 
¬øPor qu√© php no obliga a utilizar por defecto el Type Hinting?

	* **Diego Alexander Forero Higuera (Platzi)** [58150] (3)

		Porque es un lenguaje d√©bilmente tipado, el interprete asume el tipo de dato que esta almacenando y da ese tipo de dato a la variable, en lenguajes como Java o C que son fuertemente tipado si es obligatorio. Python y JavaScript son lenguajes tambi√©n d√©bilmente tipados.

## 0070. Agregar im√°genes en Jobs [16404](https://platzi.com/clases/1462-php-avanzado/16404-agregar-imagenes-en-jobs/)

### Descripci√≥n:


Antes de continuar, debemos preparar este c√≥digo por dos razones:

La primera es que queremos darle una mejor vista a nuestra aplicaci√≥n web, por lo que permitiremos que cada Job cuente con alguna imagen o logotipo que lo defina mejor. La segunda, es porque usaremos este c√≥digo para ejemplificar el uso de Traits dentro de nuestra aplicaci√≥n.

## El reto consiste en lo siguiente:

  1. Agrega una nueva columna en la tabla Jobs para almacenar la URL de una imagen.
  2. En la secci√≥n ‚ÄúAdd Job‚Äù permite al usuario agregar una imagen.
  3. La imagen debe ser guardada dentro de la carpeta public/uploads.
  4. Una vez que la imagen se almacen√≥ guarda la URL dentro de la base de datos.



Recuerda usar todo lo que has aprendido hasta el momento, y aunque vamos a resolver este reto durante el curso, realizarlo es un buen ejercicio para reforzar lo que has aprendido.

### Comentarios:

* **Paul Cortes** (1) [1127460](https://platzi.com/comentario/1127460/) 

	Tambi√©n mejore la parte del perfil permitiendo subir una imagen de perfil

* **Paul Cortes** (1) [1127390](https://platzi.com/comentario/1127390/) 

	Excelente reto vamos por ello!!!

* **cristhiancoaquira** (1) [1095121](https://platzi.com/comentario/1095121/) 

	Reto Cumplido!

* **Kenet Chungandro** (1) [976298](https://platzi.com/comentario/976298/) 

	Todo listo! üòÑ

* **Mois√©s Cede√±o** (1) [959371](https://platzi.com/comentario/959371/) 

	Reto cumplido üòÑ
	
	![reto.png](https://static.platzi.com/media/user_upload/reto-4aae750c-2d93-4295-a354-2300580537c5.jpg)

* **gerql14** (1) [924183](https://platzi.com/comentario/924183/) 

	Buen d√≠a, hice la pregunta en la clase ‚ÄúEjemplo de subida de archivos‚Äù del Curso de Introducci√≥n a PHP  
	Donde realizamos √©ste ejercicio.
	
	Mi pregunta es acerca de las rutas.
	
	Las imagenes se guardan en la carpeta **public/uploads**  
	Para mostrar la imagen en la vista **index.twig** tengo lo siguiente
	``` 
	    <p><imgsrc="public/uploads/{{ job.image }}"alt="Image Job"></p>
	    
	```
	
	Pero si quisiera mostrar una imagen por ejemplo, en la vista de **addJob.twig** , se debe especificar un directorio atr√°s, de la siguiente forma
	``` 
	    <p><imgsrc="../public/uploads/myimage.png"alt="ImageJob"></p>
	    
	```
	
	Esto a que se debe?  
	Por qu√© para enlazar la imagen en **addJob.twig** debo ‚Äòregresar‚Äô un directorio?  
	No se supone ambas vistas (** index.twig** y** addJob.twig** ) adem√°s de estar al mismo nivel (dentro de la carpeta _views_ ), ambas est√°n siendo llamadas desde el router ( _public/index.php_ ) ?

* **Miguel √Ångel Mu√±oz Pozos** (1) [855337](https://platzi.com/comentario/855337/) 

	Esto fue realizado desde el curso de introducci√≥n

* **neontigermx** (1) [782326](https://platzi.com/comentario/782326/) 

	Esto se realizo en el curso de introducci√≥n

* **Angel Infanti** (1) [679099](https://platzi.com/comentario/679099/) 

	Reto cumplido desde el curso de introducci√≥n

* **gabobardales** (1) [630993](https://platzi.com/comentario/630993/) 

	Una consulta, la direccion del archivo de la imagen donde seria o cual seria lo m√°s adecuado para guardar. Y cuando se va mostrar la imagen solo deberi mostrar el nombre del archivo o la ruta completa, esto pregunto si es una mala practica poner toda la direccion donde esta ubicada la imagen. ???

	* **Diego Alexander Forero Higuera (Platzi)** [630993] (1)

		Hola, siempre es necesario poner la ruta completa de la imagen si no el servidor web no la va a encontrar y no la va a poder servir, estas im√°genes por lo general se guardan en una carpeta llamada static o assets.

	* **lucasmartinezesper** [630993] (1)

		Hola! La imagen va ser un recurso p√∫blico en este caso, por eso deber√≠as ubicarlo dentro del public de tu app. La ruta absoluta es ideal, ya que tambien pueden alojar imagenes en otro servidor. Abrazo!

* **Santiago Arboleda Londo√±o** (1) [488887](https://platzi.com/comentario/488887/) 

	 **Reto cumplido!**

	* **lucasmartinezesper** [488887] (1)

		üëåüôå

* **Armando Tacza** (1) [488866](https://platzi.com/comentario/488866/) 

	Muy interesante, gracias Hector por todos los Tips.

	* **lucasmartinezesper** [488866] (1)

		üôåüëå

* **Japheth Calzada L√≥pez** (1) [462423](https://platzi.com/comentario/462423/) 

	realizandolo üòÉ me va gustando el curso

	* **lucasmartinezesper** [462423] (1)

		Lo bueno de seguir con lo que a uno le gusta!

* **Bryan Estiven Silva Mercado** (1) [460206](https://platzi.com/comentario/460206/) 

	Interesante reto!

## 0080. Salvar im√°genes en Jobs [16209](https://platzi.com/clases/1462-php-avanzado/16209-salvar-imagenes-en-jobs/)

### Descripci√≥n:


PHP es un lenguaje que usa herencia simple, lo cual significa que una clase solo puede heredar de una clase. Una clase no puede heredar de dos o m√°s clases.  
En momentos espec√≠ficos queremos compartir cierta parte de c√≥digo con una clase pero no queremos necesariamente que forme parte de la cadena de herencia. Para esto existen los **Traits** que est√°n presentes en otros lenguajes como **Ruby**

Los **Traits** son peque√±os conjuntos de funcionalidad que podemos inyectar en nuestras clases.

### Comentarios:

* **German Sayago** (5) [464839](https://platzi.com/comentario/464839/) 

	Lo que hace en el minuto 4:27 es clave, ya que si no comentan esas l√≠neas, al implementar los Traits en la pr√≥xima clase, el trait no va a funcionar.

	* **Emerson Cede√±o Salazar** [464839] (1)

		muy interesante, mas porqu√©?, qu√© hace ese `clousure` que no funcione el `trait`? ü§î

	* **Abrahan Oma√±a** [464839] (1)

		Lo que sucede es que cuando usamos toArray() lo que hacemos es convertir a $jobs como un arreglo, y en la proxima clase, donde se prueba el trait, ya no accede al metodo getImage() porque cada $job dejaron de ser objetos

* **jorge-gianareas** (2) [978660](https://platzi.com/comentario/978660/) 

	Los Traits son peque√±os conjuntos de funcionalidad que podemos inyectar en nuestras clases.

* **jorge-gianareas** (1) [978657](https://platzi.com/comentario/978657/) 

	En momentos espec√≠ficos queremos compartir cierta parte de c√≥digo con una clase pero no queremos necesariamente que forme parte de la cadena de herencia. Para esto existen los Traits que est√°n presentes en otros lenguajes como Ruby

* **jorge-gianareas** (1) [978656](https://platzi.com/comentario/978656/) 

	PHP es un lenguaje que usa herencia simple, lo cual significa que una clase solo puede heredar de una clase. Una clase no puede heredar de dos o m√°s clases.

* **Cristian Yepes** (1) [604286](https://platzi.com/comentario/604286/) 

	Hola, de acuerdo al reto de implementaci√≥n de un Trait para los proyectos, quise mejor retomar el tema de la funcion getDurationAsString que vimos en el curso b√°sico de PHP y lo que hice fue hacer un trait para manejar esto de mostrar los meses de un Job, esto es para que veamos que un trait se puede usar similar a una clase, les quiero dejar el c√≥digo y me gustar√≠a saber en sus comentarios, si esto que hice es pr√°ctico o recomendable. Gracias de antemano:
	``` 
	    <?php
	    
	    namespace App\traits;
	    
	    trait  HasDefaultMonthsDuration{
	    
	        private $numYears;
	        private $numtMonths;
	    
	        public function getDurationAsString($months)
	        {
	            $strYears = null;
	            $strMonths = null;
	            if (empty($months) || $months == 0)
	                return null;
	            else {
	                $this->setNumYears($months);
	                $this->setNumtMonths($months);
	                if($this->getNumYears() !== null)
	                    $strYears = $this->numYears > 1 ? "Years" : "Year";
	                if($this->getNumtMonths() !== null)
	                    $strMonths = $this->numtMonths == 1 ? 'Month' : "Months";
	                return "Duration: $this->numYears $strYears $this->numtMonths $strMonths ";
	            }
	        }
	    
	        public function getNumYears()
	        {
	            return $this->numYears;
	        }
	    
	        public function setNumYears($months): void
	        {
	            $this->numYears = floor($months/12) == 0 ? null : floor($months/12);
	        }
	    
	        public function getNumtMonths()
	        {
	            return $this->numtMonths;
	        }
	    
	        public function setNumtMonths($months): void
	        {
	            $this->numtMonths = $months % 12 == 0 ? null : $months % 12;
	        }
	        
	    }
	    
	    
	```

* **Japheth Calzada L√≥pez** (1) [462446](https://platzi.com/comentario/462446/) 
	
	![Screenshot_3.png](https://static.platzi.com/media/user_upload/Screenshot_3-6b931bb1-6fc6-4ecf-8eed-5db247a5b053.jpg)
	
	Comentario, en el archivo para descargar view/index.twig tienen esta parte del c√≥digo como muestro en la imagen, la cual esta incorrecta ya que solo deber√≠a ser  
	<img src="{{ job.image }}" alt="" style=‚Äúmax-width: 100%‚Äù>

	* **German Sayago** [462446] (3)

		es porque en el archivo ya esta implementado el trait para manejar las im√°genes, eso se ve en la clase siguiente.

* **Bryan Estiven Silva Mercado** (1) [460231](https://platzi.com/comentario/460231/) 

	Los que vienen del curso pasado o conocen sobre la validaciones con **Respect\Validation\Validator** Tengo una duda al querer validar una imagen por extenci√≥n la documentacci√≥n muesta el siguiente codigo
	``` 
	    v::extension('png')->validate('image.png'); //true
	    
	```
	
	Lo cual yo lo interpreto dentro del codigo de esta forma
	``` 
	    $jobValidator =
	                 v::key('title', v::stringType()->notEmpty())
	                 ->key('description', v::stringType()->notEmpty())
	                    ->key('valoresPuestos',v::extension('jpeg') ); //true);
	    
	```
	
	valoresPuestos
	
	* logo
	
	* logo.jpeg
	
	
	
	
	**En ambos casos me da error**

	* **German Sayago** [460231] (2)

		probaste utilizando el validador de imagen en vez de la extenci√≥n?
		``` 
		    v::image()->validate('image.gif'); //true
		    
		```
		
		[](https://respect-validation.readthedocs.io/en/1.1/rules/Image/)

	* **German Sayago** [460231] (3)

		[https://respect-validation.readthedocs.io/en/1.1/rules/Image/](url)

* **A√±aqui Apolinar Morales** (1) [80155](https://platzi.com/comentario/953513/) 
Al intentar entrar a la ruta jobs/add no me deja entrar, no encuentra la ruta ALguien mas le pasa lo mismo ??

	* **A√±aqui Apolinar Morales** [80155] (3)

		Ya lo resolvi, al bajar el proyecto del profesor al parecer lo baje con varios de sus cambios ya avanzados, lo qu eme hace ver que en las rutas todas las rutas necesitan acceso de admin entonces lo que hice simplemente fue quitar el admin de la ruta y me deja acceder al formulario para agregar imagenes

* **Bryan Estiven Silva Mercado** (1) [48900](https://platzi.com/comentario/460231/) 
Los que vienen del curso pasado o conocen sobre la validaciones con Respect\Validation\Validator Tengo una duda al quere...

	* **German Sayago** [48900] (2)

		probaste utilizando el validador de imagen en vez de la extenci√≥n?
		``` 
		    v::image()->validate('image.gif'); //true
		    
		```
		
		[](https://respect-validation.readthedocs.io/en/1.1/rules/Image/)

## 0090. Traits [16210](https://platzi.com/clases/1462-php-avanzado/16210-traits6325/)

### Descripci√≥n:


* Es importante saber que aunque se est√° intentando usar el patr√≥n de dise√±o **MVC** , normalmente no todo se tiene exclusivamente en estas 3 carpetas; podemos tener m√°s carpetas pero teniendo en cuenta el mantener el c√≥digo siempre bien organizado.
* Un **trait** se declara creando un nuevo archivo, muy parecido a una clase pero en vez de **class** se utiliza la palabra **trait**. Para que una clase utilice un trait, se deber√° usar dentro de la clase la palabra **use** y el nombre del trait.
* Lo interesante de hacer traits en vez de poner el c√≥digo directamente en una clase, es que esta funcionalidad podr√≠a servir para otras clases que no est√°n relacionadas entre s√≠.
* Un trait puede ser implementado en tantas clases como queramos.



### Links:

* [User Initial avatars](https://ui-avatars.com/)

* [PHP: Rasgos (Traits) - Manual ](http://php.net/manual/es/language.oop5.traits.php)

### Comentarios:

* **lucasmartinezesper** (3) [770094](https://platzi.com/comentario/770094/) 

	Un Trait es similar a una clase, pero con el √∫nico objetivo de agrupar funcionalidades muy espec√≠ficas y de una manera coherente. No se puede instanciar directamente un Trait. Es por tanto un a√±adido a la herencia tradicional, y habilita la composici√≥n horizontal de comportamientos; es decir, permite combinar miembros de clases sin tener que usar herencia.
	
	<https://www.php.net/manual/es/language.oop5.traits.php>

* **Bryan Estiven Silva Mercado** (3) [460288](https://platzi.com/comentario/460288/) 

	Si en vez del texto del return devuelve (unknown) a que se deber√≠a ?
	
	* Estoy usando el trait en el modelo  
	-La ruta del trait es correcta  
	-Ya revise mi sintaxis
	
	
	``` 
	    {% for datos in job %}
	                        <divclass="col-md-3">
	                            <imgsrc="{{datos.getImage()}}"style="max-width: 100%">
	                        </div>
	                        <divclass="col-md-9">
	                            <ul>
	    
	                                    <liclass="work-position">
	                                        <h5>{{datos.title}}</h5>
	                                        <p>{{datos.description}}</p>
	                                        <strong>Achievements:</strong>
	                                        <ul>
	                                            {% for dato in activity %}
	                                                {% if dato.jobs_id == datos.id %}
	                                                    <li>{{ dato.description}}</li>
	                                                {% endif %}
	                                            {% endfor %}
	                                        </ul>
	                                    </li>
	    
	                            </ul>
	                        </div>
	                    {% endfor %}
	    
	```
	``` 
	    use app\Traits\HasDefaultImage;
	    
	    classJobsextendsModel{
	        //use SoftDeletes;
	        use HasDefaultImage;
	    
	```
	``` 
	    <?php
	    namespaceApp\Traits;
	    
	    trait HasDefaultImage {
	        publicfunctiongetImage(){
	            if(!$this->imagen){
	             return"https://ui-avatars.com/api/?name=John+Doe&size=166";
	            }
	            return"hola";//$this->imagen;
	        }
	    }
	    
	```

	* **Emerson Cede√±o Salazar** [460288] (1)

		mismo tema por ac√° ‚Ä¶ lo lograste resolver?

	* **Emerson Cede√±o Salazar** [460288] (3)

		bueno ‚Ä¶ en caso alguien se tope con esto, lo que hay que hacer lo coment√≥ @germansayago en la clase anterior, hay que comentar el _clousure_ en `IndexController`

	* **Fran Delgado** [460288] (3)

		El problema es que en una clase anterior en el metodo `indexAction` del `IndexController` pasamos a las vista los jobs como array porque la funcion array_filter necesita justamente eso, un array.  
		Al ser un array no tenemos acceso a los metodos del modelo por lo que la solucion seria comentar el codigo correspondiente al filtro:
		``` 
		    //            return $job['months'] >= $limitMonths;
		    //        };
		    //
		    //        $jobs = array_filter($jobs->toArray(), $filterFunction);
		    
		```
		
		Y aplicar dicho filtro de otra forma. En los comentarios de la clase varios companieros han aportado varias soluciones.
		
		Espero haberte ayudado.

* **Mois√©s Cede√±o** (2) [959412](https://platzi.com/comentario/959412/) 

	Si en vez del texto del return devuelve (unknown) deben comentar el closure en IndexController:
	``` 
	     
	            $name = 'Hector Benitez';
	            $limitMonths = 3;
	    
	            // $filterClosure = function (array $job) use ($limitMonths) {
	            //     return $job['months'] > $limitMonths;
	            // };
	            // $jobs = array_filter($jobs->toArray(), $filterClosure);
	    
	            return $this->renderHTML('index.twig', [
	                'name' => $name,
	                'jobs' => $jobs
	            ]);
	    
	```

* **Jorge David Duque Agudelo** (2) [573620](https://platzi.com/comentario/573620/) 

	Seg√∫n tengo entendido los trait por convenci√≥n deber√≠an terminar con la palabra Trait, esto lo le√≠ en:
	
	<https://www.php-fig.org/bylaws/psr-naming-conventions/>
	
	¬øHay alguna nomenclatura estandar para definir los nombres de los trait a parte de este PSR?

	* **walis85300 (Platzi)** [573620] (1)

		No, PSR es la convenci√≥n utilizada por la industria.

	* **lucasmartinezesper** [573620] (1)

		Ninguna, guaite por PSR.

	* **lucasmartinezesper** [573620] (1)

		guiate*

* **luisangel2895** (2) [554339](https://platzi.com/comentario/554339/) 

	Al parece al convertir jobs a array con toArray hace de q al mandarlo a la vista este pierda sus metodos como objeto ya que no se estaria enviando un array de objetos como se hacia originalmente sino q ahora se esta enviando solamente un array multidimensional simple q al ser llamado en la vista ya no reconozca sus metodos porque ya no es un objeto , entonces para arreglar esto ya no se puede usar el fitro con la funcion filter_array ya q esta solamente recibe como parametro un arreglo y ya no un objeto de eloquent por lo que lo mejor es crear otro filtro sin modificar la estructura de los objetos q se enviaran a la vista :
	``` 
	    foreach ($jobs as $key => $job) {
	                if($job -> months <= $limitMonths){
	                    unset($jobs[$key]);
	                }
	            }
	    
	```

	* **koshiroanz** [554339] (2)

		Tambi√©n podr√≠as utilizar la funci√≥n: reject().
		``` 
		    $limitMonth = 10;
		    $jobs = $jobs->reject(function ($job) use ($limitMonth){
		            return $job->months < $limitMonth;
		    });
		    
		```

	* **Josu√© Isaac Fuentes L√≥pez** [554339] (1)

		ne haz salvado

	* **Jose Vidal** [554339] (2)

		Tambien se pudiera hacer de este modo
		``` 
		    $limitMonth = 10;
		    $jobs = $jobs->reject($filterFunction);
		    
		```
		
		**PEROOO** , hay que removerle el typehint a nuestro closure de array y cambiar la condici√≥n de exclusion, quedando de este modo
		``` 
		    $filterFunction = function ($job) use ($limitMonths) {
		                return $job['months'] <= $limitMonths;
		            };
		    
		```
		
		El metodo **reject** es el inverso a **filter** y pertenece a la coleccion de metodos de laravel

* **andresnakanishi** (2) [459863](https://platzi.com/comentario/459863/) 

	No s√© que tiene H√©ctor, pero tiene terrible alegr√≠a al explicar los traits, se le ve en la cara en el min 5:10 jajaja

	* **lucasmartinezesper** [459863] (1)

		Vamos que el profe hace lo mejor que puede para que aprendamos! La alegr√≠a es un condimento que todos debemos tener.

* **daxdoxsi** (1) [1062515](https://platzi.com/comentario/1062515/) 

	Traits

* **jorge-gianareas** (1) [978665](https://platzi.com/comentario/978665/) 

	Un trait puede ser implementado en tantas clases como queramos.

* **jorge-gianareas** (1) [978664](https://platzi.com/comentario/978664/) 

	Lo interesante de hacer traits en vez de poner el c√≥digo directamente en una clase, es que esta funcionalidad podr√≠a servir para otras clases que no est√°n relacionadas entre s√≠.

* **jorge-gianareas** (1) [978663](https://platzi.com/comentario/978663/) 

	Un trait se declara creando un nuevo archivo, muy parecido a una clase pero en vez de class se utiliza la palabra trait. Para que una clase utilice un trait, se deber√° usar dentro de la clase la palabra use y el nombre del trait.

* **jorge-gianareas** (1) [978662](https://platzi.com/comentario/978662/) 

	Es importante saber que aunque se est√° intentando usar el patr√≥n de dise√±o MVC, normalmente no todo se tiene exclusivamente en estas 3 carpetas; podemos tener m√°s carpetas pero teniendo en cuenta el mantener el c√≥digo siempre bien organizado.

* **Daniel Hurtado** (1) [774886](https://platzi.com/comentario/774886/) 

	Podr√≠a decirse que los traits de php son como los ‚Äúmixins‚Äù de los preprocesadores?

* **Miriam Fern√°ndez** (1) [694243](https://platzi.com/comentario/694243/) 

	Hola!. Esto es lo que se llama ‚Äúinjection over inheritance‚Äù?

	* **lucasmartinezesper** [694243] (1)

		Te recomiendo leas este articulo.
		
		<https://www.jasonlotito.com/injectors-dependency-injection-with-traits/>
		
		Saludos!

* **Cristian Yepes** (1) [604298](https://platzi.com/comentario/604298/) 

	Hola, yo quise retomar la funcion getDurationAsSTring que vimos en el curso de PHP b√°sico para hacer el reto de crea un Trait, con el fin de ver que se pod√≠a utilizar similar a una clase y les quiero compartir el c√≥digo, de pronto a alguien le interese y me pueda dejar sus comentarios sobre si es pr√°ctico o se podr√≠a mejorar o que tan recomendable es hacerlo as√≠. Gracias de antemano:
	``` 
	    <?php
	    
	    namespace App\traits;
	    
	    trait  HasDefaultMonthsDuration{
	    
	        private $numYears;
	        private $numtMonths;
	    
	        public function getDurationAsString($months)
	        {
	            $strYears = null;
	            $strMonths = null;
	            if (empty($months) || $months == 0)
	                return null;
	            else {
	                $this->setNumYears($months);
	                $this->setNumtMonths($months);
	                if($this->getNumYears() !== null)
	                    $strYears = $this->numYears > 1 ? "Years" : "Year";
	                if($this->getNumtMonths() !== null)
	                    $strMonths = $this->numtMonths == 1 ? 'Month' : "Months";
	                return "Duration: $this->numYears $strYears $this->numtMonths $strMonths ";
	            }
	        }
	    
	        public function getNumYears()
	        {
	            return $this->numYears;
	        }
	    
	        public function setNumYears($months): void
	        {
	            $this->numYears = floor($months/12) == 0 ? null : floor($months/12);
	        }
	    
	        public function getNumtMonths()
	        {
	            return $this->numtMonths;
	        }
	    
	        public function setNumtMonths($months): void
	        {
	            $this->numtMonths = $months % 12 == 0 ? null : $months % 12;
	        }
	    
	    }
	    
	    
	```

	* **lucasmartinezesper** [604298] (1)

		Recuerda que el trait solo lo vas a poder usar dentro de otras clases y no podr√°s instanciarlo de forma independiente. Saludos.

* **JosephZ** (1) [570516](https://platzi.com/comentario/570516/) 

	Excelente clase, muy bien explicado los Traits

* **Bryan Estiven Silva Mercado** (1) [460258](https://platzi.com/comentario/460258/) 

	Los rasgos (¬´traits¬ª en ingl√©s) son un mecanismo de reutilizaci√≥n de c√≥digo en lenguajes de herencia simple, como PHP. El objetivo de un rasgo es el de reducir las limitaciones propias de la herencia simple permitiendo que los desarrolladores reutilicen a voluntad conjuntos de m√©todos sobre varias clases independientes y pertenecientes a clases jer√°rquicas distintas.
	
	Un Trait es similar a una clase, pero con el √∫nico objetivo de agrupar funcionalidades muy espec√≠ficas y de una manera coherente.

	* **lucasmartinezesper** [460258] (1)

		Fuente: <https://secure.php.net/manual/en/language.oop5.traits.php>

* **Jorge David Duque Agudelo** (1) [58154](https://platzi.com/comentario/573620/) 
Seg√∫n tengo entendido los trait por convenci√≥n deber√≠an terminar con la palabra Trait, esto lo le√≠ en: 

	* **walis85300 (Platzi)** [58154] (1)

		No, PSR es la convenci√≥n utilizada por la industria.

* **Bryan Estiven Silva Mercado** (1) [48903](https://platzi.com/comentario/460288/) 
Si en vez del texto del return devuelve (unknown) a que se deber√≠a ? Estoy usando el trait en el modelo -La ruta del trait es co...

	* **Emerson Cede√±o Salazar** [48903] (1)

		mismo tema por ac√° ‚Ä¶ lo lograste resolver?

* **Juan David Gonzalez Revelo** (0) [650596](https://platzi.com/comentario/650596/) 

	Hola, Ahora que veo este tema de los traits, quisiera saber si lo puedo usar en una aplicaci√≥n donde tengo una tabla (modelo) personas, y otras tablas como empleados, clientes etc, pero todos pertenecen a una persona, y dado que todas extienden de model no pueden extender de persona. Es buena idea crear un trait Persona, y usarlo en en estos modelos y hacer cosas como que cuando intente crear un empleado o un cliente el trait cree la persona primero, para no tener que primero crear la persona y luego el empleado, o cuando le solicite el nombre al empleado esto lo obtenga del trait persona?

	* **lucasmartinezesper** [650596] (1)

		Hola, tienes que tener en cuenta que los traits no se pueden instanciar como una clase por si solos, solo se pueden utilizar dentro de una clase independiente de la herencia de la misma.

## 0100. Endpoint to delete Jobs [16211](https://platzi.com/clases/1462-php-avanzado/16211-endpoint-to-delete-jobs/)

### Descripci√≥n:


Usaremos un trait que nos provee **Eloquent** el cual permite usar soft deletes.

* Existe una funci√≥n de PHP que se llama **compact** a la cual si le pasas los nombres, buscar√° las variables y las meter√° en un arreglo.
* Un borrado f√≠sico significa que realmente estamos borrando todo de nuestra base de datos, contrario al soft delete, el cual deja la informaci√≥n a√∫n disponible en la base de datos pero oculta en la aplicaci√≥n.



### Comentarios:

* **Christian Valencia Cuero** (2) [463162](https://platzi.com/comentario/463162/) 

	Este curso esta mal subido

	* **flavioaandres** [463162] (2)

		Por que lo dices?

	* **Spyderp** [463162] (2)

		Recuerda que este curso sigue el curso de php b√°sico y laravel.
		
		Muchas de las funciones, clases y metodos fueron hechos previamente. Voy ver si coloco en los comentarios ayuda de como seguir el curso sin necesidad de ver el curso anterior.

	* **lucasmartinezesper** [463162] (1)

		Si sigues el curso desde Introducci√≥n a PHP no deber√≠as tener problemas. Saludos.

* **jorge-gianareas** (1) [978668](https://platzi.com/comentario/978668/) 

	Un borrado f√≠sico significa que realmente estamos borrando todo de nuestra base de datos, contrario al soft delete, el cual deja la informaci√≥n a√∫n disponible en la base de datos pero oculta en la aplicaci√≥n.

* **jorge-gianareas** (1) [978667](https://platzi.com/comentario/978667/) 

	Existe una funci√≥n de PHP que se llama compact a la cual si le pasas los nombres, buscar√° las variables y las meter√° en un arreglo.

* **Fran Delgado** (1) [851397](https://platzi.com/comentario/851397/) 

	Tengo una duda sobre esta clase. Tal como hemos hecho, estamos borrando un item con una peticion GET. No seria mas formal y correcto hacer esto sobre una peticion DELETE? Quiero decir, definiendo una ruta `$map->delete(...)` en vez de con get.

	* **gerql14** [851397] (1)

		Me imagino que es por la naturaleza de petici√≥n  
		Ya que en √©ste curso no estamos utilizando nada m√°s que PHP  
		Y para una petici√≥n DELETE tendr√≠amos que ocupar algo como AJAX ( para usar el route )  
		Es mi teor√≠a

* **lucasmartinezesper** (1) [770140](https://platzi.com/comentario/770140/) 

	Para los que tienen duda de la funci√≥n compact de PHP‚Ä¶
	
	INFO:  
	<https://www.php.net/manual/es/function.compact.php>
	
	EJEMPLO:  
	<https://www.w3schools.com/php/func_array_compact.asp>

* **EnriqueAL** (1) [579308](https://platzi.com/comentario/579308/) 

	Yo tengo una duda, y es que esto de las rutas se usar√≠a en el caso, que no se usar√° direcciones mediante botones o links etc.
	
	Y bueno igual no le veo mucha utilidad, ya que normalmente nunca se escribe en la url a donde se quiere ir.

	* **gabobardales** [579308] (1)

		Pero si no usaras esas rutas no podrias direccionarte a ninguna parte del sistema, el uso de boton o link tiene el mismo proposito. Es importantisimo las rutas.

	* **lucasmartinezesper** [579308] (1)

		Recuerda que se trabaja con front controller, solo tienes un acceso a la app, el router redirige la vista y sus funciones seg√∫n lo que deseas hacer y eso viene identificado por la ruta. Puedes llegar hacer algunas funcionalidades via AJAX pero lo mismo tendr√≠as que dirigir internamente a una ruta donde se ejecute la acci√≥n.

* **gerql14** (1) [78827](https://platzi.com/comentario/928255/) 
Si quisiera tener la ruta tipo /jobs/delete/id_job Tendr√≠a que tener mi map de la siguiente forma $map->get('delet...

## 0110. Third party Traits - Soft Delete [16212](https://platzi.com/clases/1462-php-avanzado/16212-third-party-traits-soft-delete/)

### Descripci√≥n:


 **Soft Delete** es una t√©cnica de programaci√≥n en la cual no borramos realmente los registros en la base de datos sino que √∫nicamente los marcamos como borrados para que ya no sean mostrados en nuestras vistas o en las consultas de usuarios. Al implementar un **soft delete** tendr√°s que usar algo en tu base de datos que te permita definir que est√°s trabajando con soft deletes. Podr√≠as usar una bandera o un datetime que te marque la fecha en la que fue borrado.

El hecho de si usar soft deletes es una buena pr√°ctica o no es discutible y depende de tu caso de uso. Usarlo si es necesario y tiene sentido como en sistemas de facturas o reportes.

* Usando el trait de **Eloquent** , cuando tengas registros que tienen el campo de ‚Äúdeleted_at‚Äù llenos, quiere decir que est√°n borrados; si el campo est√° vac√≠o quiere decir que no han sido borrados.
* Para usar este trait es necesario crear un campo en nuestra base de datos llamado ‚Äúdeleted_at‚Äù el cual ser√° tipo ‚ÄúDATETIME‚Äù.
* El borrado f√≠sico tambi√©n puede ser llamado **hard delete** o borrado permanente.
* Como un soft delete no borra f√≠sicamente, podemos igualmente consultar esta informaci√≥n.
* **withTrashed** es un m√©todo que modificar√° la consulta para que traiga los registros borrados con soft delete.
* Dependiendo de nuestra aplicaci√≥n, podemos tener vistas en las que se vean los registros borrados (mayormente se usa en √°reas de admin) y tener otras vistas donde no se reflejen estos registros.



### Links:

* [Eloquent: Getting Started - Laravel - The PHP Framework For Web Artisans](https://laravel.com/docs/5.7/eloquent#soft-deleting)

### Comentarios:

* **Emerson Cede√±o Salazar** (7) [504980](https://platzi.com/comentario/504980/) 

	Una vez implementado el _**SoftDelete**_ , porqu√© no implementar un _**Restore**_ y un _**ForceDelete**_?, aqu√≠ les comparto la extensi√≥n de la clase.
	
	En el `index.twig` se condicionan las _Acciones_ , algo como:
	``` 
	    {% if not job.deleted_at %}
	    <td><ahref="./jobs/delete?id={{ job.id }}">Delete</a></td>
	    {% else %}
	    <td>
	    <ahref="./jobs/restore?id={{ job.id }}">Restore</a>  
	    <ahref="./jobs/forcedelete?id={{ job.id }}">Delete perm.</a>
	    </td>
	    {% endif %}
	    
	```
	
	En el `index.php` se agregan las rutas correspondientes digamos que para cada una de estas los _actions_ quedan como: `restoreAction` y `forceDeleteAction`.
	
	Y en el `JobsController` estas acciones quedan como:
	``` 
	    public function restoreAction(ServerRequest $request)
	    {
	    $params = $request->getQueryParams();
	    $job = Job::withTrashed()->where('id', $params['id'])->restore();
	    
	    return new RedirectResponse('/jobs'); // Ajustar ruta segun corresponda ...
	    }
	    
	    public function forceDeleteAction(ServerRequest $request)
	    {
	    $params = $request->getQueryParams();
	    $job = Job::withTrashed()->where('id', $params['id'])->forceDelete();
	    
	    return new RedirectResponse('/jobs'); // Ajustar ruta segun corresponda ...
	    }
	    
	```

	* **Gabriel Amaya Bobadilla** [504980] (2)

		Muy buena idea ir implementando cosas a nuestro proyecto, leer la documentacion ayuda mucho!!!

	* **Luis Manuel Brito Romero** [504980] (2)

		Excelente hermanazo!
		
		Ahora me toca implementarlo en Projects para reforzar lo aprendido en el curso y aplicar tus cambios!

	* **lucasmartinezesper** [504980] (2)

		Muy bien practicando y profundizando m√°s all√° de la clase!

* **Daniel Hurtado** (2) [778797](https://platzi.com/comentario/778797/) 

	En proyectos grandes e importantes, usemos esto con cabeza, tengo entendido que cuando un cliente solicita la eliminaci√≥n de sus datos y las mantenemos, estar√≠amos incumpliendo leyes, sobre todo el Europa

* **Diego Ivan Padilla Bernal** (2) [462002](https://platzi.com/comentario/462002/) 

	30/12/18 : Esta clase aparece como la 5 pero en realidad es la 11. Si les aparece igual avancen y luego regresen aqu√≠, va despu√©s de ‚ÄúEndpoint to delete jobs‚Äù y antes de ‚ÄúSOLID‚Äù

* **Bryan Estiven Silva Mercado** (2) [460305](https://platzi.com/comentario/460305/) 

	Si ven el c√≥digo y se preguntan de donde salio todo eso (La lista de los distintos jobs en una tabla y con un link para eliminar).
	
	Este v√≠deo va despu√©s de la clase 11.

* **jorge-gianareas** (1) [978677](https://platzi.com/comentario/978677/) 

	Dependiendo de nuestra aplicaci√≥n, podemos tener vistas en las que se vean los registros borrados (mayormente se usa en √°reas de admin) y tener otras vistas donde no se reflejen estos registros.

* **jorge-gianareas** (1) [978676](https://platzi.com/comentario/978676/) 

	withTrashed es un m√©todo que modificar√° la consulta para que traiga los registros borrados con soft delete.

* **jorge-gianareas** (1) [978675](https://platzi.com/comentario/978675/) 

	Como un soft delete no borra f√≠sicamente, podemos igualmente consultar esta informaci√≥n.

* **jorge-gianareas** (1) [978674](https://platzi.com/comentario/978674/) 

	El borrado f√≠sico tambi√©n puede ser llamado hard delete o borrado permanente.

* **jorge-gianareas** (1) [978673](https://platzi.com/comentario/978673/) 

	Para usar este trait es necesario crear un campo en nuestra base de datos llamado ‚Äúdeleted_at‚Äù el cual ser√° tipo ‚ÄúDATETIME‚Äù.

* **jorge-gianareas** (1) [978672](https://platzi.com/comentario/978672/) 

	Usando el trait de Eloquent, cuando tengas registros que tienen el campo de ‚Äúdeleted_at‚Äù llenos, quiere decir que est√°n borrados; si el campo est√° vac√≠o quiere decir que no han sido borrados.

* **jorge-gianareas** (1) [978671](https://platzi.com/comentario/978671/) 

	El hecho de si usar soft deletes es una buena pr√°ctica o no es discutible y depende de tu caso de uso. Usarlo si es necesario y tiene sentido como en sistemas de facturas o reportes.

* **jorge-gianareas** (1) [978669](https://platzi.com/comentario/978669/) 

	Soft Delete es una t√©cnica de programaci√≥n en la cual no borramos realmente los registros en la base de datos sino que √∫nicamente los marcamos como borrados para que ya no sean mostrados en nuestras vistas o en las consultas de usuarios. Al implementar un soft delete tendr√°s que usar algo en tu base de datos que te permita definir que est√°s trabajando con soft deletes. Podr√≠as usar una bandera o un datetime que te marque la fecha en la que fue borrado.

* **Mois√©s Cede√±o** (1) [959484](https://platzi.com/comentario/959484/) 

	Muestro mis resultados con:
	``` 
	    <tr>
	                        <td>{{ job.title }}</td>
	                        <td>{{ job.description }}</td>
	                        <td>{{ job.months }}</td>
	                        <td>
	                            <imgheight="50px"width="50px"src="{{ job.getImage(job.title) }}" />
	                        </td>
	                        {% if job.deleted_at == null %}
	                            <td> 
	                                <spanclass="badge badge-success">Activo</span>
	                            </td>
	                        {% endif %}
	                        {% if (job.deleted_at) %}
	                            <td> 
	                                <spanclass="badge badge-danger">Inactivo</span>
	                            </td>
	                            {% endif %}                        
	                        </td>
	                        <td><ahref="/jobs/delete?id={{ job.id }}">Delete</a></td>
	                        <td><ahref="/jobs/restore?id={{ job.id }}">Restore</a></td>
	                        <td><ahref="/jobs/forceDelete?id={{ job.id }}">Delete perm.</a></td>
	                    </tr>
	    
	```

	* **Mois√©s Cede√±o** [959484] (1)

		A√±ado las rutas necesarias en index.php (carpeta public)
		``` 
		    $map->get('deleteJobs', '/jobs/delete', [
		        'controller' => 'App\Controllers\JobsController',
		        'action' => 'deleteAction'
		    ]);
		    $map->get('restoreJobs', '/jobs/restore', [
		        'controller' => 'App\Controllers\JobsController',
		        'action' => 'restoreAction'
		    ]);
		    $map->get('forceDeleteJobs', '/jobs/forceDelete', [
		        'controller' => 'App\Controllers\JobsController',
		        'action' => 'forceDeleteAction'
		    ]);
		    
		```

	* **Mois√©s Cede√±o** [959484] (1)

		Y finalmente a√±ado los m√©todos en el JobsController para que funcione todo:
		``` 
		        public function deleteAction(ServerRequest $request) {
		            $params = $request->getQueryParams();
		            $job = Job::find($params['id']);
		            $job->delete();
		    
		            return new RedirectResponse('/jobs');
		        }
		    
		        public function restoreAction(ServerRequest $request) {
		            $params = $request->getQueryParams();
		            $job = Job::withTrashed()->where('id',$params['id'])->first();
		            $job->restore();        
		    
		            return new RedirectResponse('/jobs');
		        }
		    
		        public function forceDeleteAction(ServerRequest $request) {
		            $params = $request->getQueryParams();
		            $job = Job::withTrashed()->where('id',$params['id'])->first();
		            $job->forceDelete();
		    
		            return new RedirectResponse('/jobs');
		        }
		    
		```

	* **Mois√©s Cede√±o** [959484] (2)

		El resultado (visualmente):
		
		![todo.png](https://static.platzi.com/media/user_upload/todo-bcdf8309-523e-499b-aafc-e78e4daa8260.jpg)

* **Mois√©s Cede√±o** (1) [959451](https://platzi.com/comentario/959451/) 

	Este v√≠deo me carga de un lento‚Ä¶ üò¶

# T√©cnicas de programaci√≥n [3195]

## 0120. SOLID [16214](https://platzi.com/clases/1462-php-avanzado/16214-solid/)

### Descripci√≥n:


 **SOLID** nos habla de 5 principios b√°sicos de la programaci√≥n orientada a objetos. Estos 5 principios ayudan a tener un c√≥digo m√°s claro y m√°s limpio aunque no son f√°ciles de implementar en un principio. La recomendaci√≥n es que sigas intentando hacerlo, que sigas leyendo, entrenando y prepar√°ndote y todo va a ir saliendo de manera natural.

**SOLID:**

* **S** ingle responsibility principle o principio de responsabilidad √∫nica. Quiere decir que cuando crees una clase, √©sta s√≥lo debe tener un prop√≥sito que debe ser sencillo; el no hacerlo hace que nuestro c√≥digo se pueda ver afectado ya que una sola cosa controla muchas otras.
* **O** pen-closed principle o principio ‚Äúabierto-cerrado‚Äù. Trata de explicarnos que deber√≠amos programar nuestras clases pensando que sean abiertas a la extensi√≥n pero cerradas a la modificaci√≥n. Debemos tratar que nuestras clases est√©n listas para ser heredadas o extendidas pero no deba ser necesario modificar el c√≥digo interno.
* **L** iskov substitution principle o principio de sustituci√≥n de Liskov. Nos dice que cuando tenemos una clase padre y creamos clases hijas, en las partes en las que usemos nuestra clase padre, deber√≠amos ser capaces de usar nuestras clases hijas. Las clases hijas deben poder funcionar con lo que funcionaba la clase padre.
* **I** nterface segregation principle o segregaci√≥n de interfaces. Dice que no debemos implementar o tener interfaces que incluyan m√©todos o cosas que la clase no necesita.
* **D** ependency inversion principle o inversi√≥n de dependencias. Trata de desacoplar nuestro c√≥digo; en lugar de crear clases internamente, vamos a inyectarlas o agregarlas. La inyecci√≥n de dependencias se usa mucho.



### Comentarios:

* **Emiliano Dur√°n** (4) [466218](https://platzi.com/comentario/466218/) 

	4-Segregaci√≥n de Interfaces: (Interface Segregation) Una interfaz no deber√≠a tener m√©todos o propiedades que no utilice.

* **Santiago Arboleda Londo√±o** (3) [636628](https://platzi.com/comentario/636628/) 

	Este v√≠deo es muy √∫til para entender lo que se ve en este episodio del curso y en el pr√≥ximo episodio.
	
	[POO: El desacoplamiento entre clases y el uso de interfaces](https://youtu.be/_59Bm1fxPmY), v√≠deo encontrado por: @flavioaandres

	* **lucasmartinezesper** [636628] (1)

		üôå suma!

* **koshiroanz** (2) [562326](https://platzi.com/comentario/562326/) 

	El principio de responsabilidad √∫nica est√° relacionado o es, lo que se conoce como cohesi√≥n y en relaci√≥n a esto, el acoplamiento?

	* **Diego Alexander Forero Higuera (Platzi)** [562326] (3)

		No, la responsabilidad √∫nica se refiere a que una clase debe hacer solo una cosa no varias cosas que no est√©n relacionadas, el acoplamiento se refiere a que no puedes mover una pieza de c√≥digo porque la aplicaci√≥n no va a fallar o esa pieza de c√≥digo no va a funcionar sola.

	* **ederrafo** [562326] (1)

		@Diego Alexander no ented√≠ la parte de _no puedes mover una pieza de c√≥digo porque** la aplicaci√≥n no va a fallar **_
		
		¬ø¬ø¬ø¬ø???

	* **Diego Alexander Forero Higuera (Platzi)** [562326] (1)

		@ederrafo fue un error de digitaci√≥n, la que quer√≠a decir es que la aplicaci√≥n va a fallar o esa pieza de c√≥digo no va a funcionar sola.

* **Emiliano Dur√°n** (2) [466220](https://platzi.com/comentario/466220/) 

	5-Principio de Inversi√≥n de dependencias:(Dependency inversion) Trata de desacoplar nuestro c√≥digo utilizando la inyecci√≥n de dependencias.

* **Emiliano Dur√°n** (2) [466216](https://platzi.com/comentario/466216/) 

	3- Principio de Sustituci√≥n de Liskov:(Liskov Substitution) Cuando tenemos una clase padre y creamos clases hijas. Al menos las clases hijas deber√≠an funcionar con lo que funcionaba la clase Padre.

* **Emiliano Dur√°n** (2) [466212](https://platzi.com/comentario/466212/) 

	2-Principio Abierto-Cerrado:(Open-Close principle) Deber√≠amos crear clases abiertas a la extensi√≥n y cerradas a la modificaci√≥n. Pensar en una clase padre para que pueda ser heredada por otra hija y as√≠ extenderse.As√≠ se Evita tener que modificar la clase padre.

* **jorge-gianareas** (1) [981768](https://platzi.com/comentario/981768/) 

	Single responsibility principle o principio de responsabilidad √∫nica.

* **jorge-gianareas** (1) [978683](https://platzi.com/comentario/978683/) 

	Dependency inversion principle o inversi√≥n de dependencias. Trata de desacoplar nuestro c√≥digo; en lugar de crear clases internamente, vamos a inyectarlas o agregarlas. La inyecci√≥n de dependencias se usa mucho.

* **jorge-gianareas** (1) [978682](https://platzi.com/comentario/978682/) 

	Interface segregation principle o segregaci√≥n de interfaces. Dice que no debemos implementar o tener interfaces que incluyan m√©todos o cosas que la clase no necesita.

* **jorge-gianareas** (1) [978681](https://platzi.com/comentario/978681/) 

	Liskov substitution principle o principio de sustituci√≥n de Liskov. Nos dice que cuando tenemos una clase padre y creamos clases hijas, en las partes en las que usemos nuestra clase padre, deber√≠amos ser capaces de usar nuestras clases hijas. Las clases hijas deben poder funcionar con lo que funcionaba la clase padre.

* **jorge-gianareas** (1) [978680](https://platzi.com/comentario/978680/) 

	Open-closed principle o principio ‚Äúabierto-cerrado‚Äù. Trata de explicarnos que deber√≠amos programar nuestras clases pensando que sean abiertas a la extensi√≥n pero cerradas a la modificaci√≥n. Debemos tratar que nuestras clases est√©n listas para ser heredadas o extendidas pero no deba ser necesario modificar el c√≥digo interno.

* **jorge-gianareas** (1) [978679](https://platzi.com/comentario/978679/) 

	Single responsibility principle o principio de responsabilidad √∫nica. Quiere decir que cuando crees una clase, √©sta s√≥lo debe tener un prop√≥sito que debe ser sencillo; el no hacerlo hace que nuestro c√≥digo se pueda ver afectado ya que una sola cosa controla muchas otras.

* **jorge-gianareas** (1) [978678](https://platzi.com/comentario/978678/) 

	SOLID nos habla de 5 principios b√°sicos de la programaci√≥n orientada a objetos. Estos 5 principios ayudan a tener un c√≥digo m√°s claro y m√°s limpio aunque no son f√°ciles de implementar en un principio. La recomendaci√≥n es que sigas intentando hacerlo, que sigas leyendo, entrenando y prepar√°ndote y todo va a ir saliendo de manera natural.

* **AxelEspinosa45** (1) [964076](https://platzi.com/comentario/964076/) 

	genial

* **Michael Rodriguez** (1) [961148](https://platzi.com/comentario/961148/) 

	SOLID es un acr√≥nimo de los cinco principios del dise√±o orientado a objetos (OOD Object Oriented Design) creados por Uncle Bob, quien tambi√©n es coautor de los principios del desarrollo web agile.
	
	Los cinco principios son:  
	**S. Single responsibility principle  
	O. Open/Closed principle  
	L. Liskov substitution principle  
	I. Interface segregation principle  
	D. Dependency Inversion Principle**
	
	Estos principios combinados facilitan al desarrollador crear proyectos f√°ciles de mantener y expandir.
	
	  1. Single responsibility principle
	
	
	
	Una clase s√≥lo debe tener un motivo para cambiar, lo que significa que s√≥lo debe tener una tarea. Tenemos varias figuras de las que despu√©s queremos calcular su √°rea total:
	``` 
	    Class Circle 
	    {
	        public $radius;
	    
	        public function __construct($radius) 
	        {
	            $this->radius = $radius;
	        }
	    }
	    
	    Class Square 
	    {
	        public $length;
	    
	        public function __construct($length) 
	        {
	            $this->length = $length;
	        }
	    }
	    
	```
	
	Primero creamos las clases de las figuras y dejamos que los constructores se encarguen de recibir las medidas necesarias.
	
	Ahora creamos la clase AreaCalculator, que recibe un array con los objetos de cada una de las figuras para ser sumadas:
	``` 
	    class AreaCalculator
	    {
	        protected $shapes;
	    
	        public function __construct($shapes = array())
	        {
	            $this->shapes = $shapes;
	        }
	    
	        public function sum()
	        {
	            // Aqu√≠ va la l√≥gica para sumar todas las √°reas
	        }
	    
	        public function output()
	        {
	            return implode('', array(
	                "<h1>",
	                    "Suma de todas las √°reas: ",
	                    $this->sum(),
	                "</h1>"
	            ));
	        }
	    }
	    
	```
	
	Para utilizar la clase AreaCalculator simplemente instanciamos la clase y le pasamos un array con las figuras, mostrando el output al final:
	``` 
	    $shapes = array (
	        new Circle(3),
	        new Square(4)
	    );
	    
	    $areas = new AreaCalculator($shapes);
	    
	    echo $areas->output();```
	    
	    El problema del m√©todo output es quela clase AreaCalculator adem√°s de calcular las √°reas maneja lal√≥gica dela salida de los datos. El problema surge cuando queremos mostrar los datos en otros formatos como json, por ejemplo.
	    
	    El principio Single responsibility determinar√≠a en este caso que AreaCalculator s√≥lo calculase el √°rea, y quela funcionalidad dela salida de los datos de produjera en otra entidad. Para ello podemos crear la clase SumCalculatorOutputter, que determinar√° como mostraremos los datos de las figuras. Con esta clase el c√≥digo quedar√≠a as√≠:
	```

* **Fran Delgado** (1) [851401](https://platzi.com/comentario/851401/) 

	Bueno, desconozco si este es el lugar adecuado pero me gustaria felicitar a Hector por dar una explicacion tan clara y concisa de un tema tan importante como los principios SOLID. Estoy realmente impresionado. Gracias!

* **jangove** (1) [794013](https://platzi.com/comentario/794013/) 

	Como consigo guardar un campo calculado en un migration

* **samuelrc** (1) [744913](https://platzi.com/comentario/744913/) 

	Me gust√≥ [este art√≠culo](https://profile.es/blog/principios-solid-desarrollo-software-calidad/) sobre SOLID. Aunque las definiciones que da a cada principio son simples, tiene muchas referencias a otros art√≠culos y bibliograf√≠a.

	* **lucasmartinezesper** [744913] (1)

		Muy buenas explicaciones! A tener en cuenta para profundizar.

* **Jean Carlos Nu√±ez Hernandez** (1) [461704](https://platzi.com/comentario/461704/) 

	SOLID -> Para mi es es fundamental para el desarrollo escalable y de al nivel

	* **Japheth Calzada L√≥pez** [461704] (1)

		por que ??

	* **flavioaandres** [461704] (4)

		Lo acabo de conocer, pero es un principio que piensa en el futuro mantenible del codigo. Alguien de platzi dice que pasamos leyendo m√°s codigo que escribiendo, entonces, debemos hacer nuestro codigo limpio, organizado y legible para futuras intervenciones o updates

	* **Emiliano Dur√°n** [461704] (2)

		No olvidemos que se puede escribir una vez y volver a **utilizar varias veces**.

* **koshiroanz** (1) [57231](https://platzi.com/comentario/562326/) 
El principio de responsabilidad √∫nica est√° relacionado o es, lo que se conoce como cohesi√≥n y en relaci√≥n a esto, el acoplamiento?

	* **Diego Alexander Forero Higuera (Platzi)** [57231] (3)

		No, la responsabilidad √∫nica se refiere a que una clase debe hacer solo una cosa no varias cosas que no est√©n relacionadas, el acoplamiento se refiere a que no puedes mover una pieza de c√≥digo porque la aplicaci√≥n no va a fallar o esa pieza de c√≥digo no va a funcionar sola.

## 0130. SOLID a profundidad [16234](https://platzi.com/clases/1462-php-avanzado/16234-solid-a-profundidad/)

### Descripci√≥n:


Vamos a ir mas a fondo acerca de c√≥mo funcionan los [principios de SOLID](https://platzi.com/blog/principios-de-programacion-solid/) y para esto crearemos algunos ejemplos que nos ayudar√°n a entender mejor c√≥mo se aplica esto en PHP:

Vamos a comenzar con un ejemplo de c√≥digo que claramente rompe estos principios de programaci√≥n y buscaremos la forma de repararlo:
``` 
    <class Reporter {
    	public function getExpensesReport($idReport) {
    		$expenses = $this->queryDBToGetExpenses($idReport);
    		return $this->renderHTML($expenses);
    }
    
    ‚Ä¶ // El c√≥digo de las funciones va aqu√≠
    }>
    
```

En este ejemplo, aunque aparentemente el c√≥digo no luce tan mal, en realidad estamos violando **dos veces** el principio de responsabilidad √∫nica. Imagina que queremos cambiar la forma en la que se realiza esta consulta a la DB (Data Base o Base de Datos), o queremos cambiar la forma en la que se muestra el HTML del reporte, el tener al menos dos razones tan diferentes para modificar esta clase, nos indica que realmente estamos violando este principio.

Ahora cambiemos el c√≥digo para ver c√≥mo podr√≠amos solucionar este problema:
``` 
    <class ExpensesRepository {
    	public function getExpensesForReport() {
    		// Aqui va la consulta  a la DB
    }
    }
    
    class ExpensesReportHTMLFormatter {
    	public function renderHTML($expenses) {
    		// Aqu√≠ va el c√≥digo que crea el c√≥digo HTML
    }
    }
    
    class Reporter {
    	private $repository;
    	private $formatter;
    
    	public function __construct() {
    		$this->repository = new ExpensesRepository();
    		$this->formatter = new ExpensesReportHTMLFormatter();
    }
    
    public function getExpensesReport($idReport) {
    		$expenses = $this->repository->getExpensesForReport($idReport);
    		return $this->formatter->renderHTML($expenses);
    }
    }>
    
```

Ahora este c√≥digo es un poco mejor, sin embargo estamos rompiendo claramente otro de los cinco principios SOLID: La Inversion de Control, este principio nos dice que debemos evitar que se dependa de clases concretas y tratar de usar siempre abstracciones para solucionar estas dependencias.

En este caso claramente podemos ver que la clase Reporter, depende directamente de la clase ExpensesRepository y de la clase ExpensesReportHTMLFormatter, esto hace que nuestro c√≥digo est√© muy acoplado y nos complique el mantener y extender la funcionalidad del mismo, imagina ahora que queremos imprimir el reporte tambi√©n en JSON, en ese caso tendr√≠amos que modificar el c√≥digo existente para cambiar las cosas.

En este caso, el primer paso para invertir el control ser√° evitar crear instancias de otras clases dentro de nuestra Reporter e inyectar esas dependencias a trav√©s de nuestro constructor:
``` 
    <class Reporter {
    	private $repository;
    	private $formatter;
    
    	public function __construct(ExpensesRepository $repo, ExpensesReportHTMLFormatter $formatter) {
    		$this->repository = $repo;
    		$this->formatter = $formatter;
    }
    
    public function getExpensesReport($idReport) {
    		$expenses = $this->repository->getExpensesForReport($idReport);
    		return $this->formatter->renderHTML($expenses);
    }
    }>
    
```

Esto ya es un paso inicial para cambiar la forma en la que funciona el c√≥digo, sin embargo, aun no resolvemos c√≥mo haremos para poder regresar los valores usando otro formato. Bueno, para esto lo que nos recomienda el **principio de Inversion de Control** es no depender de clases concretas y en lugar de eso depender de abstracciones.

Para este ejemplo lo que podemos hacer es crear una interfaz que sirva como contrato de la forma en la que se imprime un reporte e implementarla en todas las clases que queramos usar para lo mismo:
``` 
    <interface ExpensesReportFormatterInterface {
    	public function render($expenses);
    }>
    
```

Y esta interfaz la podremos implementar en diferentes clases:
``` 
    <class ExpensesReportHTMLFormatter implements ExpensesReportFormatterInterface {
    	public function render($expenses) {
    		// Aqu√≠ va el c√≥digo que crea el c√≥digo HTML
    }
    }
    
    class ExpensesReportJSONFormatter implements ExpensesReportFormatterInterface {
    	public function render($expenses) {
    		// Aqu√≠ va el c√≥digo que crea el c√≥digo JSON
    }
    }>
    
```

Y ahora podemos cambiar el constructor de nuestra clase para usar la abstracci√≥n en lugar de la clase concreta:
``` 
    <class Reporter {
    	private $repository;
    	private $formatter;
    
    	public function __construct(ExpensesRepository $repo, ExpensesReportFormatterInterface $formatter) {
    		$this->repository = $repo;
    		$this->formatter = $formatter;
    }
    
    public function getExpensesReport($idReport) {
    		$expenses = $this->repository->getExpensesForReport($idReport);
    		return $this->formatter->render($expenses);
    }
    }>
    
```

De esta forma, ahora cuando queramos cambiar el formato de salida, lo √∫nico que tenemos que hacer es inyectar el _formatter_ que queremos y nuestra aplicaci√≥n funcionar√° de una forma mucho m√°s clara y orientada a objetos.

Esto es solo un ejemplo de c√≥mo trabajar usando los principios SOLID recuerda que nunca debes considerar nada como simples reglas a seguir, siempre sigue practicando y trata de entender el porqu√© estos principios te pueden ayudar con tu c√≥digo, es posible que al principio no sea tan clara la forma de implementarlos en tu c√≥digo, pero te aseguro que si los tienes en mente y sigues practicando, con el tiempo ser√°n conceptos que podr√°s implementar de una forma mucho m√°s natural y sencilla.

### Comentarios:

* **flavioaandres** (11) [464612](https://platzi.com/comentario/464612/) 

	Realmente pienso que lo que debemos repasar un poco es el tema de las _interfaces_ , Aqui encontr√© un video que explica con un problema de ejemplo muy bieno
	
	**<https://www.youtube.com/watch?v=_59Bm1fxPmY>**

* **hectorbenitez** (5) [465993](https://platzi.com/comentario/465993/) 

	Si quieren aprender mas sobre este tema, les recomiendo los libros ‚ÄúAgile Software Development, Principles, Patterns, and Practices‚Äù y ‚ÄúClean Code‚Äù

	* **Alegranados** [465993] (1)

		los autores son necesarios, si no los resultados de las b√∫squedas son muy vagos

	* **Jorge David Duque Agudelo** [465993] (1)

		En este momento ando leyendo Clean Code, y es bastante interesante la cantidad de consejos, muchas gracias, buscar√© los otros.

	* **albertodsosa** [465993] (1)

		Hola Hector, en este c√≥digo estamos inyectando la interface en el constructor de la clase entiendo que para declarar la clase de formatter que querr√≠amos en el futuro. En ese futuro ¬ødonde declarar√≠amos la clase a la que implementa la interface? ¬øEn la instancia? ¬øY c√≥mo se la pasamos?.

	* **albertodsosa** [465993] (4)

		Me contest√© yo solo viendo el video de contenedores gracias de todas formas.
		``` 
		    <?php
		    
		    interfaceOutputFormatInterface{
		        publicfunctionrender($data);
		    }
		    
		    classXMLFormatimplementsOutputFormatInterface
		    {
		       publicfunctionrender($data)
		       {
		           return"retorna los $data en XML";
		       } 
		    }
		    
		    classJsonFormatimplementsOutputFormatInterface
		    {
		       publicfunctionrender($data)
		       {
		           return"retorna los $data en JSON";
		       } 
		    }
		    
		    classInjectionTest
		    {
		        private $format;
		    
		        publicfunction__construct(OutputFormatInterface $format)
		        {
		            $this->format = $format;
		        }
		    
		        publicfunctionoutput($data)
		        {
		           return $this->format->render($data);
		        }
		    }
		    
		    $data = 'Alberto';
		    
		    $test = new InjectionTest(new JsonFormat());
		    
		    var_dump($test->output($data));
		    
		```

	* **Heiner Estiben Castellanos soche** [465993] (2)

		Gracias @albertodsosa tuve la duda de como se inyecta la clase y me quedo la duda resuelta‚Ä¶ (y)

* **Ariel Fernando Mejia** (3) [536453](https://platzi.com/comentario/536453/) 

	Excelentiiisimooo!!! Grande Hector sos un crack! ya he trabajado con este principio pero tu ejemplo es Supremamente f√°cil! te felicito por tan buena explicaci√≥n y muy clarame encanto sobre todo como cerraste al inyectar la interface uff esa fue una jugada de Messi!!! jajaja

* **Japheth Calzada L√≥pez** (3) [463966](https://platzi.com/comentario/463966/) 

	necesito leer mas de esto, por que el ejemplo no me quedo muy clato üòÉ

* **Mois√©s Cede√±o** (2) [959509](https://platzi.com/comentario/959509/) 

	Tendr√© que leer esto var√≠as veces jajaja, me rompi√≥ la cabeza. Voy a buscarme esos libros que dice el prof.

	* **Michael Rodriguez** [959509] (1)

		Cuales son esos libreos? Dijo Nombres concretos?

* **Tlacaelel Le√≥n Villase√±or** (2) [652598](https://platzi.com/comentario/652598/) 

	SOLID me da miedo‚Ä¶

* **Bryan Estiven Silva Mercado** (2) [460327](https://platzi.com/comentario/460327/) 

	A practicar los principios !

* **Robinson Pulgarin Torres** (1) [1115856](https://platzi.com/comentario/1115856/) 

	Great!

* **cristhiancoaquira** (1) [1096216](https://platzi.com/comentario/1096216/) 

	Que gran explicacion.

* **Jairo Andres Grajales Salinas** (1) [1091274](https://platzi.com/comentario/1091274/) 

	Definitivamente es el mejor

* **Jes√∫s CH** (1) [1077660](https://platzi.com/comentario/1077660/) 

	Muy buena la explicaci√≥n!

* **Lautaro Cabral** (1) [1077336](https://platzi.com/comentario/1077336/) 

	Que gran ejemplo de aplicaci√≥n, me encant√≥!

* **wdevmaster** (1) [868584](https://platzi.com/comentario/868584/) 

	Gracias por la explicacion de verdad que es una buena forma de mejorar el nuestros c√≥digos con todo estos principios, excelente.

* **jangove** (1) [811160](https://platzi.com/comentario/811160/) 

	Como hago para pasar un valor calculado en una vista y guarde en la BD

* **Miriam Fern√°ndez** (1) [694276](https://platzi.com/comentario/694276/) 

	En el ejemplo se inyecta un repositorio y un formater pero cuano se aplica la interfaz solo se hace sobre el formater y no sobre el repositorio. Porque? Con el repositorio seguiriamos violando el principio de Inversion de control

* **gabobardales** (1) [635730](https://platzi.com/comentario/635730/) 

	Muy buena informaci√≥n aplicar y mejorar cada d√≠a.

* **angelo meneses** (1) [580264](https://platzi.com/comentario/580264/) 

	la verdad no me queda muy claro el tema de SOLID, y tiene mucha raz√≥n en eso que dice el ultimo p√°rrafo, seguir√© indagando mas a cerca del tema hasta que llegue al punto de poder entender su l√≥gica y la forma en la cual me pueda ayudar a facilitar el desarrollo de c√≥digo

* **Jos√© Tuzinkievicz** (1) [571867](https://platzi.com/comentario/571867/) 

	Muy buen art√≠culo! No llego a entenderlo por completo pero me dio una gran base saber como funciona a grandes rasgos y seguir investigando.

## 0140. Inyecci√≥n de dependencias [16215](https://platzi.com/clases/1462-php-avanzado/16215-inyeccion-de-dependencias6997/)

### Descripci√≥n:


El concepto de inyecci√≥n de dependencias lo encontrar√°s en muchos frameworks de programaci√≥n como Symfony o Laravel y es importante que entiendas c√≥mo funciona.

* Tener mucho c√≥digo dentro de los controladores es malo porque si lo quisi√©ramos reutilizar, tendr√≠amos que duplicarlo lo cual es muy tedioso en proyectos grandes y abre posibilidades a errores y vulnerabilidades. La mejor pr√°ctica es no tener duplicidad en el c√≥digo.
* El principio de control de inversi√≥n dice que debemos invertir el control y no tenerlo dentro de nuestra clase sino afuera.
* Al estar inyectando, si nuestra clase extiende de otra clase base hay que tener cuidado de usar el constructor base con parent::__construct();
* Para inyectar el argumento que se necesita dentro del controlador debemos usar un contenedor de inyecci√≥n de dependencias el cual es una clase que se encarga de elegir las dependencias correctas en las clases instanciadas.



### Comentarios:

* **Jos√© Tuzinkievicz** (5) [571878](https://platzi.com/comentario/571878/) 

	Esta clase es un viaje al centro del universo.

* **Robinson Pulgarin Torres** (1) [1116255](https://platzi.com/comentario/1116255/) 

	Recomiendo el uso de shortcut en el IDE: PHPStorm cuenta con una excelente herramienta de consejos para mejorar nuestras l√≠neas de c√≥digo, por ejemplo nos puede ayudar a crear la documentaci√≥n con un solo clic, y es el bombillo amarillo que aparece una vez el IDE detecta una posible mejora por implementar. Al hacer uso del shortcut alt+enter podemos solicitar una sugerencia para la l√≠nea actual o mejor a√∫n con el shortcut Alt+Enter podemos ver de inmediato las sugerencias dadas.

* **jorge-gianareas** (1) [978690](https://platzi.com/comentario/978690/) 

	Para inyectar el argumento que se necesita dentro del controlador debemos usar un contenedor de inyecci√≥n de dependencias el cual es una clase que se encarga de elegir las dependencias correctas en las clases instanciadas.

* **jorge-gianareas** (1) [978689](https://platzi.com/comentario/978689/) 

	l estar inyectando, si nuestra clase extiende de otra clase base hay que tener cuidado de usar el constructor base con parent::__construct();

* **jorge-gianareas** (1) [978688](https://platzi.com/comentario/978688/) 

	El principio de control de inversi√≥n dice que debemos invertir el control y no tenerlo dentro de nuestra clase sino afuera.

* **jorge-gianareas** (1) [978687](https://platzi.com/comentario/978687/) 

	Tener mucho c√≥digo dentro de los controladores es malo porque si lo quisi√©ramos reutilizar, tendr√≠amos que duplicarlo lo cual es muy tedioso en proyectos grandes y abre posibilidades a errores y vulnerabilidades. La mejor pr√°ctica es no tener duplicidad en el c√≥digo.

* **jorge-gianareas** (1) [978686](https://platzi.com/comentario/978686/) 

	El concepto de inyecci√≥n de dependencias lo encontrar√°s en muchos frameworks de programaci√≥n como Symfony o Laravel y es importante que entiendas c√≥mo funciona.

* **Gonzalo Vazquez** (1) [749125](https://platzi.com/comentario/749125/) 

	Osea que el parametro JobService del constructor hace referencia al objeto JobService.php creado dentro de la carpeta Services?
	
	![Sin t√≠tulo.png](https://static.platzi.com/media/user_upload/Sin%20t%C3%ADtulo-319d3068-c2d1-47fd-8eef-83632b3367a1.jpg)

	* **gerql14** [749125] (2)

		Hola buen d√≠a  
		Este parametro es indicado mediante Type Hinting  
		Es decir, el constructor espera un objeto del tipo JobService

* **jangove** (1) [582805](https://platzi.com/comentario/582805/) 

	Alguien tiene problema de compartir sus certificados a mi no me sale!!!

* **Jeith S Carrillo A** (1) [494424](https://platzi.com/comentario/494424/) 

	donde se copnsigue el repositorio de los archivos

	* **Gonzalo Cofr√©** [494424] (2)

		<https://github.com/hectorbenitez/curso-introduccion-php/>

	* **Javier Fern√°ndez Sacrist√°n** [494424] (1)

		Gracias

* **gerql14** (1) [86199](https://platzi.com/comentario/1090469/) 
Se podr√≠a inyectar la dependencia en el BaseController?

* **Mois√©s Cede√±o** (1) [80475](https://platzi.com/comentario/959510/) 
He tenido este problema de controladores muy largos. Me interesa seguir profundizando en este tema para mejorar mis pr√°cticas. Es terribl...

* **Jhonny Stiven Agudelo Tenorio** (1) [67412](https://platzi.com/comentario/722577/) 
my buenas, si tengo otra carpeta llamada consultas, y quiero inyectar dependecias, debo de creear otro constructor o en ese mismo, y como...

* **Jeith S Carrillo A** (1) [51661](https://platzi.com/comentario/494424/) 
donde se copnsigue el repositorio de los archivos

	* **Gonzalo Cofr√©** [51661] (2)

		<https://github.com/hectorbenitez/curso-introduccion-php/>

## 0150. Contenedor de inyecci√≥n de dependencias [16216](https://platzi.com/clases/1462-php-avanzado/16216-contenedor-de-inyeccion-de-dependencias/)

### Descripci√≥n:


El contenedor de inyecci√≥n de dependencias implementado se encargar√° √©l solo de revisar cu√°les son las dependencias que necesitamos inyectar y agregarlas a nuestro c√≥digo.  
Hay muchos paquetes que nos ayudan con la inyecci√≥n de dependencias pero en este caso utilizaremos **PHP-DI**

* Lo importante de un contenedor de inyecci√≥n de dependencias es que podr√°s configurarlo. **PHP-DI** contiene diferentes m√©todos para que definas c√≥mo funcionar√°n cada uno de los objetos creados. Tambi√©n usando **Type Hinting** y haciendo uso del **Autowiring** , **PHP-DI** puede inferir la clase a instanciar y puede agregarla.
* Si quieres tener el c√≥digo menos acoplado y en lugar de una clase quieres una interfaz o clase abstracta, s√≠ tendr√°s que definir ciertas reglas de configuraci√≥n para **PHP-DI** y no te servir√° el **Autowiring**.
* Por estar usando Homestead, ya tenemos **Composer** incluido e instalado.



### Comentarios:

* **flavioaandres** (6) [464630](https://platzi.com/comentario/464630/) 

	Yo con este curso:
	
	![](http://www.adnradio.cl/images_remote/382/3823548_n_vir3.jpg?u=120828)

	* **andreszapatin** [464630] (1)

		Yo tambi√©n. Me toc√≥ leer que era eso de inyecci√≥n de dependencias, el por qu√© por ejemplo no se hace una estructura de interfaces para desacoplar. Es extra√±o pero creo que luego se ver√° la utilidad de esto.

	* **luisangel2895** [464630] (1)

		xd

	* **Jorge David Duque Agudelo** [464630] (1)

		Tal cual, este tema de que se inyectara automaticamente si lo desconoc√≥a por completo.

	* **Matias Niz** [464630] (1)

		En java, con spring la inyeccion automatica es el pan de todos los dias. La primera vez que lo vi fue en el curso de Java EE, que dicto Anahi.

* **Gabriel Amaya Bobadilla** (3) [523339](https://platzi.com/comentario/523339/) 

	Un gran desaf√≠o esta clase!  
	tuve muchos problemas pero al final logr√© arreglar todo apunta de perseverancia y leer mucho!  
	√Ånimo para los que est√°n atascados!

* **juand_silva** (2) [1085518](https://platzi.com/comentario/1085518/) 

	Ahora entiendo el porqu√© deber√≠amos **olvidarnos del patr√≥n MVC** , viendo el refactor de este c√≥digo me doy cuenta que el creador de Laravel Taylor Otwell tiene razon al decir que deberiamos olvidarnos de este patr√≥n; ya que, √©l lo considera como **una divisi√≥n de de problemas.**
	
	<https://styde.net/porque-laravel-no-es-mvc-y-tu-deberias-olvidarte-de-mvc/>
	
	<https://twitter.com/taylorotwell/status/262290285499936768>

	* **Michael Rodriguez** [1085518] (2)

		Mas bien yo diria que se parte de MVC es el punto de partida, y es la base para empezar una aplicacion sencilla, y cuando ya tu proyecto empieza a escalar, entonces empiezas a aplicar todos estos principios y patrones de dise√±o porque sino imaginate, agregando Jobs, servicios, midelware de forma desordenada, seria un completo desastre. Yo creo que Laravel dejo de ser MVC desde la version 5.0, hoy en dia por eso es que es uno de los Framework mas Fuertes y sencillos que hay‚Ä¶

* **Danniel Sequera** (2) [625719](https://platzi.com/comentario/625719/) 

	Esto es medio fumado.
	
	Si se llega a entender porque el profesor lo est√° haciendo, cu√°l es la idea y todo pero para interiorizarlo correctamente no queda de otra que practicar, practicar y practicar. No es algo que puedas aprender en una sola clase.
	
	Excelente curso profe, es incre√≠ble.

* **Emerson Cede√±o Salazar** (2) [508448](https://platzi.com/comentario/508448/) 

	para los que no estamos usando PhpStorm (estoy usando Sublime Text), al momento de instanciar el contenedor, se genera un ‚Äúuse‚Äù correcto?, c√≥mo queda?

	* **Emerson Cede√±o Salazar** [508448] (1)

		el siguiente error en ./jobs me est√° apareciendo:
		
		> Fatal error: Uncaught ReflectionException: Class App\Controllers\JobService does not exist in ‚Ä¶/proyecto-resume/vendor/php-di/php-di/src/Definition/Source/ReflectionBasedAutowiring.php on line 65  
		>  ( ! ) ReflectionException: Class App\Controllers\JobService does not exist in ‚Ä¶/proyecto-resume/vendor/php-di/php-di/src/Definition/Source/ReflectionBasedAutowiring.php on line 65
		
		Y en `./` me est√° apareciendo el siguiente error:
		
		> Fatal error: Uncaught DI\Definition\Exception\InvalidDefinition: Entry ‚ÄúApp\Controllers\IndexController‚Äù cannot be resolved: Parameter $params of __construct() has no value defined or guessable Full definition: Object ( class = App\Controllers\IndexController lazy = false __construct( $params = #UNDEFINED# ) ) in ‚Ä¶/proyecto-resume/vendor/php-di/php-di/src/Definition/Exception/InvalidDefinition.php on line 18  
		>  ( ! ) DI\Definition\Exception\InvalidDefinition: Entry ‚ÄúApp\Controllers\IndexController‚Äù cannot be resolved: Parameter $params of __construct() has no value defined or guessable Full definition: Object ( class = App\Controllers\IndexController lazy = false __construct( $params = #UNDEFINED# ) ) in ‚Ä¶/proyecto-resume/vendor/php-di/php-di/src/Definition/Exception/InvalidDefinition.php on line 18

	* **iam-lars** [508448] (5)

		Me pasaba el mismo error, lo que hice fue agregar en el JobsController: use App\Services\JobServices;

	* **Michael Rodriguez** [508448] (1)

		Te sugiero que uses Visual Studio Code

* **Robinson Pulgarin Torres** (1) [1117398](https://platzi.com/comentario/1117398/) 

	¬°Excelente explicaci√≥n!

* **Robinson Pulgarin Torres** (1) [1117323](https://platzi.com/comentario/1117323/) 

	Es de gran importancia conocer a profundidad estos conceptos y opciones antes de comenzar a trabajar con un framework, ya que es muy probable comenzar a implementar malas pr√°cticas.

* **Michael Rodriguez** (1) [1094556](https://platzi.com/comentario/1094556/) 

	Que bueno que aprendi sobre estos principios, por eso Laravel es un framework completo porque implenta casi a un 100% estos principios en la estructura del proyecto base.

* **jorge-gianareas** (1) [978694](https://platzi.com/comentario/978694/) 

	Por estar usando Homestead, ya tenemos Composer incluido e instalado.

* **jorge-gianareas** (1) [978693](https://platzi.com/comentario/978693/) 

	Si quieres tener el c√≥digo menos acoplado y en lugar de una clase quieres una interfaz o clase abstracta, s√≠ tendr√°s que definir ciertas reglas de configuraci√≥n para PHP-DI y no te servir√° el Autowiring.

* **jorge-gianareas** (1) [978692](https://platzi.com/comentario/978692/) 

	Lo importante de un contenedor de inyecci√≥n de dependencias es que podr√°s configurarlo. PHP-DI contiene diferentes m√©todos para que definas c√≥mo funcionar√°n cada uno de los objetos creados. Tambi√©n usando Type Hinting y haciendo uso del Autowiring, PHP-DI puede inferir la clase a instanciar y puede agregarla.

* **jorge-gianareas** (1) [978691](https://platzi.com/comentario/978691/) 

	El contenedor de inyecci√≥n de dependencias implementado se encargar√° √©l solo de revisar cu√°les son las dependencias que necesitamos inyectar y agregarlas a nuestro c√≥digo.  
	Hay muchos paquetes que nos ayudan con la inyecci√≥n de dependencias pero en este caso utilizaremos PHP-DI

* **AxelEspinosa45** (1) [964421](https://platzi.com/comentario/964421/) 

	Que excelente clase, este tipo de practicas no las conoc√≠a

* **Michael Rodriguez** (1) [961176](https://platzi.com/comentario/961176/) 

	La clase es muy instructiva y bien clara, lo que si debemos ponerla en practica lo mas pronto posible para aprender y que se nos vuelva un habito a la hora de codificar‚Ä¶

* **Mois√©s Cede√±o** (1) [959558](https://platzi.com/comentario/959558/) 

	Esta clase es magistral. H√©ctor es demasiado PRO.

* **Carlos Andres Casta√±eda Osorio** (1) [851875](https://platzi.com/comentario/851875/) 

	Buen nivel el del curso !!, Excelente docente Hector, gracias

* **Daniel Hurtado** (1) [794964](https://platzi.com/comentario/794964/) 

	Pens√© que con el contenedor de inyecci√≥n de dependencia tendr√≠amos una especie de lista a la que le asignar√≠amos que queremos inyectar a cada clase, pero no, es todo autom√°tico, genial

* **Japheth Calzada L√≥pez** (1) [464362](https://platzi.com/comentario/464362/) 

	woow estuvo muy bueno la inyeccion de dependencias

* **Emerson Cede√±o Salazar** (1) [52685](https://platzi.com/comentario/508448/) 
para los que no estamos usando PhpStorm (estoy usando Sublime Text), al momento de instanciar el contenedor, se genera un ‚Äúuse‚Äù correcto?...

	* **Emerson Cede√±o Salazar** [52685] (1)

		el siguiente error en ./jobs me est√° apareciendo:
		
		> Fatal error: Uncaught ReflectionException: Class App\Controllers\JobService does not exist in ‚Ä¶/proyecto-resume/vendor/php-di/php-di/src/Definition/Source/ReflectionBasedAutowiring.php on line 65  
		>  ( ! ) ReflectionException: Class App\Controllers\JobService does not exist in ‚Ä¶/proyecto-resume/vendor/php-di/php-di/src/Definition/Source/ReflectionBasedAutowiring.php on line 65
		
		Y en `./` me est√° apareciendo el siguiente error:
		
		> Fatal error: Uncaught DI\Definition\Exception\InvalidDefinition: Entry ‚ÄúApp\Controllers\IndexController‚Äù cannot be resolved: Parameter $params of __construct() has no value defined or guessable Full definition: Object ( class = App\Controllers\IndexController lazy = false __construct( $params = #UNDEFINED# ) ) in ‚Ä¶/proyecto-resume/vendor/php-di/php-di/src/Definition/Exception/InvalidDefinition.php on line 18  
		>  ( ! ) DI\Definition\Exception\InvalidDefinition: Entry ‚ÄúApp\Controllers\IndexController‚Äù cannot be resolved: Parameter $params of __construct() has no value defined or guessable Full definition: Object ( class = App\Controllers\IndexController lazy = false __construct( $params = #UNDEFINED# ) ) in ‚Ä¶/proyecto-resume/vendor/php-di/php-di/src/Definition/Exception/InvalidDefinition.php on line 18

## 0160. Middlewares y PSR15 [16281](https://platzi.com/clases/1462-php-avanzado/16281-middlewares-y-psr157700/)

### Descripci√≥n:


Los **middleware** est√°n siendo muy utilizados no solamente en PHP sino en otros lenguajes. PHP tiene definido un PSR (PSR 15) con una interfaz com√∫n para trabajar los middleware.

Funcionan de la siguiente manera: Tenemos muchas capas encerrando nuestra aplicaci√≥n, las cuales ser√°n filtros que le dar√°n funcionalidad y as√≠ un request que entre no deber√° entrar al core de la aplicaci√≥n y se obtendr√° una respuesta si no pasa los filtros. Estos middleware pueden ser autenticaciones, revisiones de permisos, llamadas y conceptos de ese estilo.

* Implementamos **Harmony** de **Woohoolabs** que es compatible con PSR15. Es el motor que nos permite usar middlewares y al final utilizar el dispatcher.
* Siempre que estemos usando librer√≠as compatibles con **PSR** , ellas depender√°n siempre de las librer√≠as de PSR que ofrece las interfaces.
* En el ejemplo de uso de Harmony, ellos utilizan FastRoute y nosotros usamos AuraRouter en nuestro proyecto pero al ambos estar basados en los mismos est√°ndares, no hay problema de acoplamiento.
* **ServerRequestFactory** sirve para crear un objeto request que nosotros ya hacemos con Zend.
* **HttpHandlerRunner** ejecuta una interfaz tipo PSR 15 y emite la respuesta generada.
* AuraRouter no es compatible con **PSR 15** y por eso debemos buscar una implementaci√≥n que lo mete dentro de un contenedor que lo har√° compatible.
* Cuando entramos a un middleware siempre vamos a necesitar revisar el m√©todo **process** que nos dice c√≥mo est√° funcionando todo.
* S√≥lo se deben editar librer√≠as de terceros para realizar **debug**.



### Links:

* [PSR-15: HTTP Server Request Handlers - PHP-FIG](https://www.php-fig.org/psr/psr-15/)

### Comentarios:

* **Santiago Arboleda Londo√±o** (3) [490422](https://platzi.com/comentario/490422/) 

	Pienso que en vez de adaptar Aura Router a la app, ser√≠a mejor utilizar Harmony en todo su esplendor‚Ä¶ el proyecto tendr√≠a menos dependencias, aunque eso no sea una preocupaci√≥n, pero brindar√≠a m√°s claridad al tema y se aprovechar√≠a de mejor manera el paquete de Harmony.

	* **Ezequiel Guerra** [490422] (1)

		Si lo que pasa es que Aura Router ya venia implementado desde el curso anterior, fue mas como un reto.

* **Jean Carlos Nu√±ez Hernandez** (3) [460454](https://platzi.com/comentario/460454/) 

	Middlewares -> Bien pensado!

* **Jeith S Carrillo A** (2) [495834](https://platzi.com/comentario/495834/) 

	muy enredado con adaptar aura router a la app. uno como desarrollador si le aparece eso es mejor buscar un router mas actualizado

* **fernandgarcia** (1) [1112676](https://platzi.com/comentario/1112676/) 

	Tuve un error en el aura-router y para arreglarlo lo cambie por el que recomendaba harmony

* **fernandgarcia** (1) [1111420](https://platzi.com/comentario/1111420/) 

	Para los que tengan un error con el SapiEmitter de zend lo que deben hacer es desinstalarlo  
	composer remove zendframework/zend-httphandlerrunner  
	Y luego instalar el de laminas  
	composer require laminas/laminas-httphandlerrunner

* **jorge-gianareas** (1) [978702](https://platzi.com/comentario/978702/) 

	HttpHandlerRunner ejecuta una interfaz tipo PSR 15 y emite la respuesta generada.  
	AuraRouter no es compatible con PSR 15 y por eso debemos buscar una implementaci√≥n que lo mete dentro de un contenedor que lo har√° compatible.  
	Cuando entramos a un middleware siempre vamos a necesitar revisar el m√©todo process que nos dice c√≥mo est√° funcionando todo.  
	S√≥lo se deben editar librer√≠as de terceros para realizar debug.

* **jorge-gianareas** (1) [978701](https://platzi.com/comentario/978701/) 

	ServerRequestFactory sirve para crear un objeto request que nosotros ya hacemos con Zend.

* **jorge-gianareas** (1) [978700](https://platzi.com/comentario/978700/) 

	En el ejemplo de uso de Harmony, ellos utilizan FastRoute y nosotros usamos AuraRouter en nuestro proyecto pero al ambos estar basados en los mismos est√°ndares, no hay problema de acoplamiento.

* **jorge-gianareas** (1) [978699](https://platzi.com/comentario/978699/) 

	Siempre que estemos usando librer√≠as compatibles con PSR, ellas depender√°n siempre de las librer√≠as de PSR que ofrece las interfaces.

* **jorge-gianareas** (1) [978697](https://platzi.com/comentario/978697/) 

	Implementamos Harmony de Woohoolabs que es compatible con PSR15. Es el motor que nos permite usar middlewares y al final utilizar el dispatcher.

* **jorge-gianareas** (1) [978696](https://platzi.com/comentario/978696/) 

	Funcionan de la siguiente manera: Tenemos muchas capas encerrando nuestra aplicaci√≥n, las cuales ser√°n filtros que le dar√°n funcionalidad y as√≠ un request que entre no deber√° entrar al core de la aplicaci√≥n y se obtendr√° una respuesta si no pasa los filtros. Estos middleware pueden ser autenticaciones, revisiones de permisos, llamadas y conceptos de ese estilo.

* **jorge-gianareas** (1) [978695](https://platzi.com/comentario/978695/) 

	os middleware est√°n siendo muy utilizados no solamente en PHP sino en otros lenguajes. PHP tiene definido un PSR (PSR 15) con una interfaz com√∫n para trabajar los middleware.

* **Mois√©s Cede√±o** (1) [959585](https://platzi.com/comentario/959585/) 

	Qu√© locura esta clase hahahaha, pas√© 1 hora tratando de corregir mi error y cuando me doy cuenta en la siguiente clase se arregla jajaajja qu√© cosas.
	
	Tambi√©n porque el paquete Harmony ha sido actualizado entonces, pens√© que por eso me daba error.

* **darwistg** (1) [560879](https://platzi.com/comentario/560879/) 

	no entiendo porque aura router hay que hacerle ese adaptamiento si al principio se dijo que cumpl√≠a los est√°ndares PSR.

	* **Diego Alexander Forero Higuera (Platzi)** [560879] (2)

		Es compatible, pero no es compatible espec√≠ficamente con el PSR 15 que es el que se usa para los middlewares por eso se hace la instalaci√≥n del paquete que ya esta adaptado.

* **Jhonny Stiven Agudelo Tenorio** (1) [69079](https://platzi.com/comentario/751008/) 
Fatal error: Uncaught Zend\HttpHandlerRunner\Exception\EmitterException: Output has been emitted previously; cannot emit response in C:\x...

## 0170. Implementando el server request handler [16282](https://platzi.com/clases/1462-php-avanzado/16282-implementando-el-server-request-handler7049/)

### Descripci√≥n:


* Debes acostumbrarte a leer c√≥digo de otras personas o librer√≠as. Detr√°s de todo hay un programador haciendo algo que podr√°s entender y modificar.
* Es muy importante que leas los errores ya que muchas veces te dar√° pistas muy buenas de lo que est√° sucediendo.



### Links:

* [GitHub - woohoolabs/harmony: A simple and flexible PHP middleware dispatcher based on PSR-7, PSR-11 and PSR-15](https://github.com/woohoolabs/harmony)

### Comentarios:

* **Bryan Estiven Silva Mercado** (2) [460684](https://platzi.com/comentario/460684/) 

	Utilizar harmony simplifica realmente las cosas

	* **Spyderp** [460684] (2)

		puedes revizar otros middleware de otros framework para ver como lo hacen. Puede ver otras opciones que puede funcionarte en tus proyectos

* **Robinson Pulgarin Torres** (1) [1125095](https://platzi.com/comentario/1125095/) 

	Para la prueba, no he implementado el response con Twig, por lo que me arrojaba un Fatal error indicando que deb√≠a ser un return de tipo Interface, por lo que he utilizado el ejemplo b√°sico de FastRouteMiddleware en AuraRouter para el controlador, de la siguiente manera:
	``` 
	    use Psr\Http\Message\ServerRequestInterface;
	    use Psr\Http\Message\ResponseInterface;
	    
	    public function indexAction(ServerRequestInterface $request, ResponseInterface $response): ResponseInterface
	    {
	    	$users = [
	    		"Steve",
	    		"Arnie",
	    		$this->jobService->getJobs()['user']
	    	];
	    
	    	$response->getBody()->write(json_encode($users));
	    
	    	return $response;
	    }```
	    
	```

* **fernandgarcia** (1) [1112675](https://platzi.com/comentario/1112675/) 

	Tuve un error en el aura-router y para arreglarlo lo cambie por el que recomendaba harmony

* **fernandgarcia** (1) [1111427](https://platzi.com/comentario/1111427/) 

	Para los que tengan un error con el SapiEmitter de zend lo que deben hacer es desinstalarlo  
	composer remove zendframework/zend-httphandlerrunner  
	Y luego instalar el de laminas  
	composer require laminas/laminas-httphandlerrunner

* **jorge-gianareas** (1) [978704](https://platzi.com/comentario/978704/) 

	Es muy importante que leas los errores ya que muchas veces te dar√° pistas muy buenas de lo que est√° sucediendo.

* **jorge-gianareas** (1) [978703](https://platzi.com/comentario/978703/) 

	Debes acostumbrarte a leer c√≥digo de otras personas o librer√≠as. Detr√°s de todo hay un programador haciendo algo que podr√°s entender y modificar.

* **Nehuen Nicolas Marinelli** (1) [874822](https://platzi.com/comentario/874822/) 

	Y si quiero utilizar 2 o mas funciones dentro de mi Controller, como deberia hacer? Como seria el ‚Äòaction‚Äô? Porque siempre utiliza una funcion en cada Controller.

* **Jhonny Stiven Agudelo Tenorio** (1) [751095](https://platzi.com/comentario/751095/) 

	Fatal error: Uncaught Zend\HttpHandlerRunner\Exception\EmitterException: Output has been emitted previously; cannot emit response in C:\xampp\htdocs\curso-php\vendor\zendframework\zend-httphandlerrunner\src\Exception\EmitterException.php:23 Stack trace: #0 C:\xampp\htdocs\curso-php\vendor\zendframework\zend-httphandlerrunner\src\Emitter\SapiEmitterTrait.php(39): Zend\HttpHandlerRunner\Exception\EmitterException::forOutputSent() #1 C:\xampp\htdocs\curso-php\vendor\zendframework\zend-httphandlerrunner\src\Emitter\SapiEmitter.php(26): Zend\HttpHandlerRunner\Emitter\SapiEmitter->assertNoPreviousOutput() #2 C:\xampp\htdocs\curso-php\vendor\woohoolabs\harmony\src\Middleware\HttpHandlerRunnerMiddleware.php(36): Zend\HttpHandlerRunner\Emitter\SapiEmitter->emit(Object(Zend\Diactoros\Response\HtmlResponse)) #3 C:\xampp\htdocs\curso-php\vendor\woohoolabs\harmony\src\Harmony.php(128): WoohooLabs\Harmony\Middleware\HttpHandlerRunnerMiddleware->process(Object(Zend\Diactoros\ServerRequest), Object(WoohooLabs\Harmony\Harmony)) #4 C:\xamp in C:\xampp\htdocs\curso-php\vendor\zendframework\zend-httphandlerrunner\src\Exception\EmitterException.php on line 23

* **codeisaac** (1) [713316](https://platzi.com/comentario/713316/) 

	Y que hay con la autenticaci√≥n, seguro ahora lo crearemos un middleware para el auth y las rutas protegidas.

* **Carlos Farf√°n Baz√°n** (1) [706293](https://platzi.com/comentario/706293/) 

	Y si en vez de usar un arreglo para definir el controlador y la acci√≥n usas closure, como se hace para que el Container pueda inyectar?.

* **Genaro Mart√≠nez** (1) [581070](https://platzi.com/comentario/581070/) 

	Alguien? no puedo avanzar con el curso debido a mi error, alguien me puede ayudar?

	* **ebar0n (Platzi)** [581070] (2)

		Hola, te respondi en el hilo de la conversacion donde dejaste el error.

* **Genaro Mart√≠nez** (1) [579413](https://platzi.com/comentario/579413/) 

	No logro encontrar el detalle, me sale lo siguiente:  
	Fatal error: Uncaught Error: Class ‚ÄòWoohooLabs\Harmony\Middleware\HttpHandlerRunnerMiddleware‚Äô not found in /var/www/html/curso-php-platzi/public/index.php on line 110  
	( ! ) Error: Class ‚ÄòWoohooLabs\Harmony\Middleware\HttpHandlerRunnerMiddleware‚Äô not found in /var/www/html/curso-php-platzi/public/index.php on line 110  
	Call Stack
	
	<h1>Time Memory Function Location</h1>  
	1 0.0002 382472 {main}( ) ‚Ä¶/index.php:0
	``` 
	    <code>
	    <?php
	    require_once '../vendor/autoload.php';
	    
	    session_start();
	    
	    $dotenv = Dotenv\Dotenv::create(__DIR__ . '/..');
	    $dotenv->load();
	    
	    use Illuminate\Database\Capsule\Manager as Capsule;
	    use Aura\Router\RouterContainer;
	    use WoohooLabs\Harmony\Harmony;
	    use WoohooLabs\Harmony\Middleware\DispatcherMiddleware;
	    use WoohooLabs\Harmony\Middleware\HttpHandlerRunnerMiddleware;
	    use Zend\Diactoros\Response;
	    use Zend\HttpHandlerRunner\Emitter\SapiEmitter;
	    
	    $container = new DI\Container();
	    
	    $capsule = new Capsule;
	    
	    $capsule->addConnection([
	        'driver'    => 'mysql',
	        'host'      => getenv('DB_HOST'),
	        'database'  => getenv('DB_NAME'),
	        'username'  => getenv('DB_USER'),
	        'password'  => getenv('DB_PASS'),
	        'charset'   => 'utf8',
	        'collation' => 'utf8_unicode_ci',
	        'prefix'    => '',
	    ]);
	    $capsule->setAsGlobal();
	    $capsule->bootEloquent();
	    
	    $request = Zend\Diactoros\ServerRequestFactory::fromGlobals(
	      $_SERVER,
	      $_GET,
	      $_POST,
	      $_COOKIE,
	      $_FILES
	    );
	    
	    $routerContainer = new RouterContainer();
	    $map = $routerContainer->getMap();
	    
	    $map->get('index', '/curso-php-platzi/', [
	        'controller' => 'App\Controllers\IndexController',
	        'action' => 'indexAction'
	    ]);
	    
	    $map->get('indexJobs', '/curso-php-platzi/jobs', [
	        'controller' => 'App\Controllers\JobsController',
	        'action' => 'indexAction'
	    ]);
	    $map->get('deleteJobs', '/curso-php-platzi/jobs/delete', [
	        'controller' => 'App\Controllers\JobsController',
	        'action' => 'deleteAction'
	    ]);
	    
	    $map->get('addJobs', '/curso-php-platzi/jobs/add', [
	        'controller' => 'App\Controllers\JobsController',
	        'action' => 'getAddJobAction'
	    ]);
	    
	    $map->post('saveJobs', '/curso-php-platzi/jobs/add', [
	        'controller' => 'App\Controllers\JobsController',
	        'action' => 'getAddJobAction'
	    ]);
	    
	    $map->get('addUsers', '/curso-php-platzi/users/add', [
	        'controller' => 'App\Controllers\UsersController',
	        'action' => 'getAddUserAction'
	    ]);
	    
	    $map->post('saveUsers', '/curso-php-platzi/users/add', [
	        'controller' => 'App\Controllers\UsersController',
	        'action' => 'getAddUserAction'
	    ]);
	    
	    $map->get('loginForm', '/curso-php-platzi/login', [
	        'controller' => 'App\Controllers\AuthController',
	        'action' => 'getLogin'
	    ]);
	    
	    $map->get('logout', '/curso-php-platzi/logout', [
	        'controller' => 'App\Controllers\AuthController',
	        'action' => 'getLogout',
	    ]);
	    
	    $map->post('auth', '/curso-php-platzi/auth', [
	        'controller' => 'App\Controllers\AuthController',
	        'action' => 'postLogin'
	    ]);
	    
	    $map->get('admin', '/curso-php-platzi/admin', [
	        'controller' => 'App\Controllers\AdminController',
	        'action' => 'getIndex',
	        'auth' => true
	    ]);
	    
	    
	    $matcher = $routerContainer->getMatcher();
	    $route = $matcher->match($request);
	    
	    if (!$route) {
	        echo 'No route';
	    }else{
	        $harmony = new Harmony($request, new Response());
	        $harmony
	            ->addMiddleware(new HttpHandlerRunnerMiddleware(new SapiEmitter()))
	            ->addMiddleware(new Middlewares\AuraRouter($routerContainer))
	            ->addMiddleware(new AuthenticationMiddleware())
	            ->addMiddleware(new DispatcherMiddleware($container, 'request-handler'));
	        $harmony();
	    }
	    
	    
	```

	* **ebar0n (Platzi)** [579413] (2)

		Hola, cheka los comandos que usaste para instalar la dependencia **harmony**<https://github.com/woohoolabs/harmony>, tal vez instalaste una version que no tiene el Middleware que intentas usar.

	* **Josu√© Isaac Fuentes L√≥pez** [579413] (1)

		yo tenia el mism o problema te dejo el composer.json, yo tenia problemas pero era por las versiones de las librerias y debe de estar actualizado a php 7.1 o mayor
		``` 
		    {
		      "autoload":{
		        "psr-4":{
		          "app\\":"app/"
		        }
		      },
		      "require":{
		        "illuminate/database": "^5.5",
		        "zendframework/zend-diactoros": "^2.0.0",
		        "aura/router": "^3.1",
		        "twig/twig": "^2.9",
		        "respect/validation": "^1.1",
		        "php-di/php-di": "^6.0",
		        "woohoolabs/harmony": "^6.0",
		        "middlewares/aura-router": "^1.1",
		        "zendframework/zend-httphandlerrunner": "^1.0.0"
		      }
		    
		    }
		    
		```

	* **Mois√©s Cede√±o** [579413] (2)

		Necesitas instalar Creo que con este lo resuelves:
		``` 
		    composerrequire laminas/laminas-diactoros
		    composerrequire woohoolabs/harmony
		    composerrequire laminas/laminas-httphandlerrunner
		    
		```
		
		Con esto lo resuelves. Te falta el httphandlerrunner en tus paquetes.

* **MDCMC** (1) [575045](https://platzi.com/comentario/575045/) 

	Siento que todo se enredo mucho, creo que era mejor utilizar el fast-router.  
	Aunque estuvo muy buena la clase de ejemplo de como depurar el codigo

* **Genaro Mart√≠nez** (1) [58745](https://platzi.com/comentario/581070/) 
Alguien? no puedo avanzar con el curso debido a mi error, alguien me puede ayudar?

	* **ebar0n (Platzi)** [58745] (2)

		Hola, te respondi en el hilo de la conversacion donde dejaste el error.

* **Genaro Mart√≠nez** (1) [58619](https://platzi.com/comentario/579413/) 
No logro encontrar el detalle, me sale lo siguiente: Fatal error: Uncaught Error: Class ‚ÄòWoohooLabs\Harmony\Middleware\HttpHandlerRunnerM...

	* **ebar0n (Platzi)** [58619] (2)

		Hola, cheka los comandos que usaste para instalar la dependencia **harmony**<https://github.com/woohoolabs/harmony>, tal vez instalaste una version que no tiene el Middleware que intentas usar.

## 0180. Creando un middleware [16283](https://platzi.com/clases/1462-php-avanzado/16283-creando-un-middleware8452/)

### Descripci√≥n:


La autenticaci√≥n la manejaremos a trav√©s de un middleware.  
Para crear nuestro middleware y como estamos trabajando con **PSR-15** , utilizaremos la interfaz que nos provee **PSR-15** lo cual genera un contrato entre las clases que usamos y las clases que usan otras librer√≠as. As√≠ aseguramos interoperabilidad entre aplicaciones.

* Los status 200 son status correctos.
* Los status 400 estamos enviando alg√∫n error culpando al usuario.
* Los status 500 son errores en nuestro servidor.



Un middleware tiene la parte del handler pero puede hacer cosas antes o despu√©s.

### Comentarios:

* **Bryan Estiven Silva Mercado** (3) [460754](https://platzi.com/comentario/460754/) 

	Si quieren ampliar sobre los c√≥digos de respuesta [link](https://developer.mozilla.org/es/docs/Web/HTTP/Status)

* **Bryan Estiven Silva Mercado** (2) [460748](https://platzi.com/comentario/460748/) 

	 **Cuales pueden ser los errores**
	
	`Fatal error: Uncaught Error: Class 'App\Middleware\AuthenticationMiddleware' not found in C:\xampp\htdocs\proyectos\public\index.php:144 Stack trace: #0 {main} thrown in C:\xampp\htdocs\proyectos\public\index.php on line 144`
	
	* Ya revise la estructura de carpetas
	* Revise los nombres de las carpetas
	* Si voy a definici√≥n me lleva al archivo correcto
	
	

	* **Bryan Estiven Silva Mercado** [460748] (1)

		```
		    use App\Middleware\AuthenticationMiddleware;
		    
		    $harmony = new Harmony($request, new Response());
		        $harmony
		            ->addMiddleware(new HttpHandlerRunnerMiddleware(new SapiEmitter())) // verifica que no exista una salida previa y envia los encabezados/status
		            ->addMiddleware( new Middlewares\AuraRouter($routerContainer) ) // detecta la ruta y nos pasa los datos
		          //  ->addMiddleware(new AuthenticationMiddleware())
		            ->addMiddleware(new DispatcherMiddleware($container,'request-handler')); // llama al controlador y la acci√≥n
		    
		        $harmony();
		    
		```

	* **Bryan Estiven Silva Mercado** [460748] (1)

		```
		    <?php
		    /**
		   * Created by PhpStorm.
		   * User: bryan
		   * Date: 29/12/2018
		   * Time: 15:08
		     */
		    
		    namespaceapp\Middleware;
		    
		    
		    usePsr\Http\Message\ResponseInterface;
		    usePsr\Http\Message\ServerRequestInterface;
		    usePsr\Http\Server\MiddlewareInterface;
		    usePsr\Http\Server\RequestHandlerInterface;
		    useZend\Diactoros\Response\EmptyResponse;
		    
		    classAuthenticationMiddlewareimplementsMiddlewareInterface
		    {
		    
		        /**
		       * Process an incoming server request.
		         *
		       * Processes an incoming server request in order to produce a response.
		       * If unable to produce the response itself, it may delegate to the provided
		       * request handler to do so.
		         */
		        publicfunctionprocess(ServerRequestInterface $request, RequestHandlerInterface $handler): ResponseInterface
		        {
		            // TODO: Implement process() method.
		    
		            if($request->getUri()->getPath() === '/proyectos/admin'){
		                $sessionTrue = $_SESSION['userId'] ?? null;
		                if(!$sessionTrue){
		                    //regresar
		                    returnnew EmptyResponse(403);
		                }
		            }
		            //continuar
		            return $handler->handle($request);
		            
		        }
		    }
		    
		```

	* **hectorbenitez** [460748] (1)

		probablemente es porque el namespace debe ser con mayuscula

* **Ivan Santicomani Serrano** (2) [58852](https://platzi.com/comentario/582867/) 
Me sale este error Alguien de casualidad sabra por que me sale?

	* **Ivan Santicomani Serrano** [58852] (1)

		creo que mi captura no se ve bien
		
		Fatal error: Declaration of App\Middlewares\AuthenticationMiddleware::process(Psr\Http\Message\ServerRequestInterface $request, Psr\Http\Server\RequestHandlerInterface $handler) must be compatible with Psr\Http\Server\MiddlewareInterface::process(Psr\Http\Message\ServerRequestInterface $request, Psr\Http\Server\RequestHandlerInterface $handler): Psr\Http\Message\ResponseInterface in /home/vagrant/code/curso-introduccion-php/app/Middlewares/AuthenticationMiddleware.php on line 10

* **jorge-gianareas** (1) [978708](https://platzi.com/comentario/978708/) 

	Un middleware tiene la parte del handler pero puede hacer cosas antes o despu√©s.

* **jorge-gianareas** (1) [978707](https://platzi.com/comentario/978707/) 

	Los status 200 son status correctos.  
	Los status 400 estamos enviando alg√∫n error culpando al usuario.  
	Los status 500 son errores en nuestro servidor.

* **jorge-gianareas** (1) [978706](https://platzi.com/comentario/978706/) 

	La autenticaci√≥n la manejaremos a trav√©s de un middleware.  
	Para crear nuestro middleware y como estamos trabajando con PSR-15, utilizaremos la interfaz que nos provee PSR-15 lo cual genera un contrato entre las clases que usamos y las clases que usan otras librer√≠as. As√≠ aseguramos interoperabilidad entre aplicaciones.

* **Mois√©s Cede√±o** (1) [959597](https://platzi.com/comentario/959597/) 

	Siempre que trabajamos con Middlewares en PSR-15 debemos implementar la interface que nos provee PSR-15.

* **Jhonny Stiven Agudelo Tenorio** (1) [759074](https://platzi.com/comentario/759074/) 

	y si deseo colocar mas rutas autenticadas ?

	* **Daniel Hurtado** [759074] (1)

		Yo har√≠a un array con las rutas y realizar√≠a una comprobaci√≥n de la URI a ver si se encuentra dentro del array

* **Josu√© Isaac Fuentes L√≥pez** (1) [594327](https://platzi.com/comentario/594327/) 

	Mi midlleware Mejorado para autenticaci√≥n
	``` 
	    <?php
	    namespace app\Middlewares;
	    
	    use Psr\Http\Server\MiddlewareInterface;
	    use Psr\Http\Message\ServerRequestInterface;
	    use Psr\Http\Server\RequestHandlerInterface;
	    use Psr\Http\Message\ResponseInterface;
	    use Zend\Diactoros\Response\EmptyResponse;
	    
	    class AuthenticationMiddleware implements MiddlewareInterface
	    {
	      private $routes;
	    
	      /**
	     * __construct
	       *
	     * @param  RouterContainer $router
	       *
	     * @return void
	       */
	      public function __construct( $router)
	      {
	        $this->routes = $router;
	      }
	    
	      /**
	     * process
	       *
	     * @param  ServerRequestInterface $request
	     * @param  RequestHandlerInterface $handler
	       *
	     * @return ResponseInterface
	       */
	      public function process(ServerRequestInterface $request, RequestHandlerInterface $handler): ResponseInterface
	      {
	        if($this->rutaAuntenticada($request)){
	          $sessionUserId = $_SESSION['userId']?? null;
	          if(!$sessionUserId)
	          {
	              return new EmptyResponse(401);
	          }
	    
	        }
	        return $handler->handle($request);
	      }
	    
	      /**
	     * rutaAuntenticada
	       *
	     * @param  string $ruta
	       *
	     * @return booelan
	       */
	      private function rutaAuntenticada($request)
	      {
	        $matcher = $this->routes->getMatcher();
	        $route = $matcher->match($request);
	        $handlerData = $route->handler;
	        $needsAuth = $handlerData['auth'] ?? false;
	        if($needsAuth){
	          return true;
	        }
	        return false;
	      }
	    }```
	    
	```

* **Ivan Santicomani Serrano** (1) [582867](https://platzi.com/comentario/582867/) 

	Me sale este error
	
	![Captura de Pantalla 2019-05-09 a la\(s\) 14.35.44.png](https://static.platzi.com/media/user_upload/Captura%20de%20Pantalla%202019-05-09%20a%20la%28s%29%2014.35.44-ea617ec0-67df-4bf3-9a76-6b106fa299e7.jpg)
	
	Alguien de casualidad sabra por que me sale?

	* **Ivan Santicomani Serrano** [582867] (1)

		creo que mi captura no se ve bien
		
		Fatal error: Declaration of App\Middlewares\AuthenticationMiddleware::process(Psr\Http\Message\ServerRequestInterface $request, Psr\Http\Server\RequestHandlerInterface $handler) must be compatible with Psr\Http\Server\MiddlewareInterface::process(Psr\Http\Message\ServerRequestInterface $request, Psr\Http\Server\RequestHandlerInterface $handler): Psr\Http\Message\ResponseInterface in /home/vagrant/code/curso-introduccion-php/app/Middlewares/AuthenticationMiddleware.php on line 10

	* **walis85300 (Platzi)** [582867] (1)

		Puedes poner el c√≥digo del Middleware? As√≠ es m√°s f√°cil ver el error.

	* **Ivan Santicomani Serrano** [582867] (1)

		Disculpa que me tardara tanto en responder este es mi codigo del middleware segun yo esta bien pero me sigue marcando el mismo error
		
		namespace App\Middlewares;
		
		use Psr\Http\Server\MiddlewareInterface;  
		use Psr\Http\Server\RequestHandlerInterface;  
		use Psr\Http\Message\ServerRequestInterface;  
		use Psr\Http\Message\ResponseInterface;  
		use Psr\Http\Message\EmptyResponse;
		
		class AuthenticationMiddleware implements MiddlewareInterface  
		{  
		public function process(ServerRequestInterface $request, RequestHandlerInterface $handler){  
		if ($request->getUri()->getPath() === ‚Äò/admin‚Äô ) {  
		$sessionUserId = $_SESSION[‚ÄòuserId‚Äô] ?? null;  
		if (!$sessionUserId) {  
		return new EmptyResponse(401);  
		}  
		}  
		return $handler->handle($request);  
		}  
		}

	* **Mois√©s Cede√±o** [582867] (1)

		T√∫ error es porque no est√°s a√±adiendo los correspondientes uses para las Interfaces que est√°n implementando.
		
		Necesitas importar las interfaces parar que luego las puedas usar:
		``` 
		    use Psr\Http\Message\ResponseInterface;
		    use Psr\Http\Message\ServerRequestInterface;
		    use Psr\Http\Server\MiddlewareInterface;
		    use Psr\Http\Server\RequestHandlerInterface;
		    use Zend\Diactoros\Response\EmptyResponse;
		    
		```

* **Ariel Fernando Mejia** (1) [536481](https://platzi.com/comentario/536481/) 

	Pero que jaleo üò¶

* **Bryan Estiven Silva Mercado** (1) [48940](https://platzi.com/comentario/460748/) 
Cuales pueden ser los errores Fatal error: Uncaught Error: Class 'App\Middleware\AuthenticationMiddleware' not fou...

	* **Bryan Estiven Silva Mercado** [48940] (1)

		```
		    use App\Middleware\AuthenticationMiddleware;
		    
		    $harmony = new Harmony($request, new Response());
		        $harmony
		            ->addMiddleware(new HttpHandlerRunnerMiddleware(new SapiEmitter())) // verifica que no exista una salida previa y envia los encabezados/status
		            ->addMiddleware( new Middlewares\AuraRouter($routerContainer) ) // detecta la ruta y nos pasa los datos
		          //  ->addMiddleware(new AuthenticationMiddleware())
		            ->addMiddleware(new DispatcherMiddleware($container,'request-handler')); // llama al controlador y la acci√≥n
		    
		        $harmony();
		    
		```

# Errores y debug [3196]

## 0190. Error Handling [16285](https://platzi.com/clases/1462-php-avanzado/16285-error-handling5612/)

### Descripci√≥n:


Hasta este momento estuvimos trabajando en modo debug viendo errores en consola. Esto es √∫til al desarrollar pero cuando la aplicaci√≥n est√© funcionando abierta a usuarios se deben tomar otras medidas para no enviarles errores poco entendibles.

* Podemos controlar la excepci√≥n con error handling enviando respuestas m√°s profesionales de los errores que se puedan presentar.
* En vez de respuestas vac√≠as en el emitter, se puede enviar un HTML mostrando im√°genes o cosas custom.
* La diferencia entre las excepciones y los errores es que las excepciones normalmente son disparadas por el programador y los errores son cosas que PHP detecta que no pueden ser realizadas. En PHP 5 y anteriores no hab√≠a manera de manejar eso pero a partir de PHP 7 podemos agarrar y manejar los errores del c√≥digo.
* Error y excepci√≥n no forman parte de una cadena de herencia, funcionan porque implementan la interfaz **Throwable** la cual nunca debe ser implementada.
* Podemos tener un try y muchos catch dependiendo de los diferentes casos que tengamos.
* SPL es la biblioteca est√°ndar de PHP y aqu√≠ podemos encontrar estructuras e interfaces muy interesantes. Tambi√©n tenemos las excepciones.
* Laravel Eloquent tiene un m√©todo de findOrFail que si no encuentra un objeto, inmediatamente nos tira una excepci√≥n.



### Comentarios:

* **MDCMC** (3) [575871](https://platzi.com/comentario/575871/) 

	Esta muy buena la clase para aprender un poco mas de debug

* **Robinson Moscoso** (2) [929018](https://platzi.com/comentario/929018/) 
Al manejar las excepciones hay que tener en cuenta que son eso, excepciones y no deben ser utilizadas en el flujo normal de la aplicaci√≥n.

* **jorge-gianareas** (1) [978716](https://platzi.com/comentario/978716/) 

	SPL es la biblioteca est√°ndar de PHP y aqu√≠ podemos encontrar estructuras e interfaces muy interesantes. Tambi√©n tenemos las excepciones.  
	Laravel Eloquent tiene un m√©todo de findOrFail que si no encuentra un objeto, inmediatamente nos tira una excepci√≥n.

* **jorge-gianareas** (1) [978715](https://platzi.com/comentario/978715/) 

	Podemos tener un try y muchos catch dependiendo de los diferentes casos que tengamos.

* **jorge-gianareas** (1) [978714](https://platzi.com/comentario/978714/) 

	Error y excepci√≥n no forman parte de una cadena de herencia, funcionan porque implementan la interfaz Throwable la cual nunca debe ser implementada.

* **jorge-gianareas** (1) [978713](https://platzi.com/comentario/978713/) 

	La diferencia entre las excepciones y los errores es que las excepciones normalmente son disparadas por el programador y los errores son cosas que PHP detecta que no pueden ser realizadas. En PHP 5 y anteriores no hab√≠a manera de manejar eso pero a partir de PHP 7 podemos agarrar y manejar los errores del c√≥digo.

* **jorge-gianareas** (1) [978712](https://platzi.com/comentario/978712/) 

	En vez de respuestas vac√≠as en el emitter, se puede enviar un HTML mostrando im√°genes o cosas custom

* **jorge-gianareas** (1) [978711](https://platzi.com/comentario/978711/) 

	Podemos controlar la excepci√≥n con error handling enviando respuestas m√°s profesionales de los errores que se puedan presentar.

* **jorge-gianareas** (1) [978710](https://platzi.com/comentario/978710/) 

	Hasta este momento estuvimos trabajando en modo debug viendo errores en consola. Esto es √∫til al desarrollar pero cuando la aplicaci√≥n est√© funcionando abierta a usuarios se deben tomar otras medidas para no enviarles errores poco entendibles.

* **F√©lix Andersson** (1) [820620](https://platzi.com/comentario/820620/) 

	No me atrapa el error en el bloque try

	* **gerql14** [820620] (1)

		Hola Felix, est√°s generando el throw en el servicio de Job?  
		Podr√≠as compartir c√≥digo?

* **teisat_p** (1) [511483](https://platzi.com/comentario/511483/) 

	hola, en el ejemplo el modifica en el get al valor 1000, el cual no existe en base de datos y por ender el array da vacio, ahora si por casualidad colocan un id que si existe en base de datos lo encontrara y realizara la accion con otro usuario, ej si se quiere eliminar se eliminara otro.  
	Que hacer ahi??? como saber si la url fue manipulada

	* **Richard Santiestevan** [511483] (3)

		Hola, creo q no hay manera de identificar si la url fue manipulada salvo que pongas informacion extra en la misma y que esta te permita identificar.  
		Por otra parte en la mayoria de sistemas se maneja un sistema de roles y logs que te permite hacer un rastreo del usuario que realizo esa operacion.  
		Y para finalizar tal vez es recomendable usar otro tipo de valor que no sea numerico para que no sea tan facil para el usuario avanzado en reemplazar un numero, yo he visto que algunos crean un valor encriptado del ID para no mostrarlo asi el atacante no sabra que valor poner en la url.

	* **Erick Daniel Brito Arroyo** [511483] (2)

		La petici√≥n podr√≠a mejorarse cambiando la petici√≥n a POST, incluyendo un token validando en un Middleware que se valide para cada petici√≥n, as√≠ si viene de otro lugar no incluir√° el token valido y no podr√° realizarse la acci√≥n.  
		Ejemplo de su implementaci√≥n en Laravel [CSRF Protection](https://laravel.com/docs/5.8/csrf)

	* **lucasmartinezesper** [511483] (1)

		Yo he encriptado o pasado por hash el valor id para que si es modificado no coincida con un id existente. Saludos

* **teisat_p** (1) [52930](https://platzi.com/comentario/511483/) 
hola, en el ejemplo el modifica en el get al valor 1000, el cual no existe en base de datos y por ender el array da vacio, ahora si por c...

	* **Richard Santiestevan** [52930] (3)

		Hola, creo q no hay manera de identificar si la url fue manipulada salvo que pongas informacion extra en la misma y que esta te permita identificar.  
		Por otra parte en la mayoria de sistemas se maneja un sistema de roles y logs que te permite hacer un rastreo del usuario que realizo esa operacion.  
		Y para finalizar tal vez es recomendable usar otro tipo de valor que no sea numerico para que no sea tan facil para el usuario avanzado en reemplazar un numero, yo he visto que algunos crean un valor encriptado del ID para no mostrarlo asi el atacante no sabra que valor poner en la url.

## 0200. La biblioteca SPL [16233](https://platzi.com/clases/1462-php-avanzado/16233-la-biblioteca-spl/)

### Descripci√≥n:


La biblioteca SPL (Standard PHP Library) es un conjunto de Clases e Interfaces para PHP que fue dise√±ada para ayudarnos con nuestras aplicaciones. SPL se distribuye directamente con PHP desde su versi√≥n 5.0 y aunque no es obligatorio usarla, el aprender de ella te permitir√° tener un mejor c√≥digo, m√°s robusto y tambi√©n m√°s orientado a objetos.

Uno de los puntos m√°s usados en el pasado fue la funci√≥n spl_autoload_register que nos permit√≠a indicar a nuestro c√≥digo la forma en la que har√≠amos el autocargado de clases, obviamente esto ya no es tan usado (al menos ya no lo hacemos de forma manual) debido a que podemos solucionar el problema usando composer, pero en su momento fue una herramienta muy popular y usada dentro de las aplicaciones PHP.

Adem√°s de spl_autoload_register, SPL nos ofrece otras herramientas muy interesantes para nuestro c√≥digo:

## Iteradores

Los iteradores sirven para recorrer conjuntos de elementos. Un iterador es un objeto que sirve para recorrer algo. En esta area SPL nos ofrece muchas clases nuevas que mejoran dr√°sticamente la forma en la que escribimos c√≥digo, entre las clases m√°s populares nos encontramos con ArrayIterator que sirve para recorrer arreglos optimizando la memoria usada por el sistema y DirectoryIterator que nos permite recorrer los archivos y las carpetas de una ubicaci√≥n.

En caso de que ninguna clase cumpla con lo que queremos hacer, SPL tambi√©n nos ofrece ciertas interfaces que nos permitir√°n mejorar la forma en la que usaremos nuestros objetos, por ejemplo podemos implementar la _Interfaz Iterator_ si queremos que nuestro objeto pueda ser iterado o podemos implementar la interfaz _ArrayAccess_ si queremos usar la sintaxis de acceso a elementos tipo arreglo en nuestros objetos, por ejemplo $object[0].

## Estructuras de Datos

Los arrays dentro de PHP son muy vers√°tiles, sin embargo es verdad que no solucionan todas las funciones que a veces necesitamos, en lugar de que intentemos forzar la forma en la que usamos los arrays, una buena idea siempre ser√° echar un ojo a las estructuras que SPL nos ofrece.

Entre las estructuras m√°s usadas dentro de SPL podemos encontrar listas, pilas y colas, las cuales sin lugar a dudas dar√°n mucha m√°s claridad a lo que estamos intentando resolver dentro de nuestra aplicaci√≥n.

## Excepciones

A la hora de enviar excepciones para indicar que ocurri√≥ un error, la forma m√°s sencilla de hacerlo es utilizando la clase Exception, sin embargo SPL nos ofrece una variedad mayor de excepciones, las cuales podemos aprovechar para tener un mejor control de los errores que ocurren en nuestra app.

Por ejemplo _LogicException_ y sus derivadas indican que se encontr√≥ un error que probablemente es culpa de nosotros como programadores, algo estamos haciendo mal y debemos tratar de evitar que esto llegue a producci√≥n.

Por otro lado RuntimeException y sus derivadas nos indican que algo pas√≥ y no ten√≠amos control de eso durante el desarrollo, por ejemplo una conexi√≥n interrumpida a la base de datos o alg√∫n archivo al que no podemos acceder, y aunque esto podr√≠a pasar en producci√≥n, el controlar bien las excepciones nos permitir√° al menos tener una falla m√°s amigable y no mostrar al usuario una horrible pantalla con datos de nuestro c√≥digo.

Algo que tambi√©n puedes hacer es extender de estas clases y crear tus propias excepciones, de este modo podr√°s tener aun m√°s informaci√≥n acerca de los que pasa en tu proyecto.

Siempre trata de enviar la excepci√≥n que m√°s claramente indique lo que sucedi√≥, esto no har√° tu control de errores m√°s sencillo, pero s√≠ te ayudar√° a entender las causas de los errores que aparecen en tu c√≥digo.

## Conclusi√≥n

Revisa la documentaci√≥n oficial de SPL donde adem√°s de la forma de uso, tambi√©n encontrar√°s muchos ejemplos y aportes de la comunidad. Estoy seguro de que una vez que conozcas todo lo que SPL te puede ofrecer, tu experiencia programando con PHP mejorara much√≠simo.

### Comentarios:

* **Jorge David Duque Agudelo** (3) [578015](https://platzi.com/comentario/578015/) 

	Nunca hab√≠a escuchado hablar de SPL, le hechar√© un leida a ver que puedo reutilizar, muchas gracias.

	* **Martin L.** [578015] (1)

		idem üòÉ

* **Jeith S Carrillo A** (2) [496725](https://platzi.com/comentario/496725/) 

	excelente informaci√≥n. es mejor revisar y ver que ayuda podemos encontrar

## 0210. Debug [16284](https://platzi.com/clases/1462-php-avanzado/16284-debug8582/)

### Descripci√≥n:


Siempre que estemos desarrollando aplicaciones en cualquier lenguaje surgir√° un error el cual deberemos corregir. Para esto utilizamos el **debug** cuyo significado viene de matar bichos.

* Aunque tengas tu try-catch, ten cuidado que tu catch no emita un nuevo error.
* El middleware **Whoops** es el que utilizaremos, nos da una interfaz muy amigable para revisar c√≥mo se ven las excepciones. Es compatible con muchos frameworks y utiliza **PSR7**.
* **Whoops** ya viene preparado para que lo integremos en lo que estamos trabajando.
* Sin Whoops podemos ver el nombre del archivo y la l√≠nea donde estaba el error, pero us√°ndolo podemos ver cada parte, el c√≥digo y los datos del entorno.



### Links:

* [GitHub - franzliedke/whoops-middleware: PSR-15 compatible middleware for Whoops, the pretty error handler](https://github.com/franzliedke/whoops-middleware)

### Comentarios:

* **Gabriel Flores** (4) [487436](https://platzi.com/comentario/487436/) 

	a d√≠a de hoy est√° implementaci√≥n da error por incompatibilidad entre librer√≠as
	``` 
	    $ composer require franzl/whoops-middleware
	    Using version ^1.0 for franzl/whoops-middleware
	    ./composer.json has been updated
	    Loading composer repositories with package information
	    Updating dependencies (including require-dev)
	    Your requirements could not be resolved to an installable set of packages.
	    
	      Problem 1
	        - Installation request for franzl/whoops-middleware ^1.0 -> satisfiable by franzl/whoops-middleware[1.0.0].
	        - franzl/whoops-middleware 1.0.0 requires zendframework/zend-diactoros ^1.1.0 -> satisfiable by zendframework/zend-diactoros[1.1.0, 1.1.1, 1.1.2, 1.1.3, 1.1.4, 1.2.0, 1.2.1, 1.3.0, 1.3.1, 1.3.10, 1.3.11, 1.3.2, 1.3.3, 1.3.4, 1.3.5, 1.3.6, 1.3.7, 1.3.8, 1.3.9, 1.4.0, 1.4.1, 1.5.0, 1.6.0, 1.6.1, 1.7.0, 1.7.1, 1.7.2, 1.8.0, 1.8.1, 1.8.2, 1.8.3, 1.8.4, 1.8.5, 1.8.6, 1.8.x-dev] but these conflict with your requirements or minimum-stability.
	    
	    
	    Installation failed, reverting ./composer.json to its original content.
	    
	```
	
	Para solucionar esto y poder seguir con el v√≠deo tuve que hacer downgrade de la librer√≠a zendframework/zend-diactoros de la versi√≥n 2 a la 1.8

	* **juan-carlos-garcia53** [487436] (5)

		Buen aporte, me libraste de mucho tiempo batallando.  
		Complementando:
		
		  1. Abrir el archivo Composer.json en la ra√≠z del proyecto, es en este archivo se encuentran todas las dependencias y las versiones necesarias  
		2)Cambiar ‚Äúzendframework/zend-diactoros‚Äù: ‚Äú^2.1‚Äù por ‚Äúzendframework/zend-diactoros‚Äù: "^1.8"  
		3)En la terminal actualizamos las dependecias php composer.phar update, se actualizar√°n todas las librer√≠as, adem√°s se har√° el downgrade de Zend Diactoros de la versi√≥n 2.1 a la 1.8.x
		  2. Volvemos a instalar la librer√≠a php composer.phar require franzl/whoops-middleware
		
		

* **Daniel Hurtado** (3) [795546](https://platzi.com/comentario/795546/) 

	Para los que vean esten viendo el curso, en la actualidad el middleware lo instalamos con:  
	composer require middlewares/whoops  
	Es la versi√≥n es reciente para no tener problemas de compatibilidad

* **luisangel2895** (2) [561708](https://platzi.com/comentario/561708/) 

	Al colocar woops como middleware ya no funcionan las excepciones de index.php , esto es normal?, la unica forma de q funciones las excepciones es comentando el middleware de woops, pero no se supone q woops solo esta actuando como middleware para lo q pasa en harmony y q las excepciones de index deberian de eliminar el funcionamiento del debugger ? porfa si alguien le pasa lo mismo comenteme o respondanme las preguntas

	* **gerql14** [561708] (1)

		Hola amigo, as√≠ es  
		Las excepciones de index quedan en segundo plano.  
		Sinceramente, este curso me est√° decepcionando bastante.  
		Creo que deber√≠a llamarse  
		Curso de Manejo de Librer√≠as y Extensiones  
		Aparte‚Ä¶ muy abandonado, no comentan ni responden desde hace un a√±o
		
		Al parecer Hector s√≥lo responde reci√©n sube el tema y despu√©s se olvida totalmente de la clase/curso

* **Michael Rodriguez** (1) [1126620](https://platzi.com/comentario/1126620/) 

	Laravel 5.5 ya venia con Whoops integrado, pero ya en la version 7 usan uno mejorado.

* **jorge-gianareas** (1) [978721](https://platzi.com/comentario/978721/) 

	Whoops ya viene preparado para que lo integremos en lo que estamos trabajando.  
	Sin Whoops podemos ver el nombre del archivo y la l√≠nea donde estaba el error, pero us√°ndolo podemos ver cada parte, el c√≥digo y los datos del entorno.

* **jorge-gianareas** (1) [978720](https://platzi.com/comentario/978720/) 

	El middleware Whoops es el que utilizaremos, nos da una interfaz muy amigable para revisar c√≥mo se ven las excepciones. Es compatible con muchos frameworks y utiliza PSR7.

* **jorge-gianareas** (1) [978719](https://platzi.com/comentario/978719/) 

	Aunque tengas tu try-catch, ten cuidado que tu catch no emita un nuevo error.

* **jorge-gianareas** (1) [978718](https://platzi.com/comentario/978718/) 

	Siempre que estemos desarrollando aplicaciones en cualquier lenguaje surgir√° un error el cual deberemos corregir. Para esto utilizamos el debug cuyo significado viene de matar bichos.

* **ederrafo** (1) [672807](https://platzi.com/comentario/672807/) 

	Buena clase!

* **luisangel2895** (1) [57189](https://platzi.com/comentario/561708/) 
Al colocar woops como middleware ya no funcionan las excepciones de index.php , esto es normal?, la unica forma de q funciones las excepc...

	* **gerql14** [57189] (1)

		Hola amigo, as√≠ es  
		Las excepciones de index quedan en segundo plano.  
		Sinceramente, este curso me est√° decepcionando bastante.  
		Creo que deber√≠a llamarse  
		Curso de Manejo de Librer√≠as y Extensiones  
		Aparte‚Ä¶ muy abandonado, no comentan ni responden desde hace un a√±o
		
		Al parecer Hector s√≥lo responde reci√©n sube el tema y despu√©s se olvida totalmente de la clase/curso

## 0220. Xdebug [16286](https://platzi.com/clases/1462-php-avanzado/16286-xdebug2974/)

### Descripci√≥n:


Existe una herramienta incluida en Homestead llamada **Xdebug** la cual nos permite tener un control mejor a la hora de hacer debug. Nos deja ver el valor de las variables en tiempo real, detener la aplicaci√≥n en ciertos puntos y avanzar en ella paso a paso.

* La funci√≥n phpinfo() despliega toda la informaci√≥n de nuestro servidor para que la podamos ver. Es muy importante no dejarla p√∫blica ni en tu servidor de producci√≥n.
* Las configuraciones que m√°s nos interesan son acerca del remote para poder hacer debug conect√°ndonos por fuera de la m√°quina virtual (ya que estamos usando Homestead).
* Debemos instalar un complemento en Chrome para agregar sesiones de debug llamado **Xdebug helper**
* Para comenzar la comunicaci√≥n con Xdebug tenemos que activar el complemento de Chrome y el bot√≥n de escucha de PHPStorm. Despu√©s agregamos breakpoints para detener la ejecuci√≥n del c√≥digo en los lugares donde queremos analizar su comportamiento.
* **PHPSESSID** es una cookie que sirve para identificar las sesiones de los usuarios, se almacena en el navegador y as√≠ sabremos que es el mismo usuario el que sigue trabajando con nuestra aplicaci√≥n.



### Links:

* [Xdebug helper - Chrome Web Store](https://chrome.google.com/webstore/detail/xdebug-helper/eadndfjplgieldjbigjakmdgkmoaaaoc)

### Comentarios:

* **juliorico** (7) [479573](https://platzi.com/comentario/479573/) 

	Un video que muestra como configurar xdebug para Visual Studio Code:  
	[https://www.youtube.com/watch?v=xME6uHYTcLU&t=288s](https://www.youtube.com/watch?v=xME6uHYTcLU&t=288s)

	* **hectorbenitez** [479573] (1)

		Gracias por el aporte

	* **andreszapatin** [479573] (1)

		Ese funciona si se est√° usando XAMPP. Para usar XDebug en VS Studio a partir de Homestead:  
		<https://tighten.co/blog/debugging-configure-xdebug-and-laravel-homestead-and-vs-code-and-phpunit>

	* **Michael Rodriguez** [479573] (1)

		GRacias por el aporte!

* **Lautaro Cabral** (1) [1080293](https://platzi.com/comentario/1080293/) 

	Probablemente es una mala pr√°ctica, mi debug es var_dump() xd

* **jorge-gianareas** (1) [978730](https://platzi.com/comentario/978730/) 

	PHPSESSID es una cookie que sirve para identificar las sesiones de los usuarios, se almacena en el navegador y as√≠ sabremos que es el mismo usuario el que sigue trabajando con nuestra aplicaci√≥n.

* **jorge-gianareas** (1) [978729](https://platzi.com/comentario/978729/) 

	Para comenzar la comunicaci√≥n con Xdebug tenemos que activar el complemento de Chrome y el bot√≥n de escucha de PHPStorm. Despu√©s agregamos breakpoints para detener la ejecuci√≥n del c√≥digo en los lugares donde queremos analizar su comportamiento.

* **jorge-gianareas** (1) [978728](https://platzi.com/comentario/978728/) 

	Debemos instalar un complemento en Chrome para agregar sesiones de debug llamado Xdebug helper

* **jorge-gianareas** (1) [978727](https://platzi.com/comentario/978727/) 

	Las configuraciones que m√°s nos interesan son acerca del remote para poder hacer debug conect√°ndonos por fuera de la m√°quina virtual (ya que estamos usando Homestead).

* **jorge-gianareas** (1) [978726](https://platzi.com/comentario/978726/) 

	La funci√≥n phpinfo() despliega toda la informaci√≥n de nuestro servidor para que la podamos ver. Es muy importante no dejarla p√∫blica ni en tu servidor de producci√≥n.

* **jorge-gianareas** (1) [978724](https://platzi.com/comentario/978724/) 

	Existe una herramienta incluida en Homestead llamada Xdebug la cual nos permite tener un control mejor a la hora de hacer debug. Nos deja ver el valor de las variables en tiempo real, detener la aplicaci√≥n en ciertos puntos y avanzar en ella paso a paso.

* **luisangel2895** (1) [561704](https://platzi.com/comentario/561704/) 

	No me aparece el tool de debug en phpstorm , hice todo lo del video y al recargar index.php  
	no pasa nada, a alguno le pasa algo parecido estoy en una windows. solo me sale un error en la parte  
	de event log :  
	Error running ‚Äòindex.php‚Äô: Interpreter is not specified or invalid. Press ‚Äò‚ÄòFix‚Äô‚Äô to edit your project configuration.  
	Alguien puede ayudarme?

	* **Diego Alexander Forero Higuera (Platzi)** [561704] (1)

		Hola, al parecer no tienes correctamente configurado el editor ya que no esta configurado el interprete que usas para el proyecto.
		
		Lo configuras aqu√≠.
		
		![Screenshot_20190415_192526.png](https://static.platzi.com/media/user_upload/Screenshot_20190415_192526-3ac8b1bf-c54e-4f4e-888a-0e8abaa532e1.jpg)

* **luisangel2895** (1) [561703](https://platzi.com/comentario/561703/) 

	No me aparece el tool de debug en phpstorm , hice todo lo del video y al recargar index.php  
	no pasa nada, a alguno le pasa algo parecido estoy en una windows. solo me sale un error en la parte  
	de event log :  
	Error running ‚Äòindex.php‚Äô: Interpreter is not specified or invalid. Press ‚Äò‚ÄòFix‚Äô‚Äô to edit your project configuration.

* **wcoronado** (1) [534999](https://platzi.com/comentario/534999/) 

	Para los que les salio el error con el xdebug visual code de Twig_Extension_Debug class is deprecated.
	
	solucion en su basecontroller.php donde instaciamos esta dependencia cambiamos a esto
	``` 
	    //quitamos
	    $this->addExtension = new \Twig_Extension_Debug();
	    //remplazamos 
	    $this->addExtension = new \Twig\Extension\DebugExtension;
	    
	```

* **Armando Tacza** (1) [491702](https://platzi.com/comentario/491702/) 

	Muy interesante el Debug con √©ste utilitario.

* **Michael Rodriguez** (1) [87678](https://platzi.com/comentario/1126726/) 
Como configurar Debug con Visual Studio Code o con Atom ?

* **luisangel2895** (1) [57187](https://platzi.com/comentario/561704/) 
No me aparece el tool de debug en phpstorm , hice todo lo del video y al recargar index.php no pasa nada, a alguno le pasa algo parecido ...

	* **Diego Alexander Forero Higuera (Platzi)** [57187] (1)

		Hola, al parecer no tienes correctamente configurado el editor ya que no esta configurado el interprete que usas para el proyecto.
		
		Lo configuras aqu√≠.
		
		![Screenshot_20190415_192526.png](https://static.platzi.com/media/user_upload/Screenshot_20190415_192526-3ac8b1bf-c54e-4f4e-888a-0e8abaa532e1.jpg)

## 0230. Logs [16287](https://platzi.com/clases/1462-php-avanzado/16287-logs5146/)

### Descripci√≥n:


Los logs normalmente son archivos en los que almacenamos errores o eventos que ocurren en nuestra aplicaci√≥n. Hay muchas razones para tenerlos, como el poder monitorear para encontrar bugs; tambi√©n podemos querer monitorear eventos como el uso de una app o un usuario que est√© realizando una acci√≥n. Son archivos muy grandes con mucha informaci√≥n.

* El comando tail te permite ver el final de un archivo.
* Es importante tener los logs como soporte o respaldo para solucionar problemas.
* La librer√≠a **Monolog** nos ayuda a implementar logs. Puede enviar los logs hacia archivos, sockets, bases de datos, entre otras.
* El nombre del canal es importante para poder dividir el contenido que vamos a ir guardando.
* Existe una categorizaci√≥n de severidad de los errores: **DEBUG, INFO, NOTICE, WARNING, ERROR, CRITICAL, ALERT, EMERGENCY.**
* Si tienes otros procesos puedes crear en el log diferentes nombres para poder identificar f√°cilmente en qu√© parte del c√≥digo pas√≥ un error.
* Cuando creamos la carpeta de logs, es buena pr√°ctica agregarla al gitignore porque no tienen valor para el repositorio.
* Recuerda que nuestro endpoint est√° sobre public y no sobre la ra√≠z del proyecto.



### Links:

* [GitHub - Seldaek/monolog: Sends your logs to files, sockets, inboxes, databases and various web services](https://github.com/Seldaek/monolog)

### Comentarios:

* **Jorge David Duque Agudelo** (4) [578043](https://platzi.com/comentario/578043/) 

	¬øNo ser√≠a mejor utilizar el gitignore en un solo archivo?, lo pregunto porque en este caso en la raiz del proyecto ya existe un archivo con este nombre, que hace la misma funci√≥n.

	* **hectorbenitez** [578043] (6)

		Claro que puedes, yo en lo personal uso ese .gitignore extra para meter al repositorio la carpeta vacia y verla desde que descargas el proyecto.

* **samuelrc** (2) [746847](https://platzi.com/comentario/746847/) 

	Para los que se preguntan si no ser√≠a mejor mantener todos los archivos y directorios a ignorar en un √∫nico .gitignore; una souci√≥n es usar un archivo .gitkeep vac√≠o en la carpeta para as√≠ poder dejar todas las entradas en el .gitignore que est√° en la ra√≠z del proyecto.  
	Como git maneja archivos y no directorios/carpetas es necesario que haya almenos un archivo en la carpeta log para que esta se incluya en el √≠ndice, es por esto que hay que crear el .gitkeep vac√≠o.  
	A partir de [este comentario](https://stackoverflow.com/questions/5600621/gitignore-exclude-files-in-directory-but-not-certain-directories#comment6377255_5600673) en stackoverflow pueden encontrar una conversaci√≥n al respecto.

* **Michael Rodriguez** (1) [1126813](https://platzi.com/comentario/1126813/) 

	Laravel como Framework ya nos facilita un sistema de Log muy completos que categoriza los eventos y tambien puedemos personalizarlo de acuerdo a nuestras necesidades, pueden [checarlo aqui](https://laravel.com/docs/master/logging)

* **jorge-gianareas** (1) [978741](https://platzi.com/comentario/978741/) 

	Recuerda que nuestro endpoint est√° sobre public y no sobre la ra√≠z del proyecto.

* **jorge-gianareas** (1) [978739](https://platzi.com/comentario/978739/) 

	La librer√≠a Monolog nos ayuda a implementar logs. Puede enviar los logs hacia archivos, sockets, bases de datos, entre otras.  
	El nombre del canal es importante para poder dividir el contenido que vamos a ir guardando.  
	Existe una categorizaci√≥n de severidad de los errores: DEBUG, INFO, NOTICE, WARNING, ERROR, CRITICAL, ALERT, EMERGENCY.  
	Si tienes otros procesos puedes crear en el log diferentes nombres para poder identificar f√°cilmente en qu√© parte del c√≥digo pas√≥ un error.  
	Cuando creamos la carpeta de logs, es buena pr√°ctica agregarla al gitignore porque no tienen valor para el repositorio.

* **jorge-gianareas** (1) [978738](https://platzi.com/comentario/978738/) 

	Es importante tener los logs como soporte o respaldo para solucionar problemas

* **jorge-gianareas** (1) [978737](https://platzi.com/comentario/978737/) 

	El comando tail te permite ver el final de un archivo.

* **jorge-gianareas** (1) [978735](https://platzi.com/comentario/978735/) 

	Los logs normalmente son archivos en los que almacenamos errores o eventos que ocurren en nuestra aplicaci√≥n. Hay muchas razones para tenerlos, como el poder monitorear para encontrar bugs; tambi√©n podemos querer monitorear eventos como el uso de una app o un usuario que est√© realizando una acci√≥n. Son archivos muy grandes con mucha informaci√≥n

* **Josu√© Isaac Fuentes L√≥pez** (1) [599169](https://platzi.com/comentario/599169/) 

	no seria m√°s facil agregar al .gitignore general
	``` 
	    logs/*.log```
	    
	```

* **Jorge David Duque Agudelo** (1) [58501](https://platzi.com/comentario/578043/) 
¬øNo ser√≠a mejor utilizar el gitignore en un solo archivo?, lo pregunto porque en este caso en la raiz del proyecto ya existe un archivo c...

	* **hectorbenitez** [58501] (6)

		Claro que puedes, yo en lo personal uso ese .gitignore extra para meter al repositorio la carpeta vacia y verla desde que descargas el proyecto.

## 0240. Trabajando con Monolog [16288](https://platzi.com/clases/1462-php-avanzado/16288-trabajando-con-monolog9231/)

### Descripci√≥n:


* Los mensajes de error que ir√°n al log se pueden a√±adir a mano de manera personalizada.
* $e->getMessage() se usa para obtener el mensaje exacto que tiene una excepci√≥n. Esto es √∫til para separar el tipo de errores.
* Al utilizar **dotenv** y las variables de entorno, el valor ‚Äútrue‚Äù viene como cadena.
* El orden de los middleware es muy importante porque en ese orden se ir√°n recorriendo las capas.



### Links:

* [GitHub - Seldaek/monolog: Sends your logs to files, sockets, inboxes, databases and various web services](https://github.com/Seldaek/monolog)

### Comentarios:

* **gerql14** (2) [937555](https://platzi.com/comentario/937555/) 

	Entiendo que no se trata de reinventar la rueda  
	Pero vaya‚Ä¶ reafirmo, parece m√°s un curso de manejo de librer√≠as que de PHP avanzado üò¶

* **Japheth Calzada L√≥pez** (2) [474371](https://platzi.com/comentario/474371/) 

	no me crea el log, pero no me manda error, a que podr√≠a deberse ??

	* **hectorbenitez** [474371] (2)

		un error podria ser que no tienes los permisos correctos en la carpeta

	* **Japheth Calzada L√≥pez** [474371] (1)

		revisando, gracias üòÉ

	* **Jeith S Carrillo A** [474371] (1)

		recuerda darle permisos de lectura y escritura a la carpeta donde estas guardando el log

* **AxelEspinosa45** (1) [1000981](https://platzi.com/comentario/1000981/) 

	Ahora entiendo un poco mas como funcionan los frameworks por dentro üòØ

* **jorge-gianareas** (1) [978742](https://platzi.com/comentario/978742/) 

	Los mensajes de error que ir√°n al log se pueden a√±adir a mano de manera personalizada.  
	$e->getMessage() se usa para obtener el mensaje exacto que tiene una excepci√≥n. Esto es √∫til para separar el tipo de errores.  
	Al utilizar dotenv y las variables de entorno, el valor ‚Äútrue‚Äù viene como cadena.  
	El orden de los middleware es muy importante porque en ese orden se ir√°n recorriendo las capas.

# Databases [3197]

## 0250. Migraciones de bases de datos [16289](https://platzi.com/clases/1462-php-avanzado/16289-migraciones-de-bases-de-datos5955/)

### Descripci√≥n:


Cuando cambiamos el proyecto y tuvimos una nueva base de datos, toda nuestra informaci√≥n se perdi√≥ y no era muy sencillo saber cu√°l era la estructura que deb√≠a tener. Esto puede pasar por cambiar de entorno, cambiar de m√°quina u otras razones y en estos casos es importante no tener que construir la base de datos desde 0 siempre y m√°s si se tienen muchas tablas y condiciones.  
Aqu√≠ es donde entra en juego la migraci√≥n de bases de datos la cual nos permite crear ciertos archivos y llevar un control sobre c√≥mo va cambiando por si en un futuro cambiamos de m√°quina o entorno, podremos recrearla de manera sencilla.

Usaremos un proyecto llamado **Phinx** que fue utilizado en **CakePHP** el cual una vez instalado y usando el comando vendor/bin/phinx podremos ver la documentaci√≥n y ayuda acerca de c√≥mo funciona este sistema. Nosotros nos centraremos en:

* **create** : Comando para crear una nueva migraci√≥n.
* **init** : Inicializar√° nuestra app para poder usar migraciones.
* **migrate:** Ejecuta las migraciones en nuestra base de datos.
* **rollback:** Deshace una migraci√≥n.



En el archivo **phinx.yml** encontramos las rutas donde existir√°n las migraciones, con sus nombres y diferentes configuraciones en caso de que queramos poder tener la base de datos en diferentes entornos.

* Al crear una tabla, su nombre deber√° tener el formato que tienen los nombres de clase (con las may√∫sculas iniciales) porque a la final lo que har√° Phinx ser√° formar una clase.



### Links:

* [Phinx](https://phinx.org/)

### Comentarios:

* **Jonathan Aguasaco** (6) [505205](https://platzi.com/comentario/505205/) 

	Para los que continuen el curso sin utilizar el entorno de **Homestad **y utilicen **windows**  
	Phinx trabaja como:  
	`vendor\bin\phinx.bat`  
	Brindara toda la configuracion igual que el video  
	ej:  
	`vendor\bin\phinx create CreateUsersTable`

	* **wareva** [505205] (1)

		Como ejecutas Phinx desde Windows?

* **Daniel Ram√≠rez Mendoza** (2) [470926](https://platzi.com/comentario/470926/) 

	Para que puedan a√±adir guardar datos de jobs en la tabla sin que les mande error deben de a√±adir como tercer par√°metro de addColumn un array con la opci√≥n de null como true en months y deleted_at, de la siguiente manera:
	``` 
	    public function change()
	        {
	            $table = $this->table('jobs');
	            $table->addColumn('title', 'string')
	                ->addColumn('description', 'string')
	                ->addColumn('months', 'integer', ['null' => true])
	                ->addColumn('image', 'string')
	                ->addColumn('created_at', 'datetime')
	                ->addColumn('updated_at', 'datetime')
	                ->addColumn('deleted_at', 'datetime', ['null' => true])
	                ->create();
	        }
	    
	```

	* **hectorbenitez** [470926] (2)

		Excelente aporte Danramz, tienes razon, eso indica a la DB que los campos pueden usar null como valor

* **cristhiancoaquira** (1) [1110791](https://platzi.com/comentario/1110791/) 

	```
	    publicfunctionchange()
	        {
	            $table = $this->table('users');
	            $table->addColumn('user_name', 'string', ['limit' => '50'])
	            ->addColumn('email', 'string', ['limit' => 50])
	            ->addColumn('password', 'string')
	            ->addColumn('created_at', 'datetime', ['null' => true])
	            ->addColumn('updated_at', 'datetime', ['null' => true])
	            ->create();
	        }
	    
	```

* **Lautaro Cabral** (1) [1080496](https://platzi.com/comentario/1080496/) 

	Quiz√°s deber√≠an colocar este curso antes del curso de Laravel con PHP

	* **gerql14** [1080496] (2)

		Hola @lautaro-cabral  
		Yo hab√≠a seguido ese flujo  
		Curso **Introducci√≥n PHP** \- Curso **PHP Avanzado**
		
		Y te soy sincero, me qued√© en ceros con el de PHP Avanzado
		
		Por lo que decid√≠ tomar el Curso de **Laravel** y ahorita estoy retomando de nuevo √©ste de **PHP Avanzado** y me est√° quedando m√°s claro el panorama.
		
		Desde luego es mi percepci√≥n en base a mi experiencia, saludos!

* **jorge-gianareas** (1) [981785](https://platzi.com/comentario/981785/) 

	La migraci√≥n de bases de datos la cual nos permite crear ciertos archivos y llevar un control sobre c√≥mo va cambiando por si en un futuro cambiamos de m√°quina o entorno, podremos recrearla de manera sencilla.

* **jorge-gianareas** (1) [978747](https://platzi.com/comentario/978747/) 

	En el archivo phinx.yml encontramos las rutas donde existir√°n las migraciones, con sus nombres y diferentes configuraciones en caso de que queramos poder tener la base de datos en diferentes entornos.
	
	Al crear una tabla, su nombre deber√° tener el formato que tienen los nombres de clase (con las may√∫sculas iniciales) porque a la final lo que har√° Phinx ser√° formar una clase.

* **jorge-gianareas** (1) [978746](https://platzi.com/comentario/978746/) 

	Usaremos un proyecto llamado Phinx que fue utilizado en CakePHP el cual una vez instalado y usando el comando vendor/bin/phinx podremos ver la documentaci√≥n y ayuda acerca de c√≥mo funciona este sistema. Nosotros nos centraremos en:
	
	create: Comando para crear una nueva migraci√≥n.  
	init: Inicializar√° nuestra app para poder usar migraciones.  
	migrate: Ejecuta las migraciones en nuestra base de datos.  
	rollback: Deshace una migraci√≥n.

* **jorge-gianareas** (1) [978745](https://platzi.com/comentario/978745/) 

	Cuando cambiamos el proyecto y tuvimos una nueva base de datos, toda nuestra informaci√≥n se perdi√≥ y no era muy sencillo saber cu√°l era la estructura que deb√≠a tener. Esto puede pasar por cambiar de entorno, cambiar de m√°quina u otras razones y en estos casos es importante no tener que construir la base de datos desde 0 siempre y m√°s si se tienen muchas tablas y condiciones.

* **carlosdummy14** (1) [633329](https://platzi.com/comentario/633329/) 

	Reto.
	``` 
	    <?php
	    
	    usePhinx\Migration\AbstractMigration;
	    
	    classCreateUsersTableextendsAbstractMigration
	    {
	        publicfunctionchange()
	        {
	            $table = $this->table('users');
	            $table->addColumn('email', 'string', ['limit' => 60,'null' => true])
	                ->addColumn('password', 'string', ['limit' => 200, 'null' => true])
	                ->addColumn('userscol', 'string', ['limit' => 45,'null' => true])
	                ->addColumn('created_at', 'datetime', ['null' => true])
	                ->addColumn('updated_at', 'datetime', ['null' => true])
	                ->create();
	        }
	    }```
	    
	```

* **Matias Niz** (1) [609794](https://platzi.com/comentario/609794/) 

	```
	    vendor/bin/phinix init --format php
	    
	    
	```
	``` 
	    <?php
	    require_once'./vendor/autoload.php';
	    
	    $dotenv = Dotenv\Dotenv::create(__DIR__);
	    if(file_exists(__DIR__ . "./.env")) {
	        $dotenv->load();
	    }
	    
	    
	    return
	    [
	        'paths' => [
	            'migrations' => '%%PHINX_CONFIG_DIR%%/db/migrations',
	            'seeds' => '%%PHINX_CONFIG_DIR%%/db/seeds'
	        ],
	        'environments' => [
	            'default_migration_table' => 'phinxlog',
	            'default_database' => 'development',
	            'production' => [
	                'adapter' => getenv('DB_DRIVER'),
	                'host' => getenv('DB_HOST'),
	                'name' => getenv('DB_NAME'),
	                'user' => getenv('DB_USER'),
	                'pass' => getenv('DB_PASSWORD'),
	                'port' => getenv('DB_PORT'),
	                'charset' => 'utf8',
	            ],
	            'development' => [
	                'adapter' => getenv('DB_DRIVER'),
	                'host' => getenv('DB_HOST'),
	                'name' => getenv('DB_NAME'),
	                'user' => getenv('DB_USER'),
	                'pass' => getenv('DB_PASSWORD'),
	                'port' => getenv('DB_PORT'),
	                'charset' => 'utf8',
	            ],
	            'testing' => [
	                'adapter' => getenv('DB_DRIVER'),
	                'host' => getenv('DB_HOST'),
	                'name' => getenv('DB_NAME'),
	                'user' => getenv('DB_USER'),
	                'pass' => getenv('DB_PASSWORD'),
	                'port' => getenv('DB_PORT'),
	                'charset' => 'utf8',
	            ]
	        ],
	        'version_order' => 'creation'
	    ];
	    
	    
	```

* **Japheth Calzada L√≥pez** (1) [474665](https://platzi.com/comentario/474665/) 

	crees necesario aprender cake y zend ?

	* **hectorbenitez** [474665] (1)

		Yo en lo personal creo que es importante que sigas mejorando en general, principios de arquitectura, patrones de dise√±o, etc‚Ä¶ asi, seguramente cuando necesites usar un framework entenderas como funciona y le sacaras mucho mas provecho, lo unico que si te creo es que debes buscar un framework con buena comunidad y que veas que esta activo su desarrollo.
		
		Acerca de si lo creo necesario, dentro de PHP es muy comun trabajar proyectos basados en frameworks asi que siempre sera un plus en tu resume el tener experiencia en algunos.

* **Manuel Calle P√©rez** (1) [70348](https://platzi.com/comentario/773591/) 
Tengo este error cuando corro migrate: InvalidArgumentException: There was a problem connecting to the database: SQLSTATE[HY000] [2002] N...

	* **Manuel Calle P√©rez** [70348] (1)

		Ya lo resolvi, en la configuraci√≥n de phinx tenia q colocar la ip del homestead 192.168.10.10

# Comandos y Tareas as√≠ncronas [3198]

## 0260. Comandos [16290](https://platzi.com/clases/1462-php-avanzado/16290-comandos3183/)

### Descripci√≥n:


Al estar trabajando en una aplicaci√≥n de PHP, existen circunstancias en las que debemos hacer cosas que no necesariamente est√°n dentro del navegador como ejecutar tareas as√≠ncronas para que el usuario no tenga que esperar mucho. Para esto usamos los comandos que son aplicaciones de PHP que vamos a correr en la consola. **Phinx** es una aplicaci√≥n de PHP dise√±ada para correr sobre la consola.

**Symfony componentes** es la parte de Symfony que nos permitir√° crear muchos comandos y tener una interfaz amigable para usarlos.

* La l√≠nea de inicio #!/usr/bin/env php indica a la terminal hacia d√≥nde debe ir la ejecuci√≥n.



### Links:

* [The Console Component (Symfony Docs)](https://symfony.com/doc/current/components/console.html)

### Comentarios:

* **nick** (1) [993161](https://platzi.com/comentario/993161/) 

	Este en mi command para generar usuarios:
	``` 
	    <?php
	    namespaceApp\Commands;
	    
	    useApp\Models\User;
	    useSymfony\Component\Console\Command\Command;
	    useSymfony\Component\Console\Input\InputArgument;
	    useSymfony\Component\Console\Input\InputInterface;
	    useSymfony\Component\Console\Output\OutputInterface;
	    useIlluminate\Database\Capsule\ManagerasCapsule;
	    
	    $dotenv = \Dotenv\Dotenv::createImmutable(__DIR__ . '/../..');
	    $dotenv->load();
	    
	    $capsule = new Capsule;
	    $capsule->addConnection([
	        'driver'    => 'mysql',
	        'host'      => getenv('DB_HOST'),
	        'database'  => getenv('DB_DATABASE'),
	        'username'  => getenv('DB_USERNAME'),
	        'password'  => getenv('DB_PASS'),
	        'charset'   => 'utf8',
	        'collation' => 'utf8_unicode_ci',
	        'prefix'    => '',
	    ]);
	    
	    // Make this Capsule instance available globally via static methods... (optional)
	    $capsule->setAsGlobal();
	    
	    // Setup the Eloquent ORM... (optional; unless you've used setEventDispatcher())
	    $capsule->bootEloquent();
	    
	    
	    
	    classCreateUserCommandextendsCommand
	    {
	        // the name of the command (the part after "bin/console")
	        protectedstatic $defaultName = 'app:create-user';
	    
	        protectedfunctionconfigure()
	        {
	            $this
	            // the short description shown while running "php bin/console list"
	            ->setDescription('Creates a new user.')
	    
	            // the full command description shown when running the command with
	            // the "--help" option
	            ->setHelp('This command allows you to create a user...');
	            
	            $this
	            // configure an argument
	            ->addArgument('username', InputArgument::REQUIRED, 'The username of the user.')
	            ->addArgument('email', InputArgument::REQUIRED, 'The email of the user.')
	            ->addArgument('password',InputArgument::REQUIRED, 'User password');
	        }
	    
	        protectedfunctionexecute(InputInterface $input, OutputInterface $output)
	        {
	            $output->writeln([
	                'User Creator',
	                '============',
	                '',
	            ]);
	                
	            $user = new User();
	            $user->name = $input->getArgument('username');
	            $user->email = $input->getArgument('email');
	            $user->password = password_hash($input->getArgument('password'), PASSWORD_DEFAULT);
	            $user->save();
	            
	            // retrieve the argument value using getArgument()
	            $output->writeln('Username: '.$input->getArgument('username'));
	        
	            return0;
	        }
	    }
	    
	```

* **jorge-gianareas** (1) [978748](https://platzi.com/comentario/978748/) 

	Symfony componentes es la parte de Symfony que nos permitir√° crear muchos comandos y tener una interfaz amigable para usarlos.
	
	La l√≠nea de inicio #!/usr/bin/env php indica a la terminal hacia d√≥nde debe ir la ejecuci√≥n.

* **Mois√©s Cede√±o** (1) [960060](https://platzi.com/comentario/960060/) 

	Al d√≠a de hoy 01/02/2020, las configuraciones para el command necesitan lo siguiente:
	``` 
	    <?php
	    
	    namespaceApp\Commands;
	    
	    useSymfony\Component\Console\Command\Command;
	    useSymfony\Component\Console\Input\InputInterface;
	    useSymfony\Component\Console\Output\OutputInterface;
	    
	    classHelloWordCommandextendsCommand{
	    
	        protectedstatic $defaultName = 'app:hello-word';
	    
	        protectedfunctionexecute(InputInterface $input, OutputInterface $output): int
	        {
	            $output->writeLn('Hello World');
	            return0;
	        }
	    
	    }
	    
	```

* **Jorge David Duque Agudelo** (1) [578202](https://platzi.com/comentario/578202/) 
¬øTengo una duda, un comando hecho con este paquete puede hacer alguna de las siguientes cosas? - Modificar la configuracion de apache, - modificar el crontab, ejecutar scripts. sql

	* **walis85300 (Platzi)** [578202] (1)

		s√≠, si tiene los permisos correctos puede ejecutar el c√≥digo que se le indique sin mayor problema.

	* **Daniel Hurtado** [578202] (1)

		Si, puede hacer todo lo que quieras, es como si estuvieras corriendolo entrando desde el navegador, solo tienes que invocar las clases las cuales vayas a utilizar

* **Ariel Fernando Mejia** (1) [536826](https://platzi.com/comentario/536826/) 

	Gracias, hay algunos componentes que ya en el mundo real veo dif√≠cil usar fuera de Laravel, sin embargo, creo que si es did√°ctico, mas algunos paquetes si es como mucho el jaleo, aun as√≠ hay mucho que extraerle a este curso, as√≠ como importar a cualquier proyecto eloquent, me gusto mucho esta lecci√≥n.  
	Como curiosidad el paquete de Symfony Console es en el que se basan para crear artisan, la funcionalidad se puede lograr sin usar espec√≠ficamente esta herramienta pero los outputs de colores y otras funcionalidades son mucho mas dif√≠ciles lograr en PHP puro, para crear archivos con boilerplate y cosas as√≠ lo veo superfuncional, hay ocasiones en que se desea autocrear ciertos archivos con cierta funcionalidad especifica en esos casos es superutil, muchas gracias por tan variado material.
	
	seguro si yo sent√≠ un jaleo usar tantos paquetes la clase requiri√≥ bastante tiempo muchas gracias!

## 0270. Formulario para contacto [16292](https://platzi.com/clases/1462-php-avanzado/16292-fomulario-para-contacto5434/)

### Descripci√≥n:


Enviar correos electr√≥nicos es muy com√∫n y muy √∫til porque dependiendo de la aplicaci√≥n, necesitaremos notificaciones por ejemplo para resetear un password, confirmar una cuenta, entre otras. Para poder enviar un email, primero deberemos crear un formulario de contacto.

### Comentarios:

* **Juan Pena Verd√∫** (2) [788896](https://platzi.com/comentario/788896/) 

	Ver tambi√©n:  
	\- RFC2821 - SMTP  
	\- RFC2822 - ARPA  
	\- RFC2060 - IMAP  
	\- RFC1939 - POP3  
	\- RFC977 - NNTP  
	\- RFC2076 - Cabeceras  
	RFC2045, RFC2046, RFC2047, RFC2048 & RFC 2049 - MIME.

* **jorge-gianareas** (1) [978750](https://platzi.com/comentario/978750/) 

	Formulario para contacto  
	Enviar correos electr√≥nicos es muy com√∫n y muy √∫til porque dependiendo de la aplicaci√≥n, necesitaremos notificaciones por ejemplo para resetear un password, confirmar una cuenta, entre otras. Para poder enviar un email, primero deberemos crear un formulario de contacto.

* **Gonzalo Vazquez** (1) [68567](https://platzi.com/comentario/742398/) 
De donde sal√≠a el renderhtml()?

	* **Fran Delgado** [68567] (2)

		Viene de Twig, el template engine que hemos implementado en el proyecto. Como su nombre indica es un metodo que devuelve el html de la pagina para que lo pinte (rederice) el navegador. Mirate la documentacion del mismo y los videos referentes a template engines en el curso de introduccion a PHP.

## 0280. Emails [16291](https://platzi.com/clases/1462-php-avanzado/16291-emails1266/)

### Descripci√≥n:


Para enviar los correos electr√≥nicos utilizaremos la librer√≠a **Swiftmailer** que tambi√©n es usada por Symfony.  
Existen varias maneras de enviar correos pero lo m√°s com√∫n es usar el protocolo SMTP; podemos trabajar con nuestras cuentas propias pero para producci√≥n es recomendable usar servicios especializados. [mailtrap.io](http://mailtrap.io) nos sirve para probar correos electr√≥nicos.  
Puedes crear una cuenta gratuita en mailtrap la cual te permitir√° tener una bandeja de entrada que puedes usar y en la parte del engranaje est√° la configuraci√≥n y ver√°s los datos SMTP.

Al enviar el formulario, se tarda un cierto tiempo en dar una respuesta porque se conecta a un servicio de terceros. Esto es muy com√∫n y lo problem√°tico es que estamos bloqueando al usuario y √©ste no sabr√° qu√© est√° pasando. Por esto mismo crearemos un proceso as√≠ncrono para guardar los datos, darle respuesta al usuario y posteriormente hacer el env√≠o.

### Links:

* [Powerful component based mailing library for PHP ‚Äì Swift Mailer](https://swiftmailer.symfony.com/)

### Comentarios:

* **jorge-gianareas** (1) [978753](https://platzi.com/comentario/978753/) 

	Al enviar el formulario, se tarda un cierto tiempo en dar una respuesta porque se conecta a un servicio de terceros. Esto es muy com√∫n y lo problem√°tico es que estamos bloqueando al usuario y √©ste no sabr√° qu√© est√° pasando. Por esto mismo crearemos un proceso as√≠ncrono para guardar los datos, darle respuesta al usuario y posteriormente hacer el env√≠o.

* **jorge-gianareas** (1) [978752](https://platzi.com/comentario/978752/) 

	Existen varias maneras de enviar correos pero lo m√°s com√∫n es usar el protocolo SMTP; podemos trabajar con nuestras cuentas propias pero para producci√≥n es recomendable usar servicios especializados. [mailtrap.io](http://mailtrap.io) nos sirve para probar correos electr√≥nicos.  
	Puedes crear una cuenta gratuita en mailtrap la cual te permitir√° tener una bandeja de entrada que puedes usar y en la parte del engranaje est√° la configuraci√≥n y ver√°s los datos SMTP.

* **jorge-gianareas** (1) [978751](https://platzi.com/comentario/978751/) 

	Para enviar los correos electr√≥nicos utilizaremos la librer√≠a Swiftmailer que tambi√©n es usada por Symfony.

* **Angel Cabrera** (1) [637501](https://platzi.com/comentario/637501/) 

	Excelente clase. muy sencilla, gracias por este grandioso curso, Hector

* **luis-fernando-yupanqui-taco** (1) [568411](https://platzi.com/comentario/568411/) 

	Nose como llegue aca , solo queria recibir los mensajes que me dejan en mi pagina web.

* **Mario Campos** (1) [545568](https://platzi.com/comentario/545568/) 

	Hola,  
	tengo un problema, al ejecutar el siguiente c√≥digo:
	``` 
	    require_once 'vendor/autoload.php';
	    
	    $transport = (new Swift_SmtpTransport(SMTP_SERVER, SMTP_PASS))
	      ->setUsername(SMTP_USER)
	      ->setPassword(SMTP_PASS);
	    
	    $mailer  = new Swift_Mailer($transport);
	    $message = (new Swift_Message('Wonderful Subject'))
	      ->setFrom(['queries@test.com' => 'Queries Tasks'])
	      ->setTo(['receiver@domain.org', 'other@domain.org' => 'A name'])
	      ->setBody('alskdja klej klej l');
	    
	    $result = $mailer->send($message);
	    
	```
	
	me devuelve el siguiente error:
	``` 
	    PHP Fatal error:  Uncaught Swift_TransportException: Connection could not be established with host smtp.mailtrap.io [Connection timed out #110] in /tmp/mail/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/StreamBuffer.php:265
	    
	```

	* **hectorbenitez** [545568] (1)

		Verifica bien tus valores de configuracion para el mail, aparentemente no se esta conectando correctamente a [smtp.mailtrap.io](http://smtp.mailtrap.io)

	* **gerql14** [545568] (1)

		Me apareci√≥ lo mismo, se solucion√≥ cambiando el puerto 25 a 2525 ( Como lo tiene H√©ctor )

* **Arlin** (1) [544746](https://platzi.com/comentario/544746/) 

	Buenos d√≠as, quisiera hacer una pregunta, tengo un peque√±o proyecto pero lo tengo con php, en una tabla de Mysql tengo una tabla con datos como el cumplea√±os y el correo electr√≥nico, quisiera que cada vez que un usuario cumpla a√±os se env√≠e un mensaje de correo electr√≥nico con un mensaje, alguien e podr√≠a ayudar.?

	* **mariaguadalupelopezflores79** [544746] (2)

		Se me ocurre que puedes crear un comando como se muestra en este curso y ejecutarlo cada d√≠a podr√≠a ser con cron y dentro de las instrucciones del comando har√≠as una consulta a base de datos para revisar si la fecha de cumplea√±os es igual a la fecha actual y mandar un correo a cada registro que me regreso la consulta.

	* **neontigermx** [544746] (2)

		Eso se puede hacer con tareas, en la siguiente lecci√≥n habla H√©ctor al respecto! üòÉ

* **Mario Campos** (1) [55820](https://platzi.com/comentario/545568/) 
Hola, tengo un problema, al ejecutar el siguiente c√≥digo: require_once 'vendor/autoload.php'; $transport = (new Swift_SmtpTranspor...

	* **hectorbenitez** [55820] (1)

		Verifica bien tus valores de configuracion para el mail, aparentemente no se esta conectando correctamente a [smtp.mailtrap.io](http://smtp.mailtrap.io)

## 0290. Async tasks [16294](https://platzi.com/clases/1462-php-avanzado/16294-async-tasks1970/)

### Descripci√≥n:


Existen procesos que queremos ejecutar pero no queremos que el usuario se quede esperando por una respuesta. En muchos casos esos tiempos de espera ser√°n muy grandes dependiendo del tama√±o de los archivos.  
La mejor soluci√≥n es darle una respuesta inmediata al usuario como ‚ÄúRecibimos tu archivo, te enviaremos un correo cuando lo procesemos‚Äù y en otro proceso estaremos trabajando con el archivo y al finalizar enviaremos el correo. A esto lo llamamos tareas as√≠ncronas.

### Links:

* [crontab.guru - the cron schedule expression editor](https://crontab.guru/#*/5_*_*_*_*)

### Comentarios:

* **Daniel Ram√≠rez Mendoza** (5) [475629](https://platzi.com/comentario/475629/) 

	Para no duplicar c√≥digo lo que hice fue:  
	1.- Crear una carpeta llamada config en la ra√≠z del proyecto y dentro de el un archivo llamado database.php.
	``` 
	    curso-introduccion-php
	    	/app
	    	/config
	    		/database.php
	    	/db
	    	...
	    
	```
	
	2.- CORTAR el c√≥digo de Capsule de index.php y pegarlo en database.php, tambi√©n es necesario COPIAR el c√≥digo del Dotenv:
	``` 
	    <?php
	    
	    useIlluminate\Database\Capsule\ManagerasCapsule;
	    
	    $dotenv = new Dotenv\Dotenv(__DIR__ . '/..');
	    $dotenv->load();
	    
	    $capsule = new Capsule;
	    $capsule->addConnection([
	        'driver'    => getenv('DB_DRIVER'),
	        'host'      => getenv('DB_HOST'),
	        'database'  => getenv('DB_NAME'),
	        'username'  => getenv('DB_USER'),
	        'password'  => getenv('DB_PASS'),
	        'charset'   => 'utf8',
	        'collation' => 'utf8_unicode_ci',
	        'prefix'    => '',
	        'port'      => getenv('DB_PORT')
	    ]);
	    
	    // Make this Capsule instance available globally via static methods... (optional)
	    $capsule->setAsGlobal();
	    // Setup the Eloquent ORM... (optional; unless you've used setEventDispatcher())
	    $capsule->bootEloquent();
	    
	```
	
	3.- Agregar en el composer.json nuestro archivo database.php al autoload:
	``` 
	    {
	        "autoload": {
	            "psr-4": {
	                "App\\": "app/"
	            },
	            "files": ["config/database.php"]
	        },
	        ...
	    
	```
	
	4.- Correr en nuestra terminal el siguiente comando `composer dump-autoload`.
	
	Y listo deber√≠a funcionar sin necesidad de tener el c√≥digo de Capsule en index.php ni en console.php.

	* **hectorbenitez** [475629] (3)

		Excelente aporte @Danramz üòÑ

	* **darwistg** [475629] (2)

		justo iba yo a preguntar como simplific√°bamos el archivo index ya que se estaba convirtiendo en un todopoderoso.
		
		gracias @Danramz

	* **Luis Andr√©s Arce C√°rdenas** [475629] (1)

		Me da un error con el driver.
		``` 
		                  User Creator
		    *****************************************
		    
		    
		    In Connection.php line 664:
		                                                            
		      could not find driver (SQL: select * from `profile`)  
		                                                            
		    
		    In Connector.php line 70:
		                             
		      could not find driver  
		                             ```
		    
		```

* **davidam** (2) [534816](https://platzi.com/comentario/534816/) 

	Una consulta.  
	Cual es el contenido del modelo Message?  
	Porque solo quedo declarado y nada mas.
	
	Gracias

	* **F√©lix Andersson** [534816] (1)

		En este caso s√≥lo con declararlo es suficiente

* **flavioaandres** (2) [487439](https://platzi.com/comentario/487439/) 

	En el caso de llevar el proyecto a producci√≥n en un Hosting Compartido, hay forma de ejecutar el CustomComand desde la App? (ya que no tendr√≠a acceso a consola)

	* **Helber Fabian Toro Palacios** [487439] (3)

		En el hosting compartido si cuentas con Cpanel existe una opci√≥n llamada Cron Jobs, all√≠ puedes ejecutar el comando.

* **Emmanuel Contreras Segoviano** (2) [53228](https://platzi.com/comentario/515173/) 
Recomiendas el uso de Workerman? saludos

	* **hectorbenitez** [53228] (1)

		la verdad nunca lo he utilizado, luce muy interesante, si lo pruebas, platicanos que te parecio

* **gabobardales** (1) [1090451](https://platzi.com/comentario/1090451/) 

	Genial!

* **AxelEspinosa45** (1) [1010058](https://platzi.com/comentario/1010058/) 

	Que interesante

* **jorge-gianareas** (1) [978756](https://platzi.com/comentario/978756/) 

	La mejor soluci√≥n es darle una respuesta inmediata al usuario como ‚ÄúRecibimos tu archivo, te enviaremos un correo cuando lo procesemos‚Äù y en otro proceso estaremos trabajando con el archivo y al finalizar enviaremos el correo. A esto lo llamamos tareas as√≠ncronas.

* **jorge-gianareas** (1) [978755](https://platzi.com/comentario/978755/) 

	Existen procesos que queremos ejecutar pero no queremos que el usuario se quede esperando por una respuesta. En muchos casos esos tiempos de espera ser√°n muy grandes dependiendo del tama√±o de los archivos.

* **jorge-gianareas** (1) [978754](https://platzi.com/comentario/978754/) 

	Async tasks  
	Existen procesos que queremos ejecutar pero no queremos que el usuario se quede esperando por una respuesta. En muchos casos esos tiempos de espera ser√°n muy grandes dependiendo del tama√±o de los archivos.  
	La mejor soluci√≥n es darle una respuesta inmediata al usuario como ‚ÄúRecibimos tu archivo, te enviaremos un correo cuando lo procesemos‚Äù y en otro proceso estaremos trabajando con el archivo y al finalizar enviaremos el correo. A esto lo llamamos tareas as√≠ncronas.

* **Angel Cabrera** (1) [637550](https://platzi.com/comentario/637550/) 

	Excelente una vez m√°s, que sencillo.

* **Emmanuel Contreras Segoviano** (1) [515173](https://platzi.com/comentario/515173/) 

	Recomiendas el uso de Workerman? saludos

	* **hectorbenitez** [515173] (1)

		la verdad nunca lo he utilizado, luce muy interesante, si lo pruebas, platicanos que te parecio

* **Luis Andr√©s Arce C√°rdenas** (1) [61586](https://platzi.com/comentario/624181/) 
Tengo el siguiente error. Aclaro profile es mi tabla user. https://github.com/luilliar...

	* **Luis Andr√©s Arce C√°rdenas** [61586] (1)

		No me paren bola, estoy loco. xD jajaja‚Ä¶ Bueno por si acaso a alguien le pasa igual, no es ning√∫n error, si estas usando homestead entra a la maquina virtual con vagrant ssh y ah√≠ ejecutas el comando xD. Eso era todo.

* **flavioaandres** (1) [51095](https://platzi.com/comentario/487439/) 
En el caso de llevar el proyecto a producci√≥n en un Hosting Compartido, hay forma de ejecutar el CustomComand desde la App? (ya que no t...

	* **Helber Fabian Toro Palacios** [51095] (3)

		En el hosting compartido si cuentas con Cpanel existe una opci√≥n llamada Cron Jobs, all√≠ puedes ejecutar el comando.

## 0300. Procesar tareas as√≠ncronas [16293](https://platzi.com/clases/1462-php-avanzado/16293-procesar-tareas-asincronas9633/)

### Descripci√≥n:


Es necesario lograr que el env√≠o de correos se haga de manera autom√°tica pues no ser√≠a sostenible llamar comandos de manera manual. Para esto existe el **Cron Job** disponible en Linux y Unix que nos permite ejecutar una tarea cada cierto tiempo.  
<https://crontab.guru> nos ayudar√° a traducir lo que necesitamos poner en el Cron.

Dentro de Linux todos los procesos que est√°n corriendo son conocidos como servicios y cuando queremos recargarlos es necesario reconfigurar y reiniciar.

### Comentarios:

* **edavidsanchezb** (4) [577334](https://platzi.com/comentario/577334/) 

	Comandos en la consola:
	
	  1. Entramos al archivo con:
	
	
	``` 
	    sudo vi /etc/crontab
	    
	```
	
	  1. Luego con i editamos el archivo.
	  2. A√±adimos los asteriscos y luego el comando a ejecutar.
	
	
	* Para el caso de la maquina virtual Homestead, seria:
	
	
	``` 
	    php /home/vagrant/code/nombre_del_proyecto/console.php app:send-mail
	    
	```
	
	* Para Xampp en instalado de forma local en linux:
	
	
	``` 
	    php /opt/lampp/htdocs/nombre_del_proyecto/console.php app:send-mail
	    
	```
	
	* Si el archivo esta como un enlace simb√≥lico en la carpeta htdocs, se puede ejecutar directamente desde la ubicaci√≥n del proyecto, ejemplo:
	
	
	``` 
	    php /home/nombre_del_usuario/ubicaci√≥n_proyecto/console.php app:send-mail
	    
	```
	
	Tip:  
	Para evitar poner /home/nombre_del_usuario se usa ~/, ejemplo :
	``` 
	    ~/ubicaci√≥n_proyecto/console.php app:send-mail
	    
	```
	
	En el caso de usar Homestead:
	``` 
	    ~/code/nombre_del_proyecto/console.php app:send-mail
	    
	```
	
	  1. Se cierra el archivo con :wq
	  2. Ejecutamos el comando:
	
	
	``` 
	    sudo systemctl restart cron
	    
	```
	
	Para reiniciar el servicio de crontab.
	
	En windows me quedo corto üòï

* **jorge-gianareas** (1) [978759](https://platzi.com/comentario/978759/) 

	Dentro de Linux todos los procesos que est√°n corriendo son conocidos como servicios y cuando queremos recargarlos es necesario reconfigurar y reiniciar.

* **jorge-gianareas** (1) [978758](https://platzi.com/comentario/978758/) 

	Es necesario lograr que el env√≠o de correos se haga de manera autom√°tica pues no ser√≠a sostenible llamar comandos de manera manual. Para esto existe el Cron Job disponible en Linux y Unix que nos permite ejecutar una tarea cada cierto tiempo.  
	<https://crontab.guru> nos ayudar√° a traducir lo que necesitamos poner en el Cron.

* **Juanparro** (1) [921252](https://platzi.com/comentario/921252/) 

	Para quienes usamos Windows podemos usar este programita.
	
	<https://www.youtube.com/watch?v=xDxzpVBJ1rY>

* **Angel Cabrera** (1) [637576](https://platzi.com/comentario/637576/) 

	¬øC√≥mo podr√≠a enviar un mensaje junto con el RedirectResponse para mostrarlo luego en la vista?

	* **Diego Alexander Forero Higuera (Platzi)** [637576] (1)

		Puedes usar las sesiones para guardar el mensaje y una vez lo muestres puedes hacer el unset de la sesi√≥n para que el mensaje no se muestre m√°s
		
		Algo como esto, esta es la vista donde se va a crear el redirect y se guarda el mensaje.
		``` 
		    if (mysqli_affected_rows($link) == 1) 
		    {
		       //succes         
		        $_SESSION['message'] = 'succes';
		        redirect_to('index.php');
		    }
		    
		```
		
		Luego en index.php
		``` 
		    if (!empty($_SESSION['message'])) {
		        echo'<p class="message"> '.$_SESSION['message'].'</p>';
		        unset($_SESSION['message']);
		    }
		    
		```
		
		Aqu√≠ validas si existe message en la sesi√≥n y si existe muestras el mensaje y luego lo borras de la sesi√≥n para que no se vuelva a mostrar.

* **Jorge David Duque Agudelo** (1) [578205](https://platzi.com/comentario/578205/) 
jajajaja magicamente no, pero vamos a pensar que son cosas bonitas, muy bien explicado, no conocia el comando para reiniciar el servicio de crontab, siempre reiniciaba la instancia del servidor completamente.

## 0310. Crear un comando para agregar usuarios [16402](https://platzi.com/clases/1462-php-avanzado/16402-crear-un-comando-para-agregar-usuarios/)

### Descripci√≥n:


Como lo platicamos anteriormente, hasta este momento hemos dejado sin validaci√≥n nuestra secci√≥n para crear usuarios, esto es muy conveniente en este punto porque estamos desarrollando nuestra app, pero no queremos dejar esta secci√≥n p√∫blica cuando subamos nuestra app a producci√≥n.

Vamos a continuar practicando nuestras habilidades y crearemos el comando app:create-user

## Creando el comando

Debemos crear una clase nueva que en este caso yo llamar√© CreateUserCommand y que debe extender de Symfony\Component\Console\Command\Command, despues de eso, vamos a agregar la propiedad est√°tica $defaultName con el valor ‚Äòapp:create-user‚Äô; y crearemos los m√©todos _configure_ y _execute_ , aunque por ahora los dejaremos vac√≠os.
``` 
    <<?php
    namespace App\Commands;
    use App\Models\User;
    use Symfony\Component\Console\Command\Command;
    use Symfony\Component\Console\Input\InputArgument;
    use Symfony\Component\Console\Input\InputInterface;
    use Symfony\Component\Console\Output\OutputInterface;
    class CreateUserCommand extends Command
    {
        protected static $defaultName = 'app:create-user';
        protected function configure()
        {
        	// Aqu√≠ va la configuraci√≥n
        }
    
        protected function execute(InputInterface $input, OutputInterface $output)
        {
    	// Aqu√≠ va el c√≥digo del comando
        }
    }>
    
```

## Configuraci√≥n del comando

Ahora que ya tenemos nuestro comando vamos a pasar a agregar la configuraci√≥n, para esto vamos a indicar que necesitamos un par√°metro requerido que ser√° el email del usuario.
``` 
    <$this->addArgument('email', InputArgument::REQUIRED, 'The email of the user.');>
    
```

## Ejecuci√≥n del comando

Una vez que tenemos la configuraci√≥n, es momento de ejecutar nuestro comando, para esto lo √∫nico que vamos a hacer es leer el argumento requerido y de ahi crearemos un usuario con un password default:
``` 
    <$output->writeln([
            'User Creator',
           '============',
           '',
    ]);
    $user = new User();
    $user->email = $input->getArgument('email');
    $user->password = password_hash('UnPassMuySeguro', PASSWORD_DEFAULT);
    $user->save();
    $output->writeln('Done.');>
    
```

## Registro del comando

Para finalizar, lo √∫nico que necesitamos es registrar nuestro comando en el archivo console.php y ya estar√° listo para ser utilizado por nuestros usuarios.

$application->add(new \App\Commands\CreateUserCommand());

## Conclusi√≥n

As√≠ se debe ver el archivo final:
``` 
    <<?php
    namespace App\Commands;
    use App\Models\User;
    use Symfony\Component\Console\Command\Command;
    use Symfony\Component\Console\Input\InputArgument;
    use Symfony\Component\Console\Input\InputInterface;
    use Symfony\Component\Console\Output\OutputInterface;
    class CreateUserCommand extends Command
    {
        protected static $defaultName = 'app:create-user';
        protected function configure()
        {
            $this
                ->addArgument('email', InputArgument::REQUIRED, 'The email of the user.')
            ;
        }
        protected function execute(InputInterface $input, OutputInterface $output)
        {
            $output->writeln([
                'User Creator',
                '============',
                '',
            ]);
            $user = new User();
            $user->email = $input->getArgument('email');
            $user->password = password_hash('UnPassMuySeguro', PASSWORD_DEFAULT);
            $user->save();
            $output->writeln('Done.');
        }
    }
    
    >
    
```

¬øVes cu√°n f√°cil fue? con todo lo que aprendiste hasta este momento crear comandos ser√° una tarea simple pero a la vez muy util para tus aplicaciones, digamos que los comandos son acciones que solo podr√°n ser ejecutadas por alguien que tenga acceso de consola a nuestra aplicaci√≥n, por lo que estas acciones a la vez son muy seguras.

Como paso siguiente y para que sigas practicando, te propongo los siguientes retos:

* Agrega el par√°metro opcional password y √∫salo en caso de que el usuario lo ponga, en caso de que no lo encuentres entonces usa el default.

* Crea en la aplicaci√≥n una secci√≥n para poder cambiar el password dentro del √°rea de administraci√≥n.




Con lo que sabes hasta ahora, ambas tareas ser√°n muy sencillas para ti y te permitir√°n reforzar tus conocimientos.

### Comentarios:

* **Jes√∫s CH** (1) [1084909](https://platzi.com/comentario/1084909/) 

	```
	    // index.php
	    // Router
	    $map->get('changePassword', '/primer-proyecto-php/changePassword', [
	        'App\Controllers\ResetPasswordController',
	        'changePassword'
	    ]);
	    $map->post('resetPassword', '/primer-proyecto-php/resetPassword', [
	        'App\Controllers\ResetPasswordController',
	        'resetPassword'
	    ]);
	    
	```
	``` 
	    // App\Controllers\ResetPasswordController.php
	    <?php
	    
	    namespaceApp\Controllers;
	    
	    useApp\Models\{User};
	    useZend\Diactoros\ServerRequest;
	    useZend\Diactoros\Response\RedirectResponse;
	    
	    classResetPasswordControllerextendsBaseController{
	        publicfunctionchangePassword(){
	            return $this->renderHTML('changePassword.twig');
	        }
	    
	        publicfunctionresetPassword(ServerRequest $request){
	    
	            $postData = $request->getParsedBody();
	    
	            if (!$postData['password']) {
	                return;
	            }
	    
	            $user = User::where('id', $_SESSION['userId'])->first();
	            $user->password = password_hash($postData['password'], PASSWORD_DEFAULT);
	            $user->save();
	    
	            returnnew RedirectResponse('/primer-proyecto-php/admin');
	        }
	    }
	    
	```

* **gerql14** (1) [940997](https://platzi.com/comentario/940997/) 

	**Reto 2**
	
	_public/index.php_
	``` 
	    ....
	    $map->get('showPass','/users/pass',[
	        'App\Controllers\UsersController',
	        'getPassword'
	    ]);
	    $map->post('change','/users/changepass',[
	        'App\Controllers\UsersController',
	        'changePassword'
	    ]);
	    ....
	    
	```
	
	_Controllers/UsersControllers.php_
	``` 
	    public function getPassword(){
	            return $this->renderHTML('users/pass.twig');
	        }
	    
	    public function changePassword($request){
	            $responseMessage = '';
	            $classMessage = '';
	            if($request->getMethod() == "POST"){
	                $postData = $request->getParsedBody();
	    
	                $dataValidation = Validator::key('password',Validator::stringType()->notEmpty())
	                                           ->key('newpass',Validator::stringType()->notEmpty())
	                                           ->key('confirmpass',Validator::stringType()->notEmpty());
	                try {
	                    $dataValidation->assert($postData);
	                    $sessionUserId = $_SESSION['userId'] ?? null;
	                    $userSearch = User::find($sessionUserId);
	                    if($userSearch){
	                        if(password_verify($postData['password'],$userSearch->password)){
	                            if($postData['newpass']==$postData['confirmpass']){
	                                $newPass = $userSearch->password_hash($postData['newpass'],PASSWORD_DEFAULT);
	                                $userSearch->password = $newPass;
	                                $userSearch->save();
	                                $responseMessage = 'saved';
	                                $classMessage = 'success';
	                            }else{
	                                $responseMessage = 'Confirm Pass';
	                                $classMessage = 'warning';
	                            }
	                        }else{
	                            $responseMessage = 'Check credentials';
	                            $classMessage = 'warning';
	                        }
	                    }else{
	                        $responseMessage = 'User not Found';
	                        $classMessage = 'error';
	                    }
	                }catch (\Exception $e){
	                    $responseMessage = $e->getMessage();
	                    $classMessage = 'warning';
	                }
	    
	            }
	            return $this->renderHTML('users/pass.twig',[
	               'responseMessage' => $responseMessage,
	               'classMessage' => $classMessage
	            ]);
	        }
	    
	    
	```
	
	_views/users/pass.twig_
	``` 
	    {% extends 'layout.twig' %}
	    {% block content %}
	        {% if responseMessage != '' %}
	            <divclass="alert alert-{{ classMessage }}">
	                {{ responseMessage }}
	            </div>
	        {% endif %}
	        <formaction="/users/changepass"method="post">
	            <h1>Change Password</h1>
	            <labelfor="">Password</label>
	            <inputtype="text"name="password"><br>
	            <labelfor="">New Pass</label>
	            <inputtype="password"name="newpass"><br>
	            <labelfor="">Confirm Pass</label>
	            <inputtype="password"name="confirmpass"><br>
	            <buttontype="submit">Change</button>
	        </form>
	    {% endblock %}
	    
	```

* **gerql14** (1) [940983](https://platzi.com/comentario/940983/) 

	**Reto 1**
	
	_CreateUserCommand.php_
	``` 
	     protected function configure(){
	            $this->addArgument('email',InputArgument::REQUIRED, 'The email of the user')
	                 ->addArgument('pass', InputArgument::OPTIONAL, 'The pass of the user');
	        }
	    
	       protected function execute(InputInterface $input, OutputInterface $output)
	        {
	            $output->writeln([
	                'User Creator',
	                '============',
	                '',
	            ]);
	          $user = new User();
	          $user->email = $input->getArgument('email');
	          $pass_aux = $input->getArgument('pass') ?? "4321";
	          $user->password = password_hash($pass_aux, PASSWORD_DEFAULT);
	          $user->save();
	          $output->writeln('Done.');
	          return 0;
	       }
	    
	```

* **codeisaac** (1) [719646](https://platzi.com/comentario/719646/) 

	Reto 1
	
	Comando
	``` 
	    <?php
	    
	    namespaceApp\Commands;
	    
	    useApp\Models\User;
	    useSymfony\Component\Console\Command\Command;
	    useSymfony\Component\Console\Input\InputArgument;
	    useSymfony\Component\Console\Input\InputInterface;
	    useSymfony\Component\Console\Output\OutputInterface;
	    
	    classCreateUserCommandextendsCommand
	    {
	    
	        protectedstatic $defaultName = 'app:create-user';
	    
	        protectedfunctionexecute(InputInterface $input, OutputInterface $output){
	            $output->writeln([
	                'User Creator',
	                '============',
	                '',
	            ]);
	    
	            $password = ($input->getArgument('pass')) ? $input->getArgument('pass') : User::generatePassword(12);
	    
	            $user = new User();
	            $user->name = $input->getArgument('name');
	            $user->email = $input->getArgument('email');
	            $user->password = password_hash($password, PASSWORD_DEFAULT);
	            $user->save();
	    
	            $output->writeln("Your password: {$password}");
	            $output->writeln('Done.');
	        }
	    
	        protectedfunctionconfigure(){
	    
	            $this->addArgument('email', InputArgument::REQUIRED, 'The email of the user.');
	            $this->addArgument('name', InputArgument::REQUIRED, 'The name of the user.');
	            $this->addArgument('pass', InputArgument::OPTIONAL, 'A password of the user.');
	        }
	    }
	    
	```
	
	Creaci√≥n de un trait para generar contrase√±as
	``` 
	    <?php
	    
	    namespaceApp\Traits;
	    
	    trait HasDefaultPassword
	    {
	        publicfunctiongeneratePassword($length = 8){
	            $_alphaSmall = 'abcdefghijklmnopqrstuvwxyz';
	            $_alphaCaps  = strtoupper($_alphaSmall);
	            $_numerics   = '1234567890';
	            $_specialChars = '`~!@#$%^&*()-_=+]}[{;:,<.>/?\'"\|';
	            $_container = $_alphaSmall.$_alphaCaps.$_numerics.$_specialChars;
	            $password = ''; 
	    
	            $password = substr(str_shuffle($_container), 0, $length);
	    
	            return $password;
	        }
	    }
	    
	```
	
	Usando el trait en el modelo user
	``` 
	    <?php
	    
	    namespaceApp\Models; 
	    
	    useApp\Traits\HasDefaultPassword;
	    useIlluminate\Database\Eloquent\Model;
	    
	    classUserextendsModel
	    {
	    
	        useHasDefaultPassword;
	        
	        protected $table = 'users';
	    }
	    
	```
	
	El otro reto lo podran ver en el repo en <https://github.com/isaacBats/curso-php> en la carpeta que se llama project  
	por que es mucho codigo.  
	vistas para listar usuarios y editar  
	controladores: acciones para mostrar los usuarios , mostrar el formulario y modificar  
	rutas, las rutas que se agregaron para todas las acciones

* **carlosdummy14** (1) [638408](https://platzi.com/comentario/638408/) 

	Reto 1.
	``` 
	    classCreateUserCommandextendsCommand{
	      protectedstatic $defaultName = 'app:create-user';
	      protectedfunctionconfigure(){
	        $this->addArgument('email', InputArgument::REQUIRED, 'The email of the user.');
	        $this->addArgument('password', InputArgument::OPTIONAL, 'The email of the user.');
	      }
	    
	      protectedfunctionexecute(InputInterface $input, OutputInterface $output){
	        $output->writeln([
	          'User Creator',
	          '============',
	          '',
	        ]);
	        $user = new User();
	        $user->email = $input->getArgument('email');
	        if (!$input->getArgument('password')) {
	          $user->password = password_hash('UnPassMuySeguro', PASSWORD_DEFAULT);
	        } else {
	          $user->password = password_hash($input->getArgument('password'), PASSWORD_DEFAULT);
	        }
	        $user->save();
	        $output->writeln('Done.');
	      }
	    }
	    
	```

# Seguridad [3201]

## 0320. Security [16237](https://platzi.com/clases/1462-php-avanzado/16237-security0929/)

### Descripci√≥n:


* Es recomendado que trabajes siempre con las versiones m√°s recientes de lo que est√©s usando, como lenguajes, frameworks o bases de datos. Si es necesario que mantengas una versi√≥n anterior, revisa si hay parches de seguridad disponibles ya que lo m√°s probable es que los desarrolladores sigan implementando estas mejoras.
* Uno de los mayores problemas en la aplicaci√≥n web es la falta de validaciones por el lado de los programadores (nosotros), como manipulaci√≥n de ID‚Äôs o en el momento de autenticar, dando pie a dar informaci√≥n sobre los usuarios a los atacantes.
* Existe un proyecto llamado **OWASP** que ayuda a identificar, catalogar y nos brinda herramientas que podemos utilizar para mejorar las aplicaciones. Esto aplica para otros lenguajes de backend. En su top 10 tendremos las vulnerabilidades que m√°s han surgido en el a√±o.
* Si vas a mantener datos de usuarios, al momento de ir a producci√≥n es importante usar conexiones seguras **HTTPS** ya que esto bloquea el acceso de los atacantes al momento de los clientes conectarse al servidor web.



### Links:

* [OWASP](https://www.owasp.org/index.php/Main_Page)

### Comentarios:

* **Jorge David Duque Agudelo** (4) [578207](https://platzi.com/comentario/578207/) 
Creo que esto es uno de los temas que quedarian perfectos para un curso completo.

	* **MDCMC** [578207] (1)

		Creo la [carrera de seguridad informatica](https://platzi.com/seguridad-informatica/) trata mucho de alguna de estas cosas. Seria bueno que le eches un ojo, yo despues de la carrera de python de dare un ojo.

* **jorge-gianareas** (1) [978763](https://platzi.com/comentario/978763/) 

	Si vas a mantener datos de usuarios, al momento de ir a producci√≥n es importante usar conexiones seguras HTTPS ya que esto bloquea el acceso de los atacantes al momento de los clientes conectarse al servidor web.

* **jorge-gianareas** (1) [978762](https://platzi.com/comentario/978762/) 

	Existe un proyecto llamado OWASP que ayuda a identificar, catalogar y nos brinda herramientas que podemos utilizar para mejorar las aplicaciones. Esto aplica para otros lenguajes de backend. En su top 10 tendremos las vulnerabilidades que m√°s han surgido en el a√±o.

* **jorge-gianareas** (1) [978761](https://platzi.com/comentario/978761/) 

	Uno de los mayores problemas en la aplicaci√≥n web es la falta de validaciones por el lado de los programadores (nosotros), como manipulaci√≥n de ID‚Äôs o en el momento de autenticar, dando pie a dar informaci√≥n sobre los usuarios a los atacantes.

* **jorge-gianareas** (1) [978760](https://platzi.com/comentario/978760/) 

	Es recomendado que trabajes siempre con las versiones m√°s recientes de lo que est√©s usando, como lenguajes, frameworks o bases de datos. Si es necesario que mantengas una versi√≥n anterior, revisa si hay parches de seguridad disponibles ya que lo m√°s probable es que los desarrolladores sigan implementando estas mejoras.

## 0330. Security Examples [16235](https://platzi.com/clases/1462-php-avanzado/16235-security-examples/)

### Descripci√≥n:


* **pdo** viene de PHP Data Object y son las librer√≠as base con las que se comunica PHP y un motor de base de datos. Eloquent encapsula esta informaci√≥n y nos genera una capa superior que nos permite comunicarnos con la base de datos usando buenas pr√°cticas.
* Confiar en lo que el usuario escribe es un error al desarrollar porque puede haber atacantes que buscan obtener informaci√≥n que no les corresponde.
* En pdo existen las sentencias preparadas que crear√° el query con placeholders que luego se cambiar√°n por los valores reales, escapando la informaci√≥n y evitando **SQL Injection.** Lo importante es que cuando trabajes con entradas de usuario, valides siempre.
* Un ataque **XSS** es un ataque en el que alguien trata de inyectar c√≥digo en nuestra aplicaci√≥n. Chrome cuenta con un auditor que evita estos ataques pero s√≥lo a partir de una versi√≥n avanzada.
* strip_tags y htmlspecialchars van a escapar los caracteres HTML evitando ataques **XSS**



### Comentarios:

* **Jorge David Duque Agudelo** (2) [578208](https://platzi.com/comentario/578208/) 
¬øLos cron jobs que utilizan paramentros tambien deber√≠an estar validados?

	* **hectorbenitez** [578208] (4)

		Claro que si, recuerda nunca confiar en nadie üòÑ

	* **F√©lix Andersson** [578208] (1)

		No lo se, pues se supone que quien ejecuta los CRON es el propio servidor no un usuario, por lo tanto no se corre el peligro de un usuario que lo utilice con par√°metros maliciosos

	* **David Galisteo** [578208] (2)

		Hay que validarlo igualmente, F√©lix, se va a ejecutar desde el servidor, pero no sabemos si alguien puede alterar esa ejecuci√≥n, por un ataque o por otro motivo.

	* **F√©lix Andersson** [578208] (1)

		Ahh ya, gracias! üòÉ

* **Nexura Internacional** (2) [71532](https://platzi.com/comentario/799137/) 
¬øOWASP aplica para las aplicaciones en .Net?

	* **Juan David Castro (Platzi)** [71532] (1)

		Claro que s√≠. Aplica para aplicaciones construidas con cualquier lenguaje de programaci√≥n. üòâ

* **aleco-diaz** (1) [1096259](https://platzi.com/comentario/1096259/) 

	Buenas tarde, estoy usando PHP 7.3 y un gestor de BD Adaptive Server Enterprise de SYBASE, uso ODBC con el driver de Sybase.  
	Cuando hago la siguiente consulta, me devuelve cero, no se si es un problema con los marcadores de posicion (?), o con este gestor de BD no funciona.  
	$consulta="select sum(c.consumofac) as suma from cabfacturacion c ";  
	$consulta.="inner join cabfacturacionclie cl ";  
	$consulta.="on (cl.codcliente=c.codcliente) ";  
	$consulta.=‚Äúwhere c.anio=?‚Äù;
	``` 
	    	$sql=$dbh->prepare($consulta);	
	    	$sql->bindParam(1, $_POST['anio'], PDO::PARAM_STR,4);
	    	$sql->execute();			
	    	$total=$sql->fetchColumn();
	    	$msg=($total===false) ? "No hay filas" : sprintf("Suma: %d",$total); 
	    
	```
	
	echo $msg; Al final el resultado me da cero.

* **jorge-gianareas** (1) [978768](https://platzi.com/comentario/978768/) 

	strip_tags y htmlspecialchars van a escapar los caracteres HTML evitando ataques XSS

* **jorge-gianareas** (1) [978767](https://platzi.com/comentario/978767/) 

	Un ataque XSS es un ataque en el que alguien trata de inyectar c√≥digo en nuestra aplicaci√≥n. Chrome cuenta con un auditor que evita estos ataques pero s√≥lo a partir de una versi√≥n avanzada.

* **jorge-gianareas** (1) [978766](https://platzi.com/comentario/978766/) 

	En pdo existen las sentencias preparadas que crear√° el query con placeholders que luego se cambiar√°n por los valores reales, escapando la informaci√≥n y evitando SQL Injection. Lo importante es que cuando trabajes con entradas de usuario, valides siempre.

* **jorge-gianareas** (1) [978765](https://platzi.com/comentario/978765/) 

	Confiar en lo que el usuario escribe es un error al desarrollar porque puede haber atacantes que buscan obtener informaci√≥n que no les corresponde.

* **jorge-gianareas** (1) [978764](https://platzi.com/comentario/978764/) 

	pdo viene de PHP Data Object y son las librer√≠as base con las que se comunica PHP y un motor de base de datos. Eloquent encapsula esta informaci√≥n y nos genera una capa superior que nos permite comunicarnos con la base de datos usando buenas pr√°cticas

* **anthonycardenas** (1) [808225](https://platzi.com/comentario/808225/) 

	y como se hace un prepare en un sp?

	* **Carlos Otero Seijo** [808225] (0)

		$sentencia = $mbd->prepare(‚ÄúCALL sp_returns_string(?)‚Äù);  
		$sentencia->bindParam(1, $valor_devuleto, PDO::PARAM_STR, 4000);
		
		// llamar al procedimiento almacenado  
		$sentencia->execute();

# Conclusiones [3199]

## 0340. Crea una API Rest [16232](https://platzi.com/clases/1462-php-avanzado/16232-crea-una-api-rest/)

### Descripci√≥n:


Las API Rest son un estilo de arquitectura para dise√±ar API‚Äôs, se utilizan cuando quieres que tus usuarios tengan un nuevo mecanismo para acceder a los datos de tu app, tambi√©n para darle a tu equipo de desarrolladores m√≥viles una forma de comunicaci√≥n para sus aplicaciones con el servidor web.

### Comentarios:

* **Manuel Gil** (3) [488746](https://platzi.com/comentario/488746/) 

	Personamente utilizo [RestEasy](https://chrome.google.com/webstore/detail/resteasy/nojelkgnnpdmhpankkiikipkmhgafoch) (una extensi√≥n de Google Chrome) para probar los m√©todos del API Rest. Funciona muy bien y no requiere de una suscripci√≥n.

	* **gchacaltana** [488746] (1)

		Hola Gracias, yo uso Postman, probar√© RestEasy, saludos!

	* **Yubeli Martinez Sanchez** [488746] (1)

		Tambi√©n uso postman. la probare.

* **darwistg** (2) [564307](https://platzi.com/comentario/564307/) 

	para que se usan los nombres **name ** de las rutas?? o mejor dicho donde los usas?

	* **Diego Alexander Forero Higuera (Platzi)** [564307] (2)

		Hola en este ejemplo no se usan pero seg√∫n la documentaci√≥n <https://github.com/auraphp/Aura.Router/blob/3.x/docs/getting-started.md#adding-a-route> es para poder generar los links desde el c√≥digo, puedes llamar solo la ruta por el nombre y le pasas los par√°metros que espera en lugar de escribir la ruta completa.

* **Christian Valencia Cuero** (2) [464831](https://platzi.com/comentario/464831/) 

	Buen v√≠deo, una consulta:  
	Desde un formulario en html, como envio el put, patch o delete? porque solo funciona el method con get y post
	
	Tambi√©n como se hace desde javascript?

	* **hectorbenitez** [464831] (4)

		Normalmente no enviamos esos metodos desde un form.
		
		Cuando la usamos desde el frontend en js, practicamente cualquier libreria tiene soporte para esos metodos, por ejemplo jquery, angular, vue, etc‚Ä¶
		
		Cuando usamos una API con PHP desde el backend tambien podemos usar los metodos, por ejemplo Guzzle es una excelente libreria para esto <http://docs.guzzlephp.org>

* **gabobardales** (1) [1091549](https://platzi.com/comentario/1091549/) 

	Este es un complemento [RESTCLIENT](https://addons.mozilla.org/es/firefox/addon/restclient/) para firefox

* **jorge-gianareas** (1) [978769](https://platzi.com/comentario/978769/) 

	Las API Rest son un estilo de arquitectura para dise√±ar API‚Äôs, se utilizan cuando quieres que tus usuarios tengan un nuevo mecanismo para acceder a los datos de tu app, tambi√©n para darle a tu equipo de desarrolladores m√≥viles una forma de comunicaci√≥n para sus aplicaciones con el servidor web.

* **devops** (1) [877829](https://platzi.com/comentario/877829/) 

	CONSULTA EL PROGRAMA POSTMAN COMO LO OBTENGO ? ES EN LINEA O TENGO QUE INSTALARLO

	* **jcruzquintero** [877829] (1)

		Te recomiendo este curso <https://platzi.com/clases/postman/>.

	* **Jes√∫s L√≥pez** [877829] (1)

		Debes instalarlo:  
		<https://www.postman.com/downloads/>

* **aleniten** (1) [846338](https://platzi.com/comentario/846338/) 

	Alguien modifico los archivos de este video

* **Roberto** (1) [800086](https://platzi.com/comentario/800086/) 
No se reproduce el video de api rest

* **Daniee** (1) [513146](https://platzi.com/comentario/513146/) 

	me aparece un error muy raro en la terminal, alguna idea de qu√© puede ser ?
	``` 
	    /Users/dani/Platzi/PHP-Avanzado/homestead/scripts/homestead.rb:218:in `+': no implicit conversion of nil into String (TypeError)
	    	from /Users/dani/Platzi/PHP-Avanzado/homestead/scripts/homestead.rb:218:in `block (2 levels) in configure'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/plugins/kernel_v2/config/vm_provisioner.rb:82:in `add_config'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/plugins/kernel_v2/config/vm.rb:339:in `provision'
	    	from /Users/dani/Platzi/PHP-Avanzado/homestead/scripts/homestead.rb:217:in `block in configure'
	    	from /Users/dani/Platzi/PHP-Avanzado/homestead/scripts/homestead.rb:214:in `each'
	    	from /Users/dani/Platzi/PHP-Avanzado/homestead/scripts/homestead.rb:214:in `configure'
	    	from /Users/dani/Platzi/PHP-Avanzado/homestead/Vagrantfile:36:in `block in <top (required)>'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/lib/vagrant/config/v2/loader.rb:37:in `load'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/lib/vagrant/config/loader.rb:126:in `block (2 levels) inload'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/lib/vagrant/config/loader.rb:119:in `each'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/lib/vagrant/config/loader.rb:119:in `blockinload'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/lib/vagrant/config/loader.rb:116:in `each'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/lib/vagrant/config/loader.rb:116:in `load'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/lib/vagrant/vagrantfile.rb:29:in `initialize'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/lib/vagrant/environment.rb:793:in `new'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/lib/vagrant/environment.rb:793:in `vagrantfile'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/lib/vagrant/environment.rb:178:in `initialize'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/bin/vagrant:145:in `new'
	    	from /opt/vagrant/embedded/gems/2.2.3/gems/vagrant-2.2.3/bin/vagrant:145:in `<main>'
	    
	```

	* **hectorbenitez** [513146] (2)

		parece un error con tu instalacion de vagrant, asegurate de tener la ultima version de vagrant y virtual box

	* **Daniee** [513146] (2)

		Ya encontr√© el error ! fue en la l√≠nea donde enlazamos el c√≥digo de nuestra m√°quina vagrant con la carpeta de nuestro equipo. Gran herramienta vagrant y gran curso H√©ctor !!
		
		Enhorabuena !

* **Edward Orlando Hurtado** (1) [66888](https://platzi.com/comentario/714232/) 
Clone el repositorio, hice composer install, pero index.php me sale en blanco, que puede ser?

* **Christian Valencia Cuero** (1) [49256](https://platzi.com/comentario/464831/) 
Buen v√≠deo, una consulta: Desde un formulario en html, como envio el put, patch o delete? porque solo funciona el method con get y post T...

	* **hectorbenitez** [49256] (4)

		Normalmente no enviamos esos metodos desde un form.
		
		Cuando la usamos desde el frontend en js, practicamente cualquier libreria tiene soporte para esos metodos, por ejemplo jquery, angular, vue, etc‚Ä¶
		
		Cuando usamos una API con PHP desde el backend tambien podemos usar los metodos, por ejemplo Guzzle es una excelente libreria para esto <http://docs.guzzlephp.org>

## 0350. Cierre [16297](https://platzi.com/clases/1462-php-avanzado/16297-cierre4905/)

### Descripci√≥n:


### Comentarios:

* **neontigermx** (2) [788078](https://platzi.com/comentario/788078/) 

	Excelente curso!

* **Miguel Matos** (2) [462720](https://platzi.com/comentario/462720/) 

	Much√≠simas gracias por el curso, y justo cuando me quedan dos d√≠as para terminar la beca recibida. Con los conocimientos del curso principal y este, ahora s que puedo mejorar los proyecto con c√≥digo heredado ene PHP 5.1 a la m√°s nueva versi√≥n.

	* **hectorbenitez** [462720] (2)

		Felicidades por terminar este curso! üòÑ

* **juand_silva** (1) [1087294](https://platzi.com/comentario/1087294/) 

	Me impresion√≥ el uso de librer√≠as. Esperemos tener mejores skills en el uso de ellas.

* **AxelEspinosa45** (1) [1011568](https://platzi.com/comentario/1011568/) 

	Me gusto much√≠simo este curso, aprend√≠ cosas que no sabia acerca del lenguaje

* **Jan Adams** (1) [827935](https://platzi.com/comentario/827935/) 

	Me encanto este curso !

* **Angel Infanti** (1) [774672](https://platzi.com/comentario/774672/) 

	Curso muy completo, aprend√≠ much√≠simas cosas nuevas

* **ederrafo** (1) [673450](https://platzi.com/comentario/673450/) 

	Buen curso !

* **Nicol√°s Marulanda P.** (1) [663393](https://platzi.com/comentario/663393/) 

	Genial el curso, interesantes herramientas usadas, ahora a seguir practicando.

* **jonathan sanchez** (1) [595137](https://platzi.com/comentario/595137/) 

	Gracias por este curso, donde he adquirido mas conocimiento y como hacer un mejor uso he integracion de herramientas y librerias para tener desarrollar codigo mas profesional.

* **JDiaz0017** (1) [589826](https://platzi.com/comentario/589826/) 

	Muchas gracias profe H√©ctor, excelente curso y pues ya ser√° nuestra responsabilidad aplicar los conceptos en proyectos puntuales, no existe mejor manera de aprender que la pr√°ctica.

* **Jorge David Duque Agudelo** (1) [578210](https://platzi.com/comentario/578210/) 
Muchas gracias, muchos temas nuevos y herramientas para usar.

* **elreydavid** (1) [556092](https://platzi.com/comentario/556092/) 

	GRACIAS POR LAS CLASE SE APRENDE BASTANTE

* **Ariel Fernando Mejia** (1) [536943](https://platzi.com/comentario/536943/) 

	Gracias muy buen curso, me gusto mucho el ofrecer interacci√≥n con diferentes librer√≠as.

* **Nicolas Otero** (1) [62357](https://platzi.com/comentario/638794/) 
Hola. En JoyList, una startup de alto crecimiento buscando revolucionar la forma en que se consumen experiencias actualmente, estamos bus...

